{"version":3,"sources":["webpack://egg-born-module-cms-sitecommunity/./backend/src/bean/atom.post.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/bean/version.manager.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/beans.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/config/config.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/config/errors.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/config/locale/en-us.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/config/locale/zh-cn.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/config/locales.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/config/static/flowDef/postPublish.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/config/static/flowDefs.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/config/static/resources.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/config/validation/schemas.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/controllers.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/main.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/meta.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/model/post.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/models.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/routes.js","webpack://egg-born-module-cms-sitecommunity/./backend/src/services.js","webpack://egg-born-module-cms-sitecommunity/webpack/bootstrap","webpack://egg-born-module-cms-sitecommunity/webpack/startup"],"names":[],"mappings":";;;;;;AAAA;;AAEA;;AAEA,kBAAkB,wBAAwB;AAC1C;AACA,sCAAsC,wBAAwB;AAC9D,cAAc;AACd;;AAEA,gBAAgB,gCAAgC;AAChD;AACA,qCAAqC,gCAAgC;AACrE;AACA;AACA;AACA;;AAEA,kBAAkB,kCAAkC;AACpD;AACA,0BAA0B,kCAAkC;AAC5D;;AAEA,iBAAiB,8CAA8C;AAC/D;AACA,yBAAyB,8CAA8C;AACvE;;AAEA,kBAAkB,uBAAuB;AACzC;AACA,0BAA0B,uBAAuB;AACjD;;AAEA;;AAEA;AACA;;;;;;;;ACpCA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qEAAqE,uBAAuB;AAC5F,sEAAsE,wBAAwB;AAC9F,sEAAsE,wBAAwB;AAC9F;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,+CAA+C,8CAA8C;AAC7F;AACA;AACA,iDAAiD,8CAA8C;AAC/F;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,qDAAqD;AAChE,WAAW,gFAAgF;AAC3F,WAAW,mEAAmE;AAC9E,WAAW,oEAAoE;AAC/E,WAAW,mEAAmE;AAC9E,WAAW,yDAAyD;AACpE,WAAW,yDAAyD;AACpE,WAAW,mFAAmF;AAC9F,WAAW,oFAAoF;AAC/F,WAAW,gEAAgE;AAC3E,WAAW,kDAAkD;AAC7D;AACA,oDAAoD,oCAAoC;;AAExF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,oFAAoF;AAC7F,SAAS,qFAAqF;AAC9F,SAAS,2FAA2F;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;;AAEA;;AAEA;AACA;;;;;;;;ACjFA,uBAAuB,mBAAO,CAAC,GAA2B;AAC1D,iBAAiB,mBAAO,CAAC,GAAqB;;AAE9C;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;ACjBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA,KAAK;AACL;AACA;AACA,KAAK;AACL;;AAEA;AACA;;;;;;;;ACvDA;AACA;AACA;;;;;;;;ACFA;AACA;AACA;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACNA;AACA,WAAW,mBAAO,CAAC,GAAmB;AACtC,WAAW,mBAAO,CAAC,EAAmB;AACtC;;;;;;;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,aAAa;AACb,WAAW;AACX,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AChEA,oBAAoB,mBAAO,CAAC,GAA0B;;AAEtD;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;;;;;;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP,KAAK;AACL;AACA;AACA;;;;;;;;AC9EA;AACA;AACA;AACA;AACA;;;;;;;;ACJA,eAAe,mBAAO,CAAC,EAAoB;AAC3C,gBAAgB,mBAAO,CAAC,EAAqB;AAC7C,eAAe,mBAAO,CAAC,GAAoB;;AAE3C;;AAEA;AACA,gBAAgB,mBAAO,CAAC,GAAY;AACpC;AACA,iBAAiB,mBAAO,CAAC,GAAa;AACtC;AACA,sBAAsB,mBAAO,CAAC,EAAkB;AAChD;AACA,mBAAmB,mBAAO,CAAC,GAAe;AAC1C;AACA,iBAAiB,mBAAO,CAAC,GAAa;AACtC;AACA,eAAe,mBAAO,CAAC,GAAW;;AAElC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;AC/BA;AACA,kBAAkB,mBAAO,CAAC,GAAgC;AAC1D,yBAAyB,mBAAO,CAAC,GAA6B;AAC9D,0BAA0B,mBAAO,CAAC,GAA8B;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,OAAO;AACP,kBAAkB;AAClB;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;;;;;;;;ACxDA;AACA;AACA;AACA,kBAAkB,iCAAiC,wBAAwB,EAAE;AAC7E;AACA;AACA;AACA;;;;;;;;ACPA,aAAa,mBAAO,CAAC,GAAiB;;AAEtC;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACPA;AACA;AACA;AACA;AACA;;;;;;;;ACJA;AACA;AACA;AACA;AACA;;;;;;;UCJA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UCrBA;UACA;UACA;UACA","file":"backend.js","sourcesContent":["module.exports = app => {\n\n  class Atom extends app.meta.AtomCmsBase {\n\n    async create({ atomClass, item, user }) {\n      // super\n      const key = await super.create({ atomClass, item, user });\n      return { atomId: key.atomId };\n    }\n\n    async read({ atomClass, options, key, user }) {\n      // super\n      const item = await super.read({ atomClass, options, key, user });\n      if (!item) return null;\n      // ok\n      return item;\n    }\n\n    async select({ atomClass, options, items, user }) {\n      // super\n      await super.select({ atomClass, options, items, user });\n    }\n\n    async write({ atomClass, target, key, item, options, user }) {\n      // super\n      await super.write({ atomClass, target, key, item, options, user });\n    }\n\n    async delete({ atomClass, key, user }) {\n      // super\n      await super.delete({ atomClass, key, user });\n    }\n\n  }\n\n  return Atom;\n};\n","module.exports = app => {\n  const moduleInfo = app.meta.mockUtil.parseInfoFromPackage(__dirname);\n  class Version extends app.meta.BeanBase {\n\n    async update(options) {\n      if (options.version === 1) {\n      }\n    }\n\n    async init(options) {\n      if (options.version === 1) {\n        // create roles: cms-community-writer to template\n        const roles = [ 'cms-community-writer', 'cms-community-publisher' ];\n        const roleTemplate = await this.ctx.bean.role.getSystemRole({ roleName: 'template' });\n        const roleSuperuser = await this.ctx.bean.role.getSystemRole({ roleName: 'superuser' });\n        const roleActivated = await this.ctx.bean.role.getSystemRole({ roleName: 'activated' });\n        for (const roleName of roles) {\n          const roleId = await this.ctx.bean.role.add({\n            roleName,\n            roleIdParent: roleTemplate.id,\n          });\n          // role:superuser include cms-community\n          await this.ctx.bean.role.addRoleInc({ roleId: roleSuperuser.id, roleIdInc: roleId });\n          // role:activated include cms-community-writer\n          if (roleName === 'cms-community-writer') {\n            await this.ctx.bean.role.addRoleInc({ roleId: roleActivated.id, roleIdInc: roleId });\n          }\n        }\n        // build roles\n        await this.ctx.bean.role.setDirty(true);\n\n        // add role rights\n        const roleRights = [\n          { roleName: 'cms-community-writer', action: 'create' },\n          { roleName: 'cms-community-writer', action: 'read', scopeNames: 'authenticated' },\n          { roleName: 'cms-community-writer', action: 'write', scopeNames: 0 },\n          { roleName: 'cms-community-writer', action: 'delete', scopeNames: 0 },\n          { roleName: 'cms-community-writer', action: 'clone', scopeNames: 0 },\n          { roleName: 'cms-community-writer', action: 'deleteBulk' },\n          { roleName: 'cms-community-writer', action: 'exportBulk' },\n          { roleName: 'cms-community-publisher', action: 'read', scopeNames: 'authenticated' },\n          { roleName: 'cms-community-publisher', action: 'write', scopeNames: 'authenticated' },\n          { roleName: 'root', action: 'read', scopeNames: 'authenticated' },\n          { roleName: 'root', action: 'read', scopeNames: 0 },\n        ];\n        await this.ctx.bean.role.addRoleRightBatch({ atomClassName: 'post', roleRights });\n\n      }\n    }\n\n    async test() {\n      const atomClass = {\n        module: moduleInfo.relativeName,\n        atomClassName: 'post',\n      };\n      const categories = [\n        { categoryName: 'Share', language: 'en-us', categoryIdParent: 0, categorySorting: 1 },\n        { categoryName: 'Answer', language: 'en-us', categoryIdParent: 0, categorySorting: 2 },\n        { categoryName: 'Announcement', language: 'en-us', categoryIdParent: 0, categorySorting: 3 },\n      ];\n      const categoryIds = {};\n      for (const item of categories) {\n        // add\n        const categoryId = await this.ctx.bean.category.add({\n          atomClass,\n          data: {\n            language: item.language,\n            categoryName: item.categoryName,\n            categoryHidden: item.categoryHidden,\n            categorySorting: item.categorySorting,\n            categoryFlag: item.categoryFlag,\n            categoryIdParent: item.categoryIdParent ? categoryIds[item.categoryIdParent] : 0,\n          },\n        });\n        categoryIds[item.categoryName] = categoryId;\n      }\n    }\n\n  }\n\n  return Version;\n};\n","const versionManager = require('./bean/version.manager.js');\nconst atomPost = require('./bean/atom.post.js');\n\nmodule.exports = app => {\n  const beans = {\n    // version\n    'version.manager': {\n      mode: 'app',\n      bean: versionManager,\n    },\n    // atom\n    'atom.post': {\n      mode: 'app',\n      bean: atomPost,\n    },\n  };\n  return beans;\n};\n","// eslint-disable-next-line\nmodule.exports = appInfo => {\n  const config = {};\n\n  // site\n  config.cms = {};\n  config.cms.site = {\n    base: {\n      title: 'Community',\n      subTitle: 'Everything About CabloyJS',\n      description: '',\n      keywords: '',\n    },\n    host: {\n      url: 'http://localhost',\n      rootPath: 'cms-test-community',\n    },\n    language: {\n      default: 'en-us',\n      items: 'en-us',\n    },\n    themes: {\n      'en-us': 'cms-themecommunity',\n    },\n    edit: {\n      mode: 1, // markdown\n    },\n    env: {\n      format: {\n        date: 'YYYY-MM-DD',\n        time: 'HH:mm:ss',\n      },\n      article2: {\n        recentNum: 5,\n      },\n      comment: {\n        order: 'asc',\n        recentNum: 5,\n      },\n      brother: {\n        order: 'desc',\n      },\n      loadMore: {\n        loadOnScroll: false,\n      },\n    },\n    profile: {\n\n    },\n    beian: {\n      icp: '',\n    },\n  };\n\n  return config;\n};\n","// error code should start from 1001\nmodule.exports = {\n};\n","module.exports = {\n  Post2: 'Post',\n};\n","module.exports = {\n  'CMS:Community': 'CMS:社区',\n  Post2: '帖子',\n  'Create Post': '新建帖子',\n  'Post List': '帖子列表',\n  'Post List(by Category)': '帖子列表(按目录)',\n};\n","module.exports = {\n  'en-us': require('./locale/en-us.js'),\n  'zh-cn': require('./locale/zh-cn.js'),\n};\n","module.exports = app => {\n  const moduleInfo = app.meta.mockUtil.parseInfoFromPackage(__dirname);\n  const content = {\n    listener: null,\n    process: {\n      nodes: [\n        {\n          id: 'startEvent_1',\n          name: 'Drafting',\n          type: 'startEventAtom',\n          options: {\n            atom: {\n              module: moduleInfo.relativeName,\n              atomClassName: 'post',\n            },\n            conditionExpression: null,\n          },\n        },\n        {\n          id: 'activity_1',\n          name: 'Review',\n          type: 'activityUserTask',\n          options: {\n            assignees: {\n              roles: 'superuser',\n            },\n            confirmation: false,\n            bidding: true,\n            schema: {\n              write: {\n                module: 'a-cms',\n                schema: 'article',\n              },\n            },\n          },\n        },\n        {\n          id: 'endEvent_1',\n          name: 'End',\n          type: 'endEventNone',\n        },\n      ],\n      edges: [\n        {\n          id: 'edge_1',\n          source: 'startEvent_1',\n          target: 'activity_1',\n        },\n        {\n          id: 'edge_2',\n          source: 'activity_1',\n          target: 'endEvent_1',\n        },\n      ],\n    },\n  };\n  const definition = {\n    atomName: 'Community Post Publish',\n    atomStaticKey: 'flowPostPublish',\n    atomRevision: 0,\n    description: '',\n    content: JSON.stringify(content),\n  };\n  return definition;\n};\n","const postPublish = require('./flowDef/postPublish.js');\n\nmodule.exports = app => {\n  const flowDefs = [\n    postPublish(app),\n  ];\n  return flowDefs;\n};\n","module.exports = app => {\n  const moduleInfo = app.meta.mockUtil.parseInfoFromPackage(__dirname);\n  const resources = [\n    // menu\n    {\n      atomName: 'Create Post',\n      atomStaticKey: 'createPost',\n      atomRevision: 0,\n      atomCategoryId: 'a-base:menu.Create',\n      resourceType: 'a-base:menu',\n      resourceConfig: JSON.stringify({\n        module: moduleInfo.relativeName,\n        atomClassName: 'post',\n        atomAction: 'create',\n      }),\n      resourceRoles: 'template.cms-community-writer',\n    },\n    {\n      atomName: 'Post List',\n      atomStaticKey: 'listPost',\n      atomRevision: 0,\n      atomCategoryId: 'a-base:menu.List',\n      resourceType: 'a-base:menu',\n      resourceConfig: JSON.stringify({\n        module: moduleInfo.relativeName,\n        atomClassName: 'post',\n        atomAction: 'read',\n      }),\n      resourceRoles: 'root',\n    },\n  ];\n  return resources;\n};\n","module.exports = app => {\n  const moduleInfo = app.meta.mockUtil.parseInfoFromPackage(__dirname);\n  const schemas = {};\n  // post\n  schemas.post = {\n    type: 'object',\n    properties: {\n      atomId: {\n        type: 'number',\n      },\n      // title\n      groupTitle: {\n        type: 'null',\n        ebType: 'group-flatten',\n        ebTitle: 'Title',\n      },\n      atomName: {\n        type: 'string',\n        ebType: 'text',\n        ebTitle: 'Atom Name',\n        notEmpty: true,\n      },\n      // content\n      groupContent: {\n        type: 'null',\n        ebType: 'group-flatten',\n        ebTitle: 'Content',\n      },\n      content: {\n        type: 'string',\n        ebType: 'component',\n        ebTitle: 'Content',\n        ebRender: {\n          module: 'a-cms',\n          name: 'renderArticleContent',\n        },\n      },\n      // Basic Info\n      groupBasicInfo: {\n        type: 'null',\n        ebType: 'group-flatten',\n        ebTitle: 'Basic Info',\n        ebGroupWhole: true,\n      },\n      atomLanguage: {\n        type: 'string',\n        ebType: 'language',\n        ebTitle: 'Language',\n        notEmpty: true,\n      },\n      atomCategoryId: {\n        type: 'number',\n        ebType: 'category',\n        ebTitle: 'Category',\n        notEmpty: true,\n      },\n      atomTags: {\n        type: [ 'string', 'null' ],\n        ebType: 'tags',\n        ebTitle: 'Tags',\n      },\n    },\n  };\n  // post search\n  schemas.postSearch = {\n    type: 'object',\n    properties: {\n      html: {\n        type: 'string',\n        ebType: 'text',\n        ebTitle: 'Content',\n        ebSearch: {\n          tableAlias: 'q',\n        },\n      },\n    },\n  };\n  return schemas;\n};\n","module.exports = app => {\n  const controllers = {\n  };\n  return controllers;\n};\n","const config = require('./config/config.js');\nconst locales = require('./config/locales.js');\nconst errors = require('./config/errors.js');\n\nmodule.exports = app => {\n\n  // beans\n  const beans = require('./beans.js')(app);\n  // routes\n  const routes = require('./routes.js')(app);\n  // controllers\n  const controllers = require('./controllers.js')(app);\n  // services\n  const services = require('./services.js')(app);\n  // models\n  const models = require('./models.js')(app);\n  // meta\n  const meta = require('./meta.js')(app);\n\n  return {\n    beans,\n    routes,\n    controllers,\n    services,\n    models,\n    config,\n    locales,\n    errors,\n    meta,\n  };\n\n};\n","module.exports = app => {\n  const schemas = require('./config/validation/schemas.js')(app);\n  const staticFlowDefs = require('./config/static/flowDefs.js')(app);\n  const staticResources = require('./config/static/resources.js')(app);\n  const meta = {\n    base: {\n      atoms: {\n        post: {\n          info: {\n            bean: 'post',\n            title: 'Post2',\n            tableName: '',\n            tableNameModes: {\n              default: '',\n              full: '',\n              search: '',\n            },\n            language: true,\n            category: true,\n            tag: true,\n            cms: true,\n          },\n          actions: {\n          },\n          validator: 'post',\n          search: {\n            validator: 'postSearch',\n          },\n        },\n      },\n      statics: {\n        'a-flow.flowDef': {\n          items: staticFlowDefs,\n        },\n        'a-base.resource': {\n          items: staticResources,\n        },\n      },\n    },\n    validation: {\n      validators: {\n        post: {\n          schemas: 'post',\n        },\n        postSearch: {\n          schemas: 'postSearch',\n        },\n      },\n      keywords: {},\n      schemas: {\n        post: schemas.post,\n        postSearch: schemas.postSearch,\n      },\n    },\n  };\n  return meta;\n};\n","module.exports = app => {\n  class Post extends app.meta.Model {\n    constructor(ctx) {\n      super(ctx, { table: 'aCmsArticle', options: { disableDeleted: false } });\n    }\n  }\n  return Post;\n};\n","const post = require('./model/post.js');\n\nmodule.exports = app => {\n  const models = {\n    post,\n  };\n  return models;\n};\n","module.exports = app => {\n  const routes = [\n  ];\n  return routes;\n};\n","module.exports = app => {\n  const services = {\n  };\n  return services;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(421);\n"],"sourceRoot":""}