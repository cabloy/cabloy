window["a-base"]=function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=14)}([function(t,e,n){"use strict";function o(t,e,n,o,a,i,r,s){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),o&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),r?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=l):a&&(l=s?function(){a.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:a),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(t,e){return l.call(e),u(t,e)}}else{var m=c.beforeCreate;c.beforeCreate=m?[].concat(m,l):[l]}return{exports:t,options:c}}n.d(e,"a",(function(){return o}))},function(t,e){t.exports=window.Vue},function(t,e,n){"use strict";e.a={computed:{atomClassesAll:function(){return this.$store.getState("a/base/atomClasses")}},methods:{getAtomClass:function(t){return this.atomClassesAll&&t?this.atomClassesAll[t.module][t.atomClassName]:null}},created:function(){this.$store.dispatch("a/base/getAtomClasses")}}},function(t,e,n){"use strict";var o=n(2);function a(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,r=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function r(t,e,n,o,a,i,r){try{var s=t[i](r),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(o,a)}e.a={meta:{global:!1},mixins:[o.a],props:{scene:{type:String},options:{type:String},layout:{type:String},atomClass:{type:Object},params:{type:Object}},data:function(){return{ready:!1,layout2:null,layoutConfig:null,configAtomBase:null,configAtom:null,filter:null,atomOrderSelected:null,selectedAtomIds:null,selectedAtoms:null}},computed:{layoutComponentInstance:function(){return this.$refs.layout&&this.$refs.layout.getComponentInstance()},userLabels:function(){return this.$local.getters("userLabels")},atomOrderDefault:function(){return"select"===this.scene?{name:"atomName",by:"asc",tableAlias:"a"}:{name:"updatedAt",by:"desc",tableAlias:"a"}}},created:function(){var t=this;this.$local.dispatch("getLabels"),this.layout2=this.layout||this.getLayout(),this.prepareLayoutConfig().then((function(){t.ready=!0}))},methods:{onPageRefresh:function(){this.layoutComponentInstance&&this.layoutComponentInstance.onPageRefresh()},onPageInfinite:function(){this.layoutComponentInstance&&this.layoutComponentInstance.onPageInfinite()},onPerformFilter:function(){var t=this._getFilterConfig();this.$view.navigate("/a/baselayout/listLayoutFilter",{scene:"sidebar",sceneOptions:{side:"right",name:"filter",title:"Filter"},context:{params:{layoutManager:this,filterConfig:t}}})},onFilterChanged:function(t){this.filter=t,this.onPageRefresh()},onPerformAtomOrders:function(t){var e=this.$refs.popoverAtomOrders.$el;this.$f7.popover.open(e,t)},onPerformChangeAtomOrder:function(t,e){var n=this.atomOrderSelected||this.atomOrderDefault;this._getAtomOrderKey(n)===this._getAtomOrderKey(e)?this.atomOrderSelected={name:n.name,tableAlias:n.tableAlias,by:"desc"===n.by?"asc":"desc"}:this.atomOrderSelected=e,this.onPageRefresh()},getLayout:function(){return"small"===this.$view.size?"list":"table"},prepareSelectOptions:function(){var t;if("select"===this.scene){var e={};this.selectedAtomIds||(this.selectedAtomIds=this.params.selectedAtomIds||[]),e["a.id"]=this.selectedAtomIds.length>0?this.selectedAtomIds:null,t={where:e}}else t={where:{}};var n=this.atomOrderSelected||this.atomOrderDefault;return t.orders=[[this._getAtomOrderKey(n),n.by]],this.options&&(t=this.$utils.extend({},t,this.options)),t},prepareSelectParams:function(){var t=this.prepareSelectOptions(),e={atomClass:this.atomClass,options:t},n=this.prepareFilterParams();return n&&(e=this.$utils.extend({},e,n)),e},prepareFilterParams:function(){if(!this.filter)return null;var t={options:{where:{}}};return this.filter.form.atomClass&&(t.atomClass=this.filter.form.atomClass),t},_getAtomOrderKey:function(t){return t?"".concat(t.tableAlias||"f",".").concat(t.name):null},_getAtomOrderStatus:function(t){var e=this.atomOrderSelected||this.atomOrderDefault;return this._getAtomOrderKey(e)===this._getAtomOrderKey(t)?"desc"===e.by?"arrow_drop_down":"arrow_drop_up":""},_getAtomOrders:function(){var t=this.configAtomBase.render.list.info.orders,e=this.$meta.util.getProperty(this.configAtom,"render.list.info.orders");return e?t.concat(e):t},_getFilterConfig:function(){var t=this.configAtomBase.render.list.info.filter,e=this.$meta.util.getProperty(this.configAtom,"render.list.info.filter");return this.$meta.util.extend({},t,e)},prepareLayoutConfig:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){var n,o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.configAtomBase=e.$config.atom,!e.atomClass){t.next=6;break}return t.next=4,e.$meta.module.use(e.atomClass.module);case 4:n=e.$meta.config.modules[e.atomClass.module],e.configAtom=n&&n.atoms&&n.atoms[e.atomClass.atomClassName];case 6:o=e.configAtomBase.render.list.layouts[e.layout2],e.configAtom&&(a=(a=(a=e.configAtom)&&a.render&&a.render.list&&a.render.list.layouts)&&a[e.layout2]),e.layoutConfig=e.$meta.util.extend({},o,a);case 9:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function s(t){r(i,o,a,s,l,"next",t)}function l(t){r(i,o,a,s,l,"throw",t)}s(void 0)}))})()},getPageTitle:function(){var t=this.getAtomClass(this.atomClass);return t?"".concat(this.$text("Atom"),": ").concat(t.titleLocale):this.$text("Atom")},getLayoutComponentOptions:function(){return{props:{layoutManager:this,layoutConfig:this.layoutConfig}}},_renderLayoutComponent:function(){var t=this.$createElement;return this.ready?t("eb-component",{ref:"layout",attrs:{module:this.layoutConfig.component.module,name:this.layoutConfig.component.name,options:this.getLayoutComponentOptions()}}):null},_renderPopoverAtomOrders:function(){var t=this,e=this.$createElement;if(!this.ready)return null;var n,o=[],i=a(this._getAtomOrders());try{var r=function(){var a=n.value;o.push(e("eb-list-item",{key:t._getAtomOrderKey(a),attrs:{popoverClose:!0,link:"#"},props:{onPerform:function(e){return t.onPerformChangeAtomOrder(e,a)}}},[e("f7-icon",{slot:"media",attrs:{material:t._getAtomOrderStatus(a)}}),e("div",{slot:"title"},[t.$text(a.title)])]))};for(i.s();!(n=i.n()).done;)r()}catch(t){i.e(t)}finally{i.f()}var s=e("f7-list",{attrs:{inset:!0}},[o]);return e("eb-popover",{ref:"popoverAtomOrders",attrs:{ready:!0}},[s])}},render:function(){var t=arguments[0];return t("div",[this._renderLayoutComponent(),this._renderPopoverAtomOrders()])}}},function(t,e,n){"use strict";e.a={computed:{actionsAll:function(){return this.$store.getState("a/base/actions")}},methods:{getAction:function(t){return this.actionsAll?this.actionsAll[t.module][t.atomClassName][t.name]:null},getActionTitle:function(t){var e=this.getAction(t);return e?e.titleLocale:null},getActionsOfAtomClass:function(t){return t&&this.actionsAll?this.actionsAll[t.module][t.atomClassName]:null}},created:function(){this.$store.dispatch("a/base/getActions")}}},function(t,e,n){"use strict";e.a={computed:{menusAll:function(){return this.$store.getState("a/base/menus")}},methods:{getMenu:function(t){if(!this.menusAll)return null;var e=this.menusAll[t.module];if(t.name)return e[t.name];for(var n in e)if(e[n].action===t.action)return e[n];return null},getMenuTitle:function(t){var e=this.getMenu(t);return e?e.titleLocale:null}},created:function(){this.$store.dispatch("a/base/getMenus")}}},function(t,e,n){"use strict";var o=n(2),a=n(5);function i(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw i}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function s(t,e,n,o,a,i,r){try{var s=t[i](r),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(o,a)}e.a={mixins:[o.a,a.a],data:function(){return{ready:!1,layoutCurrent:null,layoutConfig:null,configAtomBase:null,configAtom:null,filter:null,atomOrderSelected:null,selectedAtomIds:null,selectedAtoms:null,searchQuery:null,actionsCreate:null,subnavbarActions:!1,actionsList:null}},computed:{layoutComponentInstance:function(){return this.$refs.layout&&this.$refs.layout.getComponentInstance()},userLabels:function(){return this.$store.getters["a/base/userLabels"]},atomOrderDefault:function(){return this.options&&this.options.star?{name:"updatedAt",by:"desc",tableAlias:"d"}:this.options&&this.options.label?{name:"updatedAt",by:"desc",tableAlias:"e"}:{name:"updatedAt",by:"desc",tableAlias:"a"}},showPopoverActionsCreate:function(){return this.actionsCreate&&this.actionsCreate.length>0}},created:function(){var t=this;this.$store.dispatch("a/base/getLabels"),this.layoutCurrent=this.layout||this.getLayout(),this.prepareLayoutConfig().then((function(){t.ready=!0,t.loadActionsCreate()}))},methods:{onPageRefresh:function(t){t&&t(),this.layoutComponentInstance&&this.layoutComponentInstance.onPageRefresh(!0)},onPageInfinite:function(){this.layoutComponentInstance&&this.layoutComponentInstance.onPageInfinite()},onPageClear:function(){this.layoutComponentInstance&&this.layoutComponentInstance.onPageClear()},onPerformFilter:function(){var t=this.$$(this.$el).parents(".eb-layout-view").is(".eb-layout-panel-view"),e="pc"===this.$meta.vueApp.layout&&!t,n={context:{params:{layoutManager:this,filterConfig:this._getFilterConfig(),immediate:e}}};e?(n.scene="sidebar",n.sceneOptions={side:"right",name:"filter",title:"Filter"}):n.target="_self",this.$view.navigate("/a/baselayout/listLayoutFilter",n)},onFilterChanged:function(t){this.filter=t,this.onPageRefresh()},onPerformAtomOrders:function(t){var e=this.$refs.popoverAtomOrders.$el;this.$f7.popover.open(e,t)},onPerformActionsCreate:function(t){var e=this.$refs.popoverActionsCreate.$el;this.$f7.popover.open(e,t)},onPerformChangeAtomOrder:function(t,e){var n=this.atomOrderSelected||this.atomOrderDefault;this._getAtomOrderKey(n)===this._getAtomOrderKey(e)?this.atomOrderSelected={name:n.name,tableAlias:n.tableAlias,by:"desc"===n.by?"asc":"desc"}:this.atomOrderSelected=e,this.onPageRefresh()},onActionsCreateAction:function(t,e){var n=this.getMenu(e);n&&("create"===n.action&&(e={atomClassId:e.atomClassId,module:e.module,atomClassName:e.atomClassName,atomClassIdParent:e.atomClassIdParent},n=this.$utils.extend({},n,{targetEl:t.target})),this.$meta.util.performAction({ctx:this,action:n,item:e}))},getLayout:function(){return"small"===this.$view.size?"list":"table"},prepareSelectOptions:function(){var t={where:{}};this.searchQuery&&(t.where["a.atomName"]={val:this.searchQuery,op:"like"});var e=this.atomOrderSelected||this.atomOrderDefault;return t.orders=[[this._getAtomOrderKey(e),e.by]],this.options&&(t=this.$utils.extend({},t,this.options)),t},prepareSelectParams:function(){var t=this.prepareSelectOptions(),e={atomClass:this.atomClass,options:t},n=this.prepareFilterParams();return n&&(e=this.$utils.extend({},e,n)),e},prepareFilterParams:function(){if(!this.filter)return null;var t={where:{}},e={options:t};this.filter.form&&(this.filter.form.atomName&&(t.where["a.atomName"]={val:this.filter.form.atomName,op:"like"}),this.filter.form.star&&(t.star=Number(this.filter.form.star)),this.filter.form.label&&(t.label=this.filter.form.label),this.filter.form.stage&&(t.stage=this.filter.form.stage),this.filter.form.atomClass&&(e.atomClass=this.filter.form.atomClass));var n=this.filter.formAtomClass;if(n){var o=!1;for(var a in n){var i=n[a];null!=i&&""!==i&&(t.where["f.".concat(a)]="string"==typeof i?{val:i,op:"like"}:i,o=!0)}o&&(t.mode="search")}return e},onSearch:function(t){this.searchQuery=t,this.searchQuery?this.onPageRefresh():this.onPageClear()},onSearchDisable:function(){this.$f7router.back()},onSearchAdvanced:function(){this.onPerformFilter()},_getAtomOrderKey:function(t){return t?"".concat(t.tableAlias||"f",".").concat(t.name):null},_getAtomOrderStatus:function(t){var e=this.atomOrderSelected||this.atomOrderDefault;return this._getAtomOrderKey(e)===this._getAtomOrderKey(t)?"desc"===e.by?"arrow_drop_down":"arrow_drop_up":""},_getAtomOrders:function(){var t=this.configAtomBase.render.list.info.orders,e=this.$meta.util.getProperty(this.configAtom,"render.list.info.orders");return e?t.concat(e):t},_getFilterConfig:function(){var t=this.configAtomBase.render.list.info.filter,e=this.$meta.util.getProperty(this.configAtom,"render.list.info.filter");return this.$meta.util.extend({},t,e)},prepareLayoutConfig:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.configAtomBase=e.$config.atom,!e.atomClass){t.next=5;break}return t.next=4,e.$meta.module.use(e.atomClass.module);case 4:e.configAtom=e.$meta.util.getProperty(e.$meta.config.modules[e.atomClass.module],"atoms.".concat(e.atomClass.atomClassName));case 5:n=e.configAtomBase.render.list.layouts[e.layoutCurrent],o=e.$meta.util.getProperty(e.configAtom,"render.list.layouts.".concat(e.layoutCurrent)),e.layoutConfig=e.$meta.util.extend({},n,o);case 8:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function r(t){s(i,o,a,r,l,"next",t)}function l(t){s(i,o,a,r,l,"throw",t)}r(void 0)}))})()},loadActionsCreate:function(){var t=this;if(!this.atomClass&&!this.actionsCreate){this.$api.post("/a/base/function/list",{options:{where:{menu:1,sceneName:"create"},orders:[["sorting","asc"]]}}).then((function(e){t.actionsCreate=e.list}))}},loadActionsList:function(){this.actionsList},getPageTitle:function(){var t=this.getAtomClass(this.atomClass);return t?"".concat(this.$text("Atom"),": ").concat(t.titleLocale):this.$text("Atom")},getLayoutComponentOptions:function(){return{props:{layoutManager:this,layoutConfig:this.layoutConfig}}},_renderLayoutComponent:function(){var t=this.$createElement;return this.ready?t("eb-component",{ref:"layout",attrs:{module:this.layoutConfig.component.module,name:this.layoutConfig.component.name,options:this.getLayoutComponentOptions()}}):null},_renderPopoverAtomOrders:function(){var t=this,e=this.$createElement;if(!this.ready)return null;var n,o=[],a=i(this._getAtomOrders());try{var r=function(){var a=n.value;o.push(e("eb-list-item",{key:t._getAtomOrderKey(a),attrs:{popoverClose:!0,link:"#"},props:{onPerform:function(e){return t.onPerformChangeAtomOrder(e,a)}}},[e("f7-icon",{slot:"media",attrs:{material:t._getAtomOrderStatus(a)}}),e("div",{slot:"title"},[t.$text(a.title)])]))};for(a.s();!(n=a.n()).done;)r()}catch(t){a.e(t)}finally{a.f()}return e("eb-popover",{ref:"popoverAtomOrders",attrs:{ready:!0}},[e("f7-list",{attrs:{inset:!0}},[o])])},_renderPopoverActionsCreate:function(){var t=this,e=this.$createElement;if(!this.showPopoverActionsCreate)return null;var n,o=[],a=i(this.actionsCreate);try{var r=function(){var a=n.value;o.push(e("eb-list-button",{key:a.id,attrs:{popoverClose:!0},props:{onPerform:function(e){return t.onActionsCreateAction(e,a)}}},[a.titleLocale]))};for(a.s();!(n=a.n()).done;)r()}catch(t){a.e(t)}finally{a.f()}return e("f7-popover",{ref:"popoverActionsCreate"},[e("f7-list",{attrs:{inset:!0}},[o])])},getBlockComponentOptions:function(t){return{props:{layoutManager:this,blockConfig:t.blockConfig}}},_renderBlock:function(t){var e=t.blockName,n=this.$createElement;if(!this.ready)return null;var o=this.layoutConfig.blocks[e];return o?n("eb-component",{attrs:{module:o.component.module,name:o.component.name,options:this.getBlockComponentOptions({blockConfig:o})}}):null},_renderLayout:function(){return(0,this.$createElement)("div",[this._renderLayoutComponent(),this._renderPopoverAtomOrders(),this._renderPopoverActionsCreate()])}}}},function(t,e,n){"use strict";var o=n(1),a=n.n(o),i=n(3),r=n(2),s=n(4);function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw i}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var u={mixins:[r.a,s.a],meta:{global:!1},components:{atoms:i.a},props:{mode:{type:String},query:{type:Object}},data:function(){return{atomId:parseInt(this.query.atomId||0),itemId:parseInt(this.query.itemId||0),atomClassId:parseInt(this.query.atomClassId||0),item:null,module:null,validateParams:null,actions:null,popoverId:a.a.prototype.$meta.util.nextId("popover"),notfound:!1}},computed:{ready:function(){return this.item&&this.module&&this.validateParams&&this.actions&&this.atomClassesAll&&this.actionsAll},title:function(){var t="edit"===this.mode?this.$text("Edit"):this.$text("View");return this.item?"".concat(t,": ").concat(this.item.atomName):t},showPopover:function(){if(!this.ready)return!1;if(this.findAction("write")&&0===this.item.atomStage)return!0;var t,e=l(this.actions);try{for(e.s();!(t=e.n()).done;){if("write"!==t.value.name)return!0}}catch(t){e.e(t)}finally{e.f()}return!1},atomClass:function(){return this.item?{module:this.item.module,atomClassName:this.item.atomClassName}:null},enableFootbar:function(){return this.enableComment||this.enableAttachment},enableComment:function(){var t=this.getAtomClass(this.atomClass);return!!t&&!(t.meta&&!1===t.meta.comment)},enableAttachment:function(){var t=this.getAtomClass(this.atomClass);return!!t&&!(t.meta&&!1===t.meta.attachment)}},mounted:function(){this.$meta.eventHub.$on("atom:action",this.onActionChanged),this.$meta.eventHub.$on("comment:action",this.onCommentChanged),this.$meta.eventHub.$on("attachment:action",this.onAttachmentChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("atom:action",this.onActionChanged),this.$meta.eventHub.$off("comment:action",this.onCommentChanged),this.$meta.eventHub.$off("attachment:action",this.onAttachmentChanged)},created:function(){this.load()},methods:{reload:function(){this.item=null,this.actions=null,this.load()},load:function(){var t=this;this.$api.post("atom/read",{key:{atomId:this.atomId}}).then((function(e){t.item=e,t.$meta.module.use(t.item.module,(function(e){t.module=e})),t.$api.post("atom/validator",{atomClass:{id:t.item.atomClassId}}).then((function(e){t.validateParams={module:e.module,validator:e.validator}})),t.fetchActions()})).catch((function(){t.notfound=!0}))},fetchActions:function(){var t=this;this.$api.post("atom/actions",{key:{atomId:this.atomId}}).then((function(e){t.actions=e}))},findAction:function(t){return this.actions?this.actions.find((function(e){return e.name===t})):null},onSave:function(t){return this.onAction(t,"save")},onAction:function(t,e){var n=this;if("save"===e||"submit"===e)return this.$refs.validate.perform(t,e);"string"==typeof e&&(e={module:this.item.module,atomClassName:this.item.atomClassName,name:e});var o=this.getAction(e);return"write"===e.name&&(o=this.$utils.extend({},o,{navigateOptions:{target:"_self"}})),this.$meta.util.performAction({ctx:this,action:o,item:this.item}).then((function(t){t&&n.$f7router.back()}))},onPerformValidate:function(t,e){var n=this,o=this.$utils.extend({},this.findAction("write"),{name:e}),a=this.getAction(o);return this.$meta.util.performAction({ctx:this,action:a,item:this.item}).then((function(){if("save"===e)return!0;"submit"===e&&n.$f7router.back()}))},onActionChanged:function(t){var e=t.key,n=t.action;if("edit"!==this.mode&&this.ready&&this.item.atomId===e.atomId&&(1!==n.menu||"create"!==n.action))return"delete"===n.name?(this.item=null,void(this.notfound=!0)):void this.reload()},onCommentChanged:function(t){this.item&&t.atomId===this.atomId&&("create"===t.action&&(this.item.commentCount+=1),"delete"===t.action&&(this.item.commentCount-=1))},onAttachmentChanged:function(t){this.item&&t.atomId===this.atomId&&("create"===t.action&&(this.item.attachmentCount+=1),"delete"===t.action&&(this.item.attachmentCount-=1))},onSubmit:function(){this.$refs.buttonSave.onClick()}}},m=n(0),d=Object(m.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.title,"eb-back-link":"Back"}},[n("f7-nav-right",[t.ready&&t.findAction("write")?n("eb-link",{ref:"buttonSave",attrs:{iconMaterial:"edit"===this.mode?"save":"edit",context:"edit"===this.mode?"save":"write",onPerform:t.onAction}}):t._e(),t._v(" "),t.showPopover?n("f7-link",{attrs:{iconMaterial:"more_horiz","popover-open":"#"+t.popoverId}}):t._e()],1)],1),t._v(" "),t.notfound?[n("f7-list",[n("f7-list-item",{attrs:{title:t.$text("Not found")}})],1)]:[t.ready?n("atoms",{attrs:{mode:"list",itemShow:t.item}}):t._e(),t._v(" "),t.ready?n("eb-validate",{ref:"validate",attrs:{readOnly:"edit"!==this.mode,auto:"",data:t.item,params:t.validateParams,onPerform:t.onPerformValidate,onSave:t.onSave},on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}}):t._e(),t._v(" "),n("f7-popover",{attrs:{id:t.popoverId}},[t.showPopover?n("f7-list",{attrs:{inset:""}},[t.findAction("write")&&0===t.item.atomStage?n("eb-list-button",{attrs:{"popover-close":"",context:"submit",onPerform:t.onAction}},[t._v(t._s(t.$text("Submit")))]):t._e(),t._v(" "),t._l(t.actions,(function(e){return"write"!==e.name?n("eb-list-button",{key:e.id,attrs:{"popover-close":"",context:e,onPerform:t.onAction}},[t._v(t._s(t.getActionTitle(e)))]):t._e()}))],2):t._e()],1)],t._v(" "),t.ready&&t.enableFootbar?n("f7-toolbar",{attrs:{"bottom-md":""}},[t.enableComment?n("eb-link",{attrs:{iconMaterial:"comment","eb-href":"comment/list?atomId="+t.item.atomId}},[t._v(t._s(t.item.commentCount))]):t._e(),t._v(" "),t.enableAttachment?n("eb-link",{attrs:{iconMaterial:"attach_file","eb-href":"attachment/list?atomId="+t.item.atomId}},[t._v(t._s(t.item.attachmentCount))]):t._e()],1):t._e()],2)}),[],!1,null,"447f52f2",null);e.a=d.exports},function(t,e,n){"use strict";var o=n(10),a=n(5);function i(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw i}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var s={meta:{global:!1},mixins:[o.a,a.a],props:{mode:{type:String}},data:function(){return{items:[],query:"",functionScenes:null}},computed:{itemGroups:function(){return"scenes"===this.mode?this.itemGroupsScenes:"modules"===this.mode?this.itemGroupsModules:void 0},itemGroupsScenes:function(){if(!this.functionScenes)return[];var t,e=[],n=null,o=i(this.items);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(!n||n.id!==a.sceneId){var r=this.functionScenes[a.sceneId];n={id:a.sceneId,name:r.sceneName,title:r.titleLocale,items:[]},e.push(n)}n.items.push(a)}}catch(t){o.e(t)}finally{o.f()}return e},itemGroupsModules:function(){if(!this.modulesAll)return[];var t,e=[],n=null,o=i(this.items);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(!n||n.id!==a.module){var r=this.modulesAll[a.module];n={id:a.module,title:r.titleLocale,items:[]},e.push(n)}n.items.push(a)}}catch(t){o.e(t)}finally{o.f()}return e}},mounted:function(){this.$meta.eventHub.$on("menu:star",this.onStarChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("menu:star",this.onStarChanged)},methods:{onSearch:function(t){this.query=t,this.query?this.reload(!0):this.items=[]},reload:function(t){var e=this;this.functionScenes||this.$store.dispatch("a/base/getFunctionScenes",{sceneMenu:1}).then((function(t){e.functionScenes=t})),this.$refs.loadMore.reload(t)},loadMore:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e,n=this,o=t.index;return"scenes"===this.mode?e={where:{"a.menu":1},orders:[["f.sceneSorting","asc"],["a.sorting","asc"]],page:{index:o}}:"modules"===this.mode?e={where:{"a.menu":1},orders:[["a.module","asc"],["f.sceneSorting","asc"],["a.sorting","asc"]],page:{index:o}}:"stars"===this.mode?e={where:{"a.menu":1},orders:[["d.updatedAt","desc"]],star:1,page:{index:o}}:"search"===this.mode&&(e={where:{"a.menu":1,"b.titleLocale":{val:this.query,op:"like"}},orders:[["b.titleLocale","asc"]],page:{index:o}}),this.$api.post("function/list",{options:e}).then((function(t){return n.items=n.items.concat(t.list),t}))},onStarSwitch:function(t,e){var n=this,o=e.star?0:1;return this.$api.post("function/star",{id:e.id,star:o}).then((function(){n.$meta.eventHub.$emit("menu:star",{id:e.id,star:o}),n.$meta.util.swipeoutClose(t.target)}))},onStarOff:function(t,e){var n=this;return this.$api.post("function/star",{id:e.id,star:0}).then((function(){n.$meta.eventHub.$emit("menu:star",{id:e.id,star:0}),n.$meta.util.swipeoutDelete(t.target)}))},onStarChanged:function(t){var e=this.items.findIndex((function(e){return e.id===t.id}));"stars"===this.mode?0===t.star&&-1!==e?this.items.splice(e,1):1===t.star&&-1===e&&this.reload():-1!==e&&(this.items[e].star=t.star)},onItemClick:function(t,e){var n=this.getMenu(e);if(n)return"create"===n.action&&(e={atomClassId:e.atomClassId,module:e.module,atomClassName:e.atomClassName,atomClassIdParent:e.atomClassIdParent},n=this.$utils.extend({},n,{targetEl:t.target})),this.$meta.util.performAction({ctx:this,action:n,item:e})}}},l=n(0),c=Object(l.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("f7-list",["search"===t.mode?t._l(t.items,(function(e){return n("eb-list-item",{key:e.id,attrs:{link:"#",context:e,onPerform:t.onItemClick,title:e.titleLocale,swipeout:""}},[n("f7-icon",{attrs:{slot:"media",color:"orange",material:e.star?"star":""},slot:"media"}),t._v(" "),n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"orange",context:e,onPerform:t.onStarSwitch}},[t._v(t._s(e.star?t.$text("Unstar"):t.$text("Star")))])])])],1)})):"stars"===t.mode?t._l(t.items,(function(e){return n("eb-list-item",{key:e.id,attrs:{link:"#",context:e,onPerform:t.onItemClick,title:e.titleLocale,swipeout:""}},[n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"orange",context:e,onPerform:t.onStarOff}},[t._v(t._s(t.$text("Unstar")))])])])],1)})):t._l(t.itemGroups,(function(e){return n("f7-list-group",{key:e.id},[n("f7-list-item",{attrs:{title:e.title,"group-title":""}}),t._v(" "),t._l(e.items,(function(e){return n("eb-list-item",{key:e.id,attrs:{link:"#",context:e,onPerform:t.onItemClick,title:e.titleLocale,swipeout:""}},[n("f7-icon",{attrs:{slot:"media",color:"orange",material:e.star?"star":""},slot:"media"}),t._v(" "),n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"orange",context:e,onPerform:t.onStarSwitch}},[t._v(t._s(e.star?t.$text("Unstar"):t.$text("Star")))])])])],1)}))],2)}))],2),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!1}})],1)}),[],!1,null,null,null);e.a=c.exports},function(t,e,n){var o=n(20);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,n(12).default)("2caef980",o,!0,{})},function(t,e,n){"use strict";e.a={computed:{modulesAll:function(){return this.$store.getState("a/base/modules")}},created:function(){this.$store.dispatch("a/base/getModules")},methods:{getModule:function(t){return this.modulesAll?this.modulesAll[t]:null}}}},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",o=t[3];if(!o)return n;if(e&&"function"==typeof btoa){var a=(r=o,s=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),i=o.sources.map((function(t){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(t," */")}));return[n].concat(i).concat([a]).join("\n")}var r,s,l;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,o){"string"==typeof t&&(t=[[null,t,""]]);var a={};if(o)for(var i=0;i<this.length;i++){var r=this[i][0];null!=r&&(a[r]=!0)}for(var s=0;s<t.length;s++){var l=[].concat(t[s]);o&&a[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),e.push(l))}},e}},function(t,e,n){"use strict";function o(t,e){for(var n=[],o={},a=0;a<e.length;a++){var i=e[a],r=i[0],s={id:t+":"+a,css:i[1],media:i[2],sourceMap:i[3]};o[r]?o[r].parts.push(s):n.push(o[r]={id:r,parts:[s]})}return n}n.r(e),n.d(e,"default",(function(){return f}));var a="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!a)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},r=a&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,c=!1,u=function(){},m=null,d="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(t,e,n,a){c=n,m=a||{};var r=o(t,e);return h(r),function(e){for(var n=[],a=0;a<r.length;a++){var s=r[a];(l=i[s.id]).refs--,n.push(l)}e?h(r=o(t,e)):r=[];for(a=0;a<n.length;a++){var l;if(0===(l=n[a]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete i[l.id]}}}}function h(t){for(var e=0;e<t.length;e++){var n=t[e],o=i[n.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](n.parts[a]);for(;a<n.parts.length;a++)o.parts.push(b(n.parts[a]));o.parts.length>n.parts.length&&(o.parts.length=n.parts.length)}else{var r=[];for(a=0;a<n.parts.length;a++)r.push(b(n.parts[a]));i[n.id]={id:n.id,refs:1,parts:r}}}}function p(){var t=document.createElement("style");return t.type="text/css",r.appendChild(t),t}function b(t){var e,n,o=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(o){if(c)return u;o.parentNode.removeChild(o)}if(d){var a=l++;o=s||(s=p()),e=y.bind(null,o,a,!1),n=y.bind(null,o,a,!0)}else o=p(),e=A.bind(null,o),n=function(){o.parentNode.removeChild(o)};return e(t),function(o){if(o){if(o.css===t.css&&o.media===t.media&&o.sourceMap===t.sourceMap)return;e(t=o)}else n()}}var v,g=(v=[],function(t,e){return v[t]=e,v.filter(Boolean).join("\n")});function y(t,e,n,o){var a=n?"":o.css;if(t.styleSheet)t.styleSheet.cssText=g(e,a);else{var i=document.createTextNode(a),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(i,r[e]):t.appendChild(i)}}function A(t,e){var n=e.css,o=e.media,a=e.sourceMap;if(o&&t.setAttribute("media",o),m.ssrId&&t.setAttribute("data-vue-ssr-id",e.id),a&&(n+="\n/*# sourceURL="+a.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},function(t,e,n){t.exports=n.p+"static/img/user.4819d46124c424b8e299f0f5ed68fb6d.png"},function(t,e,n){"use strict";n.r(e);var o;n(15);e.default={install:function(t,e){return o?console.error("already installed."):(o=t,e({routes:n(17).default,store:n(24).default(o),config:n(25).default,locales:n(26).default,components:n(44).default,mixins:n(45).default}))}}},function(t,e,n){var o=n(16);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,n(12).default)("f5202a0a",o,!0,{})},function(t,e,n){(e=n(11)(!0)).push([t.i,".comment .header-container {\n  width: 100%;\n}\n.comment .header-atom a.link {\n  text-transform: none;\n  text-align: right;\n}\n.comment .header-comment {\n  display: flex;\n  justify-content: space-between;\n}\n.comment .title .avatar {\n  float: left;\n}\n.comment .title .name {\n  margin-left: 40px;\n  font-size: 14px;\n  font-weight: 600;\n}\n.comment .title .date {\n  margin-top: -4px;\n  margin-left: 39px;\n  font-size: 13px;\n  color: var(--f7-text-editor-placeholder-color);\n}\n.comment .actions {\n  display: flex;\n}\n.comment .actions a.action {\n  min-width: 0;\n  height: auto;\n  color: var(--f7-text-editor-placeholder-color);\n}\n.comment .actions a.action .icon {\n  display: inline;\n  font-size: 18px;\n}\n.comment .actions a.action + a.action {\n  margin-left: 6px;\n}\n","",{version:3,sources:["/Users/yangjian/Documents/data/cabloy/cabloy-lerna/src/module-system/a-base-sync/front/src/assets/css/module.less","module.less"],names:[],mappings:"AAAA;EAGI,WAAA;ACDJ;ADFA;EAQM,oBAAA;EACA,iBAAA;ACHN;ADNA;EAcI,aAAA;EACA,8BAAA;ACLJ;ADVA;EAoBM,WAAA;ACPN;ADbA;EAwBM,iBAAA;EACA,eAAA;EACA,gBAAA;ACRN;ADlBA;EA8BM,gBAAA;EACA,iBAAA;EACA,eAAA;EACA,8CAAA;ACTN;ADxBA;EAsCI,aAAA;ACXJ;AD3BA;EAyCM,YAAA;EACA,YAAA;EACA,8CAAA;ACXN;ADhCA;EA8CQ,eAAA;EACA,eAAA;ACXR;ADcM;EACE,gBAAA;ACZR",file:"module.less",sourcesContent:[".comment {\n\n  .header-container {\n    width: 100%;\n  }\n\n  .header-atom {\n    a.link {\n      text-transform: none;\n      text-align: right;\n    }\n  }\n\n  .header-comment {\n    display: flex;\n    justify-content: space-between;\n  }\n\n  .title {\n    .avatar {\n      float: left;\n    }\n\n    .name {\n      margin-left: 40px;\n      font-size: 14px;\n      font-weight: 600;\n    }\n\n    .date {\n      margin-top: -4px;\n      margin-left: 39px;\n      font-size: 13px;\n      color: var(--f7-text-editor-placeholder-color);\n    }\n  }\n\n  .actions {\n    display: flex;\n\n    a.action {\n      min-width: 0;\n      height: auto;\n      color: var(--f7-text-editor-placeholder-color);\n\n      .icon {\n        display: inline;\n        font-size: 18px;\n      }\n\n      &+a.action {\n        margin-left: 6px;\n      }\n    }\n  }\n}\n",".comment .header-container {\n  width: 100%;\n}\n.comment .header-atom a.link {\n  text-transform: none;\n  text-align: right;\n}\n.comment .header-comment {\n  display: flex;\n  justify-content: space-between;\n}\n.comment .title .avatar {\n  float: left;\n}\n.comment .title .name {\n  margin-left: 40px;\n  font-size: 14px;\n  font-weight: 600;\n}\n.comment .title .date {\n  margin-top: -4px;\n  margin-left: 39px;\n  font-size: 13px;\n  color: var(--f7-text-editor-placeholder-color);\n}\n.comment .actions {\n  display: flex;\n}\n.comment .actions a.action {\n  min-width: 0;\n  height: auto;\n  color: var(--f7-text-editor-placeholder-color);\n}\n.comment .actions a.action .icon {\n  display: inline;\n  font-size: 18px;\n}\n.comment .actions a.action + a.action {\n  margin-left: 6px;\n}\n"]}]),t.exports=e},function(t,e,n){"use strict";function o(t){return n(18)("./".concat(t,".vue")).default}function a(t){return n(21)("./".concat(t,".jsx")).default}n.r(e),e.default=[{path:"menu/list",component:o("menu/list")},{path:"menu/search",component:o("menu/search")},{path:"menu/selectFunction",component:o("menu/selectFunction")},{path:"atom/list",component:a("atom/list")},{path:"atom/searchQuick",component:a("atom/searchQuick")},{path:"atom/labels",component:o("atom/labels")},{path:"atom/edit",component:o("atom/edit")},{path:"atom/view",component:o("atom/view")},{path:"atom/selectAtomClass",component:o("atom/selectAtomClass")},{path:"atom/select",component:o("atom/select")},{path:"atom/autoStar",component:o("atom/autoStar")},{path:"comment/list",component:o("comment/list")},{path:"comment/item",component:o("comment/item")},{path:"comment/all",component:o("comment/all")},{path:"comment/autoHeart",component:o("comment/autoHeart")},{path:"attachment/list",component:o("attachment/list")},{path:"base/alert",component:o("base/alert")}]},function(t,e,n){var o={"./atom/autoStar.vue":29,"./atom/edit.vue":30,"./atom/labels.vue":31,"./atom/select.vue":32,"./atom/selectAtomClass.vue":33,"./atom/view.vue":34,"./attachment/list.vue":35,"./base/alert.vue":36,"./comment/all.vue":37,"./comment/autoHeart.vue":38,"./comment/item.vue":39,"./comment/list.vue":40,"./menu/list.vue":41,"./menu/search.vue":42,"./menu/selectFunction.vue":43};function a(t){var e=i(t);return n(e)}function i(t){if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}a.keys=function(){return Object.keys(o)},a.resolve=i,t.exports=a,a.id=18},function(t,e,n){"use strict";var o=n(9);n.n(o).a},function(t,e,n){(e=n(11)(!0)).push([t.i,"\n.label[data-v-031299f9] {\n  position: absolute;\n  width: 100%;\n  top: 10px;\n  text-align: center;\n}\n.media[data-v-031299f9] {\n  width: 16px;\n  height: 16px;\n  border-radius: 8px;\n}\n.colors[data-v-031299f9] {\n  height: 60px;\n  width: 100%;\n}\n\n","",{version:3,sources:["front/src/pages/atom/labels.vue"],names:[],mappings:";AAiJA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;EACA,kBAAA;AACA;AAEA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;AACA;AAEA;EACA,YAAA;EACA,WAAA;AACA",file:"labels.vue",sourcesContent:['<template>\n  <eb-page>\n    <eb-navbar large largeTransparent :title="$text(\'Labels\')" eb-back-link="Back">\n      <f7-nav-right>\n        <eb-link iconMaterial="add" @click.prevent="onAddLabel"></eb-link>\n      </f7-nav-right>\n    </eb-navbar>\n    <f7-list v-if="labelsAll">\n      <f7-list-item group-title :title="item?item.atomName:\'\'"></f7-list-item>\n      <eb-list-item v-for="key of Object.keys(labelsAll)" :key="key" :title="labelsAll[key].text" checkbox :checked="labelChecked(key)" @change="onLabelCheckChange($event,key)" swipeout>\n        <div slot="media" class="media" :style="{backgroundColor:labelsAll[key].color}"></div>\n        <eb-context-menu>\n          <div slot="right">\n            <div close color="orange" :context="key" :onPerform="onEditLabel">{{$text(\'Edit\')}}</div>\n          </div>\n        </eb-context-menu>\n      </eb-list-item>\n    </f7-list>\n    <f7-sheet ref="ebSheet" fill :opened="sheetOpened" @sheet:closed="sheetOpened = false">\n      <f7-toolbar>\n        <div class="left">\n          <f7-link sheet-close>{{$text(\'Close\')}}</f7-link>\n        </div>\n        <div class="right">\n          <eb-link ref="buttonSubmit" :onPerform="onSubmit">{{$text(\'Submit\')}}</eb-link>\n        </div>\n      </f7-toolbar>\n      <f7-page-content>\n        <div class="label">\n          <f7-badge :style="{backgroundColor:labelColor}">{{labelText}}</f7-badge>\n        </div>\n        <eb-list form inline-labels no-hairlines-md @submit.prevent="onFormSubmit">\n          <eb-list-input :label="$text(\'Text\')" type="text" clear-button :placeholder="$text(\'Text\')" v-model="labelText">\n          </eb-list-input>\n          <f7-list-item>\n            <div class="row colors">\n              <f7-button v-for="color of colors" :key="color.value" class="col-33" :style="{backgroundColor:color.value}" small fill @click="onColorSelect(color)">{{$text(color.name)}}</f7-button>\n            </div>\n          </f7-list-item>\n        </eb-list>\n      </f7-page-content>\n    </f7-sheet>\n  </eb-page>\n</template>\n<script>\nexport default {\n  data() {\n    return {\n      atomId: parseInt(this.$f7route.query.atomId),\n      item: null,\n      labels: [],\n      sheetOpened: false,\n      labelId: 0,\n      labelText: \'\',\n      labelColor: \'\',\n      colors: [\n        { name: \'Red\', value: \'#FC6360\' },\n        { name: \'Orange\', value: \'#FDA951\' },\n        { name: \'Yellow\', value: \'#FED558\' },\n        { name: \'Blue\', value: \'#54BEF7\' },\n        { name: \'Green\', value: \'#86DF6A\' },\n        { name: \'Purple\', value: \'#D592E5\' },\n      ],\n    };\n  },\n  computed: {\n    labelsAll() {\n      return this.$local.getters(\'userLabels\');\n    },\n  },\n  methods: {\n    onAddLabel() {\n      this.labelId = 0;\n      this.labelText = \'\';\n      this.labelColor = \'\';\n      this.sheetOpened = true;\n    },\n    onEditLabel(event, key) {\n      this.labelId = key;\n      this.labelText = this.labelsAll[key].text;\n      this.labelColor = this.labelsAll[key].color;\n      this.sheetOpened = true;\n    },\n    onFormSubmit() {\n      this.$refs.buttonSubmit.onClick();\n    },\n    onSubmit() {\n      if (!this.labelText || !this.labelColor) return;\n      const labels = this.$meta.util.extend({}, this.labelsAll);\n      if (this.labelId === 0) {\n        labels[this.newLabelId()] = { text: this.labelText, color: this.labelColor };\n      } else {\n        labels[this.labelId] = { text: this.labelText, color: this.labelColor };\n      }\n      return this.$api.post(\'user/setLabels\', {\n        labels,\n      }).then(() => {\n        this.$local.commit(\'setLabels\', labels);\n        this.sheetOpened = false;\n      });\n    },\n    onColorSelect(color) {\n      this.labelColor = color.value;\n    },\n    newLabelId() {\n      const keys = Object.keys(this.labelsAll);\n      if (keys.length === 0) return 1;\n      keys.sort((a, b) => b - a);\n      return parseInt(keys[0]) + 1;\n    },\n    labelChecked(key) {\n      return this.labels && this.labels.indexOf(key) > -1;\n    },\n    onLabelCheckChange(event, key) {\n      // labels\n      const index = this.labels.indexOf(key);\n      if (event.target.checked && index === -1) {\n        this.labels.push(key);\n      } else if (!event.target.checked && index > -1) {\n        this.labels.splice(index, 1);\n      }\n      // sort\n      this.labels.sort((a, b) => a - b);\n      // post\n      this.$api.post(\'atom/labels\', {\n        key: { atomId: this.atomId },\n        atom: { labels: this.labels },\n      }).then(() => {\n        this.$meta.eventHub.$emit(\'atom:labels\', { key: { atomId: this.atomId }, labels: this.labels });\n      });\n    },\n  },\n  created() {\n    this.$local.dispatch(\'getLabels\');\n    this.$api.post(\'atom/read\', {\n      key: { atomId: this.atomId },\n    }).then(data => {\n      this.item = data;\n      this.labels = JSON.parse(this.item.labels) || [];\n    });\n  },\n};\n\n<\/script>\n<style scoped>\n.label {\n  position: absolute;\n  width: 100%;\n  top: 10px;\n  text-align: center;\n}\n\n.media {\n  width: 16px;\n  height: 16px;\n  border-radius: 8px;\n}\n\n.colors {\n  height: 60px;\n  width: 100%;\n}\n\n</style>\n']}]),t.exports=e},function(t,e,n){var o={"./atom/list.jsx":22,"./atom/searchQuick.jsx":23};function a(t){var e=i(t);return n(e)}function i(t){if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}a.keys=function(){return Object.keys(o)},a.resolve=i,t.exports=a,a.id=21},function(t,e,n){"use strict";n.r(e);var o=n(6);e.default={mixins:[o.a],data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName;return{atomClass:e&&n?{module:e,atomClassName:n}:null,options:t&&t.options?JSON.parse(t.options):null,params:t&&t.params?JSON.parse(t.params):null,scene:t&&t.scene,layout:t&&t.layout}},render:function(){var t=arguments[0];return t("eb-page",{attrs:{withSubnavbar:this.subnavbarActions,ptr:!0,infinite:!0,infinitePreloader:!1},on:{ptrRefresh:this.onPageRefresh,infinite:this.onPageInfinite}},[t("eb-navbar",{attrs:{title:this.getPageTitle(),"eb-back-link":"Back"}},[this._renderBlock({blockName:"title"}),this.subnavbarActions&&this._renderBlock({blockName:"subnavbarActions"})]),this._renderLayout()])}}},function(t,e,n){"use strict";n.r(e);var o=n(2),a=n(6);e.default={mixins:[o.a,a.a],data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName;return{atomClass:e&&n?{module:e,atomClassName:n}:null,options:t&&t.options?JSON.parse(t.options):null,scene:"search",layout:"list"}},computed:{pageTitle:function(){var t=this.atomClassTitle||this.$text("Atom");return"".concat(this.$text("Search")," ").concat(t)},atomClassTitle:function(){if(!this.atomClass)return"";if(this.atomClass.title)return this.atomClass.title;var t=this.getAtomClass(this.atomClass);return t?t.titleLocale:""}},render:function(){var t=arguments[0];return t("eb-search-page",{attrs:{advanced:!0,title:this.pageTitle,advancedSearchTitle:"Advanced Filter"},on:{search:this.onSearch,loadMore:this.onPageInfinite,disable:this.onSearchDisable,searchAdvanced:this.onSearchAdvanced}},[this._renderLayoutComponent()])}}},function(t,e,n){"use strict";function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.r(e),e.default=function(t){var e=t.prototype.$meta.util.queue((function(e,n){if(t.prototype.$meta.store.getState("auth/user").op.id!==e.userId)return n();t.prototype.$meta.api.post("/a/base/layoutConfig/saveKey",e.data).then((function(){n()})).catch((function(t){console.error(t),n()}))}));return t.prototype.$meta.eventHub.$on("auth:login",(function(e){t.prototype.$meta.store.commit("a/base/authLogin",e)})),{state:{labels:null,layoutConfig:{},userPanels:null,userWidgets:null,userSections:null,userButtons:null,userAtomClassRolesPreferred:{},modules:null,atomClasses:null,actions:null,functionScenes:{},functions:null,menus:null,panels:null,widgets:null,sections:null,buttons:null},getters:{userLabels:function(t){return t.labels}},mutations:{authLogin:function(t){t.labels=null,t.layoutConfig={},t.userPanels=null,t.userWidgets=null,t.userSections=null,t.userButtons=null,t.userAtomClassRolesPreferred={}},setLabels:function(t,e){t.labels=e},setLayoutConfig:function(t,e){var n=e.module,o=e.data;t.layoutConfig=a(a({},t.layoutConfig),{},i({},n,o))},setLayoutConfigKey:function(n,o){var r=o.module,s=o.key,l=o.value,c=n.layoutConfig[r]||{};c=a(a({},c),{},i({},s,l)),n.layoutConfig=a(a({},n.layoutConfig),{},i({},r,c));var u=t.prototype.$meta.store.getState("auth/user");if(!u.op.anonymous){var m={module:r,key:s,value:l};e.push({userId:u.op.id,data:m})}},setUserPanels:function(t,e){t.userPanels=e},setUserWidgets:function(t,e){t.userWidgets=e},setUserSections:function(t,e){t.userSections=e},setUserButtons:function(t,e){t.userButtons=e},setUserAtomClassRolesPreferred:function(t,e){var n=e.atomClassId,o=e.roleIdOwner;t.userAtomClassRolesPreferred=a(a({},t.userAtomClassRolesPreferred),{},i({},n,o))},setModules:function(t,e){t.modules=e},setAtomClasses:function(t,e){t.atomClasses=e},setActions:function(t,e){t.actions=e},setMenus:function(t,e){t.menus=e},setPanels:function(t,e){t.panels=e},setWidgets:function(t,e){t.widgets=e},setSections:function(t,e){t.sections=e},setButtons:function(t,e){t.buttons=e},setFunctions:function(t,e){t.functions=e},setFunctionScenes:function(t,e){var n=e.sceneMenu,o=e.scenes;t.functionScenes=a(a({},t.functionScenes),{},i({},n,o))}},actions:{getLabels:function(e){var n=e.commit,o=e.getters;return new Promise((function(e,a){var i=o.userLabels;if(i)return e(i);t.prototype.$meta.api.post("/a/base/user/getLabels").then((function(t){n("setLabels",t=t||{}),e(t)})).catch((function(t){a(t)}))}))},getModules:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.modules)return e(n.modules);t.prototype.$meta.api.post("/a/base/base/modules").then((function(t){o("setModules",t=t||{}),e(t)})).catch((function(t){a(t)}))}))},getAtomClasses:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.atomClasses)return e(n.atomClasses);t.prototype.$meta.api.post("/a/base/base/atomClasses").then((function(t){o("setAtomClasses",t=t||{}),e(t)})).catch((function(t){a(t)}))}))},getActions:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.actions)return e(n.actions);t.prototype.$meta.api.post("/a/base/base/actions").then((function(t){o("setActions",t=t||{}),e(t)})).catch((function(t){a(t)}))}))},getMenus:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.menus)return e(n.menus);t.prototype.$meta.api.post("/a/base/base/menus").then((function(t){o("setMenus",t=t||{}),e(t)})).catch((function(t){a(t)}))}))},getPanels:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.panels)return e(n.panels);t.prototype.$meta.api.post("/a/base/base/panels").then((function(t){o("setPanels",t=t||{}),e(t)})).catch((function(t){a(t)}))}))},getWidgets:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.widgets)return e(n.widgets);t.prototype.$meta.api.post("/a/base/base/widgets").then((function(t){o("setWidgets",t=t||{}),e(t)})).catch((function(t){a(t)}))}))},getSections:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.sections)return e(n.sections);t.prototype.$meta.api.post("/a/base/base/sections").then((function(t){o("setSections",t=t||{}),e(t)})).catch((function(t){a(t)}))}))},getButtons:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.buttons)return e(n.buttons);t.prototype.$meta.api.post("/a/base/base/buttons").then((function(t){o("setButtons",t=t||{}),e(t)})).catch((function(t){a(t)}))}))},getFunctionScenes:function(e,n){var o=e.state,a=e.commit,i=n.sceneMenu;return new Promise((function(e,n){if(o.functionScenes[i])return e(o.functionScenes[i]);t.prototype.$meta.api.post("/a/base/function/scenes",{sceneMenu:i}).then((function(t){a("setFunctionScenes",{sceneMenu:i,scenes:t=t||{}}),e(t)})).catch((function(t){n(t)}))}))},getFunctions:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.functions)return e(n.functions);t.prototype.$meta.api.post("/a/base/base/functions").then((function(t){o("setFunctions",t=t||{}),e(t)})).catch((function(t){a(t)}))}))},getLayoutConfig:function(e,n){var o=e.state,a=e.commit;return new Promise((function(e,i){if(o.layoutConfig[n])return e(o.layoutConfig[n]);t.prototype.$meta.api.post("/a/base/layoutConfig/load",{module:n}).then((function(t){a("setLayoutConfig",{module:n,data:t=t||{}}),e(t)})).catch((function(t){i(t)}))}))},getUserPanels:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.userPanels)return e(n.userPanels);t.prototype.$meta.api.post("/a/base/function/list",{options:{where:{menu:2},orders:[["titleLocale","asc"]],page:{size:0}}}).then((function(t){o("setUserPanels",t.list),e(t.list)})).catch((function(t){a(t)}))}))},getUserWidgets:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.userWidgets)return e(n.userWidgets);t.prototype.$meta.api.post("/a/base/function/list",{options:{where:{menu:3},orders:[["titleLocale","asc"]],page:{size:0}}}).then((function(t){o("setUserWidgets",t.list),e(t.list)})).catch((function(t){a(t)}))}))},getUserSections:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.userSections)return e(n.userSections);t.prototype.$meta.api.post("/a/base/function/list",{options:{where:{menu:4},orders:[["titleLocale","asc"]],page:{size:0}}}).then((function(t){o("setUserSections",t.list),e(t.list)})).catch((function(t){a(t)}))}))},getUserButtons:function(e){var n=e.state,o=e.commit;return new Promise((function(e,a){if(n.userButtons)return e(n.userButtons);t.prototype.$meta.api.post("/a/base/function/list",{options:{where:{menu:5},orders:[["titleLocale","asc"]],page:{size:0}}}).then((function(t){o("setUserButtons",t.list),e(t.list)})).catch((function(t){a(t)}))}))}}}}},function(t,e,n){"use strict";n.r(e);var o=n(13),a=n.n(o);e.default={menu:{scene:{0:"Default",1:"Create",2:"List",20:"Statistics",50:"Tools"}},user:{avatar:{default:a.a}},atom:{render:{list:{info:{orders:[{name:"createdAt",title:"Created Time",by:"desc",tableAlias:"a"},{name:"updatedAt",title:"Modification Time",by:"desc",tableAlias:"a"},{name:"atomName",title:"Atom Name",by:"asc",tableAlias:"a"}],filter:{component:{module:"a-baselayout",name:"listLayoutFilter"}}},layouts:{list:{component:{module:"a-baselayout",name:"listLayoutList"},blocks:{title:{component:{module:"a-baselayout",name:"listLayoutBlockListTitle"}},subnavbarActions:{component:{module:"a-baselayout",name:"listLayoutBlockListSubnavbarActions"}},items:{component:{module:"a-baselayout",name:"listLayoutBlockListItems"}}}}}}}}}},function(t,e,n){"use strict";n.r(e),e.default={"en-us":n(27).default,"zh-cn":n(28).default}},function(t,e,n){"use strict";n.r(e),e.default={Heart2:"Heart",AtomClassSelectRoleTip:"Select Role"}},function(t,e,n){"use strict";n.r(e),e.default={Menu:"",Scenes:"",Modules:"",Stars:"",Star:"",Unstar:"",Starred:"",Back:"",Done:"",Cancel:"",Close:"",Create:"",Others:"",List:"",Tools:"",Draft:"",Drafts:"",Archive:"",Archives:"",History:"",Histories:"",Labels:"",Submit:"",Edit:"",View:"",Save:"",Delete:"",Red:"",Orange:"",Yellow:"",Blue:"",Green:"",Purple:"",Label:"",Comment:"",Username:"",Realname:"",Email:"",Mobile:"",Motto:"",Locale:"",Search:"",Link:"",Select:"",Remove:"",Heart2:"",Hearted:"",AtomClassSelectRoleTip:"",Filter:"","Advanced Filter":"","Atom Flag":"","Atom Name":"","Modification Time":"","Comment List":"","Created Time":"","Search Menu":"","Search Atom":"","Search Result":"","Select Atom Class":"","Select Menu":"","Select Function":"","Select Panel":"","Select Widget":"","Atom Class":"","Allow Comment":"","Attachment List":"","Flag Not Found":"Flag","Friendly Tips":"","Please Sign In":""}},function(t,e,n){"use strict";n.r(e);var o={data:function(){return{atomId:this.$f7route.query.atomId}},created:function(){var t=this;this.$api.post("/a/base/atom/star",{key:{atomId:this.atomId},atom:{star:1}}).then((function(){t.$view.dialog.alert(t.$text("Starred")).then((function(){t.openAtom()}))}))},methods:{openAtom:function(){location.assign(this.$f7route.query.returnTo)}}},a=n(0),i=Object(a.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("eb-page",[e("eb-navbar",{attrs:{large:"",largeTransparent:"",title:this.$text("Star"),"eb-back-link":"Back"}}),this._v(" "),e("f7-block")],1)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var o={meta:{size:"medium"},components:{item:n(7).a},data:function(){return{query:this.$f7route.query}}},a=n(0),i=Object(a.a)(o,(function(){var t=this.$createElement;return(this._self._c||t)("item",{attrs:{query:this.query,mode:"edit"}})}),[],!1,null,"e2e87734",null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var o={data:function(){return{atomId:parseInt(this.$f7route.query.atomId),item:null,labels:[],sheetOpened:!1,labelId:0,labelText:"",labelColor:"",colors:[{name:"Red",value:"#FC6360"},{name:"Orange",value:"#FDA951"},{name:"Yellow",value:"#FED558"},{name:"Blue",value:"#54BEF7"},{name:"Green",value:"#86DF6A"},{name:"Purple",value:"#D592E5"}]}},computed:{labelsAll:function(){return this.$local.getters("userLabels")}},methods:{onAddLabel:function(){this.labelId=0,this.labelText="",this.labelColor="",this.sheetOpened=!0},onEditLabel:function(t,e){this.labelId=e,this.labelText=this.labelsAll[e].text,this.labelColor=this.labelsAll[e].color,this.sheetOpened=!0},onFormSubmit:function(){this.$refs.buttonSubmit.onClick()},onSubmit:function(){var t=this;if(this.labelText&&this.labelColor){var e=this.$meta.util.extend({},this.labelsAll);return 0===this.labelId?e[this.newLabelId()]={text:this.labelText,color:this.labelColor}:e[this.labelId]={text:this.labelText,color:this.labelColor},this.$api.post("user/setLabels",{labels:e}).then((function(){t.$local.commit("setLabels",e),t.sheetOpened=!1}))}},onColorSelect:function(t){this.labelColor=t.value},newLabelId:function(){var t=Object.keys(this.labelsAll);return 0===t.length?1:(t.sort((function(t,e){return e-t})),parseInt(t[0])+1)},labelChecked:function(t){return this.labels&&this.labels.indexOf(t)>-1},onLabelCheckChange:function(t,e){var n=this,o=this.labels.indexOf(e);t.target.checked&&-1===o?this.labels.push(e):!t.target.checked&&o>-1&&this.labels.splice(o,1),this.labels.sort((function(t,e){return t-e})),this.$api.post("atom/labels",{key:{atomId:this.atomId},atom:{labels:this.labels}}).then((function(){n.$meta.eventHub.$emit("atom:labels",{key:{atomId:n.atomId},labels:n.labels})}))}},created:function(){var t=this;this.$local.dispatch("getLabels"),this.$api.post("atom/read",{key:{atomId:this.atomId}}).then((function(e){t.item=e,t.labels=JSON.parse(t.item.labels)||[]}))}},a=(n(19),n(0)),i=Object(a.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Labels"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"add"},on:{click:function(e){return e.preventDefault(),t.onAddLabel(e)}}})],1)],1),t._v(" "),t.labelsAll?n("f7-list",[n("f7-list-item",{attrs:{"group-title":"",title:t.item?t.item.atomName:""}}),t._v(" "),t._l(Object.keys(t.labelsAll),(function(e){return n("eb-list-item",{key:e,attrs:{title:t.labelsAll[e].text,checkbox:"",checked:t.labelChecked(e),swipeout:""},on:{change:function(n){return t.onLabelCheckChange(n,e)}}},[n("div",{staticClass:"media",style:{backgroundColor:t.labelsAll[e].color},attrs:{slot:"media"},slot:"media"}),t._v(" "),n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{close:"",color:"orange",context:e,onPerform:t.onEditLabel}},[t._v(t._s(t.$text("Edit")))])])])],1)}))],2):t._e(),t._v(" "),n("f7-sheet",{ref:"ebSheet",attrs:{fill:"",opened:t.sheetOpened},on:{"sheet:closed":function(e){t.sheetOpened=!1}}},[n("f7-toolbar",[n("div",{staticClass:"left"},[n("f7-link",{attrs:{"sheet-close":""}},[t._v(t._s(t.$text("Close")))])],1),t._v(" "),n("div",{staticClass:"right"},[n("eb-link",{ref:"buttonSubmit",attrs:{onPerform:t.onSubmit}},[t._v(t._s(t.$text("Submit")))])],1)]),t._v(" "),n("f7-page-content",[n("div",{staticClass:"label"},[n("f7-badge",{style:{backgroundColor:t.labelColor}},[t._v(t._s(t.labelText))])],1),t._v(" "),n("eb-list",{attrs:{form:"","inline-labels":"","no-hairlines-md":""},on:{submit:function(e){return e.preventDefault(),t.onFormSubmit(e)}}},[n("eb-list-input",{attrs:{label:t.$text("Text"),type:"text","clear-button":"",placeholder:t.$text("Text")},model:{value:t.labelText,callback:function(e){t.labelText=e},expression:"labelText"}}),t._v(" "),n("f7-list-item",[n("div",{staticClass:"row colors"},t._l(t.colors,(function(e){return n("f7-button",{key:e.value,staticClass:"col-33",style:{backgroundColor:e.value},attrs:{small:"",fill:""},on:{click:function(n){return t.onColorSelect(e)}}},[t._v(t._s(t.$text(e.name)))])})),1)])],1)],1)],1)],1)}),[],!1,null,"031299f9",null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var o=n(1),a=n.n(o),i=n(2),r=n(3),s={mixins:[a.a.prototype.$meta.module.get("a-components").options.mixins.ebPageContext,i.a],components:{atoms:r.a},data:function(){return{params:null,selectMode:null,atomClass:null,where:null}},computed:{pageTitle:function(){var t,e=this.getAtomClass(this.atomClass);return t=e?e.titleLocale:this.$text("Atom"),"".concat(this.$text("Select")," ").concat(t)}},mounted:function(){var t,e=this,n=this.contextParams;this.selectMode=n.selectMode,this.atomClass=n.atomClass,this.where=n.where,t="single"===n.selectMode?n.selectedAtomId?[n.selectedAtomId]:null:n.selectedAtomIds?n.selectedAtomIds.concat():null,this.params={selectMode:this.selectMode,selectedAtomIds:t},this.$nextTick((function(){e.$refs.list.reload(!0)}))},methods:{onRefresh:function(t){t(),this.$refs.list.reload()},onInfinite:function(){this.$refs.list.loadMore()},onPerformAdd:function(){var t=this,e={},n=this.atomClass;n&&(e.module=n.module,e.atomClassName=n.atomClassName),this.where&&(e.where=JSON.stringify(this.where)),e.mode="selectSearch",e.selectMode=this.selectMode;var o=this.$meta.util.combineQueries("/a/base/atom/search",e);this.$view.navigate(o,{target:"_view",context:{params:{},callback:function(e,n){200===e&&t._updateSelectedAtoms(n)}}})},_updateSelectedAtoms:function(t){this.$refs.list.updateSelectedAtoms(t)},onPerformDone:function(){var t,e=this.$refs.list.getSelectedAtoms();t="single"===this.selectMode?e&&e.length>0?e[0]:null:e&&e.length>0?e:null,this.contextCallback(200,t),this.$f7router.back()}}},l=n(0),c=Object(l.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.pageTitle,"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"add",onPerform:t.onPerformAdd}}),t._v(" "),n("eb-link",{attrs:{iconMaterial:"done",onPerform:t.onPerformDone}})],1)],1),t._v(" "),n("atoms",{ref:"list",attrs:{mode:"select",params:t.params,atomClass:t.atomClass}})],1)}),[],!1,null,null,null);e.default=c.exports},function(t,e,n){"use strict";n.r(e);var o=n(1),a=n.n(o),i=n(2),r={mixins:[a.a.prototype.$meta.module.get("a-components").options.mixins.ebPageContext,i.a],data:function(){return{}},computed:{module:function(){return this.contextParams.atomClass?this.contextParams.atomClass.module:null},atomClassName:function(){return this.contextParams.atomClass?this.contextParams.atomClass.atomClassName:null},optional:function(){return this.contextParams.optional},atomClasses:function(){var t=this.atomClassesAll;if(!t)return[];var e=[];for(var n in this.optional&&e.push({title:null,module:null,atomClassName:null}),t)for(var o in t[n])e.push({title:t[n][o].titleLocale,module:n,atomClassName:o});return e}},methods:{onItemClick:function(t){var e=t.module?{module:t.module,atomClassName:t.atomClassName,title:t.title}:null;this.contextCallback(200,e),this.$f7router.back()}}},s=n(0),l=Object(s.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Select Atom Class"),"eb-back-link":"Back"}}),t._v(" "),n("f7-list",t._l(t.atomClasses,(function(e,o){return n("f7-list-item",{key:o,attrs:{radio:"",checked:t.module===e.module&&t.atomClassName===e.atomClassName,title:e.title},on:{click:function(n){return t.onItemClick(e)}}})})),1)],1)}),[],!1,null,null,null);e.default=l.exports},function(t,e,n){"use strict";n.r(e);var o={meta:{size:"medium"},components:{item:n(7).a},data:function(){return{query:this.$f7route.query}}},a=n(0),i=Object(a.a)(o,(function(){var t=this.$createElement;return(this._self._c||t)("item",{attrs:{query:this.query,mode:"view"}})}),[],!1,null,"38e01b06",null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);n(1);var o={data:function(){return{atomId:parseInt(this.$f7route.query.atomId),actions:null,items:[]}},computed:{user:function(){return this.$store.state.auth.user.op}},created:function(){this.fetchActions()},methods:{onRefresh:function(t){t(),this.reload()},onInfinite:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e=this,n={where:{mode:2,attachment:1},orders:[["createdAt","asc"]],page:{index:t.index}};return this.$api.post("/a/file/file/list",{key:{atomId:this.atomId},options:n}).then((function(t){return e.items=e.items.concat(t.list),t}))},reload:function(){this.$refs.loadMore.reload()},fetchActions:function(){var t=this;this.$api.post("atom/actions",{key:{atomId:this.atomId}}).then((function(e){t.actions=e}))},findAction:function(t){return this.actions?this.actions.find((function(e){return e.name===t})):null},onPerformAdd:function(){var t=this;return new Promise((function(e,n){t.$view.navigate("/a/file/file/upload",{context:{params:{mode:2,atomId:t.atomId,attachment:1},callback:function(o,a){200===o&&(t.$meta.eventHub.$emit("attachment:action",{action:"create",atomId:t.atomId}),t.reload(),e()),!1===o&&n()}}})}))},onPerformDelete:function(t,e){var n=this;return this.$view.dialog.confirm().then((function(){return n.$api.post("/a/file/file/delete",{key:{atomId:n.atomId},data:{fileId:e.id}}).then((function(){n.$meta.util.swipeoutClose(t.target),n.$meta.eventHub.$emit("attachment:action",{action:"delete",atomId:n.atomId,fileId:e.id}),n.deleteItem(e.id)}))}))},deleteItem:function(t){var e=this.items.findIndex((function(e){return e.id===t}));-1!==e&&this.items.splice(e,1)},onItemClick:function(t,e){var n=this;this.$meta.config.base.jwt?this.$api.post("/a/base/jwt/create").then((function(t){n._openUrl(e,t.jwt)})):this._openUrl(e,null)},_openUrl:function(t,e){e?window.open(this.$meta.util.combineQueries(t.downloadUrl,{"eb-jwt":e})):window.open(t.downloadUrl)},getItemMedia:function(t){var e=t.avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,32)}}},a=n(0),i=Object(a.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Attachment List"),"eb-back-link":"Back"}},[n("f7-nav-right",[t.findAction("write")?n("eb-link",{attrs:{iconMaterial:"add",onPerform:t.onPerformAdd}}):t._e()],1)],1),t._v(" "),n("f7-list",t._l(t.items,(function(e){return n("eb-list-item",{key:e.id,staticClass:"item",attrs:{title:e.realName,link:"#",context:e,onPerform:t.onItemClick,swipeout:e.userId===t.user.id}},[n("div",{attrs:{slot:"media"},slot:"media"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMedia(e)}})]),t._v(" "),n("div",{staticClass:"header",attrs:{slot:"root-start"},slot:"root-start"},[n("div",{staticClass:"userName"},[n("span",[t._v(t._s(e.userName))])]),t._v(" "),n("div",{staticClass:"date"},[t._v(t._s(t.$meta.util.formatDateTimeRelative(e.createdAt)))])]),t._v(" "),e.userId===t.user.id?n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"orange",context:e,onPerform:t.onPerformDelete}},[t._v(t._s(t.$text("Delete")))])])]):t._e()],1)})),1),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!0}})],1)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var o={components:{},data:function(){var t=JSON.parse(this.$f7route.query.data);return{data:t}},computed:{pageTitle:function(){return this.$store.state.auth.instance.title}},methods:{}},a=n(0),i=Object(a.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.pageTitle,"eb-back-link":"Back"}}),t._v(" "),n("f7-card",[n("f7-card-header",[t._v(t._s(t.data.title||t.$text("Friendly Tips")))]),t._v(" "),n("f7-card-content",[t._v("\n      "+t._s(t.data.message)+"\n    ")]),t._v(" "),t.data.link?n("f7-card-footer",[n("div"),t._v(" "),n("eb-link",{attrs:{"eb-href":t.data.link}},[t._v(t._s(t.data.linkText||t.$text("Link")))])],1):t._e()],1)],1)}),[],!1,null,"44172a93",null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var o={mixins:[n(4).a],data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName,o=e&&n?{module:e,atomClassName:n}:null,a=t&&t.where?JSON.parse(t.where):null;if("mine"===(t&&t.scene)){a||(a={});var i=this.$store.state.auth.user.op;a["h.userId"]=i.id}return{atomClass:o,where:a,order:"desc",items:[],moduleStyle:null,rightDeleteComment:!1}},computed:{user:function(){return this.$store.state.auth.user.op}},created:function(){var t=this;this.$api.post("function/check",{functions:[{module:"a-base",name:"deleteComment"}]}).then((function(e){t.rightDeleteComment=e[0].passed,t.$meta.module.use(t.$meta.config.markdown.style.module,(function(e){t.moduleStyle=e}))}))},mounted:function(){this.$meta.eventHub.$on("comment:action",this.onCommentChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("comment:action",this.onCommentChanged)},methods:{onRefresh:function(t){t(),this.reload()},onInfinite:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e=this,n=t.index,o={orders:[["h_updatedAt",this.order]],page:{index:n}};return this.where&&(o.where=this.where),this.$api.post("comment/all",{atomClass:this.atomClass,options:o}).then((function(t){return e.items=e.items.concat(t.list),t}))},reload:function(){this.$refs.loadMore.reload()},onPerformDelete:function(t,e){var n=this;return this.$view.dialog.confirm().then((function(){return n.$api.post("comment/delete",{key:{atomId:e.atomId},data:{commentId:e.h_id}}).then((function(t){return n.$meta.eventHub.$emit("comment:action",t),!0}))}))},onPerformHeart:function(t,e){var n=this;if(!this.user.anonymous)return this.$api.post("comment/heart",{key:{atomId:e.atomId},data:{commentId:e.h_id,heart:e.h_heart?0:1}}).then((function(t){n.$meta.eventHub.$emit("comment:action",t)}));this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){n.$meta.vueLayout.openLogin()}))},onCommentChanged:function(t){var e=this,n=t.action,o=t.atomId,a=t.commentId;if("create"!==n){var i=this.items.findIndex((function(t){return t.h_id===a}));"delete"!==n?-1!==i&&this.$api.post("comment/item",{key:{atomId:o},data:{commentId:a}}).then((function(t){for(var n=e.items[i],o=0,a=Object.keys(t);o<a.length;o++){var r=a[o];n["h_".concat(r)]=t[r]}})):-1!==i&&this.items.splice(i,1)}else this.reload()},onPerformSort:function(){this.order="desc"===this.order?"asc":"desc",this.reload()},onPerformViewAtom:function(t,e){var n=this.getAction({module:e.module,atomClassName:e.atomClassName,name:"read"});if(n)return this.$meta.util.performAction({ctx:this,action:n,item:e})},getItemMedia:function(t){var e=t.h_avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,32)}}},a=n(0),i=Object(a.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Comment List"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"desc"===t.order?"arrow_downward":"arrow_upward",onPerform:t.onPerformSort}})],1)],1),t._v(" "),t.moduleStyle?t._l(t.items,(function(e){return n("f7-card",{key:e.h_id,staticClass:"comment"},[n("f7-card-header",[n("div",{staticClass:"header-container"},[n("div",{staticClass:"header-atom"},[n("eb-link",{attrs:{context:e,onPerform:t.onPerformViewAtom}},[t._v(t._s(e.atomName))])],1),t._v(" "),n("div",{staticClass:"header-comment"},[n("div",{staticClass:"title"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMedia(e)}}),t._v(" "),n("div",{staticClass:"name"},[t._v(t._s(e.h_userName))]),t._v(" "),n("div",{staticClass:"date"},[t._v("#"+t._s(e.h_sorting)+"  "+t._s(t.$meta.util.formatDateTimeRelative(e.h_createdAt)))])]),t._v(" "),n("div",{staticClass:"actions"},[e.h_userId===t.user.id?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"edit","eb-href":"comment/item?atomId="+e.atomId+"&commentId="+e.h_id+"&replyId=0"}}):t._e(),t._v(" "),e.h_userId===t.user.id||t.rightDeleteComment?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"delete_forever",context:e,onPerform:t.onPerformDelete}}):t._e(),t._v(" "),n("eb-link",{staticClass:"action",attrs:{iconMaterial:e.h_heart?"favorite":"favorite_border",context:e,onPerform:t.onPerformHeart}},[t._v(t._s(e.h_heartCount))]),t._v(" "),t.user.anonymous?t._e():n("eb-link",{staticClass:"action",attrs:{iconMaterial:"reply","eb-href":"comment/item?atomId="+e.atomId+"&commentId=0&replyId="+e.h_id}})],1)])])]),t._v(" "),n("f7-card-content",{staticClass:"markdown-body",attrs:{padding:""},domProps:{innerHTML:t._s(e.h_html)}})],1)})):t._e(),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!0}})],2)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var o={data:function(){return{atomId:this.$f7route.query.atomId,commentId:this.$f7route.query.commentId}},created:function(){var t=this;this.$api.post("/a/base/comment/heart",{key:{atomId:this.atomId},atom:{star:1},data:{commentId:this.commentId,heart:1}}).then((function(){t.$view.dialog.alert(t.$text("Hearted")).then((function(){t.openAtom()}))}))},methods:{openAtom:function(){location.assign(this.$f7route.query.returnTo)}}},a=n(0),i=Object(a.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("eb-page",[e("eb-navbar",{attrs:{large:"",largeTransparent:"",title:this.$text("Heart2"),"eb-back-link":"Back"}}),this._v(" "),e("f7-block")],1)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var o={meta:{size:"medium"},data:function(){return{atomId:parseInt(this.$f7route.query.atomId),commentId:parseInt(this.$f7route.query.commentId||0),replyId:parseInt(this.$f7route.query.replyId||0),module:null,comment:null,reply:null,content:""}},computed:{ready:function(){return this.module&&(0===this.commentId||this.comment)&&(0===this.replyId||this.reply)},readOnly:function(){return!1},editable:function(){return!this.readOnly},language:function(){return"zh-cn"===this.$meta.util.getLocale()?"zh-CN":"en"},subfield:function(){return this.editable&&"small"!==this.$view.size},defaultOpen:function(){return this.editable?"":"preview"},toolbarsFlag:function(){return this.editable},navigation:function(){return!this.editable},toolbars:function(){return{bold:!0,italic:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,undo:!0,redo:!0,trash:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0}}},created:function(){var t=this;this.$meta.module.use("a-mavoneditor",(function(e){t.module=e})),this.loadComment(this.commentId),this.loadReply(this.replyId)},methods:{loadComment:function(t){var e=this;t&&this.$api.post("comment/item",{key:{atomId:this.atomId},data:{commentId:t}}).then((function(t){e.comment=t,e.content=e.comment.content}))},loadReply:function(t){var e=this;t&&this.$api.post("comment/item",{key:{atomId:this.atomId},data:{commentId:t}}).then((function(t){e.reply=t}))},onChange:function(t){this.content=t},onSave:function(){this.onPerformSave()},onPerformSave:function(){var t=this;if(this.content)return this.$api.post("/a/base/comment/save",{key:{atomId:this.atomId},data:{commentId:this.commentId,replyId:this.replyId,content:this.content}}).then((function(e){t.$meta.eventHub.$emit("comment:action",e);var n=t.$f7route.query.returnTo;n?location.assign(n):t.$f7router.back()}))},onImageUpload:function(){var t=this;return new Promise((function(e,n){t.$view.navigate("/a/file/file/upload",{context:{params:{mode:1,atomId:t.atomId,flag:"comment"},callback:function(t,o){200===t&&e({text:o.realName,addr:o.downloadUrl}),!1===t&&n()}}})}))},onPreRender:function(t){if(this.comment)return this.fullContent({content:t,replyContent:this.comment.replyContent,replyUserName:this.comment.replyUserName});if(this.reply){var e=this.fullContent({content:this.reply.content,replyContent:this.reply.replyContent,replyUserName:this.reply.replyUserName});return this.fullContent({content:t,replyContent:e,replyUserName:this.reply.userName})}return t},fullContent:function(t){var e=t.content,n=t.replyContent,o=t.replyUserName;return n?"".concat(e,"\n\n> `").concat(o,"`:\n\n::: comment-quot\n").concat(n,"\n:::\n\n"):e}}},a=n(0),i=Object(a.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{title:t.$text("Comment"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"save",onPerform:t.onPerformSave}})],1)],1),t._v(" "),t.ready?[n("eb-box",[n("mavon-editor",{ref:"editor",attrs:{value:t.content,onPreRender:t.onPreRender,onImageUpload:t.onImageUpload,language:t.language,subfield:t.subfield,editable:t.editable,defaultOpen:t.defaultOpen,toolbarsFlag:t.toolbarsFlag,navigation:t.navigation,toolbars:t.toolbars},on:{change:t.onChange,save:t.onSave}})],1)]:t._e()],2)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var o=n(1),a=n.n(o),i={data:function(){return{atomId:parseInt(this.$f7route.query.atomId),order:"desc",items:[],moduleStyle:null}},computed:{user:function(){return this.$store.state.auth.user.op}},created:function(){var t=this;this.$meta.module.use(this.$meta.config.markdown.style.module,(function(e){t.moduleStyle=e}))},mounted:function(){this.$meta.eventHub.$on("comment:action",this.onCommentChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("comment:action",this.onCommentChanged)},methods:{onRefresh:function(t){t(),this.reload()},onInfinite:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e=this,n=t.index,o={orders:[["updatedAt",this.order]],page:{index:n}};return this.$api.post("comment/list",{key:{atomId:this.atomId},options:o}).then((function(t){return e.items=e.items.concat(t.list),t}))},reload:function(){this.$refs.loadMore.reload()},onPerformDelete:function(t,e){var n=this;return this.$view.dialog.confirm().then((function(){return n.$api.post("comment/delete",{key:{atomId:n.atomId},data:{commentId:e.id}}).then((function(t){return n.$meta.eventHub.$emit("comment:action",t),!0}))}))},onPerformHeart:function(t,e){var n=this;if(!this.user.anonymous)return this.$api.post("comment/heart",{key:{atomId:this.atomId},data:{commentId:e.id,heart:e.heart?0:1}}).then((function(t){n.$meta.eventHub.$emit("comment:action",t)}));this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){n.$meta.vueLayout.openLogin()}))},onCommentChanged:function(t){var e=this,n=t.action,o=t.atomId,i=t.commentId;if(o===this.atomId)if("create"!==n){var r=this.items.findIndex((function(t){return t.id===i}));"delete"!==n?-1!==r&&this.$api.post("comment/item",{key:{atomId:this.atomId},data:{commentId:i}}).then((function(t){a.a.set(e.items,r,t)})):-1!==r&&this.items.splice(r,1)}else this.reload()},onPerformSort:function(){this.order="desc"===this.order?"asc":"desc",this.reload()},getItemMedia:function(t){var e=t.avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,32)}}},r=n(0),s=Object(r.a)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Comment List"),"eb-back-link":"Back"}},[n("f7-nav-right",[t.user.anonymous?t._e():n("eb-link",{attrs:{iconMaterial:"add","eb-href":"comment/item?atomId="+t.atomId+"&commentId=0&replyId=0"}}),t._v(" "),n("eb-link",{attrs:{iconMaterial:"desc"===t.order?"arrow_downward":"arrow_upward",onPerform:t.onPerformSort}})],1)],1),t._v(" "),t.moduleStyle?t._l(t.items,(function(e){return n("f7-card",{key:e.id,staticClass:"comment"},[n("f7-card-header",[n("div",{staticClass:"title"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMedia(e)}}),t._v(" "),n("div",{staticClass:"name"},[t._v(t._s(e.userName))]),t._v(" "),n("div",{staticClass:"date"},[t._v("#"+t._s(e.sorting)+"  "+t._s(t.$meta.util.formatDateTimeRelative(e.createdAt)))])]),t._v(" "),n("div",{staticClass:"actions"},[e.userId===t.user.id?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"edit","eb-href":"comment/item?atomId="+t.atomId+"&commentId="+e.id+"&replyId=0"}}):t._e(),t._v(" "),e.userId===t.user.id?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"delete_forever",context:e,onPerform:t.onPerformDelete}}):t._e(),t._v(" "),n("eb-link",{staticClass:"action",attrs:{iconMaterial:e.heart?"favorite":"favorite_border",context:e,onPerform:t.onPerformHeart}},[t._v(t._s(e.heartCount))]),t._v(" "),t.user.anonymous?t._e():n("eb-link",{staticClass:"action",attrs:{iconMaterial:"reply","eb-href":"comment/item?atomId="+t.atomId+"&commentId=0&replyId="+e.id}})],1)]),t._v(" "),n("f7-card-content",{staticClass:"markdown-body",attrs:{padding:""},domProps:{innerHTML:t._s(e.html)}})],1)})):t._e(),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!0}})],2)}),[],!1,null,null,null);e.default=s.exports},function(t,e,n){"use strict";n.r(e);var o=n(1),a=n.n(o),i={meta:{size:"medium"},components:{menus:n(8).a},data:function(){return{pageTitle:null,tabs:[{id:a.a.prototype.$meta.util.nextId("tab"),mode:"scenes",title:"Scenes"},{id:a.a.prototype.$meta.util.nextId("tab"),mode:"modules",title:"Modules"},{id:a.a.prototype.$meta.util.nextId("tab"),mode:"stars",title:"Stars"}],tabActive:""}},created:function(){this.__initTabActive()},mounted:function(){this.__initPageTitle()},methods:{__initPageTitle:function(){this.$$(this.$el).parents(".eb-layout-view").is(".eb-layout-panel-view")?this.pageTitle=this.$text("Menu"):this.pageTitle=this.$text("Home")},__initTabActive:function(){var t=this;this.$store.dispatch("a/base/getLayoutConfig","a-base").then((function(e){t.tabActive=e.menuTabActive||t.tabs[0].mode}))},onTabShow:function(t){this.tabActive!==t&&(this.tabActive=t,this.$store.commit("a/base/setLayoutConfigKey",{module:"a-base",key:"menuTabActive",value:this.tabActive}))}}},r=n(0),s=Object(r.a)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{"page-content":!1,tabs:"","with-subnavbar":""}},[n("eb-navbar",{attrs:{title:t.pageTitle,"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"search","eb-target":"_self","eb-href":"menu/search"}})],1),t._v(" "),t.tabActive?n("f7-subnavbar",[n("f7-toolbar",{attrs:{top:"",tabbar:""}},t._l(t.tabs,(function(e){return n("f7-link",{key:e.id,attrs:{tabLink:"#"+e.id,tabLinkActive:t.tabActive===e.mode}},[t._v(t._s(t.$text(e.title)))])})),1)],1):t._e()],1),t._v(" "),t.tabActive?n("f7-tabs",t._l(t.tabs,(function(e){return n("eb-tab-page-content",{key:e.id,attrs:{id:e.id,tabActive:t.tabActive===e.mode},on:{"tab:show":function(n){return t.onTabShow(e.mode)}}},[n("menus",{attrs:{slot:"list",mode:e.mode},slot:"list"})],1)})),1):t._e()],1)}),[],!1,null,null,null);e.default=s.exports},function(t,e,n){"use strict";n.r(e);var o={components:{menus:n(8).a},methods:{onSearch:function(t){this.$refs.list.onSearch(t)},onLoadMore:function(){this.$refs.list.loadMore()},onDisable:function(){this.$f7router.back()}}},a=n(0),i=Object(a.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("eb-search-page",{attrs:{title:this.$text("Search Menu")},on:{search:this.onSearch,loadMore:this.onLoadMore,disable:this.onDisable}},[e("menus",{ref:"list",attrs:{mode:"search"}})],1)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var o=n(1),a=n.n(o).a.prototype.$meta.module.get("a-components").options.mixins.ebPageContext,i=["Function","Menu","Panel","Widget"],r={mixins:[a],data:function(){return{}},computed:{pageTitle:function(){return this.$text("Select ".concat(i[this.menu]))},module:function(){return this.contextParams.module},name:function(){return this.contextParams.name},menu:function(){return this.contextParams.menu},optional:function(){return this.contextParams.optional},functions:function(){var t=this.$local.state.functions;if(!t)return[];var e=[];for(var n in this.optional&&e.push({title:null,name:null}),t[this.module]){var o=t[this.module][n];o.menu===this.menu&&e.push({title:o.titleLocale,name:n})}return e}},created:function(){this.$local.dispatch("getFunctions")},methods:{onItemClick:function(t){var e=t.name?{module:this.module,name:t.name,title:t.title}:null;this.contextCallback(200,e),this.$f7router.back()}}},s=n(0),l=Object(s.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.pageTitle,"eb-back-link":"Back"}}),t._v(" "),n("f7-list",t._l(t.functions,(function(e,o){return n("f7-list-item",{key:o,attrs:{radio:"",checked:t.name===e.name,title:e.title},on:{click:function(n){return t.onItemClick(e)}}})})),1)],1)}),[],!1,null,null,null);e.default=l.exports},function(t,e,n){"use strict";n.r(e);var o=n(8),a=n(3),i=n(7);function r(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){l=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(l)throw i}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var l={meta:{global:!1},methods:{onAction:function(t){var e=t.ctx,n=t.action,o=t.item;if("create"===n.name||"create"===n.action)return this._onActionCreate({ctx:e,action:n,item:o});if("delete"===n.name){var a={atomId:o.atomId,itemId:o.itemId};return e.$view.dialog.confirm().then((function(){return e.$api.post("/a/base/atom/delete",{key:a}).then((function(){return e.$meta.eventHub.$emit("atom:action",{key:a,action:n}),!0}))}))}if("save"===n.name){var i={atomId:o.atomId,itemId:o.itemId};return e.$api.post("/a/base/atom/write",{key:i,item:o}).then((function(){e.$meta.eventHub.$emit("atom:action",{key:i,action:n})}))}if("submit"===n.name){var r={atomId:o.atomId,itemId:o.itemId};return e.$view.dialog.confirm().then((function(){return e.$api.post("/a/base/atom/writeSubmit",{key:r,item:o}).then((function(){e.$meta.eventHub.$emit("atom:action",{key:r,action:n})}))}))}var s={atomId:o.atomId,itemId:o.itemId};return e.$view.dialog.confirm().then((function(){return e.$api.post("/a/base/atom/action",{action:n.code,key:s}).then((function(){return e.$meta.eventHub.$emit("atom:action",{key:s,action:n}),!0}))}))},_onActionCreate:function(t){var e=t.ctx,n=t.action,o=t.item;return this._onActionCreateGetRoleIdOwner({ctx:e,action:n,item:o}).then((function(t){if(t)return e.$api.post("/a/base/atom/create",{atomClass:{id:o.atomClassId,module:o.module,atomClassName:o.atomClassName},roleIdOwner:t,item:o}).then((function(t){return e.$meta.eventHub.$emit("atom:action",{key:t,action:n}),1===n.menu||n.actionComponent||n.actionPath?(o=e.$utils.extend({},o,t),e.$store.dispatch("a/base/getActions").then((function(t){var n=t[o.module][o.atomClassName].write;return n=e.$utils.extend({},n),e.$meta.util.performAction({ctx:e,action:n,item:o})}))):t}))}))},_onActionCreateGetAtomClassId:function(t){var e=t.ctx,n=(t.action,t.item);return n.atomClassId?Promise.resolve(n.atomClassId):e.$api.post("/a/base/atomClass/atomClass",{atomClass:{module:n.module,atomClassName:n.atomClassName}}).then((function(t){return t.id}))},_onActionCreateGetRoleIdOwner:function(t){var e=this,n=t.ctx,o=t.action,a=t.item;return this._onActionCreateGetAtomClassId({ctx:n,action:o,item:a}).then((function(t){var a=n.$store.getState("a/base/userAtomClassRolesPreferred");return a[t]?a[t]:n.$api.post("/a/base/atom/preferredRoles",{atomClass:{id:t}}).then((function(a){if(0===a.length)return Promise.reject(new Error("Error"));if(1===a.length){var i=a[0].roleIdWho;return n.$store.commit("a/base/setUserAtomClassRolesPreferred",{atomClassId:t,roleIdOwner:i}),i}return e._onActionCreateSelectPreferredRole({ctx:n,action:o,roles:a}).then((function(e){return e&&n.$store.commit("a/base/setUserAtomClassRolesPreferred",{atomClassId:t,roleIdOwner:e}),e}))}))}))},_onActionCreateSelectPreferredRole:function(t){var e=t.ctx,n=t.action,o=t.roles;return new Promise((function(t){var a=e.$view.getHostEl(),i=n.targetEl,s=[{text:e.$text("AtomClassSelectRoleTip"),label:!0}],l=!1;var c,u=r(o);try{var m=function(){var e=c.value;s.push({text:e.roleNameWho,onClick:function(){var n;n=e.roleIdWho,l=!0,t(n)}})};for(u.s();!(c=u.n()).done;)m()}catch(t){u.e(t)}finally{u.f()}var d=e.$f7.actions.create({hostEl:a,buttons:s,targetEl:i});function f(){d.destroy(),l||(l=!0,t())}d.open().once("actionsClosed",f).once("popoverClosed",f)}))}}};e.default={menus:o.a,item:i.a,action:l,ebAtoms:a.a}},function(t,e,n){"use strict";n.r(e);var o=n(2),a=n(4),i=n(10),r=n(5),s=n(6);e.default={ebAtomClasses:o.a,ebAtomActions:a.a,ebModules:i.a,ebMenus:r.a,ebFunctions:{computed:{functionsAll:function(){return this.$store.getState("a/base/functions")}},methods:{getFunction:function(t){return this.functionsAll&&t?this.functionsAll[t.module][t.name]:null},getFunctionTitle:function(t){var e=this.getFunction(t);return e?e.titleLocale:null}},created:function(){this.$store.dispatch("a/base/getFunctions")}},listLayoutManager:s.a}}]);
//# sourceMappingURL=front.js.map