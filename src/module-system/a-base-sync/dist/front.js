window["a-base"]=function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=14)}([function(t,e,n){"use strict";function a(t,e,n,a,o,i,s,r){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),a&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},c._ssrRegister=l):o&&(l=r?function(){o.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(t,e){return l.call(e),u(t,e)}}else{var m=c.beforeCreate;c.beforeCreate=m?[].concat(m,l):[l]}return{exports:t,options:c}}n.d(e,"a",(function(){return a}))},function(t,e){t.exports=window.Vue},function(t,e,n){"use strict";e.a={computed:{atomClassesAll:function(){return this.$store.getState("a/base/atomClasses")}},methods:{getAtomClass:function(t){return this.atomClassesAll&&t?this.atomClassesAll[t.module][t.atomClassName]:null}},created:function(){this.$store.dispatch("a/base/getAtomClasses")}}},function(t,e,n){"use strict";var a=n(1),o=n.n(a),i=n(2),s=n(4),r=n(9);function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,r=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){r=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(r)throw i}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var u={mixins:[i.a,s.a,r.a],meta:{global:!1},props:{mode:{type:String},itemShow:{type:Object},params:{type:Object},atomClass:{type:Object},where:{type:Object}},data:function(){return{radioName:o.a.prototype.$meta.util.nextId("radio"),items:this.itemShow?[this.itemShow]:[],atomOrderSelected:null,selectedAtomIds:null,selectedAtoms:null,query:""}},computed:{labels:function(){return this.$local.getters("userLabels")},flags:function(){return this.$local.state.flags},user:function(){return this.$store.state.auth.user.op},popoverOrdersReady:function(){return!!this.ordersAll},mode2:function(){return"select"===this.mode?"all":"selectSearch"===this.mode?"search":this.mode},atomOrders:function(){if(!this.ordersAll)return null;var t=this.getOrdersOfBase(),e=this.atomClass?this.getOrdersOfAtomClass(this.atomClass):null;return e?t.concat(e):t},atomOrderDefault:function(){return"list"===this.mode||"drafts"===this.mode?{name:"updatedAt",by:"desc",tableAlias:"a"}:"stars"===this.mode?{name:"updatedAt",by:"desc",tableAlias:"d"}:this.mode.indexOf("labels")>-1?{name:"updatedAt",by:"desc",tableAlias:"e"}:"search"===this.mode?{name:"updatedAt",by:"desc",tableAlias:"a"}:"select"===this.mode||"selectSearch"===this.mode?{name:"atomName",by:"asc",tableAlias:"a"}:{name:"updatedAt",by:"desc",tableAlias:"a"}}},created:function(){this.$local.dispatch("getLabels"),this.$local.dispatch("getFlags")},mounted:function(){this.$meta.eventHub.$on("atom:star",this.onStarChanged),this.$meta.eventHub.$on("atom:labels",this.onLabelsChanged),this.$meta.eventHub.$on("atom:action",this.onActionChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("atom:star",this.onStarChanged),this.$meta.eventHub.$off("atom:labels",this.onLabelsChanged),this.$meta.eventHub.$off("atom:action",this.onActionChanged)},methods:{reload:function(t){this.itemShow||this.$refs.loadMore.reload(t)},loadMore:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e,n=this,a=t.index;if("list"===this.mode)e={where:{"a.atomEnabled":1},page:{index:a}};else if("drafts"===this.mode)e={where:{"a.atomEnabled":0},page:{index:a}};else if("stars"===this.mode)e={star:1,page:{index:a}};else if(this.mode.indexOf("labels")>-1)e={label:this.mode.split("-")[1],page:{index:a}};else if("search"===this.mode||"selectSearch"===this.mode){var o={},i=this.params&&this.params.atomName||this.query;i&&(o["a.atomName"]={val:i,op:"like"}),this.params&&this.params.atomClassExtra&&this.$utils.extend(o,this.params.atomClassExtra),e={where:o,page:{index:a}},this.params&&this.params.label&&(e.label=this.params.label)}else if("select"===this.mode){var s={};this.selectedAtomIds||(this.selectedAtomIds=this.params.selectedAtomIds||[]),s["a.id"]=this.selectedAtomIds.length>0?this.selectedAtomIds:null,e={where:s,page:{index:a}}}else e={page:{index:a}};this.where&&(e.where=this.$utils.extend({},e.where,this.where));var r=this.atomOrderSelected||this.atomOrderDefault;return e.orders=[[this.getAtomOrderKey(r),r.by]],e.mode=this.mode2,this.$api.post("atom/select",{atomClass:this.atomClass,options:e}).then((function(t){return n.items=n.items.concat(t.list),t}))},onStarSwitch:function(t,e){var n=e.star?0:1;return this._onStarSwitch(t,e,n,"swipeoutClose")},onStarOff:function(t,e){return this._onStarSwitch(t,e,0,"swipeoutDelete")},_onStarSwitch:function(t,e,n,a){var o=this;if(!this.user.anonymous){var i={atomId:e.atomId,itemId:e.itemId};return this.$api.post("atom/star",{key:i,atom:{star:n}}).then((function(e){o.$meta.eventHub.$emit("atom:star",{key:i,star:e.star,starCount:e.starCount}),o.$meta.util[a](t.target)}))}this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){o.$meta.vueLayout.openLogin()}))},onLabel:function(t,e){var n=this;this.user.anonymous?this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){n.$meta.vueLayout.openLogin()})):this.$view.navigate("/a/base/atom/labels?atomId=".concat(e.atomId))},onStarChanged:function(t){var e=this.items.findIndex((function(e){return e.atomId===t.key.atomId}));"stars"===this.mode?0===t.star&&-1!==e?this.items.splice(e,1):1===t.star&&-1===e&&this.reload():-1!==e&&(this.items[e].star=t.star)},onLabelsChanged:function(t){var e=this.items.findIndex((function(e){return e.atomId===t.key.atomId}));if(this.mode.indexOf("labels")>-1){var n=this.mode.split("-")[1],a=t.labels.indexOf(n)>-1;a||-1===e?a&&-1===e&&this.reload():this.items.splice(e,1)}else-1!==e&&(this.items[e].labels=JSON.stringify(t.labels))},onActionChanged:function(t){var e=this,n=t.key,a=t.action;if(1!==a.menu||"create"!==a.action){var i=this.items.findIndex((function(t){return t.atomId===n.atomId}));if("delete"!==a.name){if("submit"===a.name){if("list"===this.mode)return void this.reload();if("drafts"===this.mode&&-1!==i)return void this.items.splice(i,1)}-1!==i&&this.$api.post("atom/read",{key:n}).then((function(t){o.a.set(e.items,i,t)}))}else-1!==i&&this.items.splice(i,1)}else"drafts"!==this.mode&&"search"!==this.mode&&"all"!==this.mode||this.reload()},getLabel:function(t){return this.labels?this.labels[t]:null},onSwipeoutOpened:function(t,e){this.itemShow||e._actions||this.$api.post("atom/actions",{key:{atomId:e.atomId},basic:!0}).then((function(t){o.a.set(e,"_actions",t)}))},onAction:function(t,e){var n=this,a=this.getAction(e.action);if(a)return this.$meta.util.performAction({ctx:this,action:a,item:e.item}).then((function(){n.$meta.util.swipeoutClose(t.target)}))},getActionColor:function(t,e){return 0===e?"orange":1===e?"red":"blue"},getItemMetaFlags:function(t){var e=t._meta&&t._meta.flags;return e?Array.isArray(e)?e:e.split(","):[]},getItemMetaMedia:function(t){var e=t._meta&&t._meta.media||t.avatar||this.$config.user.avatar.default;return this.$meta.util.combineImageUrl(e,32)},getItemMetaMediaLabel:function(t){return t._meta&&t._meta.mediaLabel||t.userName},getItemMetaSummary:function(t){var e=t._meta&&t._meta.summary||"";if(this.atomClass)return e;var n=this.getAtomClass({module:t.module,atomClassName:t.atomClassName});return n?"".concat(n.titleLocale," ").concat(e):e},getFlagTitle:function(t){if(!this.flags)return null;var e=this.flags[t.module][t.atomClassName][t.atomFlag];return e?e.titleLocale:this.$text("Flag Not Found")},onItemClick:function(t,e){if(!this.itemShow&&"selectSearch"!==this.mode)return this.onAction(t,{item:e,action:{module:e.module,atomClassName:e.atomClassName,name:"read"}})},openPopoverForAtomOrders:function(t){var e=this.$refs.popoverAtomOrders.$el;this.$f7.popover.open(e,t)},getAtomOrderStatus:function(t){var e=this.atomOrderSelected||this.atomOrderDefault;return this.getAtomOrderKey(e)===this.getAtomOrderKey(t)?"desc"===e.by?"arrow_drop_down":"arrow_drop_up":""},onPerformChangeAtomOrder:function(t,e){var n=this.atomOrderSelected||this.atomOrderDefault;this.getAtomOrderKey(n)===this.getAtomOrderKey(e)?this.atomOrderSelected={name:n.name,tableAlias:n.tableAlias,by:"desc"===n.by?"asc":"desc"}:this.atomOrderSelected=e,this.reload(!0)},onItemSelectRemove:function(t,e){if(this.$meta.util.swipeoutClose(t.target),this.selectedAtomIds){var n=this.selectedAtomIds.findIndex((function(t){return t===e.atomId}));-1!==n&&this.selectedAtomIds.splice(n,1)}var a=this.items.findIndex((function(t){return t.atomId===e.atomId}));-1!==a&&this.items.splice(a,1)},onItemChange:function(t,e){if("single"===this.params.selectMode)t.target.checked&&(this.selectedAtoms=[e]);else{this.selectedAtoms||(this.selectedAtoms=[]);var n=this.selectedAtoms.findIndex((function(t){return t.atomId===e.atomId}));t.target.checked&&-1===n?this.selectedAtoms.push(e):!t.target.checked&&n>-1&&this.selectedAtoms.splice(n,1)}},getSelectedAtoms:function(){return"selectSearch"===this.mode?this.selectedAtoms:"select"===this.mode?this.items:void 0},updateSelectedAtoms:function(t){if(t&&0!==t.length){var e=!1;if("single"===this.params.selectMode)this.selectedAtomIds=[t[0].atomId],e=!0;else{this.selectedAtomIds||(this.selectedAtomIds=[]);var n,a=l(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;-1===this.selectedAtomIds.indexOf(o.atomId)&&(this.selectedAtomIds.push(o.atomId),e=!0)}}catch(t){a.e(t)}finally{a.f()}}e&&this.reload(!0)}},getAtomOrderKey:function(t){return t?"".concat(t.tableAlias,".").concat(t.name):null},onSearch:function(t){this.query=t,this.query?this.reload(!0):this.items=[]}}},m=n(0),d=Object(m.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("f7-list",t._l(t.items,(function(e){return n("eb-list-item",{key:e.atomId,staticClass:"item",attrs:{name:t.radioName,radio:"selectSearch"===t.mode&&"single"===t.params.selectMode,checkbox:"selectSearch"===t.mode&&"multiple"===t.params.selectMode,link:!t.itemShow&&"selectSearch"!==t.mode&&"#",context:e,onPerform:t.onItemClick,swipeout:""},on:{"swipeout:opened":function(n){return t.onSwipeoutOpened(n,e)},"contextmenu:opened":function(n){return t.onSwipeoutOpened(n,e)},change:function(n){return t.onItemChange(n,e)}}},[t.itemShow?[n("div",{attrs:{slot:"media"},slot:"media"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMetaMedia(e)}})]),t._v(" "),n("div",{staticClass:"header",attrs:{slot:"root-start"},slot:"root-start"},[n("div",{staticClass:"mediaLabel"},[n("span",[t._v(t._s(t.getItemMetaMediaLabel(e)))])]),t._v(" "),n("div",[e.star?n("span",[t._v("â­")]):t._e(),t._v(" "),e.attachmentCount>0?n("span",[t._v("ðŸ§·")]):t._e(),t._v(" "),e.attachmentCount>1?n("span",[t._v(t._s(e.attachmentCount+"Â "))]):t._e(),t._v(" "),e.commentCount>0?n("span",[t._v("ðŸ’¬")]):t._e(),t._v(" "),e.commentCount>1?n("span",[t._v(t._s(e.commentCount+"Â "))]):t._e(),t._v(" "),t._l(t.getItemMetaFlags(e),(function(e){return n("f7-badge",{key:e},[t._v(t._s(e))])})),t._v(" "),e.atomFlag>0?n("f7-badge",[t._v(t._s(t.getFlagTitle(e)))]):t._e(),t._v(" "),e.labels&&t.labels?t._l(JSON.parse(e.labels),(function(e){return n("f7-badge",{key:e,style:{backgroundColor:t.getLabel(e).color}},[t._v(t._s(t.getLabel(e).text))])})):t._e()],2)]),t._v(" "),n("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[n("div",{staticClass:"date"},[n("div",[t._v(t._s(t.$text("Modification Time")))]),t._v(" "),n("div",[t._v(t._s(t.$text("Created Time")))])])]),t._v(" "),n("div",{staticClass:"after",attrs:{slot:"after"},slot:"after"},[n("div",{staticClass:"date"},[t._v(t._s(t.$meta.util.formatDateTime(e.atomUpdatedAt)))]),t._v(" "),n("div",{staticClass:"date"},[t._v(t._s(t.$meta.util.formatDateTime(e.atomCreatedAt)))])])]:t._e(),t._v(" "),t.itemShow?t._e():["selectSearch"!==t.mode?n("div",{attrs:{slot:"media"},slot:"media"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMetaMedia(e)}})]):t._e(),t._v(" "),n("div",{staticClass:"header",attrs:{slot:"root-start"},slot:"root-start"},[n("div",{staticClass:"mediaLabel"},[n("span",[t._v(t._s(t.getItemMetaMediaLabel(e)))])]),t._v(" "),n("div",{staticClass:"date"},[e.star?n("span",[t._v("â­")]):t._e(),t._v(" "),e.attachmentCount>0?n("span",[t._v("ðŸ§·")]):t._e(),t._v(" "),e.attachmentCount>1?n("span",[t._v(t._s(e.attachmentCount+"Â "))]):t._e(),t._v(" "),e.commentCount>0?n("span",[t._v("ðŸ’¬")]):t._e(),t._v(" "),e.commentCount>1?n("span",[t._v(t._s(e.commentCount+"Â "))]):t._e(),t._v(" "),n("span",[t._v(t._s(t.$meta.util.formatDateTimeRelative(e.atomUpdatedAt)))])])]),t._v(" "),n("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[n("div",[t._v(t._s(e.atomName))])]),t._v(" "),n("div",{staticClass:"summary",attrs:{slot:"root-end"},slot:"root-end"},[t._v("\n          "+t._s(t.getItemMetaSummary(e))+"\n        ")]),t._v(" "),n("div",{staticClass:"after",attrs:{slot:"after"},slot:"after"},[t._l(t.getItemMetaFlags(e),(function(e){return n("f7-badge",{key:e},[t._v(t._s(e))])})),t._v(" "),e.atomFlag>0?n("f7-badge",[t._v(t._s(t.getFlagTitle(e)))]):t._e(),t._v(" "),e.labels&&t.labels?t._l(JSON.parse(e.labels),(function(e){return n("f7-badge",{key:e,style:{backgroundColor:t.getLabel(e).color}},[t._v(t._s(t.getLabel(e).text))])})):t._e()],2)],t._v(" "),n("eb-context-menu",[n("div",{attrs:{slot:"left"},slot:"left"},["stars"===t.mode?[n("div",{attrs:{color:"green",context:e,onPerform:t.onStarOff}},[t._v(t._s(t.$text("Unstar")))])]:[n("div",{attrs:{color:"green",context:e,onPerform:t.onStarSwitch}},[t._v(t._s(e.star?t.$text("Unstar"):t.$text("Star")))])],t._v(" "),n("div",{attrs:{color:"blue",context:e,onPerform:t.onLabel}},[t._v(t._s(t.$text("Labels")))])],2),t._v(" "),"select"===t.mode?[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"red",context:e,onPerform:t.onItemSelectRemove}},[t._v(t._s(t.$text("Remove")))])])]:t._e(),t._v(" "),"select"!==t.mode?[t.itemShow?t._e():n("div",{attrs:{slot:"right",ready:!!e._actions},slot:"right"},[e._actions?t._l(e._actions,(function(a,o){return n("div",{key:a.id,attrs:{color:t.getActionColor(a,o),context:{item:e,action:a},onPerform:t.onAction}},[t._v(t._s(t.getActionTitle(a)))])})):t._e()],2)]:t._e()],2)],2)})),1),t._v(" "),t.itemShow?t._e():n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!1}}),t._v(" "),n("eb-popover",{ref:"popoverAtomOrders",attrs:{ready:t.popoverOrdersReady}},[t.popoverOrdersReady?n("f7-list",{attrs:{inset:""}},t._l(t.atomOrders,(function(e){return n("eb-list-item",{key:t.getAtomOrderKey(e),attrs:{"popover-close":"",link:"#",context:e,onPerform:t.onPerformChangeAtomOrder}},[n("f7-icon",{attrs:{slot:"media",material:t.getAtomOrderStatus(e)},slot:"media"}),t._v(" "),n("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.titleLocale))])],1)})),1):t._e()],1)],1)}),[],!1,null,null,null);e.a=d.exports},function(t,e,n){"use strict";e.a={computed:{actionsAll:function(){return this.$store.getState("a/base/actions")}},methods:{getAction:function(t){return this.actionsAll?this.actionsAll[t.module][t.atomClassName][t.name]:null},getActionTitle:function(t){var e=this.getAction(t);return e?e.titleLocale:null},getActionsOfAtomClass:function(t){return t&&this.actionsAll?this.actionsAll[t.module][t.atomClassName]:null}},created:function(){this.$store.dispatch("a/base/getActions")}}},function(t,e,n){"use strict";e.a={computed:{menusAll:function(){return this.$store.getState("a/base/menus")}},methods:{getMenu:function(t){if(!this.menusAll)return null;var e=this.menusAll[t.module];if(t.name)return e[t.name];for(var n in e)if(e[n].action===t.action)return e[n];return null},getMenuTitle:function(t){var e=this.getMenu(t);return e?e.titleLocale:null}},created:function(){this.$store.dispatch("a/base/getMenus")}}},function(t,e,n){"use strict";var a=n(1),o=n.n(a),i=n(3),s=n(2),r=n(4);function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,r=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){r=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(r)throw i}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var u={mixins:[s.a,r.a],meta:{global:!1},components:{atoms:i.a},props:{mode:{type:String},query:{type:Object}},data:function(){return{atomId:parseInt(this.query.atomId||0),itemId:parseInt(this.query.itemId||0),atomClassId:parseInt(this.query.atomClassId||0),item:null,module:null,validateParams:null,actions:null,popoverId:o.a.prototype.$meta.util.nextId("popover"),notfound:!1}},computed:{ready:function(){return this.item&&this.module&&this.validateParams&&this.actions&&this.atomClassesAll&&this.actionsAll},title:function(){var t="edit"===this.mode?this.$text("Edit"):this.$text("View");return this.item?"".concat(t,": ").concat(this.item.atomName):t},showPopover:function(){if(!this.ready)return!1;if(this.findAction("write")&&0===this.item.atomEnabled)return!0;var t,e=l(this.actions);try{for(e.s();!(t=e.n()).done;){if("write"!==t.value.name)return!0}}catch(t){e.e(t)}finally{e.f()}return!1},atomClass:function(){return this.item?{module:this.item.module,atomClassName:this.item.atomClassName}:null},enableFootbar:function(){return this.enableComment||this.enableAttachment},enableComment:function(){var t=this.getAtomClass(this.atomClass);return!!t&&!(t.meta&&!1===t.meta.comment)},enableAttachment:function(){var t=this.getAtomClass(this.atomClass);return!!t&&!(t.meta&&!1===t.meta.attachment)}},mounted:function(){this.$meta.eventHub.$on("atom:action",this.onActionChanged),this.$meta.eventHub.$on("comment:action",this.onCommentChanged),this.$meta.eventHub.$on("attachment:action",this.onAttachmentChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("atom:action",this.onActionChanged),this.$meta.eventHub.$off("comment:action",this.onCommentChanged),this.$meta.eventHub.$off("attachment:action",this.onAttachmentChanged)},created:function(){this.load()},methods:{reload:function(){this.item=null,this.actions=null,this.load()},load:function(){var t=this;this.$api.post("atom/read",{key:{atomId:this.atomId}}).then((function(e){t.item=e,t.$meta.module.use(t.item.module,(function(e){t.module=e})),t.$api.post("atom/validator",{atomClass:{id:t.item.atomClassId}}).then((function(e){t.validateParams={module:e.module,validator:e.validator}})),t.fetchActions()})).catch((function(){t.notfound=!0}))},fetchActions:function(){var t=this;this.$api.post("atom/actions",{key:{atomId:this.atomId}}).then((function(e){t.actions=e}))},findAction:function(t){return this.actions?this.actions.find((function(e){return e.name===t})):null},onSave:function(t){return this.onAction(t,"save")},onAction:function(t,e){var n=this;if("save"===e||"submit"===e)return this.$refs.validate.perform(t,e);"string"==typeof e&&(e={module:this.item.module,atomClassName:this.item.atomClassName,name:e});var a=this.getAction(e);return"write"===e.name&&(a=this.$utils.extend({},a,{navigateOptions:{target:"_self"}})),this.$meta.util.performAction({ctx:this,action:a,item:this.item}).then((function(t){t&&n.$f7router.back()}))},onPerformValidate:function(t,e){var n=this,a=this.$utils.extend({},this.findAction("write"),{name:e}),o=this.getAction(a);return this.$meta.util.performAction({ctx:this,action:o,item:this.item}).then((function(){if("save"===e)return!0;"submit"===e&&n.$f7router.back()}))},onActionChanged:function(t){var e=t.key,n=t.action;if("edit"!==this.mode&&this.ready&&this.item.atomId===e.atomId&&(1!==n.menu||"create"!==n.action))return"delete"===n.name?(this.item=null,void(this.notfound=!0)):void this.reload()},onCommentChanged:function(t){this.item&&t.atomId===this.atomId&&("create"===t.action&&(this.item.commentCount+=1),"delete"===t.action&&(this.item.commentCount-=1))},onAttachmentChanged:function(t){this.item&&t.atomId===this.atomId&&("create"===t.action&&(this.item.attachmentCount+=1),"delete"===t.action&&(this.item.attachmentCount-=1))},onSubmit:function(){this.$refs.buttonSave.onClick()}}},m=n(0),d=Object(m.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.title,"eb-back-link":"Back"}},[n("f7-nav-right",[t.ready&&t.findAction("write")?n("eb-link",{ref:"buttonSave",attrs:{iconMaterial:"edit"===this.mode?"save":"edit",context:"edit"===this.mode?"save":"write",onPerform:t.onAction}}):t._e(),t._v(" "),t.showPopover?n("f7-link",{attrs:{iconMaterial:"more_horiz","popover-open":"#"+t.popoverId}}):t._e()],1)],1),t._v(" "),t.notfound?[n("f7-list",[n("f7-list-item",{attrs:{title:t.$text("Not found")}})],1)]:[t.ready?n("atoms",{attrs:{mode:"list",itemShow:t.item}}):t._e(),t._v(" "),t.ready?n("eb-validate",{ref:"validate",attrs:{readOnly:"edit"!==this.mode,auto:"",data:t.item,params:t.validateParams,onPerform:t.onPerformValidate,onSave:t.onSave},on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}}):t._e(),t._v(" "),n("f7-popover",{attrs:{id:t.popoverId}},[t.showPopover?n("f7-list",{attrs:{inset:""}},[t.findAction("write")&&0===t.item.atomEnabled?n("eb-list-button",{attrs:{"popover-close":"",context:"submit",onPerform:t.onAction}},[t._v(t._s(t.$text("Submit")))]):t._e(),t._v(" "),t._l(t.actions,(function(e){return"write"!==e.name?n("eb-list-button",{key:e.id,attrs:{"popover-close":"",context:e,onPerform:t.onAction}},[t._v(t._s(t.getActionTitle(e)))]):t._e()}))],2):t._e()],1)],t._v(" "),t.ready&&t.enableFootbar?n("f7-toolbar",{attrs:{"bottom-md":""}},[t.enableComment?n("eb-link",{attrs:{iconMaterial:"comment","eb-href":"comment/list?atomId="+t.item.atomId}},[t._v(t._s(t.item.commentCount))]):t._e(),t._v(" "),t.enableAttachment?n("eb-link",{attrs:{iconMaterial:"attach_file","eb-href":"attachment/list?atomId="+t.item.atomId}},[t._v(t._s(t.item.attachmentCount))]):t._e()],1):t._e()],2)}),[],!1,null,"3e58e834",null);e.a=d.exports},function(t,e,n){"use strict";var a=n(10),o=n(5);function i(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){l=!0,i=t},f:function(){try{r||null==n.return||n.return()}finally{if(l)throw i}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var r={meta:{global:!1},mixins:[a.a,o.a],props:{mode:{type:String}},data:function(){return{items:[],query:"",functionScenes:null}},computed:{itemGroups:function(){return"scenes"===this.mode?this.itemGroupsScenes:"modules"===this.mode?this.itemGroupsModules:void 0},itemGroupsScenes:function(){if(!this.functionScenes)return[];var t,e=[],n=null,a=i(this.items);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(!n||n.id!==o.sceneId){var s=this.functionScenes[o.sceneId];n={id:o.sceneId,name:s.sceneName,title:s.titleLocale,items:[]},e.push(n)}n.items.push(o)}}catch(t){a.e(t)}finally{a.f()}return e},itemGroupsModules:function(){if(!this.modulesAll)return[];var t,e=[],n=null,a=i(this.items);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(!n||n.id!==o.module){var s=this.modulesAll[o.module];n={id:o.module,title:s.titleLocale,items:[]},e.push(n)}n.items.push(o)}}catch(t){a.e(t)}finally{a.f()}return e}},mounted:function(){this.$meta.eventHub.$on("menu:star",this.onStarChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("menu:star",this.onStarChanged)},methods:{onSearch:function(t){this.query=t,this.query?this.reload(!0):this.items=[]},reload:function(t){var e=this;this.functionScenes||this.$store.dispatch("a/base/getFunctionScenes",{sceneMenu:1}).then((function(t){e.functionScenes=t})),this.$refs.loadMore.reload(t)},loadMore:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e,n=this,a=t.index;return"scenes"===this.mode?e={where:{"a.menu":1},orders:[["f.sceneSorting","asc"],["a.sorting","asc"]],page:{index:a}}:"modules"===this.mode?e={where:{"a.menu":1},orders:[["a.module","asc"],["f.sceneSorting","asc"],["a.sorting","asc"]],page:{index:a}}:"stars"===this.mode?e={where:{"a.menu":1},orders:[["d.updatedAt","desc"]],star:1,page:{index:a}}:"search"===this.mode&&(e={where:{"a.menu":1,"b.titleLocale":{val:this.query,op:"like"}},orders:[["b.titleLocale","asc"]],page:{index:a}}),this.$api.post("function/list",{options:e}).then((function(t){return n.items=n.items.concat(t.list),t}))},onStarSwitch:function(t,e){var n=this,a=e.star?0:1;return this.$api.post("function/star",{id:e.id,star:a}).then((function(){n.$meta.eventHub.$emit("menu:star",{id:e.id,star:a}),n.$meta.util.swipeoutClose(t.target)}))},onStarOff:function(t,e){var n=this;return this.$api.post("function/star",{id:e.id,star:0}).then((function(){n.$meta.eventHub.$emit("menu:star",{id:e.id,star:0}),n.$meta.util.swipeoutDelete(t.target)}))},onStarChanged:function(t){var e=this.items.findIndex((function(e){return e.id===t.id}));"stars"===this.mode?0===t.star&&-1!==e?this.items.splice(e,1):1===t.star&&-1===e&&this.reload():-1!==e&&(this.items[e].star=t.star)},onItemClick:function(t,e){var n=this.getMenu(e);if(n)return"create"===n.action&&(e={atomClassId:e.atomClassId,module:e.module,atomClassName:e.atomClassName,atomClassIdParent:e.atomClassIdParent},n=this.$utils.extend({},n,{targetEl:t.target})),this.$meta.util.performAction({ctx:this,action:n,item:e})}}},l=n(0),c=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("f7-list",["search"===t.mode?t._l(t.items,(function(e){return n("eb-list-item",{key:e.id,attrs:{link:"#",context:e,onPerform:t.onItemClick,title:e.titleLocale,swipeout:""}},[n("f7-icon",{attrs:{slot:"media",color:"orange",material:e.star?"star":""},slot:"media"}),t._v(" "),n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"orange",context:e,onPerform:t.onStarSwitch}},[t._v(t._s(e.star?t.$text("Unstar"):t.$text("Star")))])])])],1)})):"stars"===t.mode?t._l(t.items,(function(e){return n("eb-list-item",{key:e.id,attrs:{link:"#",context:e,onPerform:t.onItemClick,title:e.titleLocale,swipeout:""}},[n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"orange",context:e,onPerform:t.onStarOff}},[t._v(t._s(t.$text("Unstar")))])])])],1)})):t._l(t.itemGroups,(function(e){return n("f7-list-group",{key:e.id},[n("f7-list-item",{attrs:{title:e.title,"group-title":""}}),t._v(" "),t._l(e.items,(function(e){return n("eb-list-item",{key:e.id,attrs:{link:"#",context:e,onPerform:t.onItemClick,title:e.titleLocale,swipeout:""}},[n("f7-icon",{attrs:{slot:"media",color:"orange",material:e.star?"star":""},slot:"media"}),t._v(" "),n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"orange",context:e,onPerform:t.onStarSwitch}},[t._v(t._s(e.star?t.$text("Unstar"):t.$text("Star")))])])])],1)}))],2)}))],2),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!1}})],1)}),[],!1,null,null,null);e.a=c.exports},function(t,e,n){var a=n(20);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n(12).default)("5c3d1884",a,!0,{})},function(t,e,n){"use strict";e.a={computed:{ordersAll:function(){return this.$store.getState("a/base/orders")}},methods:{getOrdersOfAtomClass:function(t){return t&&this.ordersAll?this.ordersAll[t.module][t.atomClassName]:null},getOrdersOfBase:function(){return this.ordersAll?this.ordersAll.base:null}},created:function(){this.$store.dispatch("a/base/getOrders")}}},function(t,e,n){"use strict";e.a={computed:{modulesAll:function(){return this.$store.getState("a/base/modules")}},created:function(){this.$store.dispatch("a/base/getModules")},methods:{getModule:function(t){return this.modulesAll?this.modulesAll[t]:null}}}},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",a=t[3];if(!a)return n;if(e&&"function"==typeof btoa){var o=(s=a,r=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),"/*# ".concat(l," */")),i=a.sources.map((function(t){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(t," */")}));return[n].concat(i).concat([o]).join("\n")}var s,r,l;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,a){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(a)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(o[s]=!0)}for(var r=0;r<t.length;r++){var l=[].concat(t[r]);a&&o[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),e.push(l))}},e}},function(t,e,n){"use strict";function a(t,e){for(var n=[],a={},o=0;o<e.length;o++){var i=e[o],s=i[0],r={id:t+":"+o,css:i[1],media:i[2],sourceMap:i[3]};a[s]?a[s].parts.push(r):n.push(a[s]={id:s,parts:[r]})}return n}n.r(e),n.d(e,"default",(function(){return f}));var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},s=o&&(document.head||document.getElementsByTagName("head")[0]),r=null,l=0,c=!1,u=function(){},m=null,d="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(t,e,n,o){c=n,m=o||{};var s=a(t,e);return h(s),function(e){for(var n=[],o=0;o<s.length;o++){var r=s[o];(l=i[r.id]).refs--,n.push(l)}e?h(s=a(t,e)):s=[];for(o=0;o<n.length;o++){var l;if(0===(l=n[o]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete i[l.id]}}}}function h(t){for(var e=0;e<t.length;e++){var n=t[e],a=i[n.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](n.parts[o]);for(;o<n.parts.length;o++)a.parts.push(v(n.parts[o]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var s=[];for(o=0;o<n.parts.length;o++)s.push(v(n.parts[o]));i[n.id]={id:n.id,refs:1,parts:s}}}}function p(){var t=document.createElement("style");return t.type="text/css",s.appendChild(t),t}function v(t){var e,n,a=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(a){if(c)return u;a.parentNode.removeChild(a)}if(d){var o=l++;a=r||(r=p()),e=A.bind(null,a,o,!1),n=A.bind(null,a,o,!0)}else a=p(),e=C.bind(null,a),n=function(){a.parentNode.removeChild(a)};return e(t),function(a){if(a){if(a.css===t.css&&a.media===t.media&&a.sourceMap===t.sourceMap)return;e(t=a)}else n()}}var b,g=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function A(t,e,n,a){var o=n?"":a.css;if(t.styleSheet)t.styleSheet.cssText=g(e,o);else{var i=document.createTextNode(o),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(i,s[e]):t.appendChild(i)}}function C(t,e){var n=e.css,a=e.media,o=e.sourceMap;if(a&&t.setAttribute("media",a),m.ssrId&&t.setAttribute("data-vue-ssr-id",e.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},function(t,e,n){t.exports=n.p+"static/img/user.4819d46124c424b8e299f0f5ed68fb6d.png"},function(t,e,n){"use strict";n.r(e);var a;n(15);e.default={install:function(t,e){return a?console.error("already installed."):(a=t,e({routes:n(17).default,store:n(21).default(a),config:n(22).default,locales:n(23).default,components:n(45).default,mixins:n(46).default}))}}},function(t,e,n){var a=n(16);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n(12).default)("04fc9bf5",a,!0,{})},function(t,e,n){(e=n(11)(!0)).push([t.i,".comment .header-container {\n  width: 100%;\n}\n.comment .header-atom a.link {\n  text-transform: none;\n  text-align: right;\n}\n.comment .header-comment {\n  display: flex;\n  justify-content: space-between;\n}\n.comment .title .avatar {\n  float: left;\n}\n.comment .title .name {\n  margin-left: 40px;\n  font-size: 14px;\n  font-weight: 600;\n}\n.comment .title .date {\n  margin-top: -4px;\n  margin-left: 39px;\n  font-size: 13px;\n  color: var(--f7-text-editor-placeholder-color);\n}\n.comment .actions {\n  display: flex;\n}\n.comment .actions a.action {\n  min-width: 0;\n  height: auto;\n  color: var(--f7-text-editor-placeholder-color);\n}\n.comment .actions a.action .icon {\n  display: inline;\n  font-size: 18px;\n}\n.comment .actions a.action + a.action {\n  margin-left: 6px;\n}\n.item .header {\n  position: relative;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: 2px 8px -8px 18px;\n  font-size: 12px;\n  color: var(--f7-block-header-text-color);\n}\n.item .header .mediaLabel {\n  display: flex;\n  align-items: center;\n}\n.item .title .date {\n  font-size: 10px;\n  color: var(--f7-text-editor-placeholder-color);\n}\n.item .after .date {\n  font-size: 10px;\n  color: var(--f7-block-header-text-color);\n}\n.item .summary {\n  position: absolute;\n  left: 72px;\n  bottom: 0;\n  height: 20px;\n  color: var(--f7-block-header-text-color);\n  font-size: 12px;\n}\n","",{version:3,sources:["/Users/yangjian/Documents/data/cabloy/egg-born-demo/src/module/a-base-sync/front/src/assets/css/module.less","module.less"],names:[],mappings:"AAAA;EAGI,WAAA;ACDJ;ADFA;EAQM,oBAAA;EACA,iBAAA;ACHN;ADNA;EAcI,aAAA;EACA,8BAAA;ACLJ;ADVA;EAoBM,WAAA;ACPN;ADbA;EAwBM,iBAAA;EACA,eAAA;EACA,gBAAA;ACRN;ADlBA;EA8BM,gBAAA;EACA,iBAAA;EACA,eAAA;EACA,8CAAA;ACTN;ADxBA;EAsCI,aAAA;ACXJ;AD3BA;EAyCM,YAAA;EACA,YAAA;EACA,8CAAA;ACXN;ADhCA;EA8CQ,eAAA;EACA,eAAA;ACXR;ADcM;EACE,gBAAA;ACZR;ADkBA;EAEI,kBAAA;EACA,sBAAA;EACA,aAAA;EACA,8BAAA;EACA,mBAAA;EACA,yBAAA;EACA,eAAA;EACA,wCAAA;ACjBJ;ADQA;EAYM,aAAA;EACA,mBAAA;ACjBN;ADIA;EAoBM,eAAA;EACA,8CAAA;ACrBN;ADAA;EA2BM,eAAA;EACA,wCAAA;ACxBN;ADJA;EAiCI,kBAAA;EACA,UAAA;EACA,SAAA;EACA,YAAA;EACA,wCAAA;EACA,eAAA;AC1BJ",file:"module.less",sourcesContent:[".comment {\n\n  .header-container {\n    width: 100%;\n  }\n\n  .header-atom {\n    a.link {\n      text-transform: none;\n      text-align: right;\n    }\n  }\n\n  .header-comment {\n    display: flex;\n    justify-content: space-between;\n  }\n\n  .title {\n    .avatar {\n      float: left;\n    }\n\n    .name {\n      margin-left: 40px;\n      font-size: 14px;\n      font-weight: 600;\n    }\n\n    .date {\n      margin-top: -4px;\n      margin-left: 39px;\n      font-size: 13px;\n      color: var(--f7-text-editor-placeholder-color);\n    }\n  }\n\n  .actions {\n    display: flex;\n\n    a.action {\n      min-width: 0;\n      height: auto;\n      color: var(--f7-text-editor-placeholder-color);\n\n      .icon {\n        display: inline;\n        font-size: 18px;\n      }\n\n      &+a.action {\n        margin-left: 6px;\n      }\n    }\n  }\n}\n\n.item {\n  .header {\n    position: relative;\n    box-sizing: border-box;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin: 2px 8px -8px 18px;\n    font-size: 12px;\n    color: var(--f7-block-header-text-color);\n\n    .mediaLabel {\n      display: flex;\n      align-items: center;\n    }\n\n  }\n\n  .title {\n    .date {\n      font-size: 10px;\n      color: var(--f7-text-editor-placeholder-color);\n    }\n  }\n\n  .after {\n    .date {\n      font-size: 10px;\n      color: var(--f7-block-header-text-color);\n    }\n  }\n\n  .summary {\n    position: absolute;\n    left: 72px;\n    bottom: 0;\n    height: 20px;\n    color: var(--f7-block-header-text-color);\n    font-size: 12px;\n  }\n\n}\n",".comment .header-container {\n  width: 100%;\n}\n.comment .header-atom a.link {\n  text-transform: none;\n  text-align: right;\n}\n.comment .header-comment {\n  display: flex;\n  justify-content: space-between;\n}\n.comment .title .avatar {\n  float: left;\n}\n.comment .title .name {\n  margin-left: 40px;\n  font-size: 14px;\n  font-weight: 600;\n}\n.comment .title .date {\n  margin-top: -4px;\n  margin-left: 39px;\n  font-size: 13px;\n  color: var(--f7-text-editor-placeholder-color);\n}\n.comment .actions {\n  display: flex;\n}\n.comment .actions a.action {\n  min-width: 0;\n  height: auto;\n  color: var(--f7-text-editor-placeholder-color);\n}\n.comment .actions a.action .icon {\n  display: inline;\n  font-size: 18px;\n}\n.comment .actions a.action + a.action {\n  margin-left: 6px;\n}\n.item .header {\n  position: relative;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: 2px 8px -8px 18px;\n  font-size: 12px;\n  color: var(--f7-block-header-text-color);\n}\n.item .header .mediaLabel {\n  display: flex;\n  align-items: center;\n}\n.item .title .date {\n  font-size: 10px;\n  color: var(--f7-text-editor-placeholder-color);\n}\n.item .after .date {\n  font-size: 10px;\n  color: var(--f7-block-header-text-color);\n}\n.item .summary {\n  position: absolute;\n  left: 72px;\n  bottom: 0;\n  height: 20px;\n  color: var(--f7-block-header-text-color);\n  font-size: 12px;\n}\n"]}]),t.exports=e},function(t,e,n){"use strict";function a(t){return n(18)("./".concat(t,".vue")).default}n.r(e),e.default=[{path:"menu/list",component:a("menu/list")},{path:"menu/search",component:a("menu/search")},{path:"menu/selectFunction",component:a("menu/selectFunction")},{path:"atom/list",component:a("atom/list")},{path:"atom/search",component:a("atom/search")},{path:"atom/searchQuick",component:a("atom/searchQuick")},{path:"atom/searchResult",component:a("atom/searchResult")},{path:"atom/labels",component:a("atom/labels")},{path:"atom/edit",component:a("atom/edit")},{path:"atom/view",component:a("atom/view")},{path:"atom/selectAtomClass",component:a("atom/selectAtomClass")},{path:"atom/select",component:a("atom/select")},{path:"atom/autoStar",component:a("atom/autoStar")},{path:"comment/list",component:a("comment/list")},{path:"comment/item",component:a("comment/item")},{path:"comment/all",component:a("comment/all")},{path:"comment/autoHeart",component:a("comment/autoHeart")},{path:"attachment/list",component:a("attachment/list")},{path:"base/alert",component:a("base/alert")}]},function(t,e,n){var a={"./atom/autoStar.vue":26,"./atom/edit.vue":27,"./atom/labels.vue":28,"./atom/list.vue":29,"./atom/search.vue":30,"./atom/searchQuick.vue":31,"./atom/searchResult.vue":32,"./atom/select.vue":33,"./atom/selectAtomClass.vue":34,"./atom/view.vue":35,"./attachment/list.vue":36,"./base/alert.vue":37,"./comment/all.vue":38,"./comment/autoHeart.vue":39,"./comment/item.vue":40,"./comment/list.vue":41,"./menu/list.vue":42,"./menu/search.vue":43,"./menu/selectFunction.vue":44};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}o.keys=function(){return Object.keys(a)},o.resolve=i,t.exports=o,o.id=18},function(t,e,n){"use strict";var a=n(8);n.n(a).a},function(t,e,n){(e=n(11)(!0)).push([t.i,"\n.label[data-v-0acc53b6] {\n  position: absolute;\n  width: 100%;\n  top: 10px;\n  text-align: center;\n}\n.media[data-v-0acc53b6] {\n  width: 16px;\n  height: 16px;\n  border-radius: 8px;\n}\n.colors[data-v-0acc53b6] {\n  height: 60px;\n  width: 100%;\n}\n\n","",{version:3,sources:["labels.vue"],names:[],mappings:";AACA;EACE,kBAAkB;EAClB,WAAW;EACX,SAAS;EACT,kBAAkB;AACpB;AACA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;AACpB;AACA;EACE,YAAY;EACZ,WAAW;AACb",file:"labels.vue",sourcesContent:["\n.label[data-v-0acc53b6] {\n  position: absolute;\n  width: 100%;\n  top: 10px;\n  text-align: center;\n}\n.media[data-v-0acc53b6] {\n  width: 16px;\n  height: 16px;\n  border-radius: 8px;\n}\n.colors[data-v-0acc53b6] {\n  height: 60px;\n  width: 100%;\n}\n\n"]}]),t.exports=e},function(t,e,n){"use strict";function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.r(e),e.default=function(t){var e=t.prototype.$meta.util.queue((function(e,n){if(t.prototype.$meta.store.getState("auth/user").op.id!==e.userId)return n();t.prototype.$meta.api.post("/a/base/layoutConfig/saveKey",e.data).then((function(){n()})).catch((function(t){console.error(t),n()}))}));return t.prototype.$meta.eventHub.$on("auth:login",(function(e){t.prototype.$meta.store.commit("a/base/authLogin",e)})),{state:{labels:null,layoutConfig:{},userPanels:null,userWidgets:null,userSections:null,userButtons:null,userAtomClassRolesPreferred:{},modules:null,atomClasses:null,actions:null,flags:null,orders:null,functionScenes:{},functions:null,menus:null,panels:null,widgets:null,sections:null,buttons:null},getters:{userLabels:function(t){return t.labels}},mutations:{authLogin:function(t){t.labels=null,t.layoutConfig={},t.userPanels=null,t.userWidgets=null,t.userSections=null,t.userButtons=null,t.userAtomClassRolesPreferred={}},setLabels:function(t,e){t.labels=e},setLayoutConfig:function(t,e){var n=e.module,a=e.data;t.layoutConfig=o(o({},t.layoutConfig),{},i({},n,a))},setLayoutConfigKey:function(n,a){var s=a.module,r=a.key,l=a.value,c=n.layoutConfig[s]||{};c=o(o({},c),{},i({},r,l)),n.layoutConfig=o(o({},n.layoutConfig),{},i({},s,c));var u=t.prototype.$meta.store.getState("auth/user");if(!u.op.anonymous){var m={module:s,key:r,value:l};e.push({userId:u.op.id,data:m})}},setUserPanels:function(t,e){t.userPanels=e},setUserWidgets:function(t,e){t.userWidgets=e},setUserSections:function(t,e){t.userSections=e},setUserButtons:function(t,e){t.userButtons=e},setUserAtomClassRolesPreferred:function(t,e){var n=e.atomClassId,a=e.roleIdOwner;t.userAtomClassRolesPreferred=o(o({},t.userAtomClassRolesPreferred),{},i({},n,a))},setModules:function(t,e){t.modules=e},setAtomClasses:function(t,e){t.atomClasses=e},setActions:function(t,e){t.actions=e},setFlags:function(t,e){t.flags=e},setOrders:function(t,e){t.orders=e},setMenus:function(t,e){t.menus=e},setPanels:function(t,e){t.panels=e},setWidgets:function(t,e){t.widgets=e},setSections:function(t,e){t.sections=e},setButtons:function(t,e){t.buttons=e},setFunctions:function(t,e){t.functions=e},setFunctionScenes:function(t,e){var n=e.sceneMenu,a=e.scenes;t.functionScenes=o(o({},t.functionScenes),{},i({},n,a))}},actions:{getLabels:function(e){var n=e.commit,a=e.getters;return new Promise((function(e,o){var i=a.userLabels;if(i)return e(i);t.prototype.$meta.api.post("/a/base/user/getLabels").then((function(t){n("setLabels",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getModules:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.modules)return e(n.modules);t.prototype.$meta.api.post("/a/base/base/modules").then((function(t){a("setModules",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getAtomClasses:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.atomClasses)return e(n.atomClasses);t.prototype.$meta.api.post("/a/base/base/atomClasses").then((function(t){a("setAtomClasses",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getActions:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.actions)return e(n.actions);t.prototype.$meta.api.post("/a/base/base/actions").then((function(t){a("setActions",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getFlags:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.flags)return e(n.flags);t.prototype.$meta.api.post("/a/base/base/flags").then((function(t){a("setFlags",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getOrders:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.orders)return e(n.orders);t.prototype.$meta.api.post("/a/base/base/orders").then((function(t){a("setOrders",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getMenus:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.menus)return e(n.menus);t.prototype.$meta.api.post("/a/base/base/menus").then((function(t){a("setMenus",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getPanels:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.panels)return e(n.panels);t.prototype.$meta.api.post("/a/base/base/panels").then((function(t){a("setPanels",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getWidgets:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.widgets)return e(n.widgets);t.prototype.$meta.api.post("/a/base/base/widgets").then((function(t){a("setWidgets",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getSections:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.sections)return e(n.sections);t.prototype.$meta.api.post("/a/base/base/sections").then((function(t){a("setSections",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getButtons:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.buttons)return e(n.buttons);t.prototype.$meta.api.post("/a/base/base/buttons").then((function(t){a("setButtons",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getFunctionScenes:function(e,n){var a=e.state,o=e.commit,i=n.sceneMenu;return new Promise((function(e,n){if(a.functionScenes[i])return e(a.functionScenes[i]);t.prototype.$meta.api.post("/a/base/function/scenes",{sceneMenu:i}).then((function(t){o("setFunctionScenes",{sceneMenu:i,scenes:t=t||{}}),e(t)})).catch((function(t){n(t)}))}))},getFunctions:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.functions)return e(n.functions);t.prototype.$meta.api.post("/a/base/base/functions").then((function(t){a("setFunctions",t=t||{}),e(t)})).catch((function(t){o(t)}))}))},getLayoutConfig:function(e,n){var a=e.state,o=e.commit;return new Promise((function(e,i){if(a.layoutConfig[n])return e(a.layoutConfig[n]);t.prototype.$meta.api.post("/a/base/layoutConfig/load",{module:n}).then((function(t){o("setLayoutConfig",{module:n,data:t=t||{}}),e(t)})).catch((function(t){i(t)}))}))},getUserPanels:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.userPanels)return e(n.userPanels);t.prototype.$meta.api.post("/a/base/function/list",{options:{where:{menu:2},orders:[["titleLocale","asc"]],page:{size:0}}}).then((function(t){a("setUserPanels",t.list),e(t.list)})).catch((function(t){o(t)}))}))},getUserWidgets:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.userWidgets)return e(n.userWidgets);t.prototype.$meta.api.post("/a/base/function/list",{options:{where:{menu:3},orders:[["titleLocale","asc"]],page:{size:0}}}).then((function(t){a("setUserWidgets",t.list),e(t.list)})).catch((function(t){o(t)}))}))},getUserSections:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.userSections)return e(n.userSections);t.prototype.$meta.api.post("/a/base/function/list",{options:{where:{menu:4},orders:[["titleLocale","asc"]],page:{size:0}}}).then((function(t){a("setUserSections",t.list),e(t.list)})).catch((function(t){o(t)}))}))},getUserButtons:function(e){var n=e.state,a=e.commit;return new Promise((function(e,o){if(n.userButtons)return e(n.userButtons);t.prototype.$meta.api.post("/a/base/function/list",{options:{where:{menu:5},orders:[["titleLocale","asc"]],page:{size:0}}}).then((function(t){a("setUserButtons",t.list),e(t.list)})).catch((function(t){o(t)}))}))}}}}},function(t,e,n){"use strict";n.r(e);var a=n(13),o=n.n(a);e.default={menu:{scene:{0:"Default",1:"Create",2:"List",20:"Statistics",50:"Tools"}},user:{avatar:{default:o.a}}}},function(t,e,n){"use strict";n.r(e),e.default={"en-us":n(24).default,"zh-cn":n(25).default}},function(t,e,n){"use strict";n.r(e),e.default={Heart2:"Heart",AtomClassSelectRoleTip:"Select Role"}},function(t,e,n){"use strict";n.r(e),e.default={Menu:"èœå•",Scenes:"åœºæ™¯",Modules:"æ¨¡å—",Stars:"æ˜Ÿæ ‡",Star:"æ˜Ÿæ ‡",Unstar:"å–æ¶ˆæ˜Ÿæ ‡",Starred:"å·²åŠ æ˜Ÿæ ‡",Close:"å…³é—­",Create:"æ–°å»º",Others:"å…¶ä»–",List:"åˆ—è¡¨",Tools:"å·¥å…·",Draft:"è‰ç¨¿",Drafts:"è‰ç¨¿",Labels:"æ ‡ç­¾",Submit:"æäº¤",Edit:"ç¼–è¾‘",View:"æŸ¥çœ‹",Save:"ä¿å­˜",Delete:"åˆ é™¤",Red:"çº¢è‰²",Orange:"æ©˜è‰²",Yellow:"é»„è‰²",Blue:"è“è‰²",Green:"ç»¿è‰²",Purple:"ç´«è‰²",Label:"æ ‡ç­¾",Comment:"è¯„è®º",Username:"ç”¨æˆ·å",Realname:"çœŸå®žå§“å",Email:"ç”µå­é‚®ç®±",Mobile:"æ‰‹æœºå·",Motto:"ç®´è¨€",Locale:"æœ¬åœ°åŒ–",Search:"æœç´¢",Link:"é“¾æŽ¥",Select:"é€‰æ‹©",Remove:"ç§»é™¤",Heart2:"ç‚¹èµž",Hearted:"å·²ç‚¹èµž",AtomClassSelectRoleTip:"é€‰æ‹©è§’è‰²","Atom Flag":"åŽŸå­æ ‡è®°","Atom Name":"åŽŸå­åç§°","Modification Time":"ä¿®æ”¹æ—¶é—´","Comment List":"è¯„è®ºåˆ—è¡¨","Created Time":"åˆ›å»ºæ—¶é—´","Search Menu":"æœç´¢èœå•","Search Atom":"æœç´¢åŽŸå­","Search Result":"æœç´¢ç»“æžœ","Select Atom Class":"é€‰æ‹©åŽŸå­ç±»åž‹","Select Menu":"é€‰æ‹©èœå•","Select Function":"é€‰æ‹©åŠŸèƒ½","Select Panel":"é€‰æ‹©è¾¹æ ","Select Widget":"é€‰æ‹©éƒ¨ä»¶","Atom Class":"åŽŸå­ç±»åž‹","Allow Comment":"å…è®¸è¯„è®º","Attachment List":"é™„ä»¶åˆ—è¡¨","Flag Not Found":"Flagæœªå‘çŽ°","Friendly Tips":"å‹æƒ…æç¤º","Please Sign In":"è¯·ç™»å½•"}},function(t,e,n){"use strict";n.r(e);var a={data:function(){return{atomId:this.$f7route.query.atomId}},created:function(){var t=this;this.$api.post("/a/base/atom/star",{key:{atomId:this.atomId},atom:{star:1}}).then((function(){t.$view.dialog.alert(t.$text("Starred")).then((function(){t.openAtom()}))}))},methods:{openAtom:function(){location.assign(this.$f7route.query.returnTo)}}},o=n(0),i=Object(o.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("eb-page",[e("eb-navbar",{attrs:{large:"",largeTransparent:"",title:this.$text("Star"),"eb-back-link":"Back"}}),this._v(" "),e("f7-block")],1)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var a={meta:{size:"medium"},components:{item:n(6).a},data:function(){return{query:this.$f7route.query}}},o=n(0),i=Object(o.a)(a,(function(){var t=this.$createElement;return(this._self._c||t)("item",{attrs:{query:this.query,mode:"edit"}})}),[],!1,null,"e2e87734",null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var a={data:function(){return{atomId:parseInt(this.$f7route.query.atomId),item:null,labels:[],sheetOpened:!1,labelId:0,labelText:"",labelColor:"",colors:[{name:"Red",value:"#FC6360"},{name:"Orange",value:"#FDA951"},{name:"Yellow",value:"#FED558"},{name:"Blue",value:"#54BEF7"},{name:"Green",value:"#86DF6A"},{name:"Purple",value:"#D592E5"}]}},computed:{labelsAll:function(){return this.$local.getters("userLabels")}},methods:{onAddLabel:function(){this.labelId=0,this.labelText="",this.labelColor="",this.sheetOpened=!0},onEditLabel:function(t,e){this.labelId=e,this.labelText=this.labelsAll[e].text,this.labelColor=this.labelsAll[e].color,this.sheetOpened=!0},onFormSubmit:function(){this.$refs.buttonSubmit.onClick()},onSubmit:function(){var t=this;if(this.labelText&&this.labelColor){var e=this.$meta.util.extend({},this.labelsAll);return 0===this.labelId?e[this.newLabelId()]={text:this.labelText,color:this.labelColor}:e[this.labelId]={text:this.labelText,color:this.labelColor},this.$api.post("user/setLabels",{labels:e}).then((function(){t.$local.commit("setLabels",e),t.sheetOpened=!1}))}},onColorSelect:function(t){this.labelColor=t.value},newLabelId:function(){var t=Object.keys(this.labelsAll);return 0===t.length?1:(t.sort((function(t,e){return e-t})),parseInt(t[0])+1)},labelChecked:function(t){return this.labels&&this.labels.indexOf(t)>-1},onLabelCheckChange:function(t,e){var n=this,a=this.labels.indexOf(e);t.target.checked&&-1===a?this.labels.push(e):!t.target.checked&&a>-1&&this.labels.splice(a,1),this.labels.sort((function(t,e){return t-e})),this.$api.post("atom/labels",{key:{atomId:this.atomId},atom:{labels:this.labels}}).then((function(){n.$meta.eventHub.$emit("atom:labels",{key:{atomId:n.atomId},labels:n.labels})}))}},created:function(){var t=this;this.$local.dispatch("getLabels"),this.$api.post("atom/read",{key:{atomId:this.atomId}}).then((function(e){t.item=e,t.labels=JSON.parse(t.item.labels)||[]}))}},o=(n(19),n(0)),i=Object(o.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Labels"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"add"},on:{click:function(e){return e.preventDefault(),t.onAddLabel(e)}}})],1)],1),t._v(" "),t.labelsAll?n("f7-list",[n("f7-list-item",{attrs:{"group-title":"",title:t.item?t.item.atomName:""}}),t._v(" "),t._l(Object.keys(t.labelsAll),(function(e){return n("eb-list-item",{key:e,attrs:{title:t.labelsAll[e].text,checkbox:"",checked:t.labelChecked(e),swipeout:""},on:{change:function(n){return t.onLabelCheckChange(n,e)}}},[n("div",{staticClass:"media",style:{backgroundColor:t.labelsAll[e].color},attrs:{slot:"media"},slot:"media"}),t._v(" "),n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{close:"",color:"orange",context:e,onPerform:t.onEditLabel}},[t._v(t._s(t.$text("Edit")))])])])],1)}))],2):t._e(),t._v(" "),n("f7-sheet",{ref:"ebSheet",attrs:{fill:"",opened:t.sheetOpened},on:{"sheet:closed":function(e){t.sheetOpened=!1}}},[n("f7-toolbar",[n("div",{staticClass:"left"},[n("f7-link",{attrs:{"sheet-close":""}},[t._v(t._s(t.$text("Close")))])],1),t._v(" "),n("div",{staticClass:"right"},[n("eb-link",{ref:"buttonSubmit",attrs:{onPerform:t.onSubmit}},[t._v(t._s(t.$text("Submit")))])],1)]),t._v(" "),n("f7-page-content",[n("div",{staticClass:"label"},[n("f7-badge",{style:{backgroundColor:t.labelColor}},[t._v(t._s(t.labelText))])],1),t._v(" "),n("eb-list",{attrs:{form:"","no-hairlines-md":""},on:{submit:function(e){return e.preventDefault(),t.onFormSubmit(e)}}},[n("eb-list-input",{attrs:{label:t.$text("Text"),"floating-label":"",type:"text","clear-button":"",placeholder:t.$text("Text")},model:{value:t.labelText,callback:function(e){t.labelText=e},expression:"labelText"}}),t._v(" "),n("f7-list-item",[n("div",{staticClass:"row colors"},t._l(t.colors,(function(e){return n("f7-button",{key:e.value,staticClass:"col-33",style:{backgroundColor:e.value},attrs:{small:"",fill:""},on:{click:function(n){return t.onColorSelect(e)}}},[t._v(t._s(t.$text(e.name)))])})),1)])],1)],1)],1)],1)}),[],!1,null,"0acc53b6",null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),i=n(3),s=n(2),r=n(4),l=n(5),c={mixins:[s.a,r.a,l.a],components:{atoms:i.a},data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName;return{atomClass:e&&n?{module:e,atomClassName:n}:null,where:t&&t.where?JSON.parse(t.where):null,scene:t&&t.scene,tabIdList:o.a.prototype.$meta.util.nextId("tab"),tabIdDrafts:o.a.prototype.$meta.util.nextId("tab"),tabIdStars:o.a.prototype.$meta.util.nextId("tab"),tabIdLabels:o.a.prototype.$meta.util.nextId("tab"),popoverId:o.a.prototype.$meta.util.nextId("popover"),actions:null}},computed:{labels:function(){return this.$local.getters("userLabels")},pageTitle:function(){var t=this.getAtomClass(this.atomClass);return t?"".concat(this.$text("Atom"),": ").concat(t.titleLocale):this.$text("Atom")},showPopover:function(){return this.actions&&this.actions.length>0},whereForList:function(){if("mine"!==this.scene)return this.where;var t=this.where||{},e=this.$store.state.auth.user.op;return t["a.userIdCreated"]=e.id,t}},created:function(){var t=this;this.$local.dispatch("getLabels");var e={where:{menu:1,sceneName:"create"},orders:[["sorting","asc"]]};this.atomClass&&(e.where["e.module"]=this.atomClass.module,e.where["e.atomClassName"]=this.atomClass.atomClassName),this.$api.post("function/list",{options:e}).then((function(e){t.actions=e.list}))},methods:{onPerformSearch:function(){var t={},e=this.atomClass;e&&(t.module=e.module,t.atomClassName=e.atomClassName),this.where&&(t.where=JSON.stringify(this.where));var n=this.$meta.util.combineQueries("/a/base/atom/searchQuick",t);this.$view.navigate(n,{target:"_self"})},onAction:function(t,e){var n=this.getMenu(e);n&&("create"===n.action&&(e={atomClassId:e.atomClassId,module:e.module,atomClassName:e.atomClassName,atomClassIdParent:e.atomClassIdParent},n=this.$utils.extend({},n,{targetEl:t.target})),this.$meta.util.performAction({ctx:this,action:n,item:e}))},onPerformAtomOrders:function(t){var e=this.$$(this.$refs.tabs.$el).find(".tab-active"),n=this.$refs[e.data("ref")];Array.isArray(n)&&(n=n[0]),n.openPopoverForAtomOrders(t.currentTarget)}}},u=n(0),m=Object(u.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{"page-content":!1,tabs:"","with-subnavbar":""}},[n("eb-navbar",{attrs:{title:t.pageTitle,"eb-back-link":"Back"}},[n("f7-nav-right",[t.showPopover?n("f7-link",{attrs:{iconMaterial:"add","popover-open":"#"+t.popoverId}}):t._e(),t._v(" "),n("eb-link",{attrs:{iconMaterial:"search",onPerform:t.onPerformSearch}}),t._v(" "),n("eb-link",{attrs:{iconMaterial:"sort",onPerform:t.onPerformAtomOrders}})],1),t._v(" "),n("f7-subnavbar",[n("f7-toolbar",{attrs:{top:"",tabbar:"",scrollable:t.labels&&Object.keys(t.labels).length>1}},[n("f7-link",{attrs:{"tab-link":"#"+t.tabIdList,"tab-link-active":""}},[t._v(t._s(t.$text("List")))]),t._v(" "),n("f7-link",{attrs:{"tab-link":"#"+t.tabIdDrafts}},[t._v(t._s(t.$text("Drafts")))]),t._v(" "),n("f7-link",{attrs:{"tab-link":"#"+t.tabIdStars}},[t._v(t._s(t.$text("Stars")))]),t._v(" "),t.labels?t._l(Object.keys(t.labels),(function(e){return n("f7-link",{key:e,attrs:{"tab-link":"#"+t.tabIdLabels+"_"+e}},[t._v(t._s(t.labels[e].text))])})):t._e()],2)],1)],1),t._v(" "),n("f7-tabs",{ref:"tabs"},[n("eb-tab-page-content",{attrs:{id:t.tabIdList,"tab-active":"","data-ref":"list"}},[n("atoms",{ref:"list",attrs:{slot:"list",mode:"list",atomClass:t.atomClass,where:t.whereForList},slot:"list"})],1),t._v(" "),n("eb-tab-page-content",{attrs:{id:t.tabIdDrafts,"data-ref":"drafts"}},[n("atoms",{ref:"drafts",attrs:{slot:"list",mode:"drafts",atomClass:t.atomClass,where:t.where},slot:"list"})],1),t._v(" "),n("eb-tab-page-content",{attrs:{id:t.tabIdStars,"data-ref":"stars"}},[n("atoms",{ref:"stars",attrs:{slot:"list",mode:"stars",atomClass:t.atomClass,where:t.where},slot:"list"})],1),t._v(" "),t.labels?t._l(Object.keys(t.labels),(function(e){return n("eb-tab-page-content",{key:e,attrs:{id:t.tabIdLabels+"_"+e,"data-ref":"labels-"+e}},[n("atoms",{ref:"labels-"+e,refInFor:!0,attrs:{slot:"list",mode:"labels-"+e,atomClass:t.atomClass,where:t.where},slot:"list"})],1)})):t._e()],2),t._v(" "),n("f7-popover",{attrs:{id:t.popoverId}},[t.showPopover?n("f7-list",{attrs:{inset:""}},t._l(t.actions,(function(e){return n("eb-list-button",{key:e.id,attrs:{"popover-close":"",context:e,onPerform:t.onAction}},[t._v(t._s(e.titleLocale))])})),1):t._e()],1)],1)}),[],!1,null,null,null);e.default=m.exports},function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),i=n(2),s={mixins:[o.a.prototype.$meta.module.get("a-components").options.mixins.ebPageContext,i.a],data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName,a=e&&n?{module:e,atomClassName:n}:null;return{atomName:"",label:0,atomClass:a,where:t&&t.where?JSON.parse(t.where):null,item:null,validateParams:null,atomClassInit:a,mode:t&&t.mode||"search",selectMode:t&&t.selectMode}},computed:{pageTitle:function(){var t=this.atomClassTitle||this.$text("Atom");return"".concat(this.$text("Search")," ").concat(t)},labels:function(){var t=this.$local.getters("userLabels");if(!t)return null;var e=[{title:"",value:0}];for(var n in t)e.push({title:t[n].text,value:n});return e},atomClassTitle:function(){if(!this.atomClass)return"";if(this.atomClass.title)return this.atomClass.title;var t=this.getAtomClass(this.atomClass);return t?t.titleLocale:""}},watch:{atomClass:function(t){this.atomClassChanged()}},created:function(){this.$local.dispatch("getLabels"),this.atomClassChanged()},methods:{onFormSubmit:function(){this.$refs.buttonSubmit.onClick()},atomClassChanged:function(){var t=this,e=this.atomClass;e?this.$meta.module.use(e.module,(function(){t.$api.post("atomClass/validatorSearch",{atomClass:{module:e.module,atomClassName:e.atomClassName}}).then((function(e){t.item={},t.validateParams={module:e.module,validator:e.validator}}))})):(this.item=null,this.validateParams=null)},onSelectAtomClass:function(){var t=this;this.$view.navigate("/a/base/atom/selectAtomClass",{target:"_self",context:{params:{atomClass:this.atomClass,optional:!0},callback:function(e,n){200===e&&(t.atomClass=n)}}})},onPerformSearch:function(){var t,e=this;if(this.item)for(var n in t={},this.item){var a=this.item[n];null!=a&&""!==a&&(t["f.".concat(n)]="string"==typeof a?{val:a,op:"like"}:a)}var o={},i=this.atomClass;i&&(o.module=i.module,o.atomClassName=i.atomClassName),this.where&&(o.where=JSON.stringify(this.where)),o.mode=this.mode;var s=this.$meta.util.combineQueries("/a/base/atom/searchResult",o);this.$view.navigate(s,{target:"_self",context:{params:{atomName:this.atomName,label:this.label,atomClassExtra:t,selectMode:this.selectMode},callback:function(t,n){200===t&&"selectSearch"===e.mode&&e.contextCallback(200,n)}}})}}},r=n(0),l=Object(r.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.pageTitle,"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{ref:"buttonSubmit",attrs:{iconMaterial:"search",onPerform:t.onPerformSearch}})],1)],1),t._v(" "),n("eb-list",{attrs:{form:"","no-hairlines-md":""},on:{submit:function(e){return e.preventDefault(),t.onFormSubmit(e)}}},[n("eb-list-input",{attrs:{label:t.$text("Atom Name"),"floating-label":"",type:"text","clear-button":"",placeholder:t.$text("Atom Name")},model:{value:t.atomName,callback:function(e){t.atomName=e},expression:"atomName"}}),t._v(" "),n("f7-list-item",{attrs:{smartSelect:"",title:t.$text("Label"),smartSelectParams:{openIn:"page",closeOnSelect:!0}}},[n("eb-select",{attrs:{name:"label",options:t.labels},model:{value:t.label,callback:function(e){t.label=e},expression:"label"}})],1),t._v(" "),n("f7-list-item",{attrs:{divider:""}}),t._v(" "),t.atomClassInit?t._e():n("f7-list-item",{attrs:{title:t.$text("Atom Class"),link:"#"},on:{click:t.onSelectAtomClass}},[n("div",{attrs:{slot:"after"},slot:"after"},[t._v(t._s(t.atomClassTitle))])])],1),t._v(" "),t.item&&t.validateParams?n("eb-validate",{ref:"validate",attrs:{auto:"",data:t.item,params:t.validateParams},on:{submit:function(e){return e.preventDefault(),t.onFormSubmit(e)}}}):t._e()],1)}),[],!1,null,"4b70a7cb",null);e.default=l.exports},function(t,e,n){"use strict";n.r(e);n(1);var a=n(2),o=n(3),i={mixins:[a.a],components:{atoms:o.a},data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName;return{queries:t,atomClass:e&&n?{module:e,atomClassName:n}:null,where:t&&t.where?JSON.parse(t.where):null,mode:t&&t.mode||"search",selectMode:t&&t.selectMode}},computed:{params:function(){return{selectMode:this.selectMode}},pageTitle:function(){var t=this.atomClassTitle||this.$text("Atom");return"".concat(this.$text("Search")," ").concat(t)},atomClassTitle:function(){if(!this.atomClass)return"";if(this.atomClass.title)return this.atomClass.title;var t=this.getAtomClass(this.atomClass);return t?t.titleLocale:""}},methods:{onSearch:function(t){this.$refs.list.onSearch(t)},onLoadMore:function(){this.$refs.list.loadMore()},onDisable:function(){this.$f7router.back()},onSearchAdvanced:function(){var t=this.$meta.util.combineQueries("/a/base/atom/search",this.queries);this.$view.navigate(t,{target:"_self"})}}},s=n(0),r=Object(s.a)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-search-page",{attrs:{advanced:"",title:t.pageTitle},on:{onSearch:t.onSearch,onLoadMore:t.onLoadMore,onDisable:t.onDisable,onSearchAdvanced:t.onSearchAdvanced}},[n("atoms",{ref:"list",attrs:{slot:"list",mode:t.mode,params:t.params,atomClass:t.atomClass,where:t.where},slot:"list"})],1)}),[],!1,null,null,null);e.default=r.exports},function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),i=n(3),s={mixins:[o.a.prototype.$meta.module.get("a-components").options.mixins.ebPageContext],components:{atoms:i.a},data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName;return{atomClass:e&&n?{module:e,atomClassName:n}:null,where:t&&t.where?JSON.parse(t.where):null,mode:t&&t.mode}},computed:{params:function(){return this.contextParams},modeAtoms:function(){return this.mode||"search"}},mounted:function(){this.$refs.list.reload(!0)},methods:{onRefresh:function(t){t(),this.$refs.list.reload()},onInfinite:function(){this.$refs.list.loadMore()},onPerformAtomOrders:function(t){this.$refs.list.openPopoverForAtomOrders(t.currentTarget)},onPerformDone:function(t){var e=this.$refs.list.getSelectedAtoms();this.contextCallback(200,e),this.$view.close()}}},r=n(0),l=Object(r.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Search Result"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"sort",onPerform:t.onPerformAtomOrders}}),t._v(" "),"selectSearch"===t.mode?n("eb-link",{attrs:{iconMaterial:"done",onPerform:t.onPerformDone}}):t._e()],1)],1),t._v(" "),n("atoms",{ref:"list",attrs:{mode:t.modeAtoms,params:t.params,atomClass:t.atomClass,where:t.where}})],1)}),[],!1,null,null,null);e.default=l.exports},function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),i=n(2),s=n(3),r={mixins:[o.a.prototype.$meta.module.get("a-components").options.mixins.ebPageContext,i.a],components:{atoms:s.a},data:function(){return{params:null,selectMode:null,atomClass:null,where:null}},computed:{pageTitle:function(){var t,e=this.getAtomClass(this.atomClass);return t=e?e.titleLocale:this.$text("Atom"),"".concat(this.$text("Select")," ").concat(t)}},mounted:function(){var t,e=this,n=this.contextParams;this.selectMode=n.selectMode,this.atomClass=n.atomClass,this.where=n.where,t="single"===n.selectMode?n.selectedAtomId?[n.selectedAtomId]:null:n.selectedAtomIds?n.selectedAtomIds.concat():null,this.params={selectMode:this.selectMode,selectedAtomIds:t},this.$nextTick((function(){e.$refs.list.reload(!0)}))},methods:{onRefresh:function(t){t(),this.$refs.list.reload()},onInfinite:function(){this.$refs.list.loadMore()},onPerformAdd:function(){var t=this,e={},n=this.atomClass;n&&(e.module=n.module,e.atomClassName=n.atomClassName),this.where&&(e.where=JSON.stringify(this.where)),e.mode="selectSearch",e.selectMode=this.selectMode;var a=this.$meta.util.combineQueries("/a/base/atom/search",e);this.$view.navigate(a,{target:"_view",context:{params:{},callback:function(e,n){200===e&&t._updateSelectedAtoms(n)}}})},_updateSelectedAtoms:function(t){this.$refs.list.updateSelectedAtoms(t)},onPerformDone:function(){var t,e=this.$refs.list.getSelectedAtoms();t="single"===this.selectMode?e&&e.length>0?e[0]:null:e&&e.length>0?e:null,this.contextCallback(200,t),this.$f7router.back()}}},l=n(0),c=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.pageTitle,"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"add",onPerform:t.onPerformAdd}}),t._v(" "),n("eb-link",{attrs:{iconMaterial:"done",onPerform:t.onPerformDone}})],1)],1),t._v(" "),n("atoms",{ref:"list",attrs:{mode:"select",params:t.params,atomClass:t.atomClass}})],1)}),[],!1,null,null,null);e.default=c.exports},function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),i=n(2),s={mixins:[o.a.prototype.$meta.module.get("a-components").options.mixins.ebPageContext,i.a],data:function(){return{}},computed:{module:function(){return this.contextParams.atomClass?this.contextParams.atomClass.module:null},atomClassName:function(){return this.contextParams.atomClass?this.contextParams.atomClass.atomClassName:null},optional:function(){return this.contextParams.optional},atomClasses:function(){var t=this.atomClassesAll;if(!t)return[];var e=[];for(var n in this.optional&&e.push({title:null,module:null,atomClassName:null}),t)for(var a in t[n])e.push({title:t[n][a].titleLocale,module:n,atomClassName:a});return e}},methods:{onItemClick:function(t){var e=t.module?{module:t.module,atomClassName:t.atomClassName,title:t.title}:null;this.contextCallback(200,e),this.$f7router.back()}}},r=n(0),l=Object(r.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Select Atom Class"),"eb-back-link":"Back"}}),t._v(" "),n("f7-list",t._l(t.atomClasses,(function(e,a){return n("f7-list-item",{key:a,attrs:{radio:"",checked:t.module===e.module&&t.atomClassName===e.atomClassName,title:e.title},on:{click:function(n){return t.onItemClick(e)}}})})),1)],1)}),[],!1,null,null,null);e.default=l.exports},function(t,e,n){"use strict";n.r(e);var a={meta:{size:"medium"},components:{item:n(6).a},data:function(){return{query:this.$f7route.query}}},o=n(0),i=Object(o.a)(a,(function(){var t=this.$createElement;return(this._self._c||t)("item",{attrs:{query:this.query,mode:"view"}})}),[],!1,null,"38e01b06",null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);n(1);var a={data:function(){return{atomId:parseInt(this.$f7route.query.atomId),actions:null,items:[]}},computed:{user:function(){return this.$store.state.auth.user.op}},created:function(){this.fetchActions()},methods:{onRefresh:function(t){t(),this.reload()},onInfinite:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e=this,n={where:{mode:2,attachment:1},orders:[["createdAt","asc"]],page:{index:t.index}};return this.$api.post("/a/file/file/list",{key:{atomId:this.atomId},options:n}).then((function(t){return e.items=e.items.concat(t.list),t}))},reload:function(){this.$refs.loadMore.reload()},fetchActions:function(){var t=this;this.$api.post("atom/actions",{key:{atomId:this.atomId}}).then((function(e){t.actions=e}))},findAction:function(t){return this.actions?this.actions.find((function(e){return e.name===t})):null},onPerformAdd:function(){var t=this;return new Promise((function(e,n){t.$view.navigate("/a/file/file/upload",{context:{params:{mode:2,atomId:t.atomId,attachment:1},callback:function(a,o){200===a&&(t.$meta.eventHub.$emit("attachment:action",{action:"create",atomId:t.atomId}),t.reload(),e()),!1===a&&n()}}})}))},onPerformDelete:function(t,e){var n=this;return this.$view.dialog.confirm().then((function(){return n.$api.post("/a/file/file/delete",{key:{atomId:n.atomId},data:{fileId:e.id}}).then((function(){n.$meta.util.swipeoutClose(t.target),n.$meta.eventHub.$emit("attachment:action",{action:"delete",atomId:n.atomId,fileId:e.id}),n.deleteItem(e.id)}))}))},deleteItem:function(t){var e=this.items.findIndex((function(e){return e.id===t}));-1!==e&&this.items.splice(e,1)},onItemClick:function(t,e){window.open(e.downloadUrl)},getItemMedia:function(t){var e=t.avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,32)}}},o=n(0),i=Object(o.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Attachment List"),"eb-back-link":"Back"}},[n("f7-nav-right",[t.findAction("write")?n("eb-link",{attrs:{iconMaterial:"add",onPerform:t.onPerformAdd}}):t._e()],1)],1),t._v(" "),n("f7-list",t._l(t.items,(function(e){return n("eb-list-item",{key:e.id,staticClass:"item",attrs:{title:e.realName,link:"#",context:e,onPerform:t.onItemClick,swipeout:e.userId===t.user.id}},[n("div",{attrs:{slot:"media"},slot:"media"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMedia(e)}})]),t._v(" "),n("div",{staticClass:"header",attrs:{slot:"root-start"},slot:"root-start"},[n("div",{staticClass:"userName"},[n("span",[t._v(t._s(e.userName))])]),t._v(" "),n("div",{staticClass:"date"},[t._v(t._s(t.$meta.util.formatDateTimeRelative(e.createdAt)))])]),t._v(" "),e.userId===t.user.id?n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"orange",context:e,onPerform:t.onPerformDelete}},[t._v(t._s(t.$text("Delete")))])])]):t._e()],1)})),1),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!0}})],1)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var a={components:{},data:function(){var t=JSON.parse(this.$f7route.query.data);return{data:t}},computed:{pageTitle:function(){return this.$store.state.auth.instance.title}},methods:{}},o=n(0),i=Object(o.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.pageTitle,"eb-back-link":"Back"}}),t._v(" "),n("f7-card",[n("f7-card-header",[t._v(t._s(t.data.title||t.$text("Friendly Tips")))]),t._v(" "),n("f7-card-content",[t._v("\n      "+t._s(t.data.message)+"\n    ")]),t._v(" "),t.data.link?n("f7-card-footer",[n("div"),t._v(" "),n("eb-link",{attrs:{"eb-href":t.data.link}},[t._v(t._s(t.data.linkText||t.$text("Link")))])],1):t._e()],1)],1)}),[],!1,null,"44172a93",null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var a={mixins:[n(4).a],data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName,a=e&&n?{module:e,atomClassName:n}:null,o=t&&t.where?JSON.parse(t.where):null;if("mine"===(t&&t.scene)){o||(o={});var i=this.$store.state.auth.user.op;o["h.userId"]=i.id}return{atomClass:a,where:o,order:"desc",items:[],moduleStyle:null,rightDeleteComment:!1}},computed:{user:function(){return this.$store.state.auth.user.op}},created:function(){var t=this;this.$api.post("function/check",{functions:[{module:"a-base",name:"deleteComment"}]}).then((function(e){t.rightDeleteComment=e[0].passed,t.$meta.module.use(t.$meta.config.markdown.style.module,(function(e){t.moduleStyle=e}))}))},mounted:function(){this.$meta.eventHub.$on("comment:action",this.onCommentChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("comment:action",this.onCommentChanged)},methods:{onRefresh:function(t){t(),this.reload()},onInfinite:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e=this,n=t.index,a={orders:[["h_updatedAt",this.order]],page:{index:n}};return this.where&&(a.where=this.where),this.$api.post("comment/all",{atomClass:this.atomClass,options:a}).then((function(t){return e.items=e.items.concat(t.list),t}))},reload:function(){this.$refs.loadMore.reload()},onPerformDelete:function(t,e){var n=this;return this.$view.dialog.confirm().then((function(){return n.$api.post("comment/delete",{key:{atomId:e.atomId},data:{commentId:e.h_id}}).then((function(t){return n.$meta.eventHub.$emit("comment:action",t),!0}))}))},onPerformHeart:function(t,e){var n=this;if(!this.user.anonymous)return this.$api.post("comment/heart",{key:{atomId:e.atomId},data:{commentId:e.h_id,heart:e.h_heart?0:1}}).then((function(t){n.$meta.eventHub.$emit("comment:action",t)}));this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){n.$meta.vueLayout.openLogin()}))},onCommentChanged:function(t){var e=this,n=t.action,a=t.atomId,o=t.commentId;if("create"!==n){var i=this.items.findIndex((function(t){return t.h_id===o}));"delete"!==n?-1!==i&&this.$api.post("comment/item",{key:{atomId:a},data:{commentId:o}}).then((function(t){for(var n=e.items[i],a=0,o=Object.keys(t);a<o.length;a++){var s=o[a];n["h_".concat(s)]=t[s]}})):-1!==i&&this.items.splice(i,1)}else this.reload()},onPerformSort:function(){this.order="desc"===this.order?"asc":"desc",this.reload()},onPerformViewAtom:function(t,e){var n=this.getAction({module:e.module,atomClassName:e.atomClassName,name:"read"});if(n)return this.$meta.util.performAction({ctx:this,action:n,item:e})},getItemMedia:function(t){var e=t.h_avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,32)}}},o=n(0),i=Object(o.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Comment List"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"desc"===t.order?"arrow_downward":"arrow_upward",onPerform:t.onPerformSort}})],1)],1),t._v(" "),t.moduleStyle?t._l(t.items,(function(e){return n("f7-card",{key:e.h_id,staticClass:"comment"},[n("f7-card-header",[n("div",{staticClass:"header-container"},[n("div",{staticClass:"header-atom"},[n("eb-link",{attrs:{context:e,onPerform:t.onPerformViewAtom}},[t._v(t._s(e.atomName))])],1),t._v(" "),n("div",{staticClass:"header-comment"},[n("div",{staticClass:"title"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMedia(e)}}),t._v(" "),n("div",{staticClass:"name"},[t._v(t._s(e.h_userName))]),t._v(" "),n("div",{staticClass:"date"},[t._v("#"+t._s(e.h_sorting)+" Â· "+t._s(t.$meta.util.formatDateTimeRelative(e.h_createdAt)))])]),t._v(" "),n("div",{staticClass:"actions"},[e.h_userId===t.user.id?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"edit","eb-href":"comment/item?atomId="+e.atomId+"&commentId="+e.h_id+"&replyId=0"}}):t._e(),t._v(" "),e.h_userId===t.user.id||t.rightDeleteComment?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"delete_forever",context:e,onPerform:t.onPerformDelete}}):t._e(),t._v(" "),n("eb-link",{staticClass:"action",attrs:{iconMaterial:e.h_heart?"favorite":"favorite_border",context:e,onPerform:t.onPerformHeart}},[t._v(t._s(e.h_heartCount))]),t._v(" "),t.user.anonymous?t._e():n("eb-link",{staticClass:"action",attrs:{iconMaterial:"reply","eb-href":"comment/item?atomId="+e.atomId+"&commentId=0&replyId="+e.h_id}})],1)])])]),t._v(" "),n("f7-card-content",{staticClass:"markdown-body",attrs:{padding:""},domProps:{innerHTML:t._s(e.h_html)}})],1)})):t._e(),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!0}})],2)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var a={data:function(){return{atomId:this.$f7route.query.atomId,commentId:this.$f7route.query.commentId}},created:function(){var t=this;this.$api.post("/a/base/comment/heart",{key:{atomId:this.atomId},atom:{star:1},data:{commentId:this.commentId,heart:1}}).then((function(){t.$view.dialog.alert(t.$text("Hearted")).then((function(){t.openAtom()}))}))},methods:{openAtom:function(){location.assign(this.$f7route.query.returnTo)}}},o=n(0),i=Object(o.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("eb-page",[e("eb-navbar",{attrs:{large:"",largeTransparent:"",title:this.$text("Heart2"),"eb-back-link":"Back"}}),this._v(" "),e("f7-block")],1)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var a={meta:{size:"medium"},data:function(){return{atomId:parseInt(this.$f7route.query.atomId),commentId:parseInt(this.$f7route.query.commentId||0),replyId:parseInt(this.$f7route.query.replyId||0),module:null,comment:null,reply:null,content:""}},computed:{ready:function(){return this.module&&(0===this.commentId||this.comment)&&(0===this.replyId||this.reply)},readOnly:function(){return!1},editable:function(){return!this.readOnly},language:function(){return"zh-cn"===(this.$meta.util.cookies.get("locale")||"en-us")?"zh-CN":"en"},subfield:function(){return this.editable&&"small"!==this.$view.size},defaultOpen:function(){return this.editable?"":"preview"},toolbarsFlag:function(){return this.editable},navigation:function(){return!this.editable},toolbars:function(){return{bold:!0,italic:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,undo:!0,redo:!0,trash:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0}}},created:function(){var t=this;this.$meta.module.use("a-mavoneditor",(function(e){t.module=e})),this.loadComment(this.commentId),this.loadReply(this.replyId)},methods:{loadComment:function(t){var e=this;t&&this.$api.post("comment/item",{key:{atomId:this.atomId},data:{commentId:t}}).then((function(t){e.comment=t,e.content=e.comment.content}))},loadReply:function(t){var e=this;t&&this.$api.post("comment/item",{key:{atomId:this.atomId},data:{commentId:t}}).then((function(t){e.reply=t}))},onChange:function(t){this.content=t},onSave:function(){this.onPerformSave()},onPerformSave:function(){var t=this;if(this.content)return this.$api.post("/a/base/comment/save",{key:{atomId:this.atomId},data:{commentId:this.commentId,replyId:this.replyId,content:this.content}}).then((function(e){t.$meta.eventHub.$emit("comment:action",e);var n=t.$f7route.query.returnTo;n?location.assign(n):t.$f7router.back()}))},onImageUpload:function(){var t=this;return new Promise((function(e,n){t.$view.navigate("/a/file/file/upload",{context:{params:{mode:1,atomId:t.atomId,flag:"comment"},callback:function(t,a){200===t&&e({text:a.realName,addr:a.downloadUrl}),!1===t&&n()}}})}))},onPreRender:function(t){if(this.comment)return this.fullContent({content:t,replyContent:this.comment.replyContent,replyUserName:this.comment.replyUserName});if(this.reply){var e=this.fullContent({content:this.reply.content,replyContent:this.reply.replyContent,replyUserName:this.reply.replyUserName});return this.fullContent({content:t,replyContent:e,replyUserName:this.reply.userName})}return t},fullContent:function(t){var e=t.content,n=t.replyContent,a=t.replyUserName;return n?"".concat(e,"\n\n> `").concat(a,"`:\n\n::: comment-quot\n").concat(n,"\n:::\n\n"):e}}},o=n(0),i=Object(o.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{title:t.$text("Comment"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"save",onPerform:t.onPerformSave}})],1)],1),t._v(" "),t.ready?[n("eb-box",[n("mavon-editor",{ref:"editor",attrs:{value:t.content,onPreRender:t.onPreRender,onImageUpload:t.onImageUpload,language:t.language,subfield:t.subfield,editable:t.editable,defaultOpen:t.defaultOpen,toolbarsFlag:t.toolbarsFlag,navigation:t.navigation,toolbars:t.toolbars},on:{change:t.onChange,save:t.onSave}})],1)]:t._e()],2)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),i={data:function(){return{atomId:parseInt(this.$f7route.query.atomId),order:"desc",items:[],moduleStyle:null}},computed:{user:function(){return this.$store.state.auth.user.op}},created:function(){var t=this;this.$meta.module.use(this.$meta.config.markdown.style.module,(function(e){t.moduleStyle=e}))},mounted:function(){this.$meta.eventHub.$on("comment:action",this.onCommentChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("comment:action",this.onCommentChanged)},methods:{onRefresh:function(t){t(),this.reload()},onInfinite:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e=this,n=t.index,a={orders:[["updatedAt",this.order]],page:{index:n}};return this.$api.post("comment/list",{key:{atomId:this.atomId},options:a}).then((function(t){return e.items=e.items.concat(t.list),t}))},reload:function(){this.$refs.loadMore.reload()},onPerformDelete:function(t,e){var n=this;return this.$view.dialog.confirm().then((function(){return n.$api.post("comment/delete",{key:{atomId:n.atomId},data:{commentId:e.id}}).then((function(t){return n.$meta.eventHub.$emit("comment:action",t),!0}))}))},onPerformHeart:function(t,e){var n=this;if(!this.user.anonymous)return this.$api.post("comment/heart",{key:{atomId:this.atomId},data:{commentId:e.id,heart:e.heart?0:1}}).then((function(t){n.$meta.eventHub.$emit("comment:action",t)}));this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){n.$meta.vueLayout.openLogin()}))},onCommentChanged:function(t){var e=this,n=t.action,a=t.atomId,i=t.commentId;if(a===this.atomId)if("create"!==n){var s=this.items.findIndex((function(t){return t.id===i}));"delete"!==n?-1!==s&&this.$api.post("comment/item",{key:{atomId:this.atomId},data:{commentId:i}}).then((function(t){o.a.set(e.items,s,t)})):-1!==s&&this.items.splice(s,1)}else this.reload()},onPerformSort:function(){this.order="desc"===this.order?"asc":"desc",this.reload()},getItemMedia:function(t){var e=t.avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,32)}}},s=n(0),r=Object(s.a)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Comment List"),"eb-back-link":"Back"}},[n("f7-nav-right",[t.user.anonymous?t._e():n("eb-link",{attrs:{iconMaterial:"add","eb-href":"comment/item?atomId="+t.atomId+"&commentId=0&replyId=0"}}),t._v(" "),n("eb-link",{attrs:{iconMaterial:"desc"===t.order?"arrow_downward":"arrow_upward",onPerform:t.onPerformSort}})],1)],1),t._v(" "),t.moduleStyle?t._l(t.items,(function(e){return n("f7-card",{key:e.id,staticClass:"comment"},[n("f7-card-header",[n("div",{staticClass:"title"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMedia(e)}}),t._v(" "),n("div",{staticClass:"name"},[t._v(t._s(e.userName))]),t._v(" "),n("div",{staticClass:"date"},[t._v("#"+t._s(e.sorting)+" Â· "+t._s(t.$meta.util.formatDateTimeRelative(e.createdAt)))])]),t._v(" "),n("div",{staticClass:"actions"},[e.userId===t.user.id?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"edit","eb-href":"comment/item?atomId="+t.atomId+"&commentId="+e.id+"&replyId=0"}}):t._e(),t._v(" "),e.userId===t.user.id?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"delete_forever",context:e,onPerform:t.onPerformDelete}}):t._e(),t._v(" "),n("eb-link",{staticClass:"action",attrs:{iconMaterial:e.heart?"favorite":"favorite_border",context:e,onPerform:t.onPerformHeart}},[t._v(t._s(e.heartCount))]),t._v(" "),t.user.anonymous?t._e():n("eb-link",{staticClass:"action",attrs:{iconMaterial:"reply","eb-href":"comment/item?atomId="+t.atomId+"&commentId=0&replyId="+e.id}})],1)]),t._v(" "),n("f7-card-content",{staticClass:"markdown-body",attrs:{padding:""},domProps:{innerHTML:t._s(e.html)}})],1)})):t._e(),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!0}})],2)}),[],!1,null,null,null);e.default=r.exports},function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),i={meta:{size:"medium"},components:{menus:n(7).a},data:function(){return{pageTitle:null,tabs:[{id:o.a.prototype.$meta.util.nextId("tab"),mode:"scenes",title:"Scenes"},{id:o.a.prototype.$meta.util.nextId("tab"),mode:"modules",title:"Modules"},{id:o.a.prototype.$meta.util.nextId("tab"),mode:"stars",title:"Stars"}],tabActive:""}},created:function(){this.__initTabActive()},mounted:function(){this.__initPageTitle()},methods:{__initPageTitle:function(){this.$$(this.$el).parents(".eb-layout-view").is(".eb-layout-panel-view")?this.pageTitle=this.$text("Menu"):this.pageTitle=this.$text("Home")},__initTabActive:function(){var t=this;this.$store.dispatch("a/base/getLayoutConfig","a-base").then((function(e){t.tabActive=e.menuTabActive||t.tabs[0].mode}))},onTabShow:function(t){this.tabActive!==t&&(this.tabActive=t,this.$store.commit("a/base/setLayoutConfigKey",{module:"a-base",key:"menuTabActive",value:this.tabActive}))}}},s=n(0),r=Object(s.a)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{"page-content":!1,tabs:"","with-subnavbar":""}},[n("eb-navbar",{attrs:{title:t.pageTitle,"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"search","eb-target":"_self","eb-href":"menu/search"}})],1),t._v(" "),t.tabActive?n("f7-subnavbar",[n("f7-toolbar",{attrs:{top:"",tabbar:""}},t._l(t.tabs,(function(e){return n("f7-link",{key:e.id,attrs:{tabLink:"#"+e.id,tabLinkActive:t.tabActive===e.mode}},[t._v(t._s(t.$text(e.title)))])})),1)],1):t._e()],1),t._v(" "),t.tabActive?n("f7-tabs",t._l(t.tabs,(function(e){return n("eb-tab-page-content",{key:e.id,attrs:{id:e.id,tabActive:t.tabActive===e.mode},on:{"tab:show":function(n){return t.onTabShow(e.mode)}}},[n("menus",{attrs:{slot:"list",mode:e.mode},slot:"list"})],1)})),1):t._e()],1)}),[],!1,null,null,null);e.default=r.exports},function(t,e,n){"use strict";n.r(e);var a={components:{menus:n(7).a},methods:{onSearch:function(t){this.$refs.list.onSearch(t)},onLoadMore:function(){this.$refs.list.loadMore()},onDisable:function(){this.$f7router.back()}}},o=n(0),i=Object(o.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("eb-search-page",{attrs:{title:this.$text("Search Menu")},on:{onSearch:this.onSearch,onLoadMore:this.onLoadMore,onDisable:this.onDisable}},[e("menus",{ref:"list",attrs:{slot:"list",mode:"search"},slot:"list"})],1)}),[],!1,null,null,null);e.default=i.exports},function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a).a.prototype.$meta.module.get("a-components").options.mixins.ebPageContext,i=["Function","Menu","Panel","Widget"],s={mixins:[o],data:function(){return{}},computed:{pageTitle:function(){return this.$text("Select ".concat(i[this.menu]))},module:function(){return this.contextParams.module},name:function(){return this.contextParams.name},menu:function(){return this.contextParams.menu},optional:function(){return this.contextParams.optional},functions:function(){var t=this.$local.state.functions;if(!t)return[];var e=[];for(var n in this.optional&&e.push({title:null,name:null}),t[this.module]){var a=t[this.module][n];a.menu===this.menu&&e.push({title:a.titleLocale,name:n})}return e}},created:function(){this.$local.dispatch("getFunctions")},methods:{onItemClick:function(t){var e=t.name?{module:this.module,name:t.name,title:t.title}:null;this.contextCallback(200,e),this.$f7router.back()}}},r=n(0),l=Object(r.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.pageTitle,"eb-back-link":"Back"}}),t._v(" "),n("f7-list",t._l(t.functions,(function(e,a){return n("f7-list-item",{key:a,attrs:{radio:"",checked:t.name===e.name,title:e.title},on:{click:function(n){return t.onItemClick(e)}}})})),1)],1)}),[],!1,null,null,null);e.default=l.exports},function(t,e,n){"use strict";n.r(e);var a=n(7),o=n(3),i=n(6);function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw i}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var l={meta:{global:!1},methods:{onAction:function(t){var e=t.ctx,n=t.action,a=t.item;if("create"===n.name||"create"===n.action)return this._onActionCreate({ctx:e,action:n,item:a});if("delete"===n.name){var o={atomId:a.atomId,itemId:a.itemId};return e.$view.dialog.confirm().then((function(){return e.$api.post("/a/base/atom/delete",{key:o}).then((function(){return e.$meta.eventHub.$emit("atom:action",{key:o,action:n}),!0}))}))}if("save"===n.name){var i={atomId:a.atomId,itemId:a.itemId};return e.$api.post("/a/base/atom/write",{key:i,item:a}).then((function(){e.$meta.eventHub.$emit("atom:action",{key:i,action:n})}))}if("submit"===n.name){var s={atomId:a.atomId,itemId:a.itemId};return e.$view.dialog.confirm().then((function(){return e.$api.post("/a/base/atom/submit",{key:s,item:a}).then((function(){e.$meta.eventHub.$emit("atom:action",{key:s,action:n})}))}))}var r={atomId:a.atomId,itemId:a.itemId};return e.$view.dialog.confirm().then((function(){return e.$api.post("/a/base/atom/action",{action:n.code,key:r}).then((function(){return e.$meta.eventHub.$emit("atom:action",{key:r,action:n}),!0}))}))},_onActionCreate:function(t){var e=t.ctx,n=t.action,a=t.item;return this._onActionCreateGetRoleIdOwner({ctx:e,action:n,item:a}).then((function(t){if(t)return e.$api.post("/a/base/atom/create",{atomClass:{id:a.atomClassId,module:a.module,atomClassName:a.atomClassName},roleIdOwner:t,item:a}).then((function(t){return e.$meta.eventHub.$emit("atom:action",{key:t,action:n}),1===n.menu||n.actionComponent||n.actionPath?(a=e.$utils.extend({},a,t),e.$store.dispatch("a/base/getActions").then((function(t){var n=t[a.module][a.atomClassName].write;return n=e.$utils.extend({},n),e.$meta.util.performAction({ctx:e,action:n,item:a})}))):t}))}))},_onActionCreateGetAtomClassId:function(t){var e=t.ctx,n=(t.action,t.item);return n.atomClassId?Promise.resolve(n.atomClassId):e.$api.post("/a/base/atomClass/atomClass",{atomClass:{module:n.module,atomClassName:n.atomClassName}}).then((function(t){return t.id}))},_onActionCreateGetRoleIdOwner:function(t){var e=this,n=t.ctx,a=t.action,o=t.item;return this._onActionCreateGetAtomClassId({ctx:n,action:a,item:o}).then((function(t){var o=n.$store.getState("a/base/userAtomClassRolesPreferred");return o[t]?o[t]:n.$api.post("/a/base/atom/preferredRoles",{atomClass:{id:t}}).then((function(o){if(0===o.length)return Promise.reject(new Error("Error"));if(1===o.length){var i=o[0].roleIdWho;return n.$store.commit("a/base/setUserAtomClassRolesPreferred",{atomClassId:t,roleIdOwner:i}),i}return e._onActionCreateSelectPreferredRole({ctx:n,action:a,roles:o}).then((function(e){return e&&n.$store.commit("a/base/setUserAtomClassRolesPreferred",{atomClassId:t,roleIdOwner:e}),e}))}))}))},_onActionCreateSelectPreferredRole:function(t){var e=t.ctx,n=t.action,a=t.roles;return new Promise((function(t){var o=e.$view.getHostEl(),i=n.targetEl,r=[{text:e.$text("AtomClassSelectRoleTip"),label:!0}],l=!1;var c,u=s(a);try{var m=function(){var e=c.value;r.push({text:e.roleNameWho,onClick:function(){var n;n=e.roleIdWho,l=!0,t(n)}})};for(u.s();!(c=u.n()).done;)m()}catch(t){u.e(t)}finally{u.f()}var d=e.$f7.actions.create({hostEl:o,buttons:r,targetEl:i});function f(){d.destroy(),l||(l=!0,t())}d.open().once("actionsClosed",f).once("popoverClosed",f)}))}}};e.default={menus:a.a,item:i.a,action:l,ebAtoms:o.a}},function(t,e,n){"use strict";n.r(e);var a=n(2),o=n(4),i=n(9),s=n(10),r=n(5);e.default={ebAtomClasses:a.a,ebAtomActions:o.a,ebAtomOrders:i.a,ebModules:s.a,ebMenus:r.a,ebFunctions:{computed:{functionsAll:function(){return this.$store.getState("a/base/functions")}},methods:{getFunction:function(t){return this.functionsAll&&t?this.functionsAll[t.module][t.name]:null},getFunctionTitle:function(t){var e=this.getFunction(t);return e?e.titleLocale:null}},created:function(){this.$store.dispatch("a/base/getFunctions")}}}}]);