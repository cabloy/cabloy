/*! For license information please see front.js.LICENSE.txt */
(()=>{var e={229:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Pf});var r={};n.r(r),n.d(r,{components:()=>at,dfs:()=>ut,dijkstra:()=>ft,dijkstraAll:()=>ht,findCycles:()=>gt,floydWarshall:()=>kt,isAcyclic:()=>Tt,postorder:()=>At,preorder:()=>Nt,prim:()=>it,tarjan:()=>pt,topsort:()=>It});var o={};n.r(o),n.d(o,{CircularLayout:()=>Le,ComboCombinedLayout:()=>bf,ComboForceLayout:()=>yf,ConcentricLayout:()=>jl,DagreCompoundLayout:()=>ll,DagreLayout:()=>vr,ERLayout:()=>Lf,Force2Layout:()=>B,ForceAtlas2Layout:()=>_f,ForceLayout:()=>Oe,FruchtermanGPULayout:()=>gf,FruchtermanLayout:()=>Ul,GForceGPULayout:()=>vf,GForceLayout:()=>M,GridLayout:()=>N,Layout:()=>zf,Layouts:()=>Gf,MDSLayout:()=>Fl,RadialLayout:()=>Pl,RandomLayout:()=>D,getLayoutByName:()=>A,registerLayout:()=>I,unRegisterLayout:()=>T});class i{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(e){return this.init(e),this.execute(!0)}init(e){this.nodes=e.nodes||[],this.edges=e.edges||[],this.combos=e.combos||[],this.comboEdges=e.comboEdges||[],this.hiddenNodes=e.hiddenNodes||[],this.hiddenEdges=e.hiddenEdges||[],this.hiddenCombos=e.hiddenCombos||[],this.vedges=e.vedges||[]}execute(e){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(e){e&&Object.assign(this,e)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}const a=e=>"string"==typeof e,s=(Object.create(null),Array.isArray),u=e=>"number"==typeof e,c=e=>Number.isNaN(Number(e)),l=e=>null!==e&&"object"==typeof e,d=e=>{if(null===e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){const t=[];return e.forEach((e=>{t.push(e)})),t.map((e=>d(e)))}if("object"==typeof e&&Object.keys(e).length){const t=Object.assign({},e);return Object.keys(t).forEach((e=>{t[e]=d(t[e])})),t}return e},f=(e,t)=>{const n=e[t];return l(n)?n.cell:n},h=(e,t,n)=>{const r=[];for(let t=0;t<e;t++)r[t]={in:0,out:0,all:0};return n?(n.forEach((e=>{const n=f(e,"source"),o=f(e,"target");n&&r[t[n]]&&(r[t[n]].out+=1,r[t[n]].all+=1),o&&r[t[o]]&&(r[t[o]].in+=1,r[t[o]].all+=1)})),r):r},p=e=>{const t=[],n=e.length;for(let r=0;r<n;r+=1){t[r]=[];for(let o=0;o<n;o+=1)r===o?t[r][o]=0:0!==e[r][o]&&e[r][o]?t[r][o]=e[r][o]:t[r][o]=1/0}for(let e=0;e<n;e+=1)for(let r=0;r<n;r+=1)for(let o=0;o<n;o+=1)t[r][o]>t[r][e]+t[e][o]&&(t[r][o]=t[r][e]+t[e][o]);return t},g=(e,t)=>{const{nodes:n,edges:r}=e,o=[],i={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach(((e,t)=>{i[e.id]=t,o.push([])})),null==r||r.forEach((e=>{const n=f(e,"source"),r=f(e,"target"),a=i[n],s=i[r];void 0!==a&&void 0!==s&&(o[a][s]=1,t||(o[s][a]=1))})),o},m=(e,t)=>{if(e&&e.children)for(let n=e.children.length-1;n>=0;n--)if(!m(e.children[n],t))return;return!!t(e)},v=(e,t)=>{"function"==typeof t&&m(e,t)},y=e=>{const t={x:0,y:0};e.forEach((e=>{t.x+=e.x||0,t.y+=e.y||0}));const n=e.length||1;return{x:t.x/n,y:t.y/n}},b=(e,t,n)=>{var r,o;return"source"===e?(null===(r=null==n?void 0:n.find((e=>e.target===t.id)))||void 0===r?void 0:r.source)||{}:(null===(o=null==n?void 0:n.find((e=>e.source===t.id)))||void 0===o?void 0:o.target)||{}},E=(e,t,n)=>{let r=[];switch(e){case"source":r=null==n?void 0:n.filter((e=>e.source===t.id)).map((e=>e.target));break;case"target":r=null==n?void 0:n.filter((e=>e.target===t.id)).map((e=>e.source));break;case"both":r=null==n?void 0:n.filter((e=>e.source===t.id)).map((e=>e.target)).concat(null==n?void 0:n.filter((e=>e.target===t.id)).map((e=>e.source)))}const o=new Set(r);return Array.from(o)},w=e=>"function"==typeof e,x=(e,t,n)=>{let r;return r=n||(u(e)?()=>e:()=>t),r},_=(e,t,n=!0)=>t||0===t?w(t)?t:u(t)?()=>t:s(t)?()=>{if(n){const n=Math.max(...t);return isNaN(n)?e:n}return t}:l(t)?()=>{if(n){const n=Math.max(t.width,t.height);return isNaN(n)?e:n}return[t.width,t.height]}:()=>e:t=>t.size?s(t.size)?t.size[0]>t.size[1]?t.size[0]:t.size[1]:l(t.size)?t.size.width>t.size.height?t.size.width:t.size.height:t.size:e,S=new Map,I=(e,t)=>{if(S.get(e)&&console.warn(`The layout with the name ${e} exists already, it will be overridden`),l(t)){class n extends i{constructor(e){super();const n=this,r={},o=n.getDefaultCfg();Object.assign(r,o,t,e),Object.keys(r).forEach((e=>{const t=r[e];n[e]=t}))}}S.set(e,n)}else S.set(e,t);return S.get(e)},T=e=>{S.has(e)&&S.delete(e)},A=e=>S.has(e)?S.get(e):null;class N extends i{constructor(e){super(),this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const e=this,{nodes:t,edges:n,begin:r}=e,o=t.length;if(0===o)return e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n};if(1===o)return t[0].x=r[0],t[0].y=r[1],e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n};let{sortBy:i,width:u,height:l}=e;const{condense:d,preventOverlapPadding:f,preventOverlap:p,nodeSpacing:g,nodeSize:m}=e,v=[];t.forEach((e=>{v.push(e)}));const y={};if(v.forEach(((e,t)=>{y[e.id]=t})),("degree"===i||!a(i)||void 0===v[0][i])&&(i="degree",c(t[0].degree))){const e=h(v.length,y,n);v.forEach(((t,n)=>{t.degree=e[n].all}))}v.sort(((e,t)=>t[i]-e[i])),u||"undefined"==typeof window||(u=window.innerWidth),l||"undefined"==typeof window||(l=window.innerHeight);const b=e.rows,E=null!=e.cols?e.cols:e.columns;if(e.cells=o,null!=b&&null!=E?(e.rows=b,e.cols=E):null!=b&&null==E?(e.rows=b,e.cols=Math.ceil(e.cells/e.rows)):null==b&&null!=E?(e.cols=E,e.rows=Math.ceil(e.cells/e.cols)):(e.splits=Math.sqrt(e.cells*e.height/e.width),e.rows=Math.round(e.splits),e.cols=Math.round(e.width/e.height*e.splits)),e.rows=Math.max(e.rows,1),e.cols=Math.max(e.cols,1),e.cols*e.rows>e.cells){const t=e.small(),n=e.large();(t-1)*n>=e.cells?e.small(t-1):(n-1)*t>=e.cells&&e.large(n-1)}else for(;e.cols*e.rows<e.cells;){const t=e.small(),n=e.large();(n+1)*t>=e.cells?e.large(n+1):e.small(t+1)}if(e.cellWidth=u/e.cols,e.cellHeight=l/e.rows,d&&(e.cellWidth=0,e.cellHeight=0),p||g){const t=_(10,g),n=_(30,m,!1);v.forEach((r=>{r.x&&r.y||(r.x=0,r.y=0);const o=n(r)||30;let i,a;s(o)?(i=o[0],a=o[1]):(i=o,a=o);const u=void 0!==t?t(r):f,c=i+u,l=a+u;e.cellWidth=Math.max(e.cellWidth,c),e.cellHeight=Math.max(e.cellHeight,l)}))}e.cellUsed={},e.row=0,e.col=0,e.id2manPos={};for(let t=0;t<v.length;t++){const n=v[t];let r;if(e.position&&(r=e.position(n)),r&&(void 0!==r.row||void 0!==r.col)){const t={row:r.row,col:r.col};if(void 0===t.col)for(t.col=0;e.used(t.row,t.col);)t.col++;else if(void 0===t.row)for(t.row=0;e.used(t.row,t.col);)t.row++;e.id2manPos[n.id]=t,e.use(t.row,t.col)}e.getPos(n)}return e.onLayoutEnd&&e.onLayoutEnd(),{edges:n,nodes:v}}small(e){const t=this;let n;const r=t.rows||5,o=t.cols||5;return null==e?n=Math.min(r,o):Math.min(r,o)===t.rows?t.rows=e:t.cols=e,n}large(e){const t=this;let n;const r=t.rows||5,o=t.cols||5;return null==e?n=Math.max(r,o):Math.max(r,o)===t.rows?t.rows=e:t.cols=e,n}used(e,t){return this.cellUsed[`c-${e}-${t}`]||!1}use(e,t){this.cellUsed[`c-${e}-${t}`]=!0}moveToNextCell(){const e=this,t=e.cols||5;e.col++,e.col>=t&&(e.col=0,e.row++)}getPos(e){const t=this,{begin:n,cellWidth:r,cellHeight:o}=t;let i,a;const s=t.id2manPos[e.id];if(s)i=s.col*r+r/2+n[0],a=s.row*o+o/2+n[1];else{for(;t.used(t.row,t.col);)t.moveToNextCell();i=t.col*r+r/2+n[0],a=t.row*o+o/2+n[1],t.use(t.row,t.col),t.moveToNextCell()}e.x=i,e.y=a}getType(){return"grid"}}class D extends i{constructor(e){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],width:300,height:300}}execute(){const e=this,t=e.nodes,n=e.center;return e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),t&&t.forEach((t=>{t.x=.9*(Math.random()-.5)*e.width+n[0],t.y=.9*(Math.random()-.5)*e.height+n[1]})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:this.edges}}getType(){return"random"}}const k=(e,t)=>{let n;return n=e?u(e)?t=>e:e:e=>t||1,n};class M extends i{constructor(e){super(),this.maxIteration=500,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.preventOverlap=!0,this.collideStrength=1,this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.animate=!0,this.updateCfg(e)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){var e,t;const n=this,r=n.nodes;if(void 0!==n.timeInterval&&"undefined"!=typeof window&&window.clearInterval(n.timeInterval),!r||0===r.length)return void(null===(e=n.onLayoutEnd)||void 0===e||e.call(n));n.width||"undefined"==typeof window||(n.width=window.innerWidth),n.height||"undefined"==typeof window||(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const o=n.center;if(1===r.length)return r[0].x=o[0],r[0].y=o[1],void(null===(t=n.onLayoutEnd)||void 0===t||t.call(n));const i={},a={};r.forEach(((e,t)=>{u(e.x)||(e.x=Math.random()*n.width),u(e.y)||(e.y=Math.random()*n.height),i[e.id]=e,a[e.id]=t})),n.nodeMap=i,n.nodeIdxMap=a,n.linkDistance=k(n.linkDistance,1),n.nodeStrength=k(n.nodeStrength,1),n.edgeStrength=k(n.edgeStrength,1);const c=n.nodeSize;let d;if(n.preventOverlap){const e=n.nodeSpacing;let t;t=u(e)?()=>e:w(e)?e:()=>0,d=c?s(c)?e=>Math.max(c[0],c[1])+t(e):e=>c+t(e):e=>e.size?s(e.size)?Math.max(e.size[0],e.size[1])+t(e):l(e.size)?Math.max(e.size.width,e.size.height)+t(e):e.size+t(e):10+t(e)}n.nodeSize=d;const f=n.edges;n.degrees=h(r.length,n.nodeIdxMap,f),n.getMass||(n.getMass=e=>e.mass||n.degrees[n.nodeIdxMap[e.id]].all||1),n.run()}run(){var e;const t=this,{maxIteration:n,nodes:r,workerEnabled:o,minMovement:i,animate:a}=t;if(r)if(o||!a){for(let e=0;e<n;e++){const n=t.runOneStep(e);if(t.reachMoveThreshold(r,n,i))break}null===(e=t.onLayoutEnd)||void 0===e||e.call(t)}else{if("undefined"==typeof window)return;let e=0;this.timeInterval=window.setInterval((()=>{var o,a;if(!r)return;const s=t.runOneStep(e)||[];t.reachMoveThreshold(r,s,i)&&(null===(o=t.onLayoutEnd)||void 0===o||o.call(t),window.clearInterval(t.timeInterval)),e++,e>=n&&(null===(a=t.onLayoutEnd)||void 0===a||a.call(t),window.clearInterval(t.timeInterval))}),0)}}reachMoveThreshold(e,t,n){let r=0;return e.forEach(((e,n)=>{const o=e.x-t[n].x,i=e.y-t[n].y;r+=Math.sqrt(o*o+i*i)})),r/=e.length,r<n}runOneStep(e){var t;const n=this,{nodes:r,edges:o}=n,i=[],a=[];if(!r)return;r.forEach(((e,t)=>{i[2*t]=0,i[2*t+1]=0,a[2*t]=0,a[2*t+1]=0})),n.calRepulsive(i,r),o&&n.calAttractive(i,o),n.calGravity(i,r);const s=Math.max(.02,n.interval-.002*e);n.updateVelocity(i,a,s,r);const u=[];return r.forEach((e=>{u.push({x:e.x,y:e.y})})),n.updatePosition(a,s,r),null===(t=n.tick)||void 0===t||t.call(n),u}calRepulsive(e,t){const n=this,{getMass:r,factor:o,coulombDisScale:i,preventOverlap:a,collideStrength:s=1}=n,u=n.nodeStrength,c=n.nodeSize;t.forEach(((n,l)=>{const d=r?r(n):1;t.forEach(((t,f)=>{if(l>=f)return;let h=n.x-t.x,p=n.y-t.y;0===h&&0===p&&(h=.01*Math.random(),p=.01*Math.random());const g=h*h+p*p,m=Math.sqrt(g),v=(m+.1)*i,y=h/m,b=p/m,E=.5*(u(n)+u(t))*o/(v*v),w=r?r(t):1;if(e[2*l]+=y*E,e[2*l+1]+=b*E,e[2*f]-=y*E,e[2*f+1]-=b*E,a&&(c(n)+c(t))/2>m){const r=s*(u(n)+u(t))*.5/g;e[2*l]+=y*r/d,e[2*l+1]+=b*r/d,e[2*f]-=y*r/w,e[2*f+1]-=b*r/w}}))}))}calAttractive(e,t){const n=this,{nodeMap:r,nodeIdxMap:o,linkDistance:i,edgeStrength:a}=n,s=n.nodeSize,u=n.getMass;t.forEach(((t,n)=>{const c=f(t,"source"),l=f(t,"target"),d=r[c],h=r[l];let p=h.x-d.x,g=h.y-d.y;0===p&&0===g&&(p=.01*Math.random(),g=.01*Math.random());const m=Math.sqrt(p*p+g*g),v=p/m,y=g/m,b=((i(t,d,h)||1+(s(d)+s(h)||0)/2)-m)*a(t),E=o[c],w=o[l],x=u?u(d):1,_=u?u(h):1;e[2*E]-=v*b/x,e[2*E+1]-=y*b/x,e[2*w]+=v*b/_,e[2*w+1]+=y*b/_}))}calGravity(e,t){const n=this,r=n.center,o=n.gravity,i=n.degrees,a=t.length;for(let s=0;s<a;s++){const a=t[s];let c=a.x-r[0],l=a.y-r[1],d=o;if(n.getCenter){const e=n.getCenter(a,i[s].all);e&&u(e[0])&&u(e[1])&&u(e[2])&&(c=a.x-e[0],l=a.y-e[1],d=e[2])}d&&(e[2*s]-=d*c,e[2*s+1]-=d*l)}}updateVelocity(e,t,n,r){const o=this,i=n*o.damping;r.forEach(((n,r)=>{let a=e[2*r]*i||.01,s=e[2*r+1]*i||.01;const u=Math.sqrt(a*a+s*s);if(u>o.maxSpeed){const e=o.maxSpeed/u;a*=e,s*=e}t[2*r]=a,t[2*r+1]=s}))}updatePosition(e,t,n){n.forEach(((n,r)=>{if(u(n.fx)&&u(n.fy))return n.x=n.fx,void(n.y=n.fy);const o=e[2*r]*t,i=e[2*r+1]*t;n.x+=o,n.y+=i}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"gForce"}}function O(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var o,i,a,s,u,c,l,d,f,h=e._root,p={data:r},g=e._x0,m=e._y0,v=e._x1,y=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((c=t>=(i=(g+v)/2))?g=i:v=i,(l=n>=(a=(m+y)/2))?m=a:y=a,o=h,!(h=h[d=l<<1|c]))return o[d]=p,e;if(s=+e._x.call(null,h.data),u=+e._y.call(null,h.data),t===s&&n===u)return p.next=h,o?o[d]=p:e._root=p,e;do{o=o?o[d]=new Array(4):e._root=new Array(4),(c=t>=(i=(g+v)/2))?g=i:v=i,(l=n>=(a=(m+y)/2))?m=a:y=a}while((d=l<<1|c)==(f=(u>=a)<<1|s>=i));return o[f]=h,o[d]=p,e}function R(e,t,n,r,o){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=o}function C(e){return e[0]}function L(e){return e[1]}function z(e,t,n){var r=new G(null==t?C:t,null==n?L:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function G(e,t,n,r,o,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=o,this._y1=i,this._root=void 0}function P(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var j=z.prototype=G.prototype;j.copy=function(){var e,t,n=new G(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=P(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var o=0;o<4;++o)(t=r.source[o])&&(t.length?e.push({source:t,target:r.target[o]=new Array(4)}):r.target[o]=P(t));return n},j.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return O(this.cover(t,n),t,n,e)},j.addAll=function(e){var t,n,r,o,i=e.length,a=new Array(i),s=new Array(i),u=1/0,c=1/0,l=-1/0,d=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(a[n]=r,s[n]=o,r<u&&(u=r),r>l&&(l=r),o<c&&(c=o),o>d&&(d=o));if(u>l||c>d)return this;for(this.cover(u,c).cover(l,d),n=0;n<i;++n)O(this,a[n],s[n],e[n]);return this},j.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,o=this._x1,i=this._y1;if(isNaN(n))o=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var a,s,u=o-n||1,c=this._root;n>e||e>=o||r>t||t>=i;)switch(s=(t<r)<<1|e<n,(a=new Array(4))[s]=c,c=a,u*=2,s){case 0:o=n+u,i=r+u;break;case 1:n=o-u,i=r+u;break;case 2:o=n+u,r=i-u;break;case 3:n=o-u,r=i-u}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=o,this._y1=i,this},j.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},j.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},j.find=function(e,t,n){var r,o,i,a,s,u,c,l=this._x0,d=this._y0,f=this._x1,h=this._y1,p=[],g=this._root;for(g&&p.push(new R(g,l,d,f,h)),null==n?n=1/0:(l=e-n,d=t-n,f=e+n,h=t+n,n*=n);u=p.pop();)if(!(!(g=u.node)||(o=u.x0)>f||(i=u.y0)>h||(a=u.x1)<l||(s=u.y1)<d))if(g.length){var m=(o+a)/2,v=(i+s)/2;p.push(new R(g[3],m,v,a,s),new R(g[2],o,v,m,s),new R(g[1],m,i,a,v),new R(g[0],o,i,m,v)),(c=(t>=v)<<1|e>=m)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=u)}else{var y=e-+this._x.call(null,g.data),b=t-+this._y.call(null,g.data),E=y*y+b*b;if(E<n){var w=Math.sqrt(n=E);l=e-w,d=t-w,f=e+w,h=t+w,r=g.data}}return r},j.remove=function(e){if(isNaN(i=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,n,r,o,i,a,s,u,c,l,d,f,h=this._root,p=this._x0,g=this._y0,m=this._x1,v=this._y1;if(!h)return this;if(h.length)for(;;){if((c=i>=(s=(p+m)/2))?p=s:m=s,(l=a>=(u=(g+v)/2))?g=u:v=u,t=h,!(h=h[d=l<<1|c]))return this;if(!h.length)break;(t[d+1&3]||t[d+2&3]||t[d+3&3])&&(n=t,f=d)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(o=h.next)&&delete h.next,r?(o?r.next=o:delete r.next,this):t?(o?t[d]=o:delete t[d],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[f]=h:this._root=h),this):(this._root=o,this)},j.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},j.root=function(){return this._root},j.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},j.visit=function(e){var t,n,r,o,i,a,s=[],u=this._root;for(u&&s.push(new R(u,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(u=t.node,r=t.x0,o=t.y0,i=t.x1,a=t.y1)&&u.length){var c=(r+i)/2,l=(o+a)/2;(n=u[3])&&s.push(new R(n,c,l,i,a)),(n=u[2])&&s.push(new R(n,r,l,c,a)),(n=u[1])&&s.push(new R(n,c,o,i,l)),(n=u[0])&&s.push(new R(n,r,o,c,l))}return this},j.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new R(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var o=t.node;if(o.length){var i,a=t.x0,s=t.y0,u=t.x1,c=t.y1,l=(a+u)/2,d=(s+c)/2;(i=o[0])&&n.push(new R(i,a,s,l,d)),(i=o[1])&&n.push(new R(i,l,s,u,d)),(i=o[2])&&n.push(new R(i,a,d,l,c)),(i=o[3])&&n.push(new R(i,l,d,u,c))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},j.x=function(e){return arguments.length?(this._x=e,this):this._x},j.y=function(e){return arguments.length?(this._y=e,this):this._y};function F(e){let t=0,n=0,r=0;if(e.length){for(let o=0;o<4;o++){const i=e[o];i&&i.weight&&(t+=i.weight,n+=i.x*i.weight,r+=i.y*i.weight)}e.x=n/t,e.y=r/t,e.weight=t}else{const t=e;e.x=t.data.x,e.y=t.data.y,e.weight=t.data.weight}}const U=(e,t)=>{let n;return n=e?u(e)?t=>e:e:e=>t||1,n};class B extends i{constructor(e){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=500,this.minMovement=.4,this.interval=.02,this.factor=1,this.linkDistance=200,this.gravity=0,this.clusterNodeStrength=20,this.preventOverlap=!0,this.distanceThresholdMode="mean",this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.judgingDistance=0,this.centripetalOptions={leaf:2,single:2,others:1,center:e=>({x:this.width/2,y:this.height/2})};const{getMass:t}=e;this.propsGetMass=t,this.updateCfg(e)}getCentripetalOptions(){const{leafCluster:e,clustering:t,nodeClusterBy:n,nodes:r,nodeMap:o,clusterNodeStrength:i}=this,a=e=>"function"==typeof i?i(e):i;let s,u={};if(e){s=this.getSameTypeLeafMap()||{};const e=Array.from(new Set(null==r?void 0:r.map((e=>e[n]))))||[];u={single:100,leaf:(t,n,r)=>{const{relativeLeafNodes:o,sameTypeLeafNodes:i}=s[t.id]||{};return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==e?void 0:e.length)?1:a(t)},others:1,center:(e,t,n)=>{var r;const{degree:o}=(null===(r=e.data)||void 0===r?void 0:r.layout)||{};if(!o)return{x:100,y:100};let i;if(1===o){const{sameTypeLeafNodes:t=[]}=s[e.id]||{};1===t.length?i=void 0:t.length>1&&(i=y(t))}else i=void 0;return{x:null==i?void 0:i.x,y:null==i?void 0:i.y}}}}if(t){s||(s=this.getSameTypeLeafMap());const e=Array.from(new Set(r.map(((e,t)=>e[n])))).filter((e=>void 0!==e)),t={};e.forEach((e=>{const i=r.filter((t=>t[n]===e)).map((e=>o[e.id]));t[e]=y(i)})),u={single:e=>a(e),leaf:e=>a(e),others:e=>a(e),center:(e,r,o)=>{const i=t[e[n]];return{x:null==i?void 0:i.x,y:null==i?void 0:i.y}}}}this.centripetalOptions=Object.assign(Object.assign({},this.centripetalOptions),u);const{leaf:c,single:l,others:d}=this.centripetalOptions;c&&"function"!=typeof c&&(this.centripetalOptions.leaf=()=>c),l&&"function"!=typeof l&&(this.centripetalOptions.single=()=>l),d&&"function"!=typeof d&&(this.centripetalOptions.others=()=>d)}updateCfg(e){e&&Object.assign(this,e)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){const e=this;e.stop();const{nodes:t,edges:n,defSpringLen:r}=e;if(e.judgingDistance=0,!t||0===t.length)return void e.onLayoutEnd([]);e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const o=e.center;if(1===t.length)return t[0].x=o[0],t[0].y=o[1],void e.onLayoutEnd([Object.assign({},t[0])]);e.degreesMap=((e,t)=>{const n={};return e.forEach((e=>{n[e.id]={in:0,out:0,all:0}})),t?(t.forEach((e=>{const t=f(e,"source"),r=f(e,"target");t&&(n[t].out+=1,n[t].all+=1),r&&(n[r].in+=1,n[r].all+=1)})),n):n})(t,n),e.propsGetMass?e.getMass=e.propsGetMass:e.getMass=t=>{let n=1;u(t.mass)&&(n=t.mass);const r=e.degreesMap[t.id].all;return!r||r<5?n:5*r*n};const i=e.nodeSize;let a;if(e.preventOverlap){const t=e.nodeSpacing;let n;n=u(t)?()=>t:w(t)?t:()=>0,a=i?s(i)?e=>Math.max(i[0],i[1])+n(e):e=>i+n(e):e=>e.size?s(e.size)?Math.max(e.size[0],e.size[1])+n(e):l(e.size)?Math.max(e.size.width,e.size.height)+n(e):e.size+n(e):10+n(e)}e.nodeSize=a,e.linkDistance=U(e.linkDistance,1),e.nodeStrength=U(e.nodeStrength,1),e.edgeStrength=U(e.edgeStrength,1);const c={},d={};t.forEach(((t,n)=>{u(t.x)||(t.x=Math.random()*e.width),u(t.y)||(t.y=Math.random()*e.height);const r=e.degreesMap[t.id];c[t.id]=Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{size:e.nodeSize(t)||30,layout:{inDegree:r.in,outDegree:r.out,degree:r.all,tDegree:r.in,sDegree:r.out,force:{mass:e.getMass(t),nodeStrength:e.nodeStrength(t)}}})}),d[t.id]=n})),e.nodeMap=c,e.nodeIdxMap=d,e.edgeInfos=[],null==n||n.forEach((t=>{const n=c[t.source],o=c[t.target];n&&o?e.edgeInfos.push({edgeStrength:e.edgeStrength(t),linkDistance:r?r(Object.assign(Object.assign({},t),{source:n,target:o}),n,o):e.linkDistance(t,n,o)||1+(i(n)+i(n)||0)/2}):elf.edgeInfos.push({})})),this.getCentripetalOptions(),e.onLayoutEnd=e.onLayoutEnd||(()=>{}),e.run()}run(){const e=this,{maxIteration:t,nodes:n,workerEnabled:r,minMovement:o,animate:i,nodeMap:a}=e;if(!n)return;const s=[];n.forEach(((e,t)=>{s[2*t]=0,s[2*t+1]=0}));const u=t;if(r||!i){let t=0;for(let n=0;(e.judgingDistance>o||n<1)&&n<u;n++)t=n,e.runOneStep(n,s);e.onLayoutEnd(Object.values(a))}else{if("undefined"==typeof window)return;let t=0;this.timeInterval=window.setInterval((()=>{n&&(e.runOneStep(t,s),t++,(t>=u||e.judgingDistance<o)&&(e.onLayoutEnd(Object.values(a)),window.clearInterval(e.timeInterval)))}),0)}}runOneStep(e,t){var n;const r=this,{nodes:o,edges:i,nodeMap:a,monitor:s}=r,u=[];if(!(null==o?void 0:o.length))return;r.calRepulsive(u),i&&r.calAttractive(u),r.calGravity(u);const c=r.interval;r.updateVelocity(u,t,c),r.updatePosition(t,c),null===(n=r.tick)||void 0===n||n.call(r),s&&s({energy:this.calTotalEnergy(u),nodes:o,edges:i,iterations:e})}calTotalEnergy(e){const{nodes:t,nodeMap:n}=this;if(!(null==t?void 0:t.length))return 0;let r=0;return t.forEach(((t,o)=>{const i=e[2*o],a=e[2*o+1],s=i*i+a*a,{mass:u=1}=n[t.id].data.layout.force;r+=u*s*.5})),r}calRepulsive(e){const{nodes:t,nodeMap:n,factor:r,coulombDisScale:o}=this;this.nodeSize,function(e,t,n,r,o){const i=n/r,a=e.map(((e,n)=>{const r=t[e.id],{data:o,x:a,y:s,size:u}=r,{nodeStrength:c}=o.layout.force;return{x:a,y:s,size:u,index:n,vx:0,vy:0,weight:i*c}})),s=z(a,(e=>e.x),(e=>e.y)).visitAfter(F);a.forEach((e=>{!function(e,t){t.visit(((t,n,r,o,i)=>((e,t,n,r,o,i)=>{const a=i.x-e.x||.1,s=i.y-e.y||.1,u=r-t,c=a*a+s*s,l=Math.sqrt(c)*c;if(u*u*.81<c){const t=e.weight/l;return i.vx+=a*t,i.vy+=s*t,!0}if(e.length)return!1;if(e.data!==i){const t=e.data.weight/l;i.vx+=a*t,i.vy+=s*t}})(t,n,0,o,0,e)))}(e,s)})),a.map(((n,r)=>{const i=t[e[r].id],{mass:a=1}=i.data.layout.force;o[2*r]=n.vx/a,o[2*r+1]=n.vy/a}))}(t,n,r,o*o,e)}calAttractive(e){const{edges:t,nodeMap:n,nodeIdxMap:r,edgeInfos:o}=this;this.nodeSize,t.forEach(((t,i)=>{const a=f(t,"source"),s=f(t,"target"),u=n[a],c=n[s];if(!u||!c)return;let l=c.x-u.x,d=c.y-u.y;l||d||(l=.01*Math.random(),d=.01*Math.random());const h=Math.sqrt(l*l+d*d),p=l/h,g=d/h,{linkDistance:m=200,edgeStrength:v=200}=o[i]||{},y=(m-h)*v,b=1/(u.data.layout.force.mass||1),E=1/(c.data.layout.force.mass||1),w=p*y,x=g*y,_=2*r[a],S=2*r[s];e[_]-=w*b,e[_+1]-=x*b,e[S]+=w*E,e[S+1]+=x*E}))}calGravity(e){var t;const n=this,{nodes:r,edges:o=[],nodeMap:i,width:a,height:s,center:c,gravity:l,degreesMap:d,centripetalOptions:f}=n;if(!r)return;const h=r.length;for(let p=0;p<h;p++){const h=2*p,g=i[r[p].id],{mass:m=1}=g.data.layout.force;let v=0,y=0,b=l;const{in:E,out:w,all:x}=d[g.id],_=null===(t=n.getCenter)||void 0===t?void 0:t.call(n,g,x);if(_){const[e,t,n]=_;v=g.x-e,y=g.y-t,b=n}else v=g.x-c[0],y=g.y-c[1];if(b&&(e[h]-=b*v/m,e[h+1]-=b*y/m),f){const{leaf:t,single:n,others:i,center:c}=f,{x:l,y:d,centerStrength:p}=(null==c?void 0:c(g,r,o,a,s))||{x:0,y:0,centerStrength:0};if(!u(l)||!u(d))continue;const v=(g.x-l)/m,y=(g.y-d)/m;if(p&&(e[h]-=p*v,e[h+1]-=p*y),0===x){const t=n(g);if(!t)continue;e[h]-=t*v,e[h+1]-=t*y;continue}if(0===E||0===w){const n=t(g,r,o);if(!n)continue;e[h]-=n*v,e[h+1]-=n*y;continue}const b=i(g);if(!b)continue;e[h]-=b*v,e[h+1]-=b*y}}}updateVelocity(e,t,n){const{nodes:r,damping:o,maxSpeed:i}=this;(null==r?void 0:r.length)&&r.forEach(((r,a)=>{let s=(t[2*a]+e[2*a]*n)*o||.01,u=(t[2*a+1]+e[2*a+1]*n)*o||.01;const c=Math.sqrt(s*s+u*u);if(c>i){const e=i/c;s*=e,u*=e}t[2*a]=s,t[2*a+1]=u}))}updatePosition(e,t){const n=this,{nodes:r,distanceThresholdMode:o,nodeMap:i}=n;if(!(null==r?void 0:r.length))return void(this.judgingDistance=0);let a=0;"max"===o?n.judgingDistance=-1/0:"min"===o&&(n.judgingDistance=1/0),r.forEach(((r,s)=>{const c=i[r.id];if(u(r.fx)&&u(r.fy))return r.x=r.fx,r.y=r.fy,c.x=r.x,void(c.y=r.y);const l=e[2*s]*t,d=e[2*s+1]*t;r.x+=l,r.y+=d,c.x=r.x,c.y=r.y;const f=Math.sqrt(l*l+d*d);switch(o){case"max":n.judgingDistance<f&&(n.judgingDistance=f);break;case"min":n.judgingDistance>f&&(n.judgingDistance=f);break;default:a+=f}})),o&&"mean"!==o||(n.judgingDistance=a/r.length)}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"force2"}getSameTypeLeafMap(){const{nodeClusterBy:e,nodes:t,edges:n,nodeMap:r,degreesMap:o}=this;if(!(null==t?void 0:t.length))return;const i={};return t.forEach(((t,a)=>{1===o[t.id].all&&(i[t.id]=((e,t,n,r,o,i)=>{const{in:a,out:s}=o[t.id];let u=t,c=[];0===a?(u=b("source",t,n),c=E("both",u,n).map((e=>i[e]))):0===s&&(u=b("target",t,n),c=E("both",u,n).map((e=>i[e]))),c=c.filter((e=>o[e.id]&&(0===o[e.id].in||0===o[e.id].out)));const l=((e,t,n,r,o)=>{const i=n[t]||"";let a=(null==r?void 0:r.filter((e=>e[t]===i)))||[];return a=a.filter((e=>{var t,n;return 0===(null===(t=o[e.id])||void 0===t?void 0:t.in)||0===(null===(n=o[e.id])||void 0===n?void 0:n.out)})),a})(0,r,t,c,o);return{coreNode:u,relativeLeafNodes:c,sameTypeLeafNodes:l}})(0,t,n,e,o,r))})),i}}function V(e){return function(){return e}}function W(e){return 1e-6*(e()-.5)}var X={value:()=>{}};function H(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new q(r)}function q(e){this._=e}function Y(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function Z(e,t){for(var n,r=0,o=e.length;r<o;++r)if((n=e[r]).name===t)return n.value}function $(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=X,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}q.prototype=H.prototype={constructor:q,on:function(e,t){var n,r=this._,o=Y(e+"",r),i=-1,a=o.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++i<a;)if(n=(e=o[i]).type)r[n]=$(r[n],e.name,t);else if(null==t)for(n in r)r[n]=$(r[n],e.name,null);return this}for(;++i<a;)if((n=(e=o[i]).type)&&(n=Z(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new q(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};const K=H;var Q,J,ee=0,te=0,ne=0,re=0,oe=0,ie=0,ae="object"==typeof performance&&performance.now?performance:Date,se="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ue(){return oe||(se(ce),oe=ae.now()+ie)}function ce(){oe=0}function le(){this._call=this._time=this._next=null}function de(e,t,n){var r=new le;return r.restart(e,t,n),r}function fe(){oe=(re=ae.now())+ie,ee=te=0;try{!function(){ue(),++ee;for(var e,t=Q;t;)(e=oe-t._time)>=0&&t._call.call(null,e),t=t._next;--ee}()}finally{ee=0,function(){for(var e,t,n=Q,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Q=t);J=e,pe(r)}(),oe=0}}function he(){var e=ae.now(),t=e-re;t>1e3&&(ie-=t,re=e)}function pe(e){ee||(te&&(te=clearTimeout(te)),e-oe>24?(e<1/0&&(te=setTimeout(fe,e-ae.now()-ie)),ne&&(ne=clearInterval(ne))):(ne||(re=ae.now(),ne=setInterval(he,1e3)),ee=1,se(fe)))}le.prototype=de.prototype={constructor:le,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?ue():+n)+(null==t?0:+t),this._next||J===this||(J?J._next=this:Q=this,J=this),this._call=e,this._time=n,pe()},stop:function(){this._call&&(this._call=null,this._time=1/0,pe())}};const ge=4294967296;function me(e){return e.x}function ve(e){return e.y}var ye=Math.PI*(3-Math.sqrt(5));function be(e){var t,n=1,r=.001,o=1-Math.pow(r,1/300),i=0,a=.6,s=new Map,u=de(d),c=K("tick","end"),l=function(){let e=1;return()=>(e=(1664525*e+1013904223)%ge)/ge}();function d(){f(),c.call("tick",t),n<r&&(u.stop(),c.call("end",t))}function f(r){var u,c,l=e.length;void 0===r&&(r=1);for(var d=0;d<r;++d)for(n+=(i-n)*o,s.forEach((function(e){e(n)})),u=0;u<l;++u)null==(c=e[u]).fx?c.x+=c.vx*=a:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=a:(c.y=c.fy,c.vy=0);return t}function h(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var o=10*Math.sqrt(.5+n),i=n*ye;t.x=o*Math.cos(i),t.y=o*Math.sin(i)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,l),t}return null==e&&(e=[]),h(),t={tick:f,restart:function(){return u.restart(d),t},stop:function(){return u.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),s.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(o=+e,t):+o},alphaTarget:function(e){return arguments.length?(i=+e,t):i},velocityDecay:function(e){return arguments.length?(a=1-e,t):1-a},randomSource:function(e){return arguments.length?(l=e,s.forEach(p),t):l},force:function(e,n){return arguments.length>1?(null==n?s.delete(e):s.set(e,p(n)),t):s.get(e)},find:function(t,n,r){var o,i,a,s,u,c=0,l=e.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(a=(o=t-(s=e[c]).x)*o+(i=n-s.y)*i)<r&&(u=s,r=a);return u},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}}function Ee(){var e,t,n,r,o,i=V(-30),a=1,s=1/0,u=.81;function c(n){var o,i=e.length,a=z(e,me,ve).visitAfter(d);for(r=n,o=0;o<i;++o)t=e[o],a.visit(f)}function l(){if(e){var t,n,r=e.length;for(o=new Array(r),t=0;t<r;++t)n=e[t],o[n.index]=+i(n,t,e)}}function d(e){var t,n,r,i,a,s=0,u=0;if(e.length){for(r=i=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(s+=t.value,u+=n,r+=n*t.x,i+=n*t.y);e.x=r/u,e.y=i/u}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=o[t.data.index]}while(t=t.next)}e.value=s}function f(e,i,c,l){if(!e.value)return!0;var d=e.x-t.x,f=e.y-t.y,h=l-i,p=d*d+f*f;if(h*h/u<p)return p<s&&(0===d&&(p+=(d=W(n))*d),0===f&&(p+=(f=W(n))*f),p<a&&(p=Math.sqrt(a*p)),t.vx+=d*e.value*r/p,t.vy+=f*e.value*r/p),!0;if(!(e.length||p>=s)){(e.data!==t||e.next)&&(0===d&&(p+=(d=W(n))*d),0===f&&(p+=(f=W(n))*f),p<a&&(p=Math.sqrt(a*p)));do{e.data!==t&&(h=o[e.data.index]*r/p,t.vx+=d*h,t.vy+=f*h)}while(e=e.next)}}return c.initialize=function(t,r){e=t,n=r,l()},c.strength=function(e){return arguments.length?(i="function"==typeof e?e:V(+e),l(),c):i},c.distanceMin=function(e){return arguments.length?(a=e*e,c):Math.sqrt(a)},c.distanceMax=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c.theta=function(e){return arguments.length?(u=e*e,c):Math.sqrt(u)},c}function we(e,t){var n,r=1;function o(){var o,i,a=n.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=n[o]).x,u+=i.y;for(s=(s/a-e)*r,u=(u/a-t)*r,o=0;o<a;++o)(i=n[o]).x-=s,i.y-=u}return null==e&&(e=0),null==t&&(t=0),o.initialize=function(e){n=e},o.x=function(t){return arguments.length?(e=+t,o):e},o.y=function(e){return arguments.length?(t=+e,o):t},o.strength=function(e){return arguments.length?(r=+e,o):r},o}function xe(e){return e.index}function _e(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Se(e){var t,n,r,o,i,a,s=xe,u=function(e){return 1/Math.min(o[e.source.index],o[e.target.index])},c=V(30),l=1;function d(r){for(var o=0,s=e.length;o<l;++o)for(var u,c,d,f,h,p,g,m=0;m<s;++m)c=(u=e[m]).source,f=(d=u.target).x+d.vx-c.x-c.vx||W(a),h=d.y+d.vy-c.y-c.vy||W(a),f*=p=((p=Math.sqrt(f*f+h*h))-n[m])/p*r*t[m],h*=p,d.vx-=f*(g=i[m]),d.vy-=h*g,c.vx+=f*(g=1-g),c.vy+=h*g}function f(){if(r){var a,u,c=r.length,l=e.length,d=new Map(r.map(((e,t)=>[s(e,t,r),e])));for(a=0,o=new Array(c);a<l;++a)(u=e[a]).index=a,"object"!=typeof u.source&&(u.source=_e(d,u.source)),"object"!=typeof u.target&&(u.target=_e(d,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(l);a<l;++a)u=e[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);t=new Array(l),h(),n=new Array(l),p()}}function h(){if(r)for(var n=0,o=e.length;n<o;++n)t[n]=+u(e[n],n,e)}function p(){if(r)for(var t=0,o=e.length;t<o;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),d.initialize=function(e,t){r=e,a=t,f()},d.links=function(t){return arguments.length?(e=t,f(),d):e},d.id=function(e){return arguments.length?(s=e,d):s},d.iterations=function(e){return arguments.length?(l=+e,d):l},d.strength=function(e){return arguments.length?(u="function"==typeof e?e:V(+e),h(),d):u},d.distance=function(e){return arguments.length?(c="function"==typeof e?e:V(+e),p(),d):c},d}function Ie(e){return e.x+e.vx}function Te(e){return e.y+e.vy}function Ae(e){var t,n,r,o=1,i=1;function a(){for(var e,a,u,c,l,d,f,h=t.length,p=0;p<i;++p)for(a=z(t,Ie,Te).visitAfter(s),e=0;e<h;++e)u=t[e],d=n[u.index],f=d*d,c=u.x+u.vx,l=u.y+u.vy,a.visit(g);function g(e,t,n,i,a){var s=e.data,h=e.r,p=d+h;if(!s)return t>c+p||i<c-p||n>l+p||a<l-p;if(s.index>u.index){var g=c-s.x-s.vx,m=l-s.y-s.vy,v=g*g+m*m;v<p*p&&(0===g&&(v+=(g=W(r))*g),0===m&&(v+=(m=W(r))*m),v=(p-(v=Math.sqrt(v)))/v*o,u.vx+=(g*=v)*(p=(h*=h)/(f+h)),u.vy+=(m*=v)*p,s.vx-=g*(p=1-p),s.vy-=m*p)}}}function s(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function u(){if(t){var r,o,i=t.length;for(n=new Array(i),r=0;r<i;++r)o=t[r],n[o.index]=+e(o,r,t)}}return"function"!=typeof e&&(e=V(null==e?1:+e)),a.initialize=function(e,n){t=e,r=n,u()},a.iterations=function(e){return arguments.length?(i=+e,a):i},a.strength=function(e){return arguments.length?(o=+e,a):o},a.radius=function(t){return arguments.length?(e="function"==typeof t?t:V(+t),u(),a):e},a}function Ne(e){var t,n,r,o=V(.1);function i(e){for(var o,i=0,a=t.length;i<a;++i)(o=t[i]).vx+=(r[i]-o.x)*n[i]*e}function a(){if(t){var i,a=t.length;for(n=new Array(a),r=new Array(a),i=0;i<a;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+o(t[i],i,t)}}return"function"!=typeof e&&(e=V(null==e?0:+e)),i.initialize=function(e){t=e,a()},i.strength=function(e){return arguments.length?(o="function"==typeof e?e:V(+e),a(),i):o},i.x=function(t){return arguments.length?(e="function"==typeof t?t:V(+t),a(),i):e},i}function De(e){var t,n,r,o=V(.1);function i(e){for(var o,i=0,a=t.length;i<a;++i)(o=t[i]).vy+=(r[i]-o.y)*n[i]*e}function a(){if(t){var i,a=t.length;for(n=new Array(a),r=new Array(a),i=0;i<a;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+o(t[i],i,t)}}return"function"!=typeof e&&(e=V(null==e?0:+e)),i.initialize=function(e){t=e,a()},i.strength=function(e){return arguments.length?(o="function"==typeof e?e:V(+e),a(),i):o},i.y=function(t){return arguments.length?(e="function"==typeof t?t:V(+t),a(),i):e},i}const ke="GPU_LAYOUT_END",Me={gForce:!0,force2:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0};class Oe extends i{constructor(e){super(),this.center=[0,0],this.nodeStrength=null,this.edgeStrength=null,this.preventOverlap=!1,this.clusterNodeStrength=null,this.clusterEdgeStrength=null,this.clusterEdgeDistance=null,this.clusterNodeSize=null,this.clusterFociStrength=null,this.linkDistance=50,this.alphaDecay=.028,this.alphaMin=.001,this.alpha=.3,this.collideStrength=1,this.workerEnabled=!1,this.tick=()=>{},this.onLayoutEnd=()=>{},this.ticking=void 0,e&&this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick(){},onLayoutEnd(){},workerEnabled:!1}}init(e){const t=this;t.nodes=e.nodes||[];const n=e.edges||[];t.edges=n.map((e=>{const t={},n=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(e).forEach((r=>{n.indexOf(r)>-1||(t[r]=e[r])})),t})),t.ticking=!1}execute(e){const t=this,n=t.nodes,r=t.edges;if(t.ticking)return;let o=t.forceSimulation;const i=t.alphaMin,a=t.alphaDecay,s=t.alpha;if(o){if(e)if(t.clustering&&t.clusterForce&&(t.clusterForce.nodes(n),t.clusterForce.links(r)),o.nodes(n),r&&t.edgeForce)t.edgeForce.links(r);else if(r&&!t.edgeForce){const e=Se().id((e=>e.id)).links(r);t.edgeStrength&&e.strength(t.edgeStrength),t.linkDistance&&e.distance(t.linkDistance),t.edgeForce=e,o.force("link",e)}t.preventOverlap&&t.overlapProcess(o),o.alpha(s).restart(),this.ticking=!0}else try{const e=Ee();if(t.nodeStrength&&e.strength(t.nodeStrength),o=be().nodes(n),t.clustering){const e=function(){function e(e){return()=>e}let t,n=e=>e.cluster,r=e(1),o=e(-1),i=e(100),a=e(.1),s=[0,0],u=[],c={},l=[],d=100,h=100,p={none:{x:0,y:0}},g=[],m="force",v=!0,y=.1;function b(e){if(!v)return b;t.tick(),w();for(let t,r=0,o=u.length,i=e*y;r<o;++r)t=u[r],t.vx+=(p[n(t)].x-t.x)*i,t.vy+=(p[n(t)].y-t.y)*i}function E(){u&&function(){if(!u||!u.length)return;if(void 0===n(u[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");const e=function(){const e=[],t=[],o={};let i=[],a={},s=[];return a=function(e){const t={};return e.forEach((e=>{const r=n(e);t[r]||(t[r]={count:0,sumforceNodeSize:0})})),e.forEach((e=>{const o=n(e),i=r(e),a=t[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,t[o]=a})),t}(u),s=function(e){const t={},r=[];return e.forEach((e=>{const r=function(e){const t=f(e,"source"),r=f(e,"target"),o=n(c[t]),i=n(c[r]);return o<=i?`${o}~${i}`:`${i}~${o}`}(e);let o=0;void 0!==t[r]&&(o=t[r]),o+=1,t[r]=o})),Object.entries(t).forEach((([e,t])=>{const n=e.split("~")[0],o=e.split("~")[1];void 0!==n&&void 0!==o&&r.push({source:n,target:o,count:t})})),r}(l),i=Object.keys(a),i.forEach(((t,n)=>{const r=a[t];e.push({id:t,size:r.count,r:Math.sqrt(r.sumforceNodeSize/Math.PI)}),o[t]=n})),s.forEach((e=>{const n=f(e,"source"),r=f(e,"target"),i=o[n],a=o[r];void 0!==i&&void 0!==a&&t.push({source:i,target:a,count:e.count})})),{nodes:e,links:t}}();t=be(e.nodes).force("x",Ne(d).strength(.1)).force("y",De(h).strength(.1)).force("collide",Ae((e=>e.r)).iterations(4)).force("charge",Ee().strength(o)).force("links",Se(e.nodes.length?e.links:[]).distance(i).strength(a)),g=t.nodes(),w()}()}function w(){return p={none:{x:0,y:0}},g.forEach((e=>{p[e.id]={x:e.x-s[0],y:e.y-s[1]}})),p}function x(e){c={},e.forEach((e=>{c[e.id]=e}))}return b.initialize=e=>{u=e,E()},b.template=function(e){return arguments.length?(m=e,E(),b):m},b.groupBy=function(e){return arguments.length?"string"==typeof e?(n=t=>t[e],b):(n=e,b):n},b.enableGrouping=function(e){return arguments.length?(v=e,b):v},b.strength=function(e){return arguments.length?(y=e,b):y},b.centerX=function(e){return arguments.length?(d=e,b):d},b.centerY=function(e){return arguments.length?(h=e,b):h},b.nodes=function(e){return arguments.length?(x(e||[]),u=e||[],b):u},b.links=function(e){return arguments.length?(l=e||[],E(),b):l},b.forceNodeSize=function(t){return arguments.length?(r="function"==typeof t?t:e(+t),E(),b):r},b.nodeSize=b.forceNodeSize,b.forceCharge=function(t){return arguments.length?(o="function"==typeof t?t:e(+t),E(),b):o},b.forceLinkDistance=function(t){return arguments.length?(i="function"==typeof t?t:e(+t),E(),b):i},b.forceLinkStrength=function(t){return arguments.length?(a="function"==typeof t?t:e(+t),E(),b):a},b.offset=function(e){return arguments.length?(s=e,b):s},b.getFocis=w,b}();e.centerX(t.center[0]).centerY(t.center[1]).template("force").strength(t.clusterFociStrength),r&&e.links(r),n&&e.nodes(n),e.forceLinkDistance(t.clusterEdgeDistance).forceLinkStrength(t.clusterEdgeStrength).forceCharge(t.clusterNodeStrength).forceNodeSize(t.clusterNodeSize),t.clusterForce=e,o.force("group",e)}if(o.force("center",we(t.center[0],t.center[1])).force("charge",e).alpha(s).alphaDecay(a).alphaMin(i),t.preventOverlap&&t.overlapProcess(o),r){const e=Se().id((e=>e.id)).links(r);t.edgeStrength&&e.strength(t.edgeStrength),t.linkDistance&&e.distance(t.linkDistance),t.edgeForce=e,o.force("link",e)}if(t.workerEnabled&&!Re()&&(t.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),t.workerEnabled){o.stop();const e=function(e){const t=e.alphaMin(),n=e.alphaTarget(),r=e.alpha(),o=Math.log((t-n)/(r-n))/Math.log(1-e.alphaDecay());return Math.ceil(o)}(o);for(let t=1;t<=e;t++)o.tick(),postMessage({nodes:n,currentTick:t,totalTicks:e,type:"LAYOUT_TICK"},void 0);t.ticking=!1}else o.on("tick",(()=>{t.tick()})).on("end",(()=>{t.ticking=!1,t.onLayoutEnd&&t.onLayoutEnd()})),t.ticking=!0;t.forceSimulation=o,t.ticking=!0}catch(e){t.ticking=!1,console.warn(e)}}overlapProcess(e){const t=this,n=t.nodeSize,r=t.nodeSpacing;let o,i;const a=t.collideStrength;if(i=u(r)?()=>r:w(r)?r:()=>0,n)if(w(n))o=e=>n(e)+i(e);else if(s(n)){const e=(n[0]>n[1]?n[0]:n[1])/2;o=t=>e+i(t)}else if(u(n)){const e=n/2;o=t=>e+i(t)}else o=()=>10;else o=e=>e.size?s(e.size)?(e.size[0]>e.size[1]?e.size[0]:e.size[1])/2+i(e):l(e.size)?(e.size.width>e.size.height?e.size.width:e.size.height)/2+i(e):e.size/2+i(e):10+i(e);e.force("collisionForce",Ae(o).strength(a))}updateCfg(e){const t=this;t.ticking&&(t.forceSimulation.stop(),t.ticking=!1),t.forceSimulation=null,Object.assign(t,e)}destroy(){const e=this;e.ticking&&(e.forceSimulation.stop(),e.ticking=!1),e.nodes=null,e.edges=null,e.destroyed=!0}}function Re(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope}function Ce(e,t){const n=e.degree,r=t.degree;return n<r?-1:n>r?1:0}class Le extends i{constructor(e){super(),this.radius=null,this.nodeSize=void 0,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(e)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){var e;const t=this,n=t.nodes,r=t.edges,o=n.length;if(0===o)return void(t.onLayoutEnd&&t.onLayoutEnd());t.width||"undefined"==typeof window||(t.width=window.innerWidth),t.height||"undefined"==typeof window||(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const i=t.center;if(1===o)return n[0].x=i[0],n[0].y=i[1],void(t.onLayoutEnd&&t.onLayoutEnd());let{radius:a,startRadius:s,endRadius:u}=t;const{divisions:c,startAngle:l,endAngle:d,angleRatio:f,ordering:p,clockwise:g,nodeSpacing:m,nodeSize:v}=t,y=(d-l)/o,b={};n.forEach(((e,t)=>{b[e.id]=t})),t.nodeMap=b;const E=h(n.length,b,r);if(t.degrees=E,m){const e=_(10,m),t=_(10,v);let r=-1/0;n.forEach((e=>{const n=t(e);r<n&&(r=n)}));let o=0;n.forEach(((t,n)=>{o+=0===n?r||10:(e(t)||0)+(r||10)})),a=o/(2*Math.PI)}else a||s||u?!s&&u?s=u:s&&!u&&(u=s):a=t.height>t.width?t.width/2:t.height/2;const w=y*f;let x=[];x="topology"===p?t.topologyOrdering():"topology-directed"===p?t.topologyOrdering(!0):"degree"===p?t.degreeOrdering():n;const S=Math.ceil(o/c);for(let e=0;e<o;++e){let t=a;t||null===s||null===u||(t=s+e*(u-s)/(o-1)),t||(t=10+100*e/(o-1));let n=l+e%S*w+2*Math.PI/c*Math.floor(e/S);g||(n=d-e%S*w-2*Math.PI/c*Math.floor(e/S)),x[e].x=i[0]+Math.cos(n)*t,x[e].y=i[1]+Math.sin(n)*t,x[e].weight=E[e].all}return null===(e=t.onLayoutEnd)||void 0===e||e.call(t),{nodes:x,edges:this.edges}}topologyOrdering(e=!1){const t=this,n=t.degrees,r=t.edges,o=t.nodes,i=d(o),a=t.nodeMap,s=[i[0]],u=[o[0]],c=[],l=o.length;c[0]=!0,function(e,t,n,r){e.forEach(((t,n)=>{e[n].children=[],e[n].parent=[]})),r?t.forEach((t=>{const r=f(t,"source"),o=f(t,"target");let i=0;r&&(i=n[r]);let a=0;o&&(a=n[o]);const s=e[i].children,u=e[a].parent;s.push(e[a].id),u.push(e[i].id)})):t.forEach((t=>{const r=f(t,"source"),o=f(t,"target");let i=0;r&&(i=n[r]);let a=0;o&&(a=n[o]);const s=e[i].children,u=e[a].children;s.push(e[a].id),u.push(e[i].id)}))}(i,r,a,e);let h=0;return i.forEach(((e,t)=>{if(0!==t)if(t!==l-1&&n[t].all===n[t+1].all&&!function(e,t,n){const r=n.length;for(let o=0;o<r;o++){const r=f(n[o],"source"),i=f(n[o],"target");if(e.id===r&&t.id===i||t.id===r&&e.id===i)return!0}return!1}(s[h],e,r)||c[t]){const e=s[h].children;let r=!1;for(let l=0;l<e.length;l++){const d=a[e[l]];if(n[d].all===n[t].all&&!c[d]){s.push(i[d]),u.push(o[a[i[d].id]]),c[d]=!0,r=!0;break}}let d=0;for(;!r&&(c[d]||(s.push(i[d]),u.push(o[a[i[d].id]]),c[d]=!0,r=!0),d++,d!==l););}else s.push(e),u.push(o[a[e.id]]),c[t]=!0,h++})),u}degreeOrdering(){const e=this.nodes,t=[],n=this.degrees;return e.forEach(((e,r)=>{e.degree=n[r].all,t.push(e)})),t.sort(Ce),t}getType(){return"circular"}}const ze=(e,t)=>{if("next"!==e&&"prev"!==e)return t},Ge=e=>{e.prev.next=e.next,e.next.prev=e.prev,delete e.next,delete e.prev};class Pe{constructor(){const e={};e.prev=e,e.next=e.prev,this.shortcut=e}dequeue(){const e=this.shortcut,t=e.prev;if(t&&t!==e)return Ge(t),t}enqueue(e){const t=this.shortcut;e.prev&&e.next&&Ge(e),e.next=t.next,t.next.prev=e,t.next=e,e.prev=t}toString(){const e=[],t=this.shortcut;let n=t.prev;for(;n!==t;)e.push(JSON.stringify(n,ze)),n=null==n?void 0:n.prev;return`[${e.join(", ")}]`}}var je;function Fe(e,t){var n=e.get(t)||0;e.set(t,n+1)}function Ue(e,t){var n=e.get(t);void 0!==n&&((n-=1)>0?e.set(t,n):e.delete(t))}function Be(e,t,n,r){var o=String(t),i=String(n);if(!e&&o>i){var a=o;o=i,i=a}return o+je.EDGE_KEY_DELIM+i+je.EDGE_KEY_DELIM+(void 0===r?je.DEFAULT_EDGE_NAME:r)}function Ve(e,t,n,r){var o=String(t),i=String(n),a={v:t,w:n};if(!e&&o>i){var s=a.v;a.v=a.w,a.w=s}return void 0!==r&&(a.name=r),a}function We(e,t){return Be(e,t.v,t.w,t.name)}function Xe(e){return"function"==typeof e}!function(e){e.DEFAULT_EDGE_NAME="\0",e.GRAPH_NODE="\0",e.EDGE_KEY_DELIM=""}(je||(je={}));var He=function(e){return e.nodes().map((function(t){var n={id:t,value:e.node(t),parent:e.parent(t)};return void 0===n.value&&delete n.value,void 0===n.parent&&delete n.parent,n}))},qe=function(e){return e.edges().map((function(t){var n=e.edge(t),r={v:t.v,w:t.w,value:n,name:t.name};return void 0===r.name&&delete r.name,void 0===r.value&&delete r.value,r}))},Ye=function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:He(e),edges:qe(e),value:e.graph()};return void 0===t.value&&delete t.value,t};function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){Ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var et={compound:!1,multigraph:!1,directed:!0},tt=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Qe(this,e),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=je.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return t.directed},this.isMultigraph=function(){return t.multigraph},this.isCompound=function(){return t.compound},this.setGraph=function(e){return t.label=e,t},this.graph=function(){return t.label},this.setDefaultNodeLabel=function(e){return Xe(e)?t.defaultNodeLabelFn=e:t.defaultNodeLabelFn=function(){return e},t},this.nodeCount=function(){return t.nodeCountNum},this.node=function(e){return t.nodesLabelMap.get(e)},this.nodes=function(){return Array.from(t.nodesLabelMap.keys())},this.sources=function(){return t.nodes().filter((function(e){var n;return!(null===(n=t.inEdgesMap.get(e))||void 0===n?void 0:n.size)}))},this.sinks=function(){return t.nodes().filter((function(e){var n;return!(null===(n=t.outEdgesMap.get(e))||void 0===n?void 0:n.size)}))},this.setNodes=function(e,n){return e.map((function(e){return t.setNode(e,n)})),t},this.hasNode=function(e){return t.nodesLabelMap.has(e)},this.checkCompound=function(){if(!t.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(e){if(t.isCompound()){var n,r=null===(n=t.parentMap)||void 0===n?void 0:n.get(e);if(r!==t.GRAPH_NODE)return r}},this.removeFromParentsChildList=function(e){var n=t.parentMap.get(e);t.childrenMap.get(n).delete(e)},this.setParent=function(e,n){var r,o;t.checkCompound();for(var i=void 0===n?t.GRAPH_NODE:n,a=t.parent(i);a;){if(e===a)throw new Error("Setting "+n+" as parent of "+e+" would create a cycle");a=t.parent(a)}n&&t.setNode(n),t.setNode(e),t.removeFromParentsChildList(e),null===(r=t.parentMap)||void 0===r||r.set(e,i);var s=t.childrenMap.get(i);return s.set(e,!0),null===(o=t.childrenMap)||void 0===o||o.set(i,s),t},this.children=function(e){var n=void 0===e?t.GRAPH_NODE:e;if(t.isCompound()){var r,o=null===(r=t.childrenMap)||void 0===r?void 0:r.get(n);return o?Array.from(o.keys()):void 0}return n===t.GRAPH_NODE?t.nodes():e&&t.hasNode(e)?[]:void 0},this.predecessors=function(e){var n=t.predecessorsMap.get(e);return n?Array.from(n.keys()):void 0},this.successors=function(e){var n=t.successorsMap.get(e);return n?Array.from(n.keys()):void 0},this.neighbors=function(e){var n;if(t.hasNode(e))return Array.from(new Set(null===(n=t.predecessors(e))||void 0===n?void 0:n.concat(t.successors(e))))},this.isLeaf=function(e){var n,r;return t.isDirected()?!(null===(r=t.successors(e))||void 0===r?void 0:r.length):!(null===(n=t.neighbors(e))||void 0===n?void 0:n.length)},this.filterNodes=function(n){var r=t.directed,o=t.multigraph,i=t.compound,a=new e({directed:r,multigraph:o,compound:i});return a.setGraph(t.graph()),t.nodes().forEach((function(e){n(e)&&a.setNode(e,t.node(e))})),t.edges().forEach((function(e){a.hasNode(e.v)&&a.hasNode(e.w)&&a.setEdgeObj(e,t.edge(e))})),i&&a.nodes().forEach((function(e){a.setParent(e,function(e){for(var n=t.parent(e);void 0!==n&&!a.hasNode(n);)n=t.parent(n);return n}(e))})),a},this.setDefaultEdgeLabel=function(e){return Xe(e)?t.defaultEdgeLabelFn=e:t.defaultEdgeLabelFn=function(){return e},t},this.edgeCount=function(){return t.edgeCountNum},this.setEdgeObj=function(e,n){return t.setEdge(e.v,e.w,n,e.name)},this.setPath=function(e,n){return e.reduce((function(e,r){return t.setEdge(e,r,n),r})),t},this.edgeFromArgs=function(e,n,r){return t.edge({v:e,w:n,name:r})},this.edge=function(e){return t.edgesLabelsMap.get(We(t.isDirected(),e))},this.hasEdge=function(e,n,r){return t.edgesLabelsMap.has(We(t.isDirected(),{v:e,w:n,name:r}))},this.removeEdgeObj=function(e){var n=e.v,r=e.w,o=e.name;return t.removeEdge(n,r,o)},this.edges=function(){return Array.from(t.edgesMap.values())},this.inEdges=function(e,n){var r=t.inEdgesMap.get(e);if(r)return Array.from(r.values()).filter((function(e){return!n||e.v===n}))},this.outEdges=function(e,n){var r=t.outEdgesMap.get(e);if(r)return Array.from(r.values()).filter((function(e){return!n||e.w===n}))},this.nodeEdges=function(e,n){var r;if(t.hasNode(e))return null===(r=t.inEdges(e,n))||void 0===r?void 0:r.concat(t.outEdges(e,n))},this.toJSON=function(){return Ye(t)},this.nodeInDegree=function(e){var n=t.inEdgesMap.get(e);return n?n.size:0},this.nodeOutDegree=function(e){var n=t.outEdgesMap.get(e);return n?n.size:0},this.nodeDegree=function(e){return t.nodeInDegree(e)+t.nodeOutDegree(e)},this.source=function(e){return e.v},this.target=function(e){return e.w};var r=$e($e({},et),n);this.compound=r.compound,this.directed=r.directed,this.multigraph=r.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}var t,n;return t=e,n=[{key:"setNode",value:function(e,t){var n,r=this.nodesLabelMap,o=this.defaultNodeLabelFn,i=this.isCompound,a=this.parentMap,s=this.childrenMap,u=this.inEdgesMap,c=this.outEdgesMap,l=this.predecessorsMap,d=this.successorsMap;return r.has(e)?(void 0!==t&&r.set(e,t),this):(r.set(e,t||o(e)),i()&&(null==a||a.set(e,this.GRAPH_NODE),null==s||s.set(e,new Map),(null==s?void 0:s.has(this.GRAPH_NODE))||null==s||s.set(this.GRAPH_NODE,new Map),null==s||null===(n=s.get(this.GRAPH_NODE))||void 0===n||n.set(e,!0)),[u,c,l,d].forEach((function(t){return t.set(e,new Map)})),this.nodeCountNum+=1,this)}},{key:"removeNode",value:function(e){var t=this;if(this.hasNode(e)){var n,r,o,i=function(e){t.removeEdge(e.v,e.w,e.name)},a=this.inEdgesMap,s=this.outEdgesMap,u=this.predecessorsMap,c=this.successorsMap,l=this.nodesLabelMap;this.isCompound()&&(this.removeFromParentsChildList(e),null===(n=this.parentMap)||void 0===n||n.delete(e),null===(r=this.children(e))||void 0===r||r.forEach((function(e){return t.setParent(e)})),null===(o=this.childrenMap)||void 0===o||o.delete(e));var d=a.get(e),f=s.get(e);Array.from(d.values()).forEach((function(e){return i(e)})),Array.from(f.values()).forEach((function(e){return i(e)})),l.delete(e),a.delete(e),s.delete(e),u.delete(e),c.delete(e),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(e,t,n,r){var o,i,a=Ve(this.isDirected(),e,t,r),s=We(this.isDirected(),a),u=a.v,c=a.w;if(this.edgesLabelsMap.has(s))return this.edgesLabelsMap.set(s,n),this;if(void 0!==r&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(c),this.edgesLabelsMap.set(s,n||this.defaultEdgeLabelFn(u,c,r)),Object.freeze(a),this.edgesMap.set(s,a);var l=this.predecessorsMap.get(c),d=this.successorsMap.get(u);return Fe(l,u),Fe(d,c),null===(o=this.inEdgesMap.get(c))||void 0===o||o.set(s,a),null===(i=this.outEdgesMap.get(u))||void 0===i||i.set(s,a),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(e,t,n){var r=Be(this.isDirected(),e,t,n);if(this.edgesMap.get(r)){var o=Ve(this.isDirected(),e,t,n),i=o.v,a=o.w;this.edgesLabelsMap.delete(r),this.edgesMap.delete(r);var s=this.predecessorsMap.get(a),u=this.successorsMap.get(i);Ue(s,i),Ue(u,a),this.inEdgesMap.get(a).delete(r),this.outEdgesMap.get(i).delete(r),this.edgeCountNum-=1}return this}}],n&&Je(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rt(e,t,n){return t&&nt(e.prototype,t),n&&nt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}tt.fromJSON=function(e){var t=new tt(e.options);return void 0!==e.value&&t.setGraph(e.value),e.nodes.forEach((function(e){t.setNode(e.id,e.value),e.parent&&t.setParent(e.id,e.parent)})),e.edges.forEach((function(e){t.setEdge(e.v,e.w,e.value,e.name)})),t};var ot=rt((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.arr=[],this.keyIndice=new Map,this.size=function(){return t.arr.length},this.keys=function(){return t.arr.map((function(e){return e.key}))},this.has=function(e){return t.keyIndice.has(e)},this.priority=function(e){var n=t.keyIndice.get(e);if(void 0!==n)return t.arr[n].priority},this.swap=function(e,n){var r=t.arr,o=t.keyIndice,i=[r[e],r[n]],a=i[0],s=i[1];r[e]=s,r[n]=a,o.set(a.key,n),o.set(s.key,e)},this.innerDecrease=function(e){for(var n,r=t.arr,o=r[e].priority,i=e;0!==i;){var a;if((null===(a=r[n=i>>1])||void 0===a?void 0:a.priority)<o)break;t.swap(i,n),i=n}},this.heapify=function(e){var n=t.arr,r=e<<1,o=r+1,i=e;r<n.length&&(i=n[r].priority<n[i].priority?r:i,o<n.length&&(i=n[o].priority<n[i].priority?o:i),i!==e&&(t.swap(e,i),t.heapify(i)))},this.min=function(){if(0===t.size())throw new Error("Queue underflow");return t.arr[0].key},this.add=function(e,n){var r=t.keyIndice,o=t.arr;if(!r.has(e)){var i=o.length;return r.set(e,i),o.push({key:e,priority:n}),t.innerDecrease(i),!0}return!1},this.removeMin=function(){t.swap(0,t.arr.length-1);var e=t.arr.pop();return t.keyIndice.delete(e.key),t.heapify(0),e.key},this.decrease=function(e,n){if(!t.has(e))throw new Error("There's no key named ".concat(e));var r=t.keyIndice.get(e);if(n>t.arr[r].priority)throw new Error("New priority is greater than current priority.Key: ".concat(e," Old: + ").concat(t.arr[r].priority," New: ").concat(n));t.arr[r].priority=n,t.innerDecrease(r)}}));const it=function(e,t){var n,r=new tt,o=new Map,i=new ot;function a(e){var r=e.v===n?e.w:e.v,a=i.priority(r);if(void 0!==a){var s=t(e);s<a&&(o.set(r,n),i.decrease(r,s))}}if(0===e.nodeCount())return r;e.nodes().forEach((function(e){i.add(e,Number.POSITIVE_INFINITY),r.setNode(e)})),i.decrease(e.nodes()[0],0);for(var s=!1;i.size()>0;){var u;if(n=i.removeMin(),o.has(n))r.setEdge(n,o.get(n));else{if(s)throw new Error("Input graph is not connected: "+e.graph());s=!0}null===(u=e.nodeEdges(n))||void 0===u||u.forEach(a)}return r},at=function(e){var t=new Set,n=[];return e.nodes().forEach((function(r){for(var o=[],i=[r];i.length>0;){var a,s,u=i.pop();t.has(u)||(t.add(u),o.push(u),null===(a=e.successors(u))||void 0===a||a.forEach((function(e){return i.push(e)})),null===(s=e.predecessors(u))||void 0===s||s.forEach((function(e){return i.push(e)})))}o.length&&n.push(o)})),n};var st=function e(t,n,r,o,i,a){o.includes(n)||(o.push(n),r||a.push(n),i(n).forEach((function(n){return e(t,n,r,o,i,a)})),r&&a.push(n))};const ut=function(e,t,n){var r=Array.isArray(t)?t:[t],o=function(t){return e.isDirected()?e.successors(t):e.neighbors(t)},i=[],a=[];return r.forEach((function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);st(e,t,"post"===n,a,o,i)})),i};function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lt=function(){return 1},dt=function(e,t,n,r){var o,i,a=new Map,s=new ot,u=function(e){var t=e.v!==o?e.v:e.w,r=a.get(t),u=n(e),c=i.distance+u;if(u<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+u);c<r.distance&&(r.distance=c,r.predecessor=o,s.decrease(t,c))};for(e.nodes().forEach((function(e){var n=e===t?0:Number.POSITIVE_INFINITY;a.set(e,{distance:n}),s.add(e,n)}));s.size()>0&&(o=s.removeMin(),!(i=a.get(o))||i.distance!==Number.POSITIVE_INFINITY);)r(o).forEach(u);var c={};return Array.from(a.entries()).forEach((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ct(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),n=t[0],r=t[1];return c[String(n)]=r,c})),c};const ft=function(e,t,n,r){return dt(e,t,n||lt,r||function(t){return e.outEdges(t)})},ht=function(e,t,n){var r={};return e.nodes().forEach((function(o){return r[String(o)]=ft(e,o,t,n),r})),r},pt=function(e){var t=0,n=[],r=new Map,o=[];function i(a){var s,u={onStack:!0,lowlink:t,index:t};if(r.set(a,u),t+=1,n.push(a),null===(s=e.successors(a))||void 0===s||s.forEach((function(e){var t;if(r.has(e)){if(null===(t=r.get(e))||void 0===t?void 0:t.onStack){var n=r.get(e);u.lowlink=Math.min(u.lowlink,n.index)}}else{i(e);var o=r.get(e);u.lowlink=Math.min(u.lowlink,o.lowlink)}})),u.lowlink===u.index){var c,l=[];do{c=n.pop(),r.get(c).onStack=!1,l.push(c)}while(a!==c);o.push(l)}}return e.nodes().forEach((function(e){r.has(e)||i(e)})),o},gt=function(e){return pt(e).filter((function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))};function mt(e){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt(e)}function vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yt(e,t){if(t&&("object"===mt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function bt(e){var t="function"==typeof Map?new Map:void 0;return bt=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Et(e,arguments,_t(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),xt(r,e)},bt(e)}function Et(e,t,n){return Et=wt()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&xt(o,n.prototype),o},Et.apply(null,arguments)}function wt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function xt(e,t){return xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xt(e,t)}function _t(e){return _t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_t(e)}var St=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xt(e,t)}(i,e);var t,n,r,o=(t=i,n=wt(),function(){var e,r=_t(t);if(n){var o=_t(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return yt(this,e)});function i(){return vt(this,i),o.apply(this,arguments)}return r=i,Object.defineProperty(r,"prototype",{writable:!1}),r}(bt(Error));const It=function(e){var t=new Set,n=new Set,r=[];if(e.sinks().forEach((function o(i){if(n.has(i))throw new St;var a;t.has(i)||(n.add(i),t.add(i),null===(a=e.predecessors(i))||void 0===a||a.forEach(o),n.delete(i),r.push(i))})),t.size!==e.nodeCount())throw new St;return r},Tt=function(e){try{It(e)}catch(e){if(e instanceof St)return!1;throw e}return!0},At=function(e,t){return ut(e,t,"post")},Nt=function(e,t){return ut(e,t,"pre")};var Dt=function(){return 1};const kt=function(e,t,n){return function(e,t,n){var r={},o=e.nodes();return o.forEach((function(e){var i=String(e);r[i]={},r[i][i]={distance:0},o.forEach((function(t){e!==t&&(r[i][String(t)]={distance:Number.POSITIVE_INFINITY})})),n(e).forEach((function(n){var o=n.v===e?n.w:n.v,a=t(n);r[i][String(o)]={distance:a,predecessor:e}}))})),o.forEach((function(e){var t=String(e),n=r[t];o.forEach((function(e){var i=String(e),a=r[i];o.forEach((function(e){var r=String(e),o=a[t],i=n[r],s=a[r],u=o.distance+i.distance;u<s.distance&&(s.distance=u,s.predecessor=i.predecessor)}))}))})),r}(e,t||Dt,n||function(t){return e.outEdges(t)})};class Mt extends Pe{}class Ot extends tt{}const Rt=()=>1,Ct=(e,t,n,r,o)=>{var i,a;const s=[];return null===(i=e.inEdges(r.v))||void 0===i||i.forEach((r=>{const i=e.edge(r),a=e.node(r.v);o&&s.push({v:r.v,w:r.w,in:0,out:0}),void 0===a.out&&(a.out=0),a.out-=i,Lt(t,n,a)})),null===(a=e.outEdges(r.v))||void 0===a||a.forEach((r=>{const o=e.edge(r),i=r.w,a=e.node(i);void 0===a.in&&(a.in=0),a.in-=o,Lt(t,n,a)})),e.removeNode(r.v),o?s:void 0},Lt=(e,t,n)=>{n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)},zt=(e,t)=>{var n;if(e.nodeCount()<=1)return[];const r=((e,t)=>{const n=new Ot;let r=0,o=0;e.nodes().forEach((e=>{n.setNode(e,{v:e,in:0,out:0})})),e.edges().forEach((e=>{const i=n.edge(e)||0,a=(null==t?void 0:t(e))||1,s=i+a;n.setEdge(e.v,e.w,s),o=Math.max(o,n.node(e.v).out+=a),r=Math.max(r,n.node(e.w).in+=a)}));const i=[],a=o+r+3;for(let e=0;e<a;e++)i.push(new Mt);const s=r+1;return n.nodes().forEach((e=>{Lt(i,s,n.node(e))})),{buckets:i,zeroIdx:s,graph:n}})(e,t||Rt);return null===(n=((e,t,n)=>{let r=[];const o=t[t.length-1],i=t[0];let a;for(;e.nodeCount();){for(;a=i.dequeue();)Ct(e,t,n,a);for(;a=o.dequeue();)Ct(e,t,n,a);if(e.nodeCount())for(let o=t.length-2;o>0;--o)if(a=t[o].dequeue(),a){r=r.concat(Ct(e,t,n,a,!0));break}}return r})(r.graph,r.buckets,r.zeroIdx).map((t=>e.outEdges(t.v,t.w))))||void 0===n?void 0:n.flat()};class Gt extends tt{}const Pt=(e,t,n,r)=>{let o;do{o=`${r}${Math.random()}`}while(e.hasNode(o));return n.dummy=t,e.setNode(o,n),o},jt=e=>{const t=new Gt({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach((n=>{var r;(null===(r=e.children(n))||void 0===r?void 0:r.length)||t.setNode(n,e.node(n))})),e.edges().forEach((n=>{t.setEdgeObj(n,e.edge(n))})),t},Ft=(e,t)=>{const n=Number(e.x),r=Number(e.y),o=Number(t.x)-n,i=Number(t.y)-r;let a,s,u=Number(e.width)/2,c=Number(e.height)/2;return o||i?(Math.abs(i)*u>Math.abs(o)*c?(i<0&&(c=-c),a=c*o/i,s=c):(o<0&&(u=-u),a=u,s=u*i/o),{x:n+a,y:r+s}):{x:0,y:0}},Ut=e=>{const t=[],n=Vt(e)+1;for(let e=0;e<n;e++)t.push([]);e.nodes().forEach((n=>{const r=e.node(n);if(!r)return;const o=r.rank;void 0!==o&&t[o]&&t[o].push(n)}));for(let r=0;r<n;r++)t[r]=t[r].sort(((t,n)=>{var r,o,i,a;return i=null===(r=e.node(t))||void 0===r?void 0:r.order,a=null===(o=e.node(n))||void 0===o?void 0:o.order,Number(i)-Number(a)}));return t},Bt=(e,t,n,r)=>{const o={width:0,height:0};return u(n)&&u(r)&&(o.rank=n,o.order=r),Pt(e,"border",o,t)},Vt=e=>{let t;return e.nodes().forEach((n=>{var r;const o=null===(r=e.node(n))||void 0===r?void 0:r.rank;void 0!==o&&(void 0===t||o>t)&&(t=o)})),t||(t=0),t},Wt=(e,t)=>{const n=Date.now();try{return t()}finally{console.log(`${e} time: ${Date.now()-n}ms`)}},Xt=(e,t)=>t(),Ht=(e,t)=>e.reduce(((e,n)=>t(e)>t(n)?n:e)),qt=e=>{e.graph().dummyChains=[],e.edges().forEach((t=>((e,t)=>{let n=t.v,r=e.node(n).rank;const o=t.w,i=e.node(o).rank,a=t.name,s=e.edge(t),u=s.labelRank;if(i===r+1)return;e.removeEdgeObj(t);const c=e.graph();let l,d,f;for(f=0,++r;r<i;++f,++r)s.points=[],d={edgeLabel:s,width:0,height:0,edgeObj:t,rank:r},l=Pt(e,"edge",d,"_d"),r===u&&(d.width=s.width,d.height=s.height,d.dummy="edge-label",d.labelpos=s.labelpos),e.setEdge(n,l,{weight:s.weight},a),0===f&&(c.dummyChains||(c.dummyChains=[]),c.dummyChains.push(l)),n=l;e.setEdge(n,o,{weight:s.weight},a)})(e,t)))},Yt=e=>{var t;const n={},r=t=>{var o;const i=e.node(t);if(!i)return 0;if(n[t])return i.rank;let a;return n[t]=!0,null===(o=e.outEdges(t))||void 0===o||o.forEach((t=>{const n=r(t.w)-e.edge(t).minlen;n&&(void 0===a||n<a)&&(a=n)})),a||(a=0),i.rank=a,a};null===(t=e.sources())||void 0===t||t.forEach((e=>r(e)))},Zt=(e,t)=>e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen,$t=(e,t)=>{const n=r=>{t.nodeEdges(r).forEach((o=>{const i=o.v,a=r===i?o.w:i;e.hasNode(a)||Zt(t,o)||(e.setNode(a,{}),e.setEdge(r,a,{}),n(a))}))};return e.nodes().forEach(n),e.nodeCount()},Kt=(e,t)=>{const n=r=>{var o;null===(o=t.nodeEdges(r))||void 0===o||o.forEach((o=>{const i=o.v,a=r===i?o.w:i;e.hasNode(a)||void 0===t.node(a).layer&&Zt(t,o)||(e.setNode(a,{}),e.setEdge(r,a,{}),n(a))}))};return e.nodes().forEach(n),e.nodeCount()},Qt=(e,t)=>Ht(t.edges(),(n=>e.hasNode(n.v)!==e.hasNode(n.w)?Zt(t,n):1/0)),Jt=(e,t,n)=>{e.nodes().forEach((e=>{t.node(e).rank||(t.node(e).rank=0),t.node(e).rank+=n}))},{preorder:en,postorder:tn}=r,nn=(e,t)=>{let n=tn(e,e.nodes());n=null==n?void 0:n.slice(0,(null==n?void 0:n.length)-1),null==n||n.forEach((n=>{rn(e,t,n)}))},rn=(e,t,n)=>{const r=e.node(n).parent;e.edgeFromArgs(n,r).cutvalue=on(e,t,n)},on=(e,t,n)=>{var r;const o=e.node(n).parent;let i=!0,a=t.edgeFromArgs(n,o),s=0;return a||(i=!1,a=t.edgeFromArgs(o,n)),s=a.weight,null===(r=t.nodeEdges(n))||void 0===r||r.forEach((r=>{const a=r.v===n,u=a?r.w:r.v;if(u!==o){const o=a===i,c=t.edge(r).weight;if(s+=o?c:-c,fn(e,n,u)){const t=e.edgeFromArgs(n,u).cutvalue;s+=o?-t:t}}})),s},an=(e,t=e.nodes()[0])=>{sn(e,{},1,t)},sn=(e,t,n,r,o)=>{var i;const a=n;let s=n;const u=e.node(r);return t[r]=!0,null===(i=e.neighbors(r))||void 0===i||i.forEach((n=>{t[n]||(s=sn(e,t,s,n,r))})),u.low=a,u.lim=s++,o?u.parent=o:delete u.parent,s},un=e=>e.edges().find((t=>e.edge(t).cutvalue<0)),cn=(e,t,n)=>{let r=n.v,o=n.w;t.hasEdge(r,o)||(r=n.w,o=n.v);const i=e.node(r),a=e.node(o);let s=i,u=!1;i.lim>a.lim&&(s=a,u=!0);const c=t.edges().filter((t=>u===hn(e,e.node(t.v),s)&&u!==hn(e,e.node(t.w),s)));return Ht(c,(e=>Zt(t,e)))},ln=(e,t,n,r)=>{const o=n.v,i=n.w;e.removeEdge(o,i),e.setEdge(r.v,r.w,{}),an(e),nn(e,t),dn(e,t)},dn=(e,t)=>{const n=e.nodes().find((e=>{var n;return!(null===(n=t.node(e))||void 0===n?void 0:n.parent)}));let r=en(e,n);r=null==r?void 0:r.slice(1),null==r||r.forEach((n=>{const r=e.node(n).parent;let o=t.edgeFromArgs(n,r),i=!1;o||(o=t.edgeFromArgs(r,n),i=!0),t.node(n).rank=t.node(r).rank+(i?o.minlen:-o.minlen)}))},fn=(e,t,n)=>e.hasEdge(t,n),hn=(e,t,n)=>n.low<=t.lim&&t.lim<=n.lim,pn=e=>{const t=(e=>{const t=(new Gt).setGraph(e.graph());return e.nodes().forEach((n=>{t.setNode(n,e.node(n))})),e.edges().forEach((n=>{const r=t.edgeFromArgs(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})})),t})(e);Yt(t);const n=(e=>{const t=new Gt({directed:!1}),n=e.nodes()[0],r=e.nodeCount();let o,i;for(t.setNode(n,{});$t(t,e)<r;)o=Qt(t,e),i=t.hasNode(o.v)?Zt(e,o):-Zt(e,o),Jt(t,e,i);return t})(t);let r,o;for(an(n),nn(n,t);r=un(n);)o=cn(n,t,r),ln(n,t,r,o)},gn=Yt,mn=e=>{(e=>{var t;const n={};let r;const o=t=>{var i;const a=e.node(t);if(!a)return 0;if(n[t])return a.rank;let s;return n[t]=!0,null===(i=e.outEdges(t))||void 0===i||i.forEach((t=>{const n=o(t.w)-e.edge(t).minlen;n&&(void 0===s||n<s)&&(s=n)})),s||(s=0),(void 0===r||s<r)&&(r=s),a.rank=s,s};null===(t=e.sources())||void 0===t||t.forEach((t=>{e.node(t)&&o(t)})),void 0===r&&(r=0);const i={},a=(t,n)=>{var r;const o=e.node(t),s=isNaN(o.layer)?n:o.layer;(void 0===o.rank||o.rank<s)&&(o.rank=s),i[t]||(i[t]=!0,null===(r=e.outEdges(t))||void 0===r||r.map((t=>{a(t.w,s+e.edge(t).minlen)})))};e.nodes().forEach((t=>{const n=e.node(t);n&&(isNaN(n.layer)?n.rank-=r:a(t,n.layer))}))})(e),(e=>{const t=new Gt({directed:!1}),n=e.nodes()[0],r=e.nodes().filter((t=>!!e.node(t))).length;let o,i;for(t.setNode(n,{});Kt(t,e)<r;)o=Qt(t,e),i=t.hasNode(o.v)?Zt(e,o):-Zt(e,o),Jt(t,e,i)})(e)},vn=e=>{switch(e.graph().ranker){case"network-simplex":(e=>{pn(e)})(e);break;case"tight-tree":default:mn(e);break;case"longest-path":gn(e)}},yn=(e,t,n,r,o,i,a)=>{const s=e.children(a);if(!(null==s?void 0:s.length))return void(a!==t&&e.setEdge(t,a,{weight:0,minlen:n}));const u=Bt(e,"_bt"),c=Bt(e,"_bb"),l=e.node(a);e.setParent(u,a),l.borderTop=u,e.setParent(c,a),l.borderBottom=c,null==s||s.forEach((s=>{yn(e,t,n,r,o,i,s);const l=e.node(s),d=l.borderTop?l.borderTop:s,f=l.borderBottom?l.borderBottom:s,h=l.borderTop?r:2*r,p=d!==f?1:o-i[a]+1;e.setEdge(u,d,{minlen:p,weight:h,nestingEdge:!0}),e.setEdge(f,c,{minlen:p,weight:h,nestingEdge:!0})})),e.parent(a)||e.setEdge(t,u,{weight:0,minlen:o+i[a]})},bn=(e,t,n,r,o,i)=>{const a={rank:i,borderType:t,width:0,height:0},s=o[t][i-1],u=Pt(e,"border",a,n);o[t][i]=u,e.setParent(u,r),s&&e.setEdge(s,u,{weight:1})},En=e=>{e.nodes().forEach((t=>{wn(e.node(t))})),e.edges().forEach((t=>{wn(e.edge(t))}))},wn=e=>{const t=e.width;e.width=e.height,e.height=t},xn=e=>{(null==e?void 0:e.y)&&(e.y=-e.y)},_n=e=>{const t=e.x;e.x=e.y,e.y=t},Sn=e=>{var t;const n=null===(t=e.graph().rankdir)||void 0===t?void 0:t.toLowerCase();"bt"!==n&&"rl"!==n||(e=>{e.nodes().forEach((t=>{xn(e.node(t))})),e.edges().forEach((t=>{var n;const r=e.edge(t);null===(n=r.points)||void 0===n||n.forEach((e=>xn(e))),r.hasOwnProperty("y")&&xn(r)}))})(e),"lr"!==n&&"rl"!==n||((e=>{e.nodes().forEach((t=>{_n(e.node(t))})),e.edges().forEach((t=>{var n;const r=e.edge(t);null===(n=r.points)||void 0===n||n.forEach((e=>_n(e))),r.hasOwnProperty("x")&&_n(r)}))})(e),En(e))},In=e=>{const t={},n=e.nodes().filter((t=>{var n;return!(null===(n=e.children(t))||void 0===n?void 0:n.length)})),r=n.map((t=>e.node(t).rank)),o=Math.max(...r),i=[];for(let e=0;e<o+1;e++)i.push([]);const a=n=>{var r;if(t.hasOwnProperty(n))return;t[n]=!0;const o=e.node(n);isNaN(o.rank)||i[o.rank].push(n),null===(r=e.successors(n))||void 0===r||r.forEach((e=>a(e)))},s=n.sort(((t,n)=>e.node(t).rank-e.node(n).rank)),u=s.filter((t=>void 0!==e.node(t).fixorder)),c=u.sort(((t,n)=>e.node(t).fixorder-e.node(n).fixorder));return null==c||c.forEach((n=>{isNaN(e.node(n).rank)||i[e.node(n).rank].push(n),t[n]=!0})),null==s||s.forEach(a),i},Tn=(e,t,n)=>{const r=(a=n,s=n.map(((e,t)=>t)),null==a?void 0:a.reduce(((e,t,n)=>(e[t]=s[n],e)),{})),o=t.map((t=>{var n;const o=null===(n=e.outEdges(t))||void 0===n?void 0:n.map((t=>({pos:r[t.w]||0,weight:e.edge(t).weight})));return null==o?void 0:o.sort(((e,t)=>e.pos-t.pos))})),i=o.flat().filter((e=>void 0!==e));var a,s;let u=1;for(;u<n.length;)u<<=1;const c=2*u-1;u-=1;const l=Array(c).fill(0,0,c);let d=0;return null==i||i.forEach((e=>{if(e){let t=e.pos+u;l[t]+=e.weight;let n=0;for(;t>0;)t%2&&(n+=l[t+1]),t=t-1>>1,l[t]+=e.weight;d+=e.weight*n}})),d},An=(e,t)=>{let n=0;for(let r=1;r<(null==t?void 0:t.length);r+=1)n+=Tn(e,t[r-1],t[r]);return n},Nn=(e,t,n)=>{const r=(e=>{let t;for(;e.hasNode(t=`_root${Math.random()}`););return t})(e),o=new Gt({compound:!0}).setGraph({root:r}).setDefaultNodeLabel((t=>e.node(t)));return e.nodes().forEach((i=>{var a;const s=e.node(i),u=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(o.setNode(i),o.setParent(i,u||r),null===(a=e[n](i))||void 0===a||a.forEach((t=>{const n=t.v===i?t.w:t.v,r=o.edgeFromArgs(n,i),a=void 0!==r?r.weight:0;o.setEdge(n,i,{weight:e.edge(t).weight+a})})),s.hasOwnProperty("minRank")&&o.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))})),o},Dn=(e,t)=>{var n;let r=0,o=0;e.weight&&(r+=e.barycenter*e.weight,o+=e.weight),t.weight&&(r+=t.barycenter*t.weight,o+=t.weight),e.vs=null===(n=t.vs)||void 0===n?void 0:n.concat(e.vs),e.barycenter=r/o,e.weight=o,e.i=Math.min(t.i,e.i),t.merged=!0},kn=(e,t)=>{var n,r,o;const i={};null==e||e.forEach(((e,t)=>{i[e.v]={i:t,indegree:0,in:[],out:[],vs:[e.v]};const n=i[e.v];void 0!==e.barycenter&&(n.barycenter=e.barycenter,n.weight=e.weight)})),null===(n=t.edges())||void 0===n||n.forEach((e=>{const t=i[e.v],n=i[e.w];void 0!==t&&void 0!==n&&(n.indegree++,t.out.push(i[e.w]))}));return(e=>{var t,n;const r=[];for(;null==e?void 0:e.length;){const o=e.pop();r.push(o),null===(t=o.in.reverse())||void 0===t||t.forEach((e=>{return(t=o,e=>{e.merged||(void 0===e.barycenter||void 0===t.barycenter||e.barycenter>=t.barycenter)&&Dn(t,e)})(e);var t})),null===(n=o.out)||void 0===n||n.forEach((t=>{return(n=o,t=>{t.in.push(n),0==--t.indegree&&e.push(t)})(t);var n}))}const o=r.filter((e=>!e.merged)),i=["vs","i","barycenter","weight"];return o.map((e=>{const t={};return null==i||i.forEach((n=>{void 0!==e[n]&&(t[n]=e[n])})),t}))})(null===(o=(r=Object.values(i)).filter)||void 0===o?void 0:o.call(r,(e=>!e.indegree)))},Mn=(e,t,n)=>{let r,o=n;for(;t.length&&(r=t[t.length-1]).i<=o;)t.pop(),null==e||e.push(r.vs),o++;return o},On=(e,t,n,r)=>{const o=((e,t)=>{const n={lhs:[],rhs:[]};return null==e||e.forEach((e=>{(e=>{const t=e.hasOwnProperty("fixorder")&&!isNaN(e.fixorder);return r?!t&&e.hasOwnProperty("barycenter"):t||e.hasOwnProperty("barycenter")})(e)?n.lhs.push(e):n.rhs.push(e)})),n})(e),i=o.lhs,a=o.rhs.sort(((e,t)=>-e.i- -t.i)),s=[];let u=0,c=0,l=0;null==i||i.sort(((e,t)=>(n,r)=>{if(void 0!==n.fixorder&&void 0!==r.fixorder)return n.fixorder-r.fixorder;if(n.barycenter<r.barycenter)return-1;if(n.barycenter>r.barycenter)return 1;if(t&&void 0!==n.order&&void 0!==r.order){if(n.order<r.order)return-1;if(n.order>r.order)return 1}return e?r.i-n.i:n.i-r.i})(!!t,!!n)),l=Mn(s,a,l),null==i||i.forEach((e=>{var t;l+=null===(t=e.vs)||void 0===t?void 0:t.length,s.push(e.vs),u+=e.barycenter*e.weight,c+=e.weight,l=Mn(s,a,l)}));const d={vs:s.flat()};return c&&(d.barycenter=u/c,d.weight=c),d},Rn=(e,t,n,r,o,i)=>{var a,s,u,c;let l=e.children(t);const d=e.node(t),f=d?d.borderLeft:void 0,h=d?d.borderRight:void 0,p={};f&&(l=null==l?void 0:l.filter((e=>e!==f&&e!==h)));const g=((e,t)=>t.map((t=>{const n=e.inEdges(t);if(!(null==n?void 0:n.length))return{v:t};{const r={sum:0,weight:0};return null==n||n.forEach((t=>{const n=e.edge(t),o=e.node(t.v);r.sum+=n.weight*o.order,r.weight+=n.weight})),{v:t,barycenter:r.sum/r.weight,weight:r.weight}}})))(e,l||[]);null==g||g.forEach((t=>{var o;if(null===(o=e.children(t.v))||void 0===o?void 0:o.length){const o=Rn(e,t.v,n,r,i);p[t.v]=o,o.hasOwnProperty("barycenter")&&Ln(t,o)}}));const m=kn(g,n);Cn(m,p),null===(a=m.filter((e=>e.vs.length>0)))||void 0===a||a.forEach((t=>{const n=e.node(t.vs[0]);n&&(t.fixorder=n.fixorder,t.order=n.order)}));const v=On(m,r,o,i);if(f&&(v.vs=[f,v.vs,h].flat(),null===(s=e.predecessors(f))||void 0===s?void 0:s.length)){const t=e.node((null===(u=e.predecessors(f))||void 0===u?void 0:u[0])||""),n=e.node((null===(c=e.predecessors(h))||void 0===c?void 0:c[0])||"");v.hasOwnProperty("barycenter")||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+t.order+n.order)/(v.weight+2),v.weight+=2}return v},Cn=(e,t)=>{null==e||e.forEach((e=>{var n;const r=null===(n=e.vs)||void 0===n?void 0:n.map((e=>t[e]?t[e].vs:e));e.vs=r.flat()}))},Ln=(e,t)=>{void 0!==e.barycenter?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)},zn=Rn,Gn=(e,t,n)=>t.map((t=>Nn(e,t,n))),Pn=(e,t,n,r)=>{const o=new Gt;null==e||e.forEach((e=>{var i;const a=e.graph().root,s=zn(e,a,o,t,n,r);for(let t=0;t<(null===(i=s.vs)||void 0===i?void 0:i.length);t++){const n=e.node(s.vs[t]);n&&(n.order=t)}((e,t,n)=>{const r={};let o;null==n||n.forEach((n=>{let i,a,s=e.parent(n);for(;s;){if(i=e.parent(s),i?(a=r[i],r[i]=s):(a=o,o=s),a&&a!==s)return void t.setEdge(a,s);s=i}}))})(e,o,s.vs)}))},jn=(e,t)=>{null==t||t.forEach((t=>{null==t||t.forEach(((t,n)=>{e.node(t).order=n}))}))};class Fn extends tt{}const Un=(e,t)=>{var n,r;if(null===(n=e.node(t))||void 0===n?void 0:n.dummy)return null===(r=e.predecessors(t))||void 0===r?void 0:r.find((t=>e.node(t).dummy))},Bn=(e,t,n)=>{let r=t,o=n;if(r>o){const e=r;r=o,o=e}let i=e[r];i||(e[r]=i={}),i[o]=!0},Vn=(e,t,n)=>{let r=t,o=n;return r>n&&(r=n,o=t),!!e[r]},Wn=(e,t,n,r)=>{const o=new Fn,i=e.graph(),a=Xn(i.nodesep,i.edgesep,r);return null==t||t.forEach((t=>{let r;null==t||t.forEach((t=>{const i=n[t];if(o.setNode(i),r){const s=n[r],u=o.edgeFromArgs(s,i);o.setEdge(s,i,Math.max(a(e,t,r),u||0))}r=t}))})),o};const Xn=(e,t,n)=>(r,o,i)=>{const a=r.node(o),s=r.node(i);let u,c=0;if(c+=a.width/2,a.hasOwnProperty("labelpos"))switch((a.labelpos||"").toLowerCase()){case"l":u=-a.width/2;break;case"r":u=a.width/2}if(u&&(c+=n?u:-u),u=0,c+=(a.dummy?t:e)/2,c+=(s.dummy?t:e)/2,c+=s.width/2,s.labelpos)switch((s.labelpos||"").toLowerCase()){case"l":u=s.width/2;break;case"r":u=-s.width/2}return u&&(c+=n?u:-u),u=0,c},Hn=(e,t)=>e.node(t).width||0,qn=e=>{var t;const n=jt(e);(e=>{const t=Ut(e),n=e.graph().ranksep;let r=0;null==t||t.forEach((t=>{const o=t.map((t=>e.node(t).height)),i=Math.max(...o,0);null==t||t.forEach((t=>{e.node(t).y=r+i/2})),r+=i+n}))})(n);const r=(e=>{const t=Ut(e),n=Object.assign(((e,t)=>{const n={};return(null==t?void 0:t.length)&&t.reduce(((t,r)=>{let o=0,i=0;const a=t.length,s=null==r?void 0:r[(null==r?void 0:r.length)-1];return null==r||r.forEach(((t,u)=>{var c;const l=Un(e,t),d=l?e.node(l).order:a;(l||t===s)&&(null===(c=r.slice(i,u+1))||void 0===c||c.forEach((t=>{var r;null===(r=e.predecessors(t))||void 0===r||r.forEach((r=>{var i;const a=e.node(r),s=a.order;!(s<o||d<s)||a.dummy&&(null===(i=e.node(t))||void 0===i?void 0:i.dummy)||Bn(n,r,t)}))})),i=u+1,o=d)})),r})),n})(e,t),((e,t)=>{const n={};function r(t,r){const o=function(e){return JSON.stringify(e.slice(1))}(t);r.get(o)||(function(t,r,o,i,a){var s,u;let c;for(let l=r;l<o;l++)c=t[l],(null===(s=e.node(c))||void 0===s?void 0:s.dummy)&&(null===(u=e.predecessors(c))||void 0===u||u.forEach((t=>{const r=e.node(t);r.dummy&&(r.order<i||r.order>a)&&Bn(n,t,c)})))}(...t),r.set(o,!0))}return(null==t?void 0:t.length)&&t.reduce(((t,n)=>{let o,i=-1,a=0;const s=new Map;return null==n||n.forEach(((u,c)=>{var l;if("border"===(null===(l=e.node(u))||void 0===l?void 0:l.dummy)){const t=e.predecessors(u)||[];t.length&&(o=e.node(t[0]).order,r([n,a,c,i,o],s),a=c,i=o)}r([n,a,n.length,o,t.length],s)})),n})),n})(e,t)),r={};let o=[];["u","d"].forEach((i=>{o="u"===i?t:Object.values(t).reverse(),["l","r"].forEach((t=>{"r"===t&&(o=o.map((e=>Object.values(e).reverse())));const a=("u"===i?e.predecessors:e.successors).bind(e),s=((e,t,n,r)=>{const o={},i={},a={};return null==t||t.forEach((e=>{null==e||e.forEach(((e,t)=>{o[e]=e,i[e]=e,a[e]=t}))})),null==t||t.forEach((e=>{let t=-1;null==e||e.forEach((e=>{let s=r(e);if(s.length){s=s.sort(((e,t)=>a[e]-a[t]));const r=(s.length-1)/2;for(let u=Math.floor(r),c=Math.ceil(r);u<=c;++u){const r=s[u];i[e]===e&&t<a[r]&&!Vn(n,e,r)&&(i[r]=e,i[e]=o[e]=o[r],t=a[r])}}}))})),{root:o,align:i}})(0,o,n,a),u=((e,t,n,r,o)=>{var i;const a={},s=Wn(e,t,n,o),u=o?"borderLeft":"borderRight",c=(e,t)=>{let n=s.nodes(),r=n.pop();const o={};for(;r;)o[r]?e(r):(o[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()};return c((e=>{a[e]=(s.inEdges(e)||[]).reduce(((e,t)=>Math.max(e,(a[t.v]||0)+s.edge(t))),0)}),s.predecessors.bind(s)),c((t=>{const n=(s.outEdges(t)||[]).reduce(((e,t)=>Math.min(e,(a[t.w]||0)-s.edge(t))),Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==u&&(a[t]=Math.max(a[t],n))}),s.successors.bind(s)),null===(i=Object.values(r))||void 0===i||i.forEach((e=>{a[e]=a[n[e]]})),a})(e,o,s.root,s.align,"r"===t);"r"===t&&Object.keys(u).forEach((e=>u[e]=-u[e])),r[i+t]=u}))}));const i=((e,t)=>Ht(Object.values(t),(t=>{var n;let r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(n=Object.keys(t))||void 0===n||n.forEach((n=>{const i=t[n],a=Hn(e,n)/2;r=Math.max(i+a,r),o=Math.min(i-a,o)})),r-o})))(e,r);return i&&function(e,t){const n=Object.values(t),r=Math.min(...n),o=Math.max(...n);["u","d"].forEach((n=>{["l","r"].forEach((i=>{const a=n+i,s=e[a];let u;if(s===t)return;const c=Object.values(s);u="l"===i?r-Math.min(...c):o-Math.max(...c),u&&(e[a]={},Object.keys(s).forEach((t=>{e[a][t]=s[t]+u})))}))}))}(r,i),((e,t)=>{const n={};return Object.keys(e.ul).forEach((r=>{if(t)n[r]=e[t.toLowerCase()][r];else{const t=Object.values(e).map((e=>e[r]));n[r]=(t[0]+t[1])/2}})),n})(r,e.graph().align)})(n);null===(t=Object.keys(r))||void 0===t||t.forEach((e=>{n.node(e).x=r[e]}))},Yn=(e,t,n)=>{t("    removeSelfEdges",(()=>{dr(e)})),t("    acyclic",(()=>{(e=>{const t="greedy"===e.graph().acyclicer?zt(e,(e=>t=>{var n;return(null===(n=e.edge(t))||void 0===n?void 0:n.weight)||1})(e)):(e=>{const t=[],n={},r={},o=i=>{var a;r[i]||(r[i]=!0,n[i]=!0,null===(a=e.outEdges(i))||void 0===a||a.forEach((e=>{n[e.w]?t.push(e):o(e.w)})),delete n[i])};return e.nodes().forEach(o),t})(e);null==t||t.forEach((t=>{const n=e.edge(t);e.removeEdgeObj(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,`rev-${Math.random()}`)}))})(e)})),t("    nestingGraph.run",(()=>{(e=>{var t;const n=Pt(e,"root",{},"_root"),r=(e=>{var t;const n={},r=(t,o)=>{const i=e.children(t);null==i||i.forEach((e=>r(e,o+1))),n[t]=o};return null===(t=e.children())||void 0===t||t.forEach((e=>r(e,1))),n})(e);let o=Math.max(...Object.values(r));Math.abs(o)===1/0&&(o=1);const i=o-1,a=2*i+1;e.graph().nestingRoot=n,e.edges().forEach((t=>{e.edge(t).minlen*=a}));const s=(e=>{let t=0;return e.edges().forEach((n=>{t+=e.edge(n).weight})),t})(e)+1;null===(t=e.children())||void 0===t||t.forEach((t=>{yn(e,n,a,s,i,r,t)})),e.graph().nodeRankFactor=a})(e)})),t("    rank",(()=>{vn(jt(e))})),t("    injectEdgeLabelProxies",(()=>{rr(e)})),t("    removeEmptyRanks",(()=>{(e=>{const t=e.nodes(),n=t.filter((t=>{var n;return void 0!==(null===(n=e.node(t))||void 0===n?void 0:n.rank)})).map((t=>e.node(t).rank)),r=Math.min(...n),o=[];t.forEach((t=>{var n;const i=((null===(n=e.node(t))||void 0===n?void 0:n.rank)||0)-r;o[i]||(o[i]=[]),o[i].push(t)}));let i=0;const a=e.graph().nodeRankFactor||0;for(let t=0;t<o.length;t++){const n=o[t];void 0===n?t%a!=0&&(i-=1):i&&(null==n||n.forEach((t=>{const n=e.node(t);n&&(n.rank=n.rank||0,n.rank+=i)})))}})(e)})),t("    nestingGraph.cleanup",(()=>{(e=>{const t=e.graph();t.nestingRoot&&e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach((t=>{e.edge(t).nestingEdge&&e.removeEdgeObj(t)}))})(e)})),t("    normalizeRanks",(()=>{(e=>{const t=e.nodes().filter((t=>{var n;return void 0!==(null===(n=e.node(t))||void 0===n?void 0:n.rank)})).map((t=>e.node(t).rank)),n=Math.min(...t);e.nodes().forEach((t=>{const r=e.node(t);r.hasOwnProperty("rank")&&n!==1/0&&(r.rank-=n)}))})(e)})),t("    assignRankMinMax",(()=>{or(e)})),t("    removeEdgeLabelProxies",(()=>{ir(e)})),t("    normalize.run",(()=>{qt(e)})),t("    parentDummyChains",(()=>{(e=>{var t;const n=(e=>{var t;const n={};let r=0;const o=t=>{var i;const a=r;null===(i=e.children(t))||void 0===i||i.forEach(o),n[t]={low:a,lim:r++}};return null===(t=e.children())||void 0===t||t.forEach(o),n})(e);null===(t=e.graph().dummyChains)||void 0===t||t.forEach((t=>{var r,o;let i=t,a=e.node(i);const s=a.edgeObj;if(!s)return;const u=((e,t,n,r)=>{const o=[],i=[],a=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim);let u,c;u=n;do{u=e.parent(u),o.push(u)}while(u&&(t[u].low>a||s>t[u].lim));for(c=u,u=r;u&&u!==c;)i.push(u),u=e.parent(u);return{lca:c,path:o.concat(i.reverse())}})(e,n,s.v,s.w),c=u.path,l=u.lca;let d=0,f=c[d],h=!0;for(;i!==s.w;){if(a=e.node(i),h){for(;f!==l&&(null===(r=e.node(f))||void 0===r?void 0:r.maxRank)<a.rank;)d++,f=c[d];f===l&&(h=!1)}if(!h){for(;d<c.length-1&&(null===(o=e.node(c[d+1]))||void 0===o?void 0:o.minRank)<=a.rank;)d++;f=c[d]}e.setParent(i,f),i=e.successors(i)[0]}}))})(e)})),t("    addBorderSegments",(()=>{(e=>{var t;const n=t=>{const r=e.children(t),o=e.node(t);if((null==r?void 0:r.length)&&r.forEach((e=>n(e))),o.hasOwnProperty("minRank")){o.borderLeft=[],o.borderRight=[];for(let n=o.minRank,r=o.maxRank+1;n<r;n+=1)bn(e,"borderLeft","_bl",t,o,n),bn(e,"borderRight","_br",t,o,n)}};null===(t=e.children())||void 0===t||t.forEach((e=>n(e)))})(e)})),n&&n.keepNodeOrder&&t("    initDataOrder",(()=>{((e,t)=>{const n=e.nodes().filter((t=>{var n;return!(null===(n=e.children(t))||void 0===n?void 0:n.length)})),r=n.map((t=>e.node(t).rank)),o=Math.max(...r),i=[];for(let e=0;e<o+1;e++)i[e]=[];null==t||t.forEach((t=>{const n=e.node(t);n&&!(null==n?void 0:n.dummy)&&(isNaN(n.rank)||(n.fixorder=i[n.rank].length,i[n.rank].push(t)))}))})(e,n.nodeOrder)})),t("    order",(()=>{((e,t)=>{const n=Vt(e),r=[],o=[];for(let e=1;e<n+1;e++)r.push(e);for(let e=n-1;e>-1;e--)o.push(e);const i=Gn(e,r,"inEdges"),a=Gn(e,o,"outEdges");let s=In(e);jn(e,s);let u,c=Number.POSITIVE_INFINITY;for(let n=0,r=0;r<4;++n,++r){Pn(n%2?i:a,n%4>=2,!1,t),s=Ut(e);const o=An(e,s);o<c&&(r=0,u=d(s),c=o)}s=In(e),jn(e,s);for(let n=0,r=0;r<4;++n,++r){Pn(n%2?i:a,n%4>=2,!0,t),s=Ut(e);const o=An(e,s);o<c&&(r=0,u=d(s),c=o)}jn(e,u)})(e,null==n?void 0:n.keepNodeOrder)})),t("    insertSelfEdges",(()=>{fr(e)})),t("    adjustCoordinateSystem",(()=>{(e=>{var t;const n=null===(t=e.graph().rankdir)||void 0===t?void 0:t.toLowerCase();"lr"!==n&&"rl"!==n||En(e)})(e)})),t("    position",(()=>{qn(e)})),t("    positionSelfEdges",(()=>{hr(e)})),t("    removeBorderNodes",(()=>{lr(e)})),t("    normalize.undo",(()=>{(e=>{var t;null===(t=e.graph().dummyChains)||void 0===t||t.forEach((t=>{let n=e.node(t);const r=n.edgeLabel;let o;n.edgeObj&&e.setEdgeObj(n.edgeObj,r);let i=t;for(;n.dummy;)o=e.successors(i)[0],e.removeNode(i),r.points.push({x:n.x,y:n.y}),"edge-label"===n.dummy&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),i=o,n=e.node(i)}))})(e)})),t("    fixupEdgeLabelCoords",(()=>{ur(e)})),t("    undoCoordinateSystem",(()=>{Sn(e)})),t("    translateGraph",(()=>{ar(e)})),t("    assignNodeIntersects",(()=>{sr(e)})),t("    reversePoints",(()=>{cr(e)})),t("    acyclic.undo",(()=>{(e=>{e.edges().forEach((t=>{const n=e.edge(t);if(n.reversed){e.removeEdgeObj(t);const r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}}))})(e)}))},Zn=["nodesep","edgesep","ranksep","marginx","marginy"],$n={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Kn=["acyclicer","ranker","rankdir","align"],Qn=["width","height","layer","fixorder"],Jn={width:0,height:0},er=["minlen","weight","width","height","labeloffset"],tr={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},nr=["labelpos"],rr=e=>{e.edges().forEach((t=>{const n=e.edge(t);if(n.width&&n.height){const n=e.node(t.v),r={e:t,rank:(e.node(t.w).rank-n.rank)/2+n.rank};Pt(e,"edge-proxy",r,"_ep")}}))},or=e=>{let t=0;e.nodes().forEach((n=>{var r,o;const i=e.node(n);i.borderTop&&(i.minRank=null===(r=e.node(i.borderTop))||void 0===r?void 0:r.rank,i.maxRank=null===(o=e.node(i.borderBottom))||void 0===o?void 0:o.rank,t=Math.max(t,i.maxRank||-1/0))})),e.graph().maxRank=t},ir=e=>{e.nodes().forEach((t=>{const n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}))},ar=e=>{let t,n,r=0,o=0;const i=e.graph(),a=i.marginx||0,s=i.marginy||0,u=e=>{if(!e)return;const i=e.x,a=e.y,s=e.width,u=e.height;isNaN(i)||isNaN(s)||(void 0===t&&(t=i-s/2),t=Math.min(t,i-s/2),r=Math.max(r,i+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),o=Math.max(o,a+u/2))};e.nodes().forEach((t=>{u(e.node(t))})),e.edges().forEach((t=>{const n=e.edge(t);(null==n?void 0:n.hasOwnProperty("x"))&&u(n)})),t-=a,n-=s,e.nodes().forEach((r=>{const o=e.node(r);o&&(o.x-=t,o.y-=n)})),e.edges().forEach((r=>{var o;const i=e.edge(r);null===(o=i.points)||void 0===o||o.forEach((e=>{e.x-=t,e.y-=n})),i.hasOwnProperty("x")&&(i.x-=t),i.hasOwnProperty("y")&&(i.y-=n)})),i.width=r-t+a,i.height=o-n+s},sr=e=>{e.edges().forEach((t=>{const n=e.edge(t),r=e.node(t.v),o=e.node(t.w);let i,a;n.points?(i=n.points[0],a=n.points[n.points.length-1]):(n.points=[],i=o,a=r),n.points.unshift(Ft(r,i)),n.points.push(Ft(o,a))}))},ur=e=>{e.edges().forEach((t=>{const n=e.edge(t);if(null==n?void 0:n.hasOwnProperty("x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))},cr=e=>{e.edges().forEach((t=>{var n;const r=e.edge(t);r.reversed&&(null===(n=r.points)||void 0===n||n.reverse())}))},lr=e=>{e.nodes().forEach((t=>{var n,r,o;if(null===(n=e.children(t))||void 0===n?void 0:n.length){const n=e.node(t),i=e.node(n.borderTop),a=e.node(n.borderBottom),s=e.node(n.borderLeft[(null===(r=n.borderLeft)||void 0===r?void 0:r.length)-1]),u=e.node(n.borderRight[(null===(o=n.borderRight)||void 0===o?void 0:o.length)-1]);n.width=Math.abs((null==u?void 0:u.x)-(null==s?void 0:s.x))||10,n.height=Math.abs((null==a?void 0:a.y)-(null==i?void 0:i.y))||10,n.x=((null==s?void 0:s.x)||0)+n.width/2,n.y=((null==i?void 0:i.y)||0)+n.height/2}})),e.nodes().forEach((t=>{var n;"border"===(null===(n=e.node(t))||void 0===n?void 0:n.dummy)&&e.removeNode(t)}))},dr=e=>{e.edges().forEach((t=>{if(t.v===t.w){const n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdgeObj(t)}}))},fr=e=>{const t=Ut(e);null==t||t.forEach((t=>{let n=0;null==t||t.forEach(((t,r)=>{var o;const i=e.node(t);i.order=r+n,null===(o=i.selfEdges)||void 0===o||o.forEach((t=>{Pt(e,"selfedge",{width:t.label.width,height:t.label.height,rank:i.rank,order:r+ ++n,e:t.e,label:t.label},"_se")})),delete i.selfEdges}))}))},hr=e=>{e.nodes().forEach((t=>{const n=e.node(t);if("selfedge"===n.dummy){const r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,a=n.x-o,s=r.height/2;e.setEdgeObj(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],n.label.x=n.x,n.label.y=n.y}}))},pr=(e,t)=>{const n={};return null==t||t.forEach((t=>{void 0!==e[t]&&(n[t]=+e[t])})),n},gr=(e={})=>{const t={};return Object.keys(e).forEach((n=>{t[n.toLowerCase()]=e[n]})),t},mr=(e,t)=>{const n=t&&t.debugTiming?Wt:Xt;n("layout",(()=>{t&&!t.keepNodeOrder&&t.prevGraph&&n("  inheritOrder",(()=>{var n,r;n=e,r=t.prevGraph,n.nodes().forEach((e=>{const t=n.node(e),o=r.node(e);void 0!==o?(t.fixorder=o._order,delete o._order):delete t.fixorder}))}));const r=n("  buildLayoutGraph",(()=>(e=>{const t=new Gt({multigraph:!0,compound:!0}),n=gr(e.graph()),r={};return null==Kn||Kn.forEach((e=>{void 0!==n[e]&&(r[e]=n[e])})),t.setGraph(Object.assign({},$n,pr(n,Zn),r)),e.nodes().forEach((n=>{const r=gr(e.node(n)),o=Object.assign(Object.assign({},Jn),r),i=pr(o,Qn);t.setNode(n,i),t.setParent(n,e.parent(n))})),e.edges().forEach((n=>{const r=gr(e.edge(n)),o={};null==nr||nr.forEach((e=>{void 0!==r[e]&&(o[e]=r[e])})),t.setEdgeObj(n,Object.assign({},tr,pr(r,er),o))})),t})(e)));t&&!1===t.edgeLabelSpace||n("  makeSpaceForEdgeLabels",(()=>{(e=>{const t=e.graph();t.ranksep||(t.ranksep=0),t.ranksep/=2,e.nodes().forEach((t=>{const n=e.node(t);isNaN(n.layer)||n.layer||(n.layer=0)})),e.edges().forEach((n=>{var r;const o=e.edge(n);o.minlen*=2,"c"!==(null===(r=o.labelpos)||void 0===r?void 0:r.toLowerCase())&&("TB"===t.rankdir||"BT"===t.rankdir?o.width+=o.labeloffset:o.height+=o.labeloffset)}))})(r)}));try{n("  runLayout",(()=>{Yn(r,n,t)}))}catch(e){if("Not possible to find intersection inside of the rectangle"===e.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",e);throw e}n("  updateInputGraph",(()=>{((e,t)=>{e.nodes().forEach((n=>{var r;const o=e.node(n);if(o){const e=t.node(n);o.x=e.x,o.y=e.y,o._order=e.order,o._rank=e.rank,(null===(r=t.children(n))||void 0===r?void 0:r.length)&&(o.width=e.width,o.height=e.height)}})),e.edges().forEach((n=>{const r=e.edge(n),o=t.edge(n);r.points=o?o.points:[],o&&o.hasOwnProperty("x")&&(r.x=o.x,r.y=o.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height})(e,r)}))}))};class vr extends i{constructor(e){super(),this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.radial=!1,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=e=>{const{nodes:t}=this,n=t.find((t=>t.id===e));return!n||!1!==n.layout},this.updateCfg(e)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}}execute(){var e,t,n;const r=this,{nodes:o,nodeSize:i,rankdir:c,combos:d,begin:h,radial:p,comboEdges:g=[],vedges:m=[]}=r;if(!o)return;const v=r.edges||[],y=new Gt({multigraph:!0,compound:!0});r.nodeMap={};const b={};let E;o.forEach((e=>{r.nodeMap[e.id]=e,e.comboId&&(b[e.comboId]=b[e.comboId]||[],b[e.comboId].push(e.id))})),E=i?s(i)?()=>i:()=>[i,i]:e=>e.size?s(e.size)?e.size:l(e.size)?[e.size.width||40,e.size.height||40]:[e.size,e.size]:[40,40];const w=x(r.ranksep,50,r.ranksepFunc),_=x(r.nodesep,50,r.nodesepFunc);let S=_,I=w;"LR"!==c&&"RL"!==c||(S=w,I=_),y.setDefaultEdgeLabel((()=>({}))),y.setGraph(r);const T={};let A;this.sortByCombo&&d&&d.forEach((e=>{if(T[e.id]=e,e.collapsed){const t=E(e),n=I(e),r=S(e),o=t[0]+2*r,i=t[1]+2*n;y.setNode(e.id,{width:o,height:i})}e.parentId&&(T[e.parentId]||y.setNode(e.parentId,{}),y.setParent(e.id,e.parentId))})),o.filter((e=>!1!==e.layout)).forEach((e=>{const t=E(e),n=I(e),r=S(e),o=t[0]+2*r,i=t[1]+2*n,a=e.layer;u(a)?y.setNode(e.id,{width:o,height:i,layer:a}):y.setNode(e.id,{width:o,height:i}),this.sortByCombo&&e.comboId&&(T[e.comboId]||(T[e.comboId]={id:e.comboId},y.setNode(e.comboId,{})),y.setParent(e.id,e.comboId))})),v.forEach((e=>{const t=f(e,"source"),n=f(e,"target");this.layoutNode(t)&&this.layoutNode(n)&&y.setEdge(t,n,{weight:e.weight||1})})),null===(e=null==g?void 0:g.concat(m||[]))||void 0===e||e.forEach((e=>{var t,n;const{source:r,target:o}=e,i=(null===(t=T[r])||void 0===t?void 0:t.collapsed)?[r]:b[r]||[r],a=(null===(n=T[o])||void 0===n?void 0:n.collapsed)?[o]:b[o]||[o];i.forEach((t=>{a.forEach((n=>{y.setEdge(t,n,{weight:e.weight||1})}))}))})),(null===(t=r.preset)||void 0===t?void 0:t.nodes)&&(A=new Gt({multigraph:!0,compound:!0}),r.preset.nodes.forEach((e=>{null==A||A.setNode(e.id,e)}))),mr(y,{prevGraph:A,edgeLabelSpace:r.edgeLabelSpace,keepNodeOrder:Boolean(!!r.nodeOrder),nodeOrder:r.nodeOrder});const N=[0,0];if(h){let e=1/0,t=1/0;y.nodes().forEach((n=>{const r=y.node(n);e>r.x&&(e=r.x),t>r.y&&(t=r.y)})),y.edges().forEach((n=>{var r;null===(r=y.edge(n).points)||void 0===r||r.forEach((n=>{e>n.x&&(e=n.x),t>n.y&&(t=n.y)}))})),N[0]=h[0]-e,N[1]=h[1]-t}const D="LR"===c||"RL"===c;if(p){const{focusNode:e,ranksep:t,getRadialPos:i}=this,s=a(e)?e:null==e?void 0:e.id,u=s?null===(n=y.node(s))||void 0===n?void 0:n._rank:0,c=[],l=D?"y":"x",d=D?"height":"width";let h=1/0,p=-1/0;y.nodes().forEach((e=>{const t=y.node(e),n=o.findIndex((t=>t.id===e));if(!o[n])return;const r=_(o[n]);if(0===u)c[t._rank]||(c[t._rank]={nodes:[],totalWidth:0,maxSize:-1/0}),c[t._rank].nodes.push(e),c[t._rank].totalWidth+=2*r+t[d],c[t._rank].maxSize<Math.max(t.width,t.height)&&(c[t._rank].maxSize=Math.max(t.width,t.height));else{const n=t._rank-u;if(0===n)c[n]||(c[n]={nodes:[],totalWidth:0,maxSize:-1/0}),c[n].nodes.push(e),c[n].totalWidth+=2*r+t[d],c[n].maxSize<Math.max(t.width,t.height)&&(c[n].maxSize=Math.max(t.width,t.height));else{const o=Math.abs(n);c[o]||(c[o]={left:[],right:[],totalWidth:0,maxSize:-1/0}),c[o].totalWidth+=2*r+t[d],c[o].maxSize<Math.max(t.width,t.height)&&(c[o].maxSize=Math.max(t.width,t.height)),n<0?c[o].left.push(e):c[o].right.push(e)}}const i=t[l]-t[d]/2-r,a=t[l]+t[d]/2+r;i<h&&(h=i),a>p&&(p=a)}));let g=t||50;const m={},b=(p-h)/.9,E=[.5*(h+p-b),.5*(h+p+b)],x=(e,t,n=-1/0,r=[0,1])=>{let a=n;return e.forEach((e=>{const n=y.node(e);m[e]=t;const{x:s,y:u}=i(n[l],E,b,t,r),c=o.findIndex((t=>t.id===e));if(!o[c])return;o[c].x=s+N[0],o[c].y=u+N[1],o[c]._order=n._order;const d=w(o[c]);a<d&&(a=d)})),a};let S=!0;c.forEach((e=>{var t,n,r,i,a,s,c;if(!(null===(t=null==e?void 0:e.nodes)||void 0===t?void 0:t.length)&&!(null===(n=null==e?void 0:e.left)||void 0===n?void 0:n.length)&&!(null===(r=null==e?void 0:e.right)||void 0===r?void 0:r.length))return;if(S&&1===e.nodes.length){const t=o.findIndex((t=>t.id===e.nodes[0]));if(t<=-1)return;return o[t].x=N[0],o[t].y=N[1],m[e.nodes[0]]=0,g=w(o[t]),void(S=!1)}g=Math.max(g,e.totalWidth/(2*Math.PI));let l=-1/0;if(0===u||(null===(i=e.nodes)||void 0===i?void 0:i.length))l=x(e.nodes,g,l,[0,1]);else{const t=(null===(a=e.left)||void 0===a?void 0:a.length)/((null===(s=e.left)||void 0===s?void 0:s.length)+(null===(c=e.right)||void 0===c?void 0:c.length));l=x(e.left,g,l,[0,t]),l=x(e.right,g,l,[t+.05,1])}g+=l,S=!1,e.maxSize})),y.edges().forEach((e=>{var t,n,o;const a=y.edge(e),s=v.findIndex((t=>{const n=f(t,"source"),r=f(t,"target");return n===e.v&&r===e.w}));if(!(s<=-1)&&r.edgeLabelSpace&&r.controlPoints&&"loop"!==v[s].type){const r="x"===l?"y":"x",u=null===(t=null==a?void 0:a.points)||void 0===t?void 0:t.slice(1,a.points.length-1),c=[],d=null===(n=y.node(e.v))||void 0===n?void 0:n[r],f=d-(null===(o=y.node(e.w))||void 0===o?void 0:o[r]),h=m[e.v],p=h-m[e.w];null==u||u.forEach((e=>{const t=(e[r]-d)/f*p+h,n=i(e[l],E,b,t);c.push({x:n.x+N[0],y:n.y+N[1]})})),v[s].controlPoints=c}}))}else{const e=new Set,t="BT"===c||"RL"===c?(e,t)=>t-e:(e,t)=>e-t;y.nodes().forEach((t=>{const n=y.node(t);if(!n)return;let r=this.nodeMap[t];r||(r=null==d?void 0:d.find((e=>e.id===t))),r&&(r.x=n.x+N[0],r.y=n.y+N[1],r._order=n._order,e.add(D?r.x:r.y))}));const n=Array.from(e).sort(t),o=D?(e,t)=>e.x!==t.x:(e,t)=>e.y!==t.y,i=D?(e,t,n)=>{const r=Math.max(t.y,n.y),o=Math.min(t.y,n.y);return e.filter((e=>e.y<=r&&e.y>=o))}:(e,t,n)=>{const r=Math.max(t.x,n.x),o=Math.min(t.x,n.x);return e.filter((e=>e.x<=r&&e.x>=o))};y.edges().forEach((e=>{const t=y.edge(e),a=v.findIndex((t=>{const n=f(t,"source"),r=f(t,"target");return n===e.v&&r===e.w}));if(!(a<=-1)&&r.edgeLabelSpace&&r.controlPoints&&"loop"!==v[a].type){const s=r.nodeMap[e.v],u=r.nodeMap[e.w];v[a].controlPoints=yr(null==t?void 0:t.points,s,u,n,D,o,i),v[a].controlPoints.forEach((e=>{e.x+=N[0],e.y+=N[1]}))}}))}return r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:v}}getRadialPos(e,t,n,r,o=[0,1]){let i=(e-t[0])/n;i=i*(o[1]-o[0])+o[0];const a=2*i*Math.PI;return{x:Math.cos(a)*r,y:Math.sin(a)*r}}getType(){return"dagre"}}const yr=(e,t,n,r,o,i,a)=>{let s=(null==e?void 0:e.slice(1,e.length-1))||[];if(t&&n){let{x:e,y:u}=t,{x:c,y:l}=n;if(o&&(e=t.y,u=t.x,c=n.y,l=n.x),l!==u&&e!==c){const d=r.indexOf(u),f=r[d+1];if(f){const e=s[0],t=o?{x:(u+f)/2,y:(null==e?void 0:e.y)||c}:{x:(null==e?void 0:e.x)||c,y:(u+f)/2};e&&!i(e,t)||s.unshift(t)}const h=r.indexOf(l),p=Math.abs(h-d);if(1===p)s=a(s,t,n),s.length||s.push(o?{x:(u+l)/2,y:e}:{x:e,y:(u+l)/2});else if(p>1){const t=r[h-1];if(t){const n=s[s.length-1],r=o?{x:(l+t)/2,y:(null==n?void 0:n.y)||c}:{x:(null==n?void 0:n.x)||e,y:(l+t)/2};n&&!i(n,r)||s.push(r)}}}}return s},br={graph:{meta:{rankDir:"TB",nodeSep:50,rankSep:50,edgeSep:5,align:void 0}},subScene:{meta:{paddingTop:20,paddingBottom:20,paddingLeft:20,paddingRight:20,labelHeight:20}},nodeSize:{meta:{width:100,maxLabelWidth:0,height:20},node:{width:80,height:20,labelOffset:10,maxLabelWidth:40},bridge:{width:5,height:5,radius:2,labelOffset:0}}};function Er(e={},t=br){var n,r,o,i;const a=JSON.parse(JSON.stringify(t)),s=(null===(n=null==e?void 0:e.graph)||void 0===n?void 0:n.meta)||{},u=(null===(r=null==e?void 0:e.subScene)||void 0===r?void 0:r.meta)||{},c=(null===(o=null==e?void 0:e.nodeSize)||void 0===o?void 0:o.meta)||{},l=(null===(i=null==e?void 0:e.nodeSize)||void 0===i?void 0:i.node)||{},d=a.nodeSize.bridge;return{graph:{meta:Object.assign(a.graph.meta,s)},subScene:{meta:Object.assign(a.subScene.meta,u)},nodeSize:{meta:Object.assign(a.nodeSize.meta,c),node:Object.assign(a.nodeSize.node,l),bridge:d}}}function wr(e){return`${e}`}const xr=wr("ROOT"),_r=wr("BRIDGE_GRAPH");var Sr,Ir,Tr,Ar;!function(e){e[e.META=0]="META",e[e.NODE=1]="NODE",e[e.BRIDGE=2]="BRIDGE"}(Sr||(Sr={})),function(e){e[e.INCLUDE=0]="INCLUDE",e[e.EXCLUDE=1]="EXCLUDE",e[e.UNSPECIFIED=2]="UNSPECIFIED"}(Ir||(Ir={})),function(e){e[e.META=0]="META",e[e.CORE=1]="CORE",e[e.BRIDGE=2]="BRIDGE"}(Tr||(Tr={})),function(e){e[e.META=0]="META",e[e.OP=1]="OP",e[e.SERIES=2]="SERIES"}(Ar||(Ar={}));var Nr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function Dr(e,t){return e(t={exports:{}},t.exports),t.exports}var kr=function(e,t){return e===t||e!=e&&t!=t},Mr=function(e,t){for(var n=e.length;n--;)if(kr(e[n][0],t))return n;return-1},Or=Array.prototype.splice;function Rr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Rr.prototype.clear=function(){this.__data__=[],this.size=0},Rr.prototype.delete=function(e){var t=this.__data__,n=Mr(t,e);return!(n<0||(n==t.length-1?t.pop():Or.call(t,n,1),--this.size,0))},Rr.prototype.get=function(e){var t=this.__data__,n=Mr(t,e);return n<0?void 0:t[n][1]},Rr.prototype.has=function(e){return Mr(this.__data__,e)>-1},Rr.prototype.set=function(e,t){var n=this.__data__,r=Mr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var Cr,Lr=Rr,zr="object"==typeof Nr&&Nr&&Nr.Object===Object&&Nr,Gr="object"==typeof self&&self&&self.Object===Object&&self,Pr=zr||Gr||Function("return this")(),jr=Pr.Symbol,Fr=Object.prototype,Ur=Fr.hasOwnProperty,Br=Fr.toString,Vr=jr?jr.toStringTag:void 0,Wr=Object.prototype.toString,Xr=jr?jr.toStringTag:void 0,Hr=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Xr&&Xr in Object(e)?function(e){var t=Ur.call(e,Vr),n=e[Vr];try{e[Vr]=void 0;var r=!0}catch(e){}var o=Br.call(e);return r&&(t?e[Vr]=n:delete e[Vr]),o}(e):function(e){return Wr.call(e)}(e)},qr=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Yr=function(e){if(!qr(e))return!1;var t=Hr(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Zr=Pr["__core-js_shared__"],$r=(Cr=/[^.]+$/.exec(Zr&&Zr.keys&&Zr.keys.IE_PROTO||""))?"Symbol(src)_1."+Cr:"",Kr=Function.prototype.toString,Qr=function(e){if(null!=e){try{return Kr.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Jr=/^\[object .+?Constructor\]$/,eo=Function.prototype,to=Object.prototype,no=eo.toString,ro=to.hasOwnProperty,oo=RegExp("^"+no.call(ro).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),io=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!qr(e)||function(e){return!!$r&&$r in e}(e))&&(Yr(e)?oo:Jr).test(Qr(e))}(n)?n:void 0},ao=io(Pr,"Map"),so=io(Object,"create"),uo=Object.prototype.hasOwnProperty,co=Object.prototype.hasOwnProperty;function lo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}lo.prototype.clear=function(){this.__data__=so?so(null):{},this.size=0},lo.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},lo.prototype.get=function(e){var t=this.__data__;if(so){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return uo.call(t,e)?t[e]:void 0},lo.prototype.has=function(e){var t=this.__data__;return so?void 0!==t[e]:co.call(t,e)},lo.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=so&&void 0===t?"__lodash_hash_undefined__":t,this};var fo=lo,ho=function(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map};function po(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}po.prototype.clear=function(){this.size=0,this.__data__={hash:new fo,map:new(ao||Lr),string:new fo}},po.prototype.delete=function(e){var t=ho(this,e).delete(e);return this.size-=t?1:0,t},po.prototype.get=function(e){return ho(this,e).get(e)},po.prototype.has=function(e){return ho(this,e).has(e)},po.prototype.set=function(e,t){var n=ho(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var go=po;function mo(e){var t=this.__data__=new Lr(e);this.size=t.size}mo.prototype.clear=function(){this.__data__=new Lr,this.size=0},mo.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},mo.prototype.get=function(e){return this.__data__.get(e)},mo.prototype.has=function(e){return this.__data__.has(e)},mo.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Lr){var r=n.__data__;if(!ao||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new go(r)}return n.set(e,t),this.size=n.size,this};var vo=mo,yo=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},bo=function(){try{var e=io(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Eo=function(e,t,n){"__proto__"==t&&bo?bo(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},wo=Object.prototype.hasOwnProperty,xo=function(e,t,n){var r=e[t];wo.call(e,t)&&kr(r,n)&&(void 0!==n||t in e)||Eo(e,t,n)},_o=function(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],u=r?r(n[s],e[s],s,n,e):void 0;void 0===u&&(u=e[s]),o?Eo(n,s,u):xo(n,s,u)}return n},So=function(e){return null!=e&&"object"==typeof e},Io=function(e){return So(e)&&"[object Arguments]"==Hr(e)},To=Object.prototype,Ao=To.hasOwnProperty,No=To.propertyIsEnumerable,Do=Io(function(){return arguments}())?Io:function(e){return So(e)&&Ao.call(e,"callee")&&!No.call(e,"callee")},ko=Array.isArray,Mo=function(){return!1},Oo=Dr((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,o=r&&r.exports===n?Pr.Buffer:void 0,i=(o?o.isBuffer:void 0)||Mo;e.exports=i})),Ro=/^(?:0|[1-9]\d*)$/,Co=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Ro.test(e))&&e>-1&&e%1==0&&e<t},Lo=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},zo={};zo["[object Float32Array]"]=zo["[object Float64Array]"]=zo["[object Int8Array]"]=zo["[object Int16Array]"]=zo["[object Int32Array]"]=zo["[object Uint8Array]"]=zo["[object Uint8ClampedArray]"]=zo["[object Uint16Array]"]=zo["[object Uint32Array]"]=!0,zo["[object Arguments]"]=zo["[object Array]"]=zo["[object ArrayBuffer]"]=zo["[object Boolean]"]=zo["[object DataView]"]=zo["[object Date]"]=zo["[object Error]"]=zo["[object Function]"]=zo["[object Map]"]=zo["[object Number]"]=zo["[object Object]"]=zo["[object RegExp]"]=zo["[object Set]"]=zo["[object String]"]=zo["[object WeakMap]"]=!1;var Go=function(e){return function(t){return e(t)}},Po=Dr((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,o=r&&r.exports===n&&zr.process,i=function(){try{return r&&r.require&&r.require("util").types||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=i})),jo=Po&&Po.isTypedArray,Fo=jo?Go(jo):function(e){return So(e)&&Lo(e.length)&&!!zo[Hr(e)]},Uo=Object.prototype.hasOwnProperty,Bo=function(e,t){var n=ko(e),r=!n&&Do(e),o=!n&&!r&&Oo(e),i=!n&&!r&&!o&&Fo(e),a=n||r||o||i,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=s.length;for(var c in e)!t&&!Uo.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Co(c,u))||s.push(c);return s},Vo=Object.prototype,Wo=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Vo)},Xo=function(e,t){return function(n){return e(t(n))}},Ho=Xo(Object.keys,Object),qo=Object.prototype.hasOwnProperty,Yo=function(e){if(!Wo(e))return Ho(e);var t=[];for(var n in Object(e))qo.call(e,n)&&"constructor"!=n&&t.push(n);return t},Zo=function(e){return null!=e&&Lo(e.length)&&!Yr(e)},$o=function(e){return Zo(e)?Bo(e):Yo(e)},Ko=Object.prototype.hasOwnProperty,Qo=function(e){return Zo(e)?Bo(e,!0):function(e){if(!qr(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Wo(e),n=[];for(var r in e)("constructor"!=r||!t&&Ko.call(e,r))&&n.push(r);return n}(e)},Jo=Dr((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,o=r&&r.exports===n?Pr.Buffer:void 0,i=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=i?i(n):new e.constructor(n);return e.copy(r),r}})),ei=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},ti=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i},ni=function(){return[]},ri=Object.prototype.propertyIsEnumerable,oi=Object.getOwnPropertySymbols,ii=oi?function(e){return null==e?[]:(e=Object(e),ti(oi(e),(function(t){return ri.call(e,t)})))}:ni,ai=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e},si=Xo(Object.getPrototypeOf,Object),ui=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)ai(t,ii(e)),e=si(e);return t}:ni,ci=function(e,t,n){var r=t(e);return ko(e)?r:ai(r,n(e))},li=function(e){return ci(e,$o,ii)},di=function(e){return ci(e,Qo,ui)},fi=io(Pr,"DataView"),hi=io(Pr,"Promise"),pi=io(Pr,"Set"),gi=io(Pr,"WeakMap"),mi=Qr(fi),vi=Qr(ao),yi=Qr(hi),bi=Qr(pi),Ei=Qr(gi),wi=Hr;(fi&&"[object DataView]"!=wi(new fi(new ArrayBuffer(1)))||ao&&"[object Map]"!=wi(new ao)||hi&&"[object Promise]"!=wi(hi.resolve())||pi&&"[object Set]"!=wi(new pi)||gi&&"[object WeakMap]"!=wi(new gi))&&(wi=function(e){var t=Hr(e),n="[object Object]"==t?e.constructor:void 0,r=n?Qr(n):"";if(r)switch(r){case mi:return"[object DataView]";case vi:return"[object Map]";case yi:return"[object Promise]";case bi:return"[object Set]";case Ei:return"[object WeakMap]"}return t});var xi=wi,_i=Object.prototype.hasOwnProperty,Si=Pr.Uint8Array,Ii=function(e){var t=new e.constructor(e.byteLength);return new Si(t).set(new Si(e)),t},Ti=/\w*$/,Ai=jr?jr.prototype:void 0,Ni=Ai?Ai.valueOf:void 0,Di=function(e,t){var n=t?Ii(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)},ki=Object.create,Mi=function(){function e(){}return function(t){if(!qr(t))return{};if(ki)return ki(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),Oi=function(e){return"function"!=typeof e.constructor||Wo(e)?{}:Mi(si(e))},Ri=Po&&Po.isMap,Ci=Ri?Go(Ri):function(e){return So(e)&&"[object Map]"==xi(e)},Li=Po&&Po.isSet,zi=Li?Go(Li):function(e){return So(e)&&"[object Set]"==xi(e)},Gi={};Gi["[object Arguments]"]=Gi["[object Array]"]=Gi["[object ArrayBuffer]"]=Gi["[object DataView]"]=Gi["[object Boolean]"]=Gi["[object Date]"]=Gi["[object Float32Array]"]=Gi["[object Float64Array]"]=Gi["[object Int8Array]"]=Gi["[object Int16Array]"]=Gi["[object Int32Array]"]=Gi["[object Map]"]=Gi["[object Number]"]=Gi["[object Object]"]=Gi["[object RegExp]"]=Gi["[object Set]"]=Gi["[object String]"]=Gi["[object Symbol]"]=Gi["[object Uint8Array]"]=Gi["[object Uint8ClampedArray]"]=Gi["[object Uint16Array]"]=Gi["[object Uint32Array]"]=!0,Gi["[object Error]"]=Gi["[object Function]"]=Gi["[object WeakMap]"]=!1;var Pi=function e(t,n,r,o,i,a){var s,u=1&n,c=2&n,l=4&n;if(r&&(s=i?r(t,o,i,a):r(t)),void 0!==s)return s;if(!qr(t))return t;var d=ko(t);if(d){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&_i.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(t),!u)return ei(t,s)}else{var f=xi(t),h="[object Function]"==f||"[object GeneratorFunction]"==f;if(Oo(t))return Jo(t,u);if("[object Object]"==f||"[object Arguments]"==f||h&&!i){if(s=c||h?{}:Oi(t),!u)return c?function(e,t){return _o(e,ui(e),t)}(t,function(e,t){return e&&_o(t,Qo(t),e)}(s,t)):function(e,t){return _o(e,ii(e),t)}(t,function(e,t){return e&&_o(t,$o(t),e)}(s,t))}else{if(!Gi[f])return i?t:{};s=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Ii(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return function(e,t){var n=t?Ii(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Di(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,Ti.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Symbol]":return function(e){return Ni?Object(Ni.call(e)):{}}(e)}}(t,f,u)}}a||(a=new vo);var p=a.get(t);if(p)return p;a.set(t,s),zi(t)?t.forEach((function(o){s.add(e(o,n,r,o,t,a))})):Ci(t)&&t.forEach((function(o,i){s.set(i,e(o,n,r,i,t,a))}));var g=d?void 0:(l?c?di:li:c?Qo:$o)(t);return yo(g||t,(function(o,i){g&&(o=t[i=o]),xo(s,i,e(o,n,r,i,t,a))})),s},ji=function(e){return function(){return e}},Fi=function(e,t,n){for(var r=-1,o=Object(e),i=n(e),a=i.length;a--;){var s=i[++r];if(!1===t(o[s],s,o))break}return e},Ui=function(e,t){return e&&Fi(e,t,$o)},Bi=function(e,t){return function(t,n){if(null==t)return t;if(!Zo(t))return e(t,n);for(var r=t.length,o=-1,i=Object(t);++o<r&&!1!==n(i[o],o,i););return t}}(Ui),Vi=function(e){return e},Wi=function(e){return"function"==typeof e?e:Vi},Xi=function(e,t){return(ko(e)?yo:Bi)(e,Wi(t))},Hi=Xi,qi=function(e,t){var n=[];return Bi(e,(function(e,r,o){t(e,r,o)&&n.push(e)})),n};function Yi(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new go;++t<n;)this.add(e[t])}Yi.prototype.add=Yi.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Yi.prototype.has=function(e){return this.__data__.has(e)};var Zi=Yi,$i=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},Ki=function(e,t){return e.has(t)},Qi=function(e,t,n,r,o,i){var a=1&n,s=e.length,u=t.length;if(s!=u&&!(a&&u>s))return!1;var c=i.get(e),l=i.get(t);if(c&&l)return c==t&&l==e;var d=-1,f=!0,h=2&n?new Zi:void 0;for(i.set(e,t),i.set(t,e);++d<s;){var p=e[d],g=t[d];if(r)var m=a?r(g,p,d,t,e,i):r(p,g,d,e,t,i);if(void 0!==m){if(m)continue;f=!1;break}if(h){if(!$i(t,(function(e,t){if(!Ki(h,t)&&(p===e||o(p,e,n,r,i)))return h.push(t)}))){f=!1;break}}else if(p!==g&&!o(p,g,n,r,i)){f=!1;break}}return i.delete(e),i.delete(t),f},Ji=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},ea=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},ta=jr?jr.prototype:void 0,na=ta?ta.valueOf:void 0,ra=function(e,t,n,r,o,i,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new Si(e),new Si(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return kr(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=Ji;case"[object Set]":var u=1&r;if(s||(s=ea),e.size!=t.size&&!u)return!1;var c=a.get(e);if(c)return c==t;r|=2,a.set(e,t);var l=Qi(s(e),s(t),r,o,i,a);return a.delete(e),l;case"[object Symbol]":if(na)return na.call(e)==na.call(t)}return!1},oa=Object.prototype.hasOwnProperty,ia=Object.prototype.hasOwnProperty,aa=function e(t,n,r,o,i){return t===n||(null==t||null==n||!So(t)&&!So(n)?t!=t&&n!=n:function(e,t,n,r,o,i){var a=ko(e),s=ko(t),u=a?"[object Array]":xi(e),c=s?"[object Array]":xi(t),l="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),d="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),f=u==c;if(f&&Oo(e)){if(!Oo(t))return!1;a=!0,l=!1}if(f&&!l)return i||(i=new vo),a||Fo(e)?Qi(e,t,n,r,o,i):ra(e,t,u,n,r,o,i);if(!(1&n)){var h=l&&ia.call(e,"__wrapped__"),p=d&&ia.call(t,"__wrapped__");if(h||p){var g=h?e.value():e,m=p?t.value():t;return i||(i=new vo),o(g,m,n,r,i)}}return!!f&&(i||(i=new vo),function(e,t,n,r,o,i){var a=1&n,s=li(e),u=s.length;if(u!=li(t).length&&!a)return!1;for(var c=u;c--;){var l=s[c];if(!(a?l in t:oa.call(t,l)))return!1}var d=i.get(e),f=i.get(t);if(d&&f)return d==t&&f==e;var h=!0;i.set(e,t),i.set(t,e);for(var p=a;++c<u;){var g=e[l=s[c]],m=t[l];if(r)var v=a?r(m,g,l,t,e,i):r(g,m,l,e,t,i);if(!(void 0===v?g===m||o(g,m,n,r,i):v)){h=!1;break}p||(p="constructor"==l)}if(h&&!p){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(h=!1)}return i.delete(e),i.delete(t),h}(e,t,n,r,o,i))}(t,n,r,o,e,i))},sa=function(e){return e==e&&!qr(e)},ua=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}},ca=function(e){return"symbol"==typeof e||So(e)&&"[object Symbol]"==Hr(e)},la=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,da=/^\w*$/,fa=function(e,t){if(ko(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ca(e))||da.test(e)||!la.test(e)||null!=t&&e in Object(t)};function ha(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(ha.Cache||go),n}ha.Cache=go;var pa,ga=ha,ma=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,va=/\\(\\)?/g,ya=function(e){var t=ga((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ma,(function(e,n,r,o){t.push(r?o.replace(va,"$1"):n||e)})),t}),(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}(),ba=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o},Ea=jr?jr.prototype:void 0,wa=Ea?Ea.toString:void 0,xa=function e(t){if("string"==typeof t)return t;if(ko(t))return ba(t,e)+"";if(ca(t))return wa?wa.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n},_a=function(e){return null==e?"":xa(e)},Sa=function(e,t){return ko(e)?e:fa(e,t)?[e]:ya(_a(e))},Ia=function(e){if("string"==typeof e||ca(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},Ta=function(e,t){for(var n=0,r=(t=Sa(t,e)).length;null!=e&&n<r;)e=e[Ia(t[n++])];return n&&n==r?e:void 0},Aa=function(e,t){return null!=e&&t in Object(e)},Na=function(e,t,n){for(var r=-1,o=(t=Sa(t,e)).length,i=!1;++r<o;){var a=Ia(t[r]);if(!(i=null!=e&&n(e,a)))break;e=e[a]}return i||++r!=o?i:!!(o=null==e?0:e.length)&&Lo(o)&&Co(a,o)&&(ko(e)||Do(e))},Da=function(e,t){return null!=e&&Na(e,t,Aa)},ka=function(e){return function(t){return null==t?void 0:t[e]}},Ma=function(e){return"function"==typeof e?e:null==e?Vi:"object"==typeof e?ko(e)?function(e,t){return fa(e)&&sa(t)?ua(Ia(e),t):function(n){var r=function(e,t,n){var r=null==e?void 0:Ta(e,t);return void 0===r?void 0:r}(n,e);return void 0===r&&r===t?Da(n,e):aa(t,r,3)}}(e[0],e[1]):function(e){var t=function(e){for(var t=$o(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,sa(o)]}return t}(e);return 1==t.length&&t[0][2]?ua(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,r){var o=n.length,i=o;if(null==e)return!i;for(e=Object(e);o--;){var a=n[o];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++o<i;){var s=(a=n[o])[0],u=e[s],c=a[1];if(a[2]){if(void 0===u&&!(s in e))return!1}else{var l,d=new vo;if(!(void 0===l?aa(c,u,3,r,d):l))return!1}}return!0}(n,0,t)}}(e):function(e){return fa(e)?ka(Ia(e)):function(e){return function(t){return Ta(t,e)}}(e)}(e)},Oa=function(e,t){return(ko(e)?ti:qi)(e,Ma(t))},Ra=Object.prototype.hasOwnProperty,Ca=function(e,t){return null!=e&&Ra.call(e,t)},La=function(e,t){return null!=e&&Na(e,t,Ca)},za=Object.prototype.hasOwnProperty,Ga=function(e){return void 0===e},Pa=function(e,t){var n=-1,r=Zo(e)?Array(e.length):[];return Bi(e,(function(e,o,i){r[++n]=t(e,o,i)})),r},ja=function(e,t){return(ko(e)?ba:Pa)(e,Ma(t))},Fa=function(e,t,n,r){var o=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n},Ua=function(e,t,n,r,o){return o(e,(function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)})),n},Ba=function(e,t,n){var r=ko(e)?Fa:Ua,o=arguments.length<3;return r(e,Ma(t),n,o,Bi)},Va=ka("length"),Wa=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),Xa="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ha="\\ud83c[\\udffb-\\udfff]",qa="[^\\ud800-\\udfff]",Ya="(?:\\ud83c[\\udde6-\\uddff]){2}",Za="[\\ud800-\\udbff][\\udc00-\\udfff]",$a="(?:"+Xa+"|"+Ha+")?",Ka="[\\ufe0e\\ufe0f]?"+$a+"(?:\\u200d(?:"+[qa,Ya,Za].join("|")+")[\\ufe0e\\ufe0f]?"+$a+")*",Qa="(?:"+[qa+Xa+"?",Xa,Ya,Za,"[\\ud800-\\udfff]"].join("|")+")",Ja=RegExp(Ha+"(?="+Ha+")|"+Qa+Ka,"g"),es=jr?jr.isConcatSpreadable:void 0,ts=function(e){return ko(e)||Do(e)||!!(es&&e&&e[es])},ns=function e(t,n,r,o,i){var a=-1,s=t.length;for(r||(r=ts),i||(i=[]);++a<s;){var u=t[a];n>0&&r(u)?n>1?e(u,n-1,r,o,i):ai(i,u):o||(i[i.length]=u)}return i},rs=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},os=Math.max,is=function(e,t,n){return t=os(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=os(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(a),rs(e,this,s)}},as=bo?function(e,t){return bo(e,"toString",{configurable:!0,enumerable:!1,value:ji(t),writable:!0})}:Vi,ss=Date.now,us=function(e){var t=0,n=0;return function(){var r=ss(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(as),cs=function(e,t){return us(is(e,t,Vi),e+"")},ls=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1},ds=function(e){return e!=e},fs=function(e,t){return!(null==e||!e.length)&&function(e,t,n){return t==t?function(e,t,n){for(var r=-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t):ls(e,ds,0)}(e,t)>-1},hs=pi&&1/ea(new pi([,-0]))[1]==1/0?function(e){return new pi(e)}:function(){},ps=function(e){return So(e)&&Zo(e)},gs=cs((function(e){return function(e,t,n){var r=-1,o=fs,i=e.length,a=!0,s=[],u=s;if(i>=200){var c=hs(e);if(c)return ea(c);a=!1,o=Ki,u=new Zi}else u=s;e:for(;++r<i;){var l=e[r],d=l;if(l=0!==l?l:0,a&&d==d){for(var f=u.length;f--;)if(u[f]===d)continue e;s.push(l)}else o(u,d,n)||(u!==s&&u.push(d),s.push(l))}return s}(ns(e,1,ps,!0))})),ms=function(e){return null==e?[]:function(e,t){return ba(t,(function(t){return e[t]}))}(e,$o(e))};try{pa={clone:function(e){return Pi(e,4)},constant:ji,each:Hi,filter:Oa,has:La,isArray:ko,isEmpty:function(e){if(null==e)return!0;if(Zo(e)&&(ko(e)||"string"==typeof e||"function"==typeof e.splice||Oo(e)||Fo(e)||Do(e)))return!e.length;var t=xi(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(Wo(e))return!Yo(e).length;for(var n in e)if(za.call(e,n))return!1;return!0},isFunction:Yr,isUndefined:Ga,keys:$o,map:ja,reduce:Ba,size:function(e){if(null==e)return 0;if(Zo(e))return function(e){return"string"==typeof e||!ko(e)&&So(e)&&"[object String]"==Hr(e)}(e)?function(e){return function(e){return Wa.test(e)}(e)?function(e){for(var t=Ja.lastIndex=0;Ja.test(e);)++t;return t}(e):Va(e)}(e):e.length;var t=xi(e);return"[object Map]"==t||"[object Set]"==t?e.size:Yo(e).length},transform:function(e,t,n){var r=ko(e),o=r||Oo(e)||Fo(e);if(t=Ma(t),null==n){var i=e&&e.constructor;n=o?r?new i:[]:qr(e)&&Yr(i)?Mi(si(e)):{}}return(o?yo:Ui)(e,(function(e,r,o){return t(n,e,r,o)})),n},union:gs,values:ms}}catch(br){}pa||(pa=window._);var vs=pa,ys=bs;function bs(e){this._isDirected=!vs.has(e,"directed")||e.directed,this._isMultigraph=!!vs.has(e,"multigraph")&&e.multigraph,this._isCompound=!!vs.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=vs.constant(void 0),this._defaultEdgeLabelFn=vs.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function Es(e,t){e[t]?e[t]++:e[t]=1}function ws(e,t){--e[t]||delete e[t]}function xs(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var a=o;o=i,i=a}return o+""+i+""+(vs.isUndefined(r)?"\0":r)}function _s(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var a=o;o=i,i=a}var s={v:o,w:i};return r&&(s.name=r),s}function Ss(e,t){return xs(e,t.v,t.w,t.name)}bs.prototype._nodeCount=0,bs.prototype._edgeCount=0,bs.prototype.isDirected=function(){return this._isDirected},bs.prototype.isMultigraph=function(){return this._isMultigraph},bs.prototype.isCompound=function(){return this._isCompound},bs.prototype.setGraph=function(e){return this._label=e,this},bs.prototype.graph=function(){return this._label},bs.prototype.setDefaultNodeLabel=function(e){return vs.isFunction(e)||(e=vs.constant(e)),this._defaultNodeLabelFn=e,this},bs.prototype.nodeCount=function(){return this._nodeCount},bs.prototype.nodes=function(){return vs.keys(this._nodes)},bs.prototype.sources=function(){var e=this;return vs.filter(this.nodes(),(function(t){return vs.isEmpty(e._in[t])}))},bs.prototype.sinks=function(){var e=this;return vs.filter(this.nodes(),(function(t){return vs.isEmpty(e._out[t])}))},bs.prototype.setNodes=function(e,t){var n=arguments,r=this;return vs.each(e,(function(e){n.length>1?r.setNode(e,t):r.setNode(e)})),this},bs.prototype.setNode=function(e,t){return vs.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]="\0",this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},bs.prototype.node=function(e){return this._nodes[e]},bs.prototype.hasNode=function(e){return vs.has(this._nodes,e)},bs.prototype.removeNode=function(e){var t=this;if(vs.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],vs.each(this.children(e),(function(e){t.setParent(e)})),delete this._children[e]),vs.each(vs.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],vs.each(vs.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},bs.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(vs.isUndefined(t))t="\0";else{for(var n=t+="";!vs.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},bs.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},bs.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if("\0"!==t)return t}},bs.prototype.children=function(e){if(vs.isUndefined(e)&&(e="\0"),this._isCompound){var t=this._children[e];if(t)return vs.keys(t)}else{if("\0"===e)return this.nodes();if(this.hasNode(e))return[]}},bs.prototype.predecessors=function(e){var t=this._preds[e];if(t)return vs.keys(t)},bs.prototype.successors=function(e){var t=this._sucs[e];if(t)return vs.keys(t)},bs.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return vs.union(t,this.successors(e))},bs.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},bs.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;vs.each(this._nodes,(function(n,r){e(r)&&t.setNode(r,n)})),vs.each(this._edgeObjs,(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))}));var r={};function o(e){var i=n.parent(e);return void 0===i||t.hasNode(i)?(r[e]=i,i):i in r?r[i]:o(i)}return this._isCompound&&vs.each(t.nodes(),(function(e){t.setParent(e,o(e))})),t},bs.prototype.setDefaultEdgeLabel=function(e){return vs.isFunction(e)||(e=vs.constant(e)),this._defaultEdgeLabelFn=e,this},bs.prototype.edgeCount=function(){return this._edgeCount},bs.prototype.edges=function(){return vs.values(this._edgeObjs)},bs.prototype.setPath=function(e,t){var n=this,r=arguments;return vs.reduce(e,(function(e,o){return r.length>1?n.setEdge(e,o,t):n.setEdge(e,o),o})),this},bs.prototype.setEdge=function(){var e,t,n,r,o=!1,i=arguments[0];"object"==typeof i&&null!==i&&"v"in i?(e=i.v,t=i.w,n=i.name,2===arguments.length&&(r=arguments[1],o=!0)):(e=i,t=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],o=!0)),e=""+e,t=""+t,vs.isUndefined(n)||(n=""+n);var a=xs(this._isDirected,e,t,n);if(vs.has(this._edgeLabels,a))return o&&(this._edgeLabels[a]=r),this;if(!vs.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[a]=o?r:this._defaultEdgeLabelFn(e,t,n);var s=_s(this._isDirected,e,t,n);return e=s.v,t=s.w,Object.freeze(s),this._edgeObjs[a]=s,Es(this._preds[t],e),Es(this._sucs[e],t),this._in[t][a]=s,this._out[e][a]=s,this._edgeCount++,this},bs.prototype.edge=function(e,t,n){var r=1===arguments.length?Ss(this._isDirected,arguments[0]):xs(this._isDirected,e,t,n);return this._edgeLabels[r]},bs.prototype.hasEdge=function(e,t,n){var r=1===arguments.length?Ss(this._isDirected,arguments[0]):xs(this._isDirected,e,t,n);return vs.has(this._edgeLabels,r)},bs.prototype.removeEdge=function(e,t,n){var r=1===arguments.length?Ss(this._isDirected,arguments[0]):xs(this._isDirected,e,t,n),o=this._edgeObjs[r];return o&&(e=o.v,t=o.w,delete this._edgeLabels[r],delete this._edgeObjs[r],ws(this._preds[t],e),ws(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},bs.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var r=vs.values(n);return t?vs.filter(r,(function(e){return e.v===t})):r}},bs.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var r=vs.values(n);return t?vs.filter(r,(function(e){return e.w===t})):r}},bs.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))};var Is={Graph:ys,version:"2.1.8"},Ts={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:As(e),edges:Ns(e)};return vs.isUndefined(e.graph())||(t.value=vs.clone(e.graph())),t},read:function(e){var t=new ys(e.options).setGraph(e.value);return vs.each(e.nodes,(function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)})),vs.each(e.edges,(function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),t}};function As(e){return vs.map(e.nodes(),(function(t){var n=e.node(t),r=e.parent(t),o={v:t};return vs.isUndefined(n)||(o.value=n),vs.isUndefined(r)||(o.parent=r),o}))}function Ns(e){return vs.map(e.edges(),(function(t){var n=e.edge(t),r={v:t.v,w:t.w};return vs.isUndefined(t.name)||(r.name=t.name),vs.isUndefined(n)||(r.value=n),r}))}var Ds=ks;function ks(){this._arr=[],this._keyIndices={}}ks.prototype.size=function(){return this._arr.length},ks.prototype.keys=function(){return this._arr.map((function(e){return e.key}))},ks.prototype.has=function(e){return vs.has(this._keyIndices,e)},ks.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},ks.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},ks.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!vs.has(n,e)){var r=this._arr,o=r.length;return n[e]=o,r.push({key:e,priority:t}),this._decrease(o),!0}return!1},ks.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},ks.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},ks.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,o=e;n<t.length&&(o=t[n].priority<t[o].priority?n:o,r<t.length&&(o=t[r].priority<t[o].priority?r:o),o!==e&&(this._swap(e,o),this._heapify(o)))},ks.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t},ks.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,o=n[e],i=n[t];n[e]=i,n[t]=o,r[i.key]=e,r[o.key]=t};var Ms=function(e,t,n,r){return function(e,t,n,r){var o,i,a={},s=new Ds,u=function(e){var t=e.v!==o?e.v:e.w,r=a[t],u=n(e),c=i.distance+u;if(u<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+u);c<r.distance&&(r.distance=c,r.predecessor=o,s.decrease(t,c))};for(e.nodes().forEach((function(e){var n=e===t?0:Number.POSITIVE_INFINITY;a[e]={distance:n},s.add(e,n)}));s.size()>0&&(o=s.removeMin(),(i=a[o]).distance!==Number.POSITIVE_INFINITY);)r(o).forEach(u);return a}(e,String(t),n||Os,r||function(t){return e.outEdges(t)})},Os=vs.constant(1),Rs=function(e){var t=0,n=[],r={},o=[];function i(a){var s=r[a]={onStack:!0,lowlink:t,index:t++};if(n.push(a),e.successors(a).forEach((function(e){vs.has(r,e)?r[e].onStack&&(s.lowlink=Math.min(s.lowlink,r[e].index)):(i(e),s.lowlink=Math.min(s.lowlink,r[e].lowlink))})),s.lowlink===s.index){var u,c=[];do{u=n.pop(),r[u].onStack=!1,c.push(u)}while(a!==u);o.push(c)}}return e.nodes().forEach((function(e){vs.has(r,e)||i(e)})),o},Cs=vs.constant(1),Ls=zs;function zs(e){var t={},n={},r=[];if(vs.each(e.sinks(),(function o(i){if(vs.has(n,i))throw new Gs;vs.has(t,i)||(n[i]=!0,t[i]=!0,vs.each(e.predecessors(i),o),delete n[i],r.push(i))})),vs.size(t)!==e.nodeCount())throw new Gs;return r}function Gs(){}zs.CycleException=Gs,Gs.prototype=new Error;var Ps=function(e,t,n){vs.isArray(t)||(t=[t]);var r=(e.isDirected()?e.successors:e.neighbors).bind(e),o=[],i={};return vs.each(t,(function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);js(e,t,"post"===n,i,r,o)})),o};function js(e,t,n,r,o,i){vs.has(r,t)||(r[t]=!0,n||i.push(t),vs.each(o(t),(function(t){js(e,t,n,r,o,i)})),n&&i.push(t))}var Fs,Us={Graph:Is.Graph,json:Ts,alg:{components:function(e){var t,n={},r=[];function o(r){vs.has(n,r)||(n[r]=!0,t.push(r),vs.each(e.successors(r),o),vs.each(e.predecessors(r),o))}return vs.each(e.nodes(),(function(e){t=[],o(e),t.length&&r.push(t)})),r},dijkstra:Ms,dijkstraAll:function(e,t,n){return vs.transform(e.nodes(),(function(r,o){r[o]=Ms(e,o,t,n)}),{})},findCycles:function(e){return vs.filter(Rs(e),(function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))},floydWarshall:function(e,t,n){return function(e,t,n){var r={},o=e.nodes();return o.forEach((function(e){r[e]={},r[e][e]={distance:0},o.forEach((function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})})),n(e).forEach((function(n){var o=n.v===e?n.w:n.v,i=t(n);r[e][o]={distance:i,predecessor:e}}))})),o.forEach((function(e){var t=r[e];o.forEach((function(n){var i=r[n];o.forEach((function(n){var r=i[e],o=t[n],a=i[n],s=r.distance+o.distance;s<a.distance&&(a.distance=s,a.predecessor=o.predecessor)}))}))})),r}(e,t||Cs,n||function(t){return e.outEdges(t)})},isAcyclic:function(e){try{Ls(e)}catch(e){if(e instanceof Ls.CycleException)return!1;throw e}return!0},postorder:function(e,t){return Ps(e,t,"post")},preorder:function(e,t){return Ps(e,t,"pre")},prim:function(e,t){var n,r=new ys,o={},i=new Ds;function a(e){var r=e.v===n?e.w:e.v,a=i.priority(r);if(void 0!==a){var s=t(e);s<a&&(o[r]=n,i.decrease(r,s))}}if(0===e.nodeCount())return r;vs.each(e.nodes(),(function(e){i.add(e,Number.POSITIVE_INFINITY),r.setNode(e)})),i.decrease(e.nodes()[0],0);for(var s=!1;i.size()>0;){if(n=i.removeMin(),vs.has(o,n))r.setEdge(n,o[n]);else{if(s)throw new Error("Input graph is not connected: "+e);s=!0}e.nodeEdges(n).forEach(a)}return r},tarjan:Rs,topsort:Ls},version:Is.version};try{Fs=Us}catch(br){}Fs||(Fs=window.graphlib);var Bs,Vs=Fs,Ws=function(e,t,n){if(!qr(n))return!1;var r=typeof t;return!!("number"==r?Zo(n)&&Co(t,n.length):"string"==r&&t in n)&&kr(n[t],e)},Xs=Object.prototype,Hs=Xs.hasOwnProperty,qs=cs((function(e,t){e=Object(e);var n=-1,r=t.length,o=r>2?t[2]:void 0;for(o&&Ws(t[0],t[1],o)&&(r=1);++n<r;)for(var i=t[n],a=Qo(i),s=-1,u=a.length;++s<u;){var c=a[s],l=e[c];(void 0===l||kr(l,Xs[c])&&!Hs.call(e,c))&&(e[c]=i[c])}return e})),Ys=/^\s+|\s+$/g,Zs=/^[-+]0x[0-9a-f]+$/i,$s=/^0b[01]+$/i,Ks=/^0o[0-7]+$/i,Qs=parseInt,Js=function(e){return e?1/0===(e=function(e){if("number"==typeof e)return e;if(ca(e))return NaN;if(qr(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=qr(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Ys,"");var n=$s.test(e);return n||Ks.test(e)?Qs(e.slice(2),n?2:8):Zs.test(e)?NaN:+e}(e))||-1/0===e?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},eu=Math.max,tu=function(e,t,n){var r=Object(e);if(!Zo(e)){var o=Ma(t);e=$o(e),t=function(e){return o(r[e],e,r)}}var i=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:function(e){var t=Js(e),n=t%1;return t==t?n?t-n:t:0}(n);return o<0&&(o=eu(r+o,0)),ls(e,Ma(t),o)}(e,t,n);return i>-1?r[o?e[i]:i]:void 0},nu=function(e){return null!=e&&e.length?ns(e,1):[]},ru=function(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],a=t(i);if(null!=a&&(void 0===s?a==a&&!ca(a):n(a,s)))var s=a,u=i}return u},ou=function(e,t){return e>t},iu=function(e,t,n){(void 0!==n&&!kr(e[t],n)||void 0===n&&!(t in e))&&Eo(e,t,n)},au=Function.prototype,su=Object.prototype,uu=au.toString,cu=su.hasOwnProperty,lu=uu.call(Object),du=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},fu=function e(t,n,r,o,i){t!==n&&Fi(n,(function(a,s){if(i||(i=new vo),qr(a))!function(e,t,n,r,o,i,a){var s=du(e,n),u=du(t,n),c=a.get(u);if(c)iu(e,n,c);else{var l=i?i(s,u,n+"",e,t,a):void 0,d=void 0===l;if(d){var f=ko(u),h=!f&&Oo(u),p=!f&&!h&&Fo(u);l=u,f||h||p?ko(s)?l=s:ps(s)?l=ei(s):h?(d=!1,l=Jo(u,!0)):p?(d=!1,l=Di(u,!0)):l=[]:function(e){if(!So(e)||"[object Object]"!=Hr(e))return!1;var t=si(e);if(null===t)return!0;var n=cu.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&uu.call(n)==lu}(u)||Do(u)?(l=s,Do(s)?l=function(e){return _o(e,Qo(e))}(s):qr(s)&&!Yr(s)||(l=Oi(u))):d=!1}d&&(a.set(u,l),o(l,u,r,i,a),a.delete(u)),iu(e,n,l)}}(t,n,s,r,e,o,i);else{var u=o?o(du(t,s),a,s+"",t,n,i):void 0;void 0===u&&(u=a),iu(t,s,u)}}),Qo)},hu=function(e){return cs((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&Ws(n[0],n[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r)}return t}))}((function(e,t,n){fu(e,t,n)})),pu=function(e,t){return e<t},gu=function(e,t,n,r){if(!qr(e))return e;for(var o=-1,i=(t=Sa(t,e)).length,a=i-1,s=e;null!=s&&++o<i;){var u=Ia(t[o]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(o!=a){var l=s[u];void 0===(c=r?r(l,u,s):void 0)&&(c=qr(l)?l:Co(t[o+1])?[]:{})}xo(s,u,c),s=s[u]}return e},mu=function(e){return us(is(e,void 0,nu),e+"")}((function(e,t){return null==e?{}:function(e,t){return function(e,t,n){for(var r=-1,o=t.length,i={};++r<o;){var a=t[r],s=Ta(e,a);n(0,a)&&gu(i,Sa(a,e),s)}return i}(e,t,(function(t,n){return Da(e,n)}))}(e,t)})),vu=Math.ceil,yu=Math.max,bu=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,o=e==e,i=ca(e),a=void 0!==t,s=null===t,u=t==t,c=ca(t);if(!s&&!c&&!i&&e>t||i&&a&&u&&!s&&!c||r&&a&&u||!n&&u||!o)return 1;if(!r&&!i&&!c&&e<t||c&&n&&o&&!r&&!i||s&&n&&o||!a&&o||!u)return-1}return 0},Eu=cs((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Ws(e,t[0],t[1])?t=[]:n>2&&Ws(t[0],t[1],t[2])&&(t=[t[0]]),function(e,t,n){t=t.length?ba(t,(function(e){return ko(e)?function(t){return Ta(t,1===e.length?e[0]:e)}:e})):[Vi];var r=-1;t=ba(t,Go(Ma));var o=Pa(e,(function(e,n,o){return{criteria:ba(t,(function(t){return t(e)})),index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(o,(function(e,t){return function(e,t,n){for(var r=-1,o=e.criteria,i=t.criteria,a=o.length,s=n.length;++r<a;){var u=bu(o[r],i[r]);if(u)return r>=s?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}(e,ns(t,1),[])})),wu=0;try{Bs={cloneDeep:function(e){return Pi(e,5)},constant:ji,defaults:qs,each:Hi,filter:Oa,find:tu,flatten:nu,forEach:Xi,forIn:function(e,t){return null==e?e:Fi(e,Wi(t),Qo)},has:La,isUndefined:Ga,last:function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},map:ja,mapValues:function(e,t){var n={};return t=Ma(t),Ui(e,(function(e,r,o){Eo(n,r,t(e,r,o))})),n},max:function(e){return e&&e.length?ru(e,Vi,ou):void 0},merge:hu,min:function(e){return e&&e.length?ru(e,Vi,pu):void 0},minBy:function(e,t){return e&&e.length?ru(e,Ma(t),pu):void 0},now:function(){return Pr.Date.now()},pick:mu,range:function(e,t,n){return n&&"number"!=typeof n&&Ws(e,t,n)&&(t=n=void 0),e=Js(e),void 0===t?(t=e,e=0):t=Js(t),function(e,t,n,r){for(var o=-1,i=yu(vu((t-e)/(n||1)),0),a=Array(i);i--;)a[++o]=e,e+=n;return a}(e,t,n=void 0===n?e<t?1:-1:Js(n))},reduce:Ba,sortBy:Eu,uniqueId:function(e){var t=++wu;return _a(e)+t},values:ms,zipObject:function(e,t){return function(e,t,n){for(var r=-1,o=e.length,i=t.length,a={};++r<o;){var s=r<i?t[r]:void 0;n(a,e[r],s)}return a}(e||[],t||[],xo)}}}catch(br){}Bs||(Bs=window._);var xu=Bs,_u=Su;function Su(){var e={};e._next=e._prev=e,this._sentinel=e}function Iu(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Tu(e,t){if("_next"!==e&&"_prev"!==e)return t}Su.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return Iu(t),t},Su.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&Iu(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},Su.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,Tu)),n=n._prev;return"["+e.join(", ")+"]"};var Au=Vs.Graph,Nu=xu.constant(1);function Du(e,t,n,r,o){var i=o?[]:void 0;return xu.forEach(e.inEdges(r.v),(function(r){var a=e.edge(r),s=e.node(r.v);o&&i.push({v:r.v,w:r.w}),s.out-=a,ku(t,n,s)})),xu.forEach(e.outEdges(r.v),(function(r){var o=e.edge(r),i=r.w,a=e.node(i);a.in-=o,ku(t,n,a)})),e.removeNode(r.v),i}function ku(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var Mu=Vs.Graph,Ou={addDummyNode:Ru,simplify:function(e){var t=(new Mu).setGraph(e.graph());return xu.forEach(e.nodes(),(function(n){t.setNode(n,e.node(n))})),xu.forEach(e.edges(),(function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})})),t},asNonCompoundGraph:function(e){var t=new Mu({multigraph:e.isMultigraph()}).setGraph(e.graph());return xu.forEach(e.nodes(),(function(n){e.children(n).length||t.setNode(n,e.node(n))})),xu.forEach(e.edges(),(function(n){t.setEdge(n,e.edge(n))})),t},successorWeights:function(e){var t=xu.map(e.nodes(),(function(t){var n={};return xu.forEach(e.outEdges(t),(function(t){n[t.w]=(n[t.w]||0)+e.edge(t).weight})),n}));return xu.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=xu.map(e.nodes(),(function(t){var n={};return xu.forEach(e.inEdges(t),(function(t){n[t.v]=(n[t.v]||0)+e.edge(t).weight})),n}));return xu.zipObject(e.nodes(),t)},intersectRect:function(e,t){var n,r,o=e.x,i=e.y,a=t.x-o,s=t.y-i,u=e.width/2,c=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*u>Math.abs(a)*c?(s<0&&(c=-c),n=c*a/s,r=c):(a<0&&(u=-u),n=u,r=u*s/a),{x:o+n,y:i+r}},buildLayerMatrix:function(e){var t=xu.map(xu.range(Cu(e)+1),(function(){return[]}));return xu.forEach(e.nodes(),(function(n){var r=e.node(n),o=r.rank;xu.isUndefined(o)||(t[o][r.order]=n)})),t},normalizeRanks:function(e){var t=xu.min(xu.map(e.nodes(),(function(t){return e.node(t).rank})));xu.forEach(e.nodes(),(function(n){var r=e.node(n);xu.has(r,"rank")&&(r.rank-=t)}))},removeEmptyRanks:function(e){var t=xu.min(xu.map(e.nodes(),(function(t){return e.node(t).rank}))),n=[];xu.forEach(e.nodes(),(function(r){var o=e.node(r).rank-t;n[o]||(n[o]=[]),n[o].push(r)}));var r=0,o=e.graph().nodeRankFactor;xu.forEach(n,(function(t,n){xu.isUndefined(t)&&n%o!=0?--r:r&&xu.forEach(t,(function(t){e.node(t).rank+=r}))}))},addBorderNode:function(e,t,n,r){var o={width:0,height:0};return arguments.length>=4&&(o.rank=n,o.order=r),Ru(e,"border",o,t)},maxRank:Cu,partition:function(e,t){var n={lhs:[],rhs:[]};return xu.forEach(e,(function(e){t(e)?n.lhs.push(e):n.rhs.push(e)})),n},time:function(e,t){var n=xu.now();try{return t()}finally{console.log(e+" time: "+(xu.now()-n)+"ms")}},notime:function(e,t){return t()}};function Ru(e,t,n,r){var o;do{o=xu.uniqueId(r)}while(e.hasNode(o));return n.dummy=t,e.setNode(o,n),o}function Cu(e){return xu.max(xu.map(e.nodes(),(function(t){var n=e.node(t).rank;if(!xu.isUndefined(n))return n})))}var Lu=function(e){var t={};xu.forEach(e.sources(),(function n(r){var o=e.node(r);if(xu.has(t,r))return o.rank;t[r]=!0;var i=xu.min(xu.map(e.outEdges(r),(function(t){return n(t.w)-e.edge(t).minlen})));return i!==Number.POSITIVE_INFINITY&&null!=i||(i=0),o.rank=i}))},zu=function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen},Gu=Vs.Graph,Pu=zu,ju=function(e){var t,n,r=new Gu({directed:!1}),o=e.nodes()[0],i=e.nodeCount();for(r.setNode(o,{});Fu(r,e)<i;)t=Uu(r,e),n=r.hasNode(t.v)?Pu(e,t):-Pu(e,t),Bu(r,e,n);return r};function Fu(e,t){return xu.forEach(e.nodes(),(function n(r){xu.forEach(t.nodeEdges(r),(function(o){var i=o.v,a=r===i?o.w:i;e.hasNode(a)||Pu(t,o)||(e.setNode(a,{}),e.setEdge(r,a,{}),n(a))}))})),e.nodeCount()}function Uu(e,t){return xu.minBy(t.edges(),(function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return Pu(t,n)}))}function Bu(e,t,n){xu.forEach(e.nodes(),(function(e){t.node(e).rank+=n}))}var Vu=zu,Wu=Lu,Xu=Vs.alg.preorder,Hu=Vs.alg.postorder,qu=Ou.simplify,Yu=Zu;function Zu(e){e=qu(e),Wu(e);var t,n=ju(e);for(Qu(n),$u(n,e);t=ec(n);)nc(n,e,t,tc(n,e,t))}function $u(e,t){var n=Hu(e,e.nodes());n=n.slice(0,n.length-1),xu.forEach(n,(function(n){!function(e,t,n){var r=e.node(n).parent;e.edge(n,r).cutvalue=Ku(e,t,n)}(e,t,n)}))}function Ku(e,t,n){var r=e.node(n).parent,o=!0,i=t.edge(n,r),a=0;return i||(o=!1,i=t.edge(r,n)),a=i.weight,xu.forEach(t.nodeEdges(n),(function(i){var s,u,c=i.v===n,l=c?i.w:i.v;if(l!==r){var d=c===o,f=t.edge(i).weight;if(a+=d?f:-f,s=n,u=l,e.hasEdge(s,u)){var h=e.edge(n,l).cutvalue;a+=d?-h:h}}})),a}function Qu(e,t){arguments.length<2&&(t=e.nodes()[0]),Ju(e,{},1,t)}function Ju(e,t,n,r,o){var i=n,a=e.node(r);return t[r]=!0,xu.forEach(e.neighbors(r),(function(o){xu.has(t,o)||(n=Ju(e,t,n,o,r))})),a.low=i,a.lim=n++,o?a.parent=o:delete a.parent,n}function ec(e){return xu.find(e.edges(),(function(t){return e.edge(t).cutvalue<0}))}function tc(e,t,n){var r=n.v,o=n.w;t.hasEdge(r,o)||(r=n.w,o=n.v);var i=e.node(r),a=e.node(o),s=i,u=!1;i.lim>a.lim&&(s=a,u=!0);var c=xu.filter(t.edges(),(function(t){return u===rc(0,e.node(t.v),s)&&u!==rc(0,e.node(t.w),s)}));return xu.minBy(c,(function(e){return Vu(t,e)}))}function nc(e,t,n,r){var o=n.v,i=n.w;e.removeEdge(o,i),e.setEdge(r.v,r.w,{}),Qu(e),$u(e,t),function(e,t){var n=xu.find(e.nodes(),(function(e){return!t.node(e).parent})),r=Xu(e,n);r=r.slice(1),xu.forEach(r,(function(n){var r=e.node(n).parent,o=t.edge(n,r),i=!1;o||(o=t.edge(r,n),i=!0),t.node(n).rank=t.node(r).rank+(i?o.minlen:-o.minlen)}))}(e,t)}function rc(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}Zu.initLowLimValues=Qu,Zu.initCutValues=$u,Zu.calcCutValue=Ku,Zu.leaveEdge=ec,Zu.enterEdge=tc,Zu.exchangeEdges=nc;var oc=Lu,ic=oc;var ac=function(e){var t=Ou.addDummyNode(e,"root",{},"_root"),n=function(e){var t={};function n(r,o){var i=e.children(r);i&&i.length&&xu.forEach(i,(function(e){n(e,o+1)})),t[r]=o}return xu.forEach(e.children(),(function(e){n(e,1)})),t}(e),r=xu.max(xu.values(n))-1,o=2*r+1;e.graph().nestingRoot=t,xu.forEach(e.edges(),(function(t){e.edge(t).minlen*=o}));var i=function(e){return xu.reduce(e.edges(),(function(t,n){return t+e.edge(n).weight}),0)}(e)+1;xu.forEach(e.children(),(function(a){sc(e,t,o,i,r,n,a)})),e.graph().nodeRankFactor=o};function sc(e,t,n,r,o,i,a){var s=e.children(a);if(s.length){var u=Ou.addBorderNode(e,"_bt"),c=Ou.addBorderNode(e,"_bb"),l=e.node(a);e.setParent(u,a),l.borderTop=u,e.setParent(c,a),l.borderBottom=c,xu.forEach(s,(function(s){sc(e,t,n,r,o,i,s);var l=e.node(s),d=l.borderTop?l.borderTop:s,f=l.borderBottom?l.borderBottom:s,h=l.borderTop?r:2*r,p=d!==f?1:o-i[a]+1;e.setEdge(u,d,{weight:h,minlen:p,nestingEdge:!0}),e.setEdge(f,c,{weight:h,minlen:p,nestingEdge:!0})})),e.parent(a)||e.setEdge(t,u,{weight:0,minlen:o+i[a]})}else a!==t&&e.setEdge(t,a,{weight:0,minlen:n})}function uc(e,t,n,r,o,i){var a={width:0,height:0,rank:i,borderType:t},s=o[t][i-1],u=Ou.addDummyNode(e,"border",a,n);o[t][i]=u,e.setParent(u,r),s&&e.setEdge(s,u,{weight:1})}function cc(e){xu.forEach(e.nodes(),(function(t){lc(e.node(t))})),xu.forEach(e.edges(),(function(t){lc(e.edge(t))}))}function lc(e){var t=e.width;e.width=e.height,e.height=t}function dc(e){e.y=-e.y}function fc(e){var t=e.x;e.x=e.y,e.y=t}var hc=function(e,t){for(var n=0,r=1;r<t.length;++r)n+=pc(e,t[r-1],t[r]);return n};function pc(e,t,n){for(var r=xu.zipObject(n,xu.map(n,(function(e,t){return t}))),o=xu.flatten(xu.map(t,(function(t){return xu.sortBy(xu.map(e.outEdges(t),(function(t){return{pos:r[t.w],weight:e.edge(t).weight}})),"pos")})),!0),i=1;i<n.length;)i<<=1;var a=2*i-1;i-=1;var s=xu.map(new Array(a),(function(){return 0})),u=0;return xu.forEach(o.forEach((function(e){var t=e.pos+i;s[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=s[t+1]),s[t=t-1>>1]+=e.weight;u+=e.weight*n}))),u}function gc(e,t,n){for(var r;t.length&&(r=xu.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}var mc=function e(t,n,r,o){var i=t.children(n),a=t.node(n),s=a?a.borderLeft:void 0,u=a?a.borderRight:void 0,c={};s&&(i=xu.filter(i,(function(e){return e!==s&&e!==u})));var l=function(e,t){return xu.map(t,(function(t){var n=e.inEdges(t);if(n.length){var r=xu.reduce(n,(function(t,n){var r=e.edge(n),o=e.node(n.v);return{sum:t.sum+r.weight*o.order,weight:t.weight+r.weight}}),{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}return{v:t}}))}(t,i);xu.forEach(l,(function(n){if(t.children(n.v).length){var i=e(t,n.v,r,o);c[n.v]=i,xu.has(i,"barycenter")&&(a=n,s=i,xu.isUndefined(a.barycenter)?(a.barycenter=s.barycenter,a.weight=s.weight):(a.barycenter=(a.barycenter*a.weight+s.barycenter*s.weight)/(a.weight+s.weight),a.weight+=s.weight))}var a,s}));var d=function(e,t){var n={};return xu.forEach(e,(function(e,t){var r=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};xu.isUndefined(e.barycenter)||(r.barycenter=e.barycenter,r.weight=e.weight)})),xu.forEach(t.edges(),(function(e){var t=n[e.v],r=n[e.w];xu.isUndefined(t)||xu.isUndefined(r)||(r.indegree++,t.out.push(n[e.w]))})),function(e){var t=[];function n(e){return function(t){t.merged||(xu.isUndefined(t.barycenter)||xu.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&function(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function r(t){return function(n){n.in.push(t),0==--n.indegree&&e.push(n)}}for(;e.length;){var o=e.pop();t.push(o),xu.forEach(o.in.reverse(),n(o)),xu.forEach(o.out,r(o))}return xu.map(xu.filter(t,(function(e){return!e.merged})),(function(e){return xu.pick(e,["vs","i","barycenter","weight"])}))}(xu.filter(n,(function(e){return!e.indegree})))}(l,r);!function(e,t){xu.forEach(e,(function(e){e.vs=xu.flatten(e.vs.map((function(e){return t[e]?t[e].vs:e})),!0)}))}(d,c);var f=function(e,t){var n,r=Ou.partition(e,(function(e){return xu.has(e,"barycenter")})),o=r.lhs,i=xu.sortBy(r.rhs,(function(e){return-e.i})),a=[],s=0,u=0,c=0;o.sort((n=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:n?t.i-e.i:e.i-t.i})),c=gc(a,i,c),xu.forEach(o,(function(e){c+=e.vs.length,a.push(e.vs),s+=e.barycenter*e.weight,u+=e.weight,c=gc(a,i,c)}));var l={vs:xu.flatten(a,!0)};return u&&(l.barycenter=s/u,l.weight=u),l}(d,o);if(s&&(f.vs=xu.flatten([s,f.vs,u],!0),t.predecessors(s).length)){var h=t.node(t.predecessors(s)[0]),p=t.node(t.predecessors(u)[0]);xu.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+h.order+p.order)/(f.weight+2),f.weight+=2}return f},vc=Vs.Graph,yc=Vs.Graph;function bc(e,t,n){return xu.map(t,(function(t){return function(e,t,n){var r=function(e){for(var t;e.hasNode(t=xu.uniqueId("_root")););return t}(e),o=new vc({compound:!0}).setGraph({root:r}).setDefaultNodeLabel((function(t){return e.node(t)}));return xu.forEach(e.nodes(),(function(i){var a=e.node(i),s=e.parent(i);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(o.setNode(i),o.setParent(i,s||r),xu.forEach(e[n](i),(function(t){var n=t.v===i?t.w:t.v,r=o.edge(n,i),a=xu.isUndefined(r)?0:r.weight;o.setEdge(n,i,{weight:e.edge(t).weight+a})})),xu.has(a,"minRank")&&o.setNode(i,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))})),o}(e,t,n)}))}function Ec(e,t){var n=new yc;xu.forEach(e,(function(e){var r=e.graph().root,o=mc(e,r,n,t);xu.forEach(o.vs,(function(t,n){e.node(t).order=n})),function(e,t,n){var r,o={};xu.forEach(n,(function(n){for(var i,a,s=e.parent(n);s;){if((i=e.parent(s))?(a=o[i],o[i]=s):(a=r,r=s),a&&a!==s)return void t.setEdge(a,s);s=i}}))}(e,n,o.vs)}))}function wc(e,t){xu.forEach(t,(function(t){xu.forEach(t,(function(t,n){e.node(t).order=n}))}))}var xc=Vs.Graph;function _c(e,t,n){if(t>n){var r=t;t=n,n=r}var o=e[t];o||(e[t]=o={}),o[n]=!0}function Sc(e,t,n){if(t>n){var r=t;t=n,n=r}return xu.has(e[t],n)}var Ic=Ou.normalizeRanks,Tc=Ou.removeEmptyRanks,Ac=Ou,Nc=Vs.Graph,Dc=["nodesep","edgesep","ranksep","marginx","marginy"],kc={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Mc=["acyclicer","ranker","rankdir","align"],Oc=["width","height"],Rc={width:0,height:0},Cc=["minlen","weight","width","height","labeloffset"],Lc={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},zc=["labelpos"];function Gc(e,t){return xu.mapValues(xu.pick(e,t),Number)}function Pc(e){var t={};return xu.forEach(e,(function(e,n){t[n.toLowerCase()]=e})),t}var jc=Vs.Graph,Fc={graphlib:Vs,layout:function(e,t){var n=t&&t.debugTiming?Ac.time:Ac.notime;n("layout",(function(){var t=n("  buildLayoutGraph",(function(){return function(e){var t=new Nc({multigraph:!0,compound:!0}),n=Pc(e.graph());return t.setGraph(xu.merge({},kc,Gc(n,Dc),xu.pick(n,Mc))),xu.forEach(e.nodes(),(function(n){var r=Pc(e.node(n));t.setNode(n,xu.defaults(Gc(r,Oc),Rc)),t.setParent(n,e.parent(n))})),xu.forEach(e.edges(),(function(n){var r=Pc(e.edge(n));t.setEdge(n,xu.merge({},Lc,Gc(r,Cc),xu.pick(r,zc)))})),t}(e)}));n("  runLayout",(function(){!function(e,t){t("    makeSpaceForEdgeLabels",(function(){!function(e){var t=e.graph();t.ranksep/=2,xu.forEach(e.edges(),(function(n){var r=e.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(e)})),t("    removeSelfEdges",(function(){!function(e){xu.forEach(e.edges(),(function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))}(e)})),t("    acyclic",(function(){!function(e){var t="greedy"===e.graph().acyclicer?function(e,t){if(e.nodeCount()<=1)return[];var n=function(e,t){var n=new Au,r=0,o=0;xu.forEach(e.nodes(),(function(e){n.setNode(e,{v:e,in:0,out:0})})),xu.forEach(e.edges(),(function(e){var i=n.edge(e.v,e.w)||0,a=t(e),s=i+a;n.setEdge(e.v,e.w,s),o=Math.max(o,n.node(e.v).out+=a),r=Math.max(r,n.node(e.w).in+=a)}));var i=xu.range(o+r+3).map((function(){return new _u})),a=r+1;return xu.forEach(n.nodes(),(function(e){ku(i,a,n.node(e))})),{graph:n,buckets:i,zeroIdx:a}}(e,t||Nu),r=function(e,t,n){for(var r,o=[],i=t[t.length-1],a=t[0];e.nodeCount();){for(;r=a.dequeue();)Du(e,t,n,r);for(;r=i.dequeue();)Du(e,t,n,r);if(e.nodeCount())for(var s=t.length-2;s>0;--s)if(r=t[s].dequeue()){o=o.concat(Du(e,t,n,r,!0));break}}return o}(n.graph,n.buckets,n.zeroIdx);return xu.flatten(xu.map(r,(function(t){return e.outEdges(t.v,t.w)})),!0)}(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],n={},r={};return xu.forEach(e.nodes(),(function o(i){xu.has(r,i)||(r[i]=!0,n[i]=!0,xu.forEach(e.outEdges(i),(function(e){xu.has(n,e.w)?t.push(e):o(e.w)})),delete n[i])})),t}(e);xu.forEach(t,(function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,xu.uniqueId("rev"))}))}(e)})),t("    nestingGraph.run",(function(){ac(e)})),t("    rank",(function(){!function(e){switch(e.graph().ranker){case"network-simplex":default:!function(e){Yu(e)}(e);break;case"tight-tree":!function(e){oc(e),ju(e)}(e);break;case"longest-path":ic(e)}}(Ac.asNonCompoundGraph(e))})),t("    injectEdgeLabelProxies",(function(){!function(e){xu.forEach(e.edges(),(function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),o={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};Ac.addDummyNode(e,"edge-proxy",o,"_ep")}}))}(e)})),t("    removeEmptyRanks",(function(){Tc(e)})),t("    nestingGraph.cleanup",(function(){!function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,xu.forEach(e.edges(),(function(t){e.edge(t).nestingEdge&&e.removeEdge(t)}))}(e)})),t("    normalizeRanks",(function(){Ic(e)})),t("    assignRankMinMax",(function(){!function(e){var t=0;xu.forEach(e.nodes(),(function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=xu.max(t,r.maxRank))})),e.graph().maxRank=t}(e)})),t("    removeEdgeLabelProxies",(function(){!function(e){xu.forEach(e.nodes(),(function(t){var n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}))}(e)})),t("    normalize.run",(function(){!function(e){e.graph().dummyChains=[],xu.forEach(e.edges(),(function(t){!function(e,t){var n,r,o,i=t.v,a=e.node(i).rank,s=t.w,u=e.node(s).rank,c=t.name,l=e.edge(t),d=l.labelRank;if(u!==a+1){for(e.removeEdge(t),o=0,++a;a<u;++o,++a)l.points=[],r={width:0,height:0,edgeLabel:l,edgeObj:t,rank:a},n=Ou.addDummyNode(e,"edge",r,"_d"),a===d&&(r.width=l.width,r.height=l.height,r.dummy="edge-label",r.labelpos=l.labelpos),e.setEdge(i,n,{weight:l.weight},c),0===o&&e.graph().dummyChains.push(n),i=n;e.setEdge(i,s,{weight:l.weight},c)}}(e,t)}))}(e)})),t("    parentDummyChains",(function(){!function(e){var t=function(e){var t={},n=0;return xu.forEach(e.children(),(function r(o){var i=n;xu.forEach(e.children(o),r),t[o]={low:i,lim:n++}})),t}(e);xu.forEach(e.graph().dummyChains,(function(n){for(var r=e.node(n),o=r.edgeObj,i=function(e,t,n,r){var o,i,a=[],s=[],u=Math.min(t[n].low,t[r].low),c=Math.max(t[n].lim,t[r].lim);o=n;do{o=e.parent(o),a.push(o)}while(o&&(t[o].low>u||c>t[o].lim));for(i=o,o=r;(o=e.parent(o))!==i;)s.push(o);return{path:a.concat(s.reverse()),lca:i}}(e,t,o.v,o.w),a=i.path,s=i.lca,u=0,c=a[u],l=!0;n!==o.w;){if(r=e.node(n),l){for(;(c=a[u])!==s&&e.node(c).maxRank<r.rank;)u++;c===s&&(l=!1)}if(!l){for(;u<a.length-1&&e.node(c=a[u+1]).minRank<=r.rank;)u++;c=a[u]}e.setParent(n,c),n=e.successors(n)[0]}}))}(e)})),t("    addBorderSegments",(function(){!function(e){xu.forEach(e.children(),(function t(n){var r=e.children(n),o=e.node(n);if(r.length&&xu.forEach(r,t),xu.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var i=o.minRank,a=o.maxRank+1;i<a;++i)uc(e,"borderLeft","_bl",n,o,i),uc(e,"borderRight","_br",n,o,i)}}))}(e)})),t("    order",(function(){!function(e){var t=Ou.maxRank(e),n=bc(e,xu.range(1,t+1),"inEdges"),r=bc(e,xu.range(t-1,-1,-1),"outEdges"),o=function(e){var t={},n=xu.filter(e.nodes(),(function(t){return!e.children(t).length})),r=xu.max(xu.map(n,(function(t){return e.node(t).rank}))),o=xu.map(xu.range(r+1),(function(){return[]})),i=xu.sortBy(n,(function(t){return e.node(t).rank}));return xu.forEach(i,(function n(r){if(!xu.has(t,r)){t[r]=!0;var i=e.node(r);o[i.rank].push(r),xu.forEach(e.successors(r),n)}})),o}(e);wc(e,o);for(var i,a=Number.POSITIVE_INFINITY,s=0,u=0;u<4;++s,++u){Ec(s%2?n:r,s%4>=2),o=Ou.buildLayerMatrix(e);var c=hc(e,o);c<a&&(u=0,i=xu.cloneDeep(o),a=c)}wc(e,i)}(e)})),t("    insertSelfEdges",(function(){!function(e){var t=Ac.buildLayerMatrix(e);xu.forEach(t,(function(t){var n=0;xu.forEach(t,(function(t,r){var o=e.node(t);o.order=r+n,xu.forEach(o.selfEdges,(function(t){Ac.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:o.rank,order:r+ ++n,e:t.e,label:t.label},"_se")})),delete o.selfEdges}))}))}(e)})),t("    adjustCoordinateSystem",(function(){!function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||cc(e)}(e)})),t("    position",(function(){!function(e){(function(e){var t=Ou.buildLayerMatrix(e),n=e.graph().ranksep,r=0;xu.forEach(t,(function(t){var o=xu.max(xu.map(t,(function(t){return e.node(t).height})));xu.forEach(t,(function(t){e.node(t).y=r+o/2})),r+=o+n}))})(e=Ou.asNonCompoundGraph(e)),xu.forEach(function(e){var t,n=Ou.buildLayerMatrix(e),r=xu.merge(function(e,t){var n={};return xu.reduce(t,(function(t,r){var o=0,i=0,a=t.length,s=xu.last(r);return xu.forEach(r,(function(t,u){var c=function(e,t){if(e.node(t).dummy)return xu.find(e.predecessors(t),(function(t){return e.node(t).dummy}))}(e,t),l=c?e.node(c).order:a;(c||t===s)&&(xu.forEach(r.slice(i,u+1),(function(t){xu.forEach(e.predecessors(t),(function(r){var i=e.node(r),a=i.order;!(a<o||l<a)||i.dummy&&e.node(t).dummy||_c(n,r,t)}))})),i=u+1,o=l)})),r})),n}(e,n),function(e,t){var n={};function r(t,r,o,i,a){var s;xu.forEach(xu.range(r,o),(function(r){s=t[r],e.node(s).dummy&&xu.forEach(e.predecessors(s),(function(t){var r=e.node(t);r.dummy&&(r.order<i||r.order>a)&&_c(n,t,s)}))}))}return xu.reduce(t,(function(t,n){var o,i=-1,a=0;return xu.forEach(n,(function(s,u){if("border"===e.node(s).dummy){var c=e.predecessors(s);c.length&&(o=e.node(c[0]).order,r(n,a,u,i,o),a=u,i=o)}r(n,a,n.length,o,t.length)})),n})),n}(e,n)),o={};xu.forEach(["u","d"],(function(i){t="u"===i?n:xu.values(n).reverse(),xu.forEach(["l","r"],(function(n){"r"===n&&(t=xu.map(t,(function(e){return xu.values(e).reverse()})));var a=("u"===i?e.predecessors:e.successors).bind(e),s=function(e,t,n,r){var o={},i={},a={};return xu.forEach(t,(function(e){xu.forEach(e,(function(e,t){o[e]=e,i[e]=e,a[e]=t}))})),xu.forEach(t,(function(e){var t=-1;xu.forEach(e,(function(e){var s=r(e);if(s.length)for(var u=((s=xu.sortBy(s,(function(e){return a[e]}))).length-1)/2,c=Math.floor(u),l=Math.ceil(u);c<=l;++c){var d=s[c];i[e]===e&&t<a[d]&&!Sc(n,e,d)&&(i[d]=e,i[e]=o[e]=o[d],t=a[d])}}))})),{root:o,align:i}}(0,t,r,a),u=function(e,t,n,r,o){var i={},a=function(e,t,n,r){var o=new xc,i=e.graph(),a=function(e,t,n){return function(r,o,i){var a,s=r.node(o),u=r.node(i),c=0;if(c+=s.width/2,xu.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":a=-s.width/2;break;case"r":a=s.width/2}if(a&&(c+=n?a:-a),a=0,c+=(s.dummy?t:e)/2,c+=(u.dummy?t:e)/2,c+=u.width/2,xu.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":a=u.width/2;break;case"r":a=-u.width/2}return a&&(c+=n?a:-a),a=0,c}}(i.nodesep,i.edgesep,r);return xu.forEach(t,(function(t){var r;xu.forEach(t,(function(t){var i=n[t];if(o.setNode(i),r){var s=n[r],u=o.edge(s,i);o.setEdge(s,i,Math.max(a(e,t,r),u||0))}r=t}))})),o}(e,t,n,o),s=o?"borderLeft":"borderRight";function u(e,t){for(var n=a.nodes(),r=n.pop(),o={};r;)o[r]?e(r):(o[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}return u((function(e){i[e]=a.inEdges(e).reduce((function(e,t){return Math.max(e,i[t.v]+a.edge(t))}),0)}),a.predecessors.bind(a)),u((function(t){var n=a.outEdges(t).reduce((function(e,t){return Math.min(e,i[t.w]-a.edge(t))}),Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==s&&(i[t]=Math.max(i[t],n))}),a.successors.bind(a)),xu.forEach(r,(function(e){i[e]=i[n[e]]})),i}(e,t,s.root,s.align,"r"===n);"r"===n&&(u=xu.mapValues(u,(function(e){return-e}))),o[i+n]=u}))}));var i=function(e,t){return xu.minBy(xu.values(t),(function(t){var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return xu.forIn(t,(function(t,o){var i=function(e,t){return e.node(t).width}(e,o)/2;n=Math.max(t+i,n),r=Math.min(t-i,r)})),n-r}))}(e,o);return function(e,t){var n=xu.values(t),r=xu.min(n),o=xu.max(n);xu.forEach(["u","d"],(function(n){xu.forEach(["l","r"],(function(i){var a,s=n+i,u=e[s];if(u!==t){var c=xu.values(u);(a="l"===i?r-xu.min(c):o-xu.max(c))&&(e[s]=xu.mapValues(u,(function(e){return e+a})))}}))}))}(o,i),function(e,t){return xu.mapValues(e.ul,(function(n,r){if(t)return e[t.toLowerCase()][r];var o=xu.sortBy(xu.map(e,r));return(o[1]+o[2])/2}))}(o,e.graph().align)}(e),(function(t,n){e.node(n).x=t}))}(e)})),t("    positionSelfEdges",(function(){!function(e){xu.forEach(e.nodes(),(function(t){var n=e.node(t);if("selfedge"===n.dummy){var r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,a=n.x-o,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{x:o+a,y:i},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],n.label.x=n.x,n.label.y=n.y}}))}(e)})),t("    removeBorderNodes",(function(){!function(e){xu.forEach(e.nodes(),(function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),o=e.node(n.borderBottom),i=e.node(xu.last(n.borderLeft)),a=e.node(xu.last(n.borderRight));n.width=Math.abs(a.x-i.x),n.height=Math.abs(o.y-r.y),n.x=i.x+n.width/2,n.y=r.y+n.height/2}})),xu.forEach(e.nodes(),(function(t){"border"===e.node(t).dummy&&e.removeNode(t)}))}(e)})),t("    normalize.undo",(function(){!function(e){xu.forEach(e.graph().dummyChains,(function(t){var n,r=e.node(t),o=r.edgeLabel;for(e.setEdge(r.edgeObj,o);r.dummy;)n=e.successors(t)[0],e.removeNode(t),o.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(o.x=r.x,o.y=r.y,o.width=r.width,o.height=r.height),t=n,r=e.node(t)}))}(e)})),t("    fixupEdgeLabelCoords",(function(){!function(e){xu.forEach(e.edges(),(function(t){var n=e.edge(t);if(xu.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(e)})),t("    undoCoordinateSystem",(function(){!function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){xu.forEach(e.nodes(),(function(t){dc(e.node(t))})),xu.forEach(e.edges(),(function(t){var n=e.edge(t);xu.forEach(n.points,dc),xu.has(n,"y")&&dc(n)}))}(e),"lr"!==t&&"rl"!==t||(function(e){xu.forEach(e.nodes(),(function(t){fc(e.node(t))})),xu.forEach(e.edges(),(function(t){var n=e.edge(t);xu.forEach(n.points,fc),xu.has(n,"x")&&fc(n)}))}(e),cc(e))}(e)})),t("    translateGraph",(function(){!function(e){var t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,o=0,i=e.graph(),a=i.marginx||0,s=i.marginy||0;function u(e){var i=e.x,a=e.y,s=e.width,u=e.height;t=Math.min(t,i-s/2),n=Math.max(n,i+s/2),r=Math.min(r,a-u/2),o=Math.max(o,a+u/2)}xu.forEach(e.nodes(),(function(t){u(e.node(t))})),xu.forEach(e.edges(),(function(t){var n=e.edge(t);xu.has(n,"x")&&u(n)})),t-=a,r-=s,xu.forEach(e.nodes(),(function(n){var o=e.node(n);o.x-=t,o.y-=r})),xu.forEach(e.edges(),(function(n){var o=e.edge(n);xu.forEach(o.points,(function(e){e.x-=t,e.y-=r})),xu.has(o,"x")&&(o.x-=t),xu.has(o,"y")&&(o.y-=r)})),i.width=n-t+a,i.height=o-r+s}(e)})),t("    assignNodeIntersects",(function(){!function(e){xu.forEach(e.edges(),(function(t){var n,r,o=e.edge(t),i=e.node(t.v),a=e.node(t.w);o.points?(n=o.points[0],r=o.points[o.points.length-1]):(o.points=[],n=a,r=i),o.points.unshift(Ac.intersectRect(i,n)),o.points.push(Ac.intersectRect(a,r))}))}(e)})),t("    reversePoints",(function(){!function(e){xu.forEach(e.edges(),(function(t){var n=e.edge(t);n.reversed&&n.points.reverse()}))}(e)})),t("    acyclic.undo",(function(){!function(e){xu.forEach(e.edges(),(function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}}))}(e)}))}(t,n)})),n("  updateInputGraph",(function(){!function(e,t){xu.forEach(e.nodes(),(function(n){var r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,t.children(n).length&&(r.width=o.width,r.height=o.height))})),xu.forEach(e.edges(),(function(n){var r=e.edge(n),o=t.edge(n);r.points=o.points,xu.has(o,"x")&&(r.x=o.x,r.y=o.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)}))}))},debug:{debugOrdering:function(e){var t=Ou.buildLayerMatrix(e),n=new jc({compound:!0,multigraph:!0}).setGraph({});return xu.forEach(e.nodes(),(function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)})),xu.forEach(e.edges(),(function(e){n.setEdge(e.v,e.w,{},e.name)})),xu.forEach(t,(function(e,t){var r="layer"+t;n.setNode(r,{rank:"same"}),xu.reduce(e,(function(e,t){return n.setEdge(e,t,{style:"invis"}),t}))})),n}},util:{time:Ou.time,notime:Ou.notime},version:"0.8.5"},Uc=Fc.graphlib,Bc=Fc.layout;class Vc{constructor(e){this.cardinality=1,this.include=Ir.UNSPECIFIED,this.isGroupNode=!1,this.parentNode=null,this.type=Sr.NODE,this.name=e.name,this.attr=e.attr||{},this.inputs=e.inputs,this.path=e.path||[],this.width=e.width,this.height=e.height}}class Wc{constructor(){this.nodes={},this.edges=[],this.nodes={},this.edges=[]}}class Xc{constructor(e,t={}){this.attr=null,this.bridgeGraph=null,this.cardinality=0,this.depth=1,this.include=Ir.UNSPECIFIED,this.isGroupNode=!0,this.parentNode=null,this.type=Sr.META,this.path=[],this.name=e,this.metaGraph=Zc(e,Tr.META,t)}getFirstChild(){return this.metaGraph.node(this.metaGraph.nodes()[0])}getChildren(){return this.metaGraph.nodes().map((e=>this.metaGraph.node(e)))}leaves(){let e,t=[],n=[this];for(;n.length;){let r=n.shift();r.isGroupNode?(e=r.metaGraph,e.nodes().forEach((t=>n.push(e.node(t))))):t.push(r.name)}return t}}class Hc{constructor(e,t){this.v=e,this.w=t,this.baseEdgeList=[],this.inbound=null,this.name=null}addBaseEdge(e,t){this.baseEdgeList.push(e)}}function qc(e,t={}){return new Xc(e,t)}function Yc(e,t){return new Hc(e,t)}function Zc(e,t,n){const r=n||{},o=new Uc.Graph(r);return o.setGraph({name:e,rankdir:r.rankdir,type:t,align:r.align}),o}class $c{constructor(e={}){this.graphOptions=e,this.index={},this.graphOptions.compound=!0,this.root=qc(xr,this.graphOptions),this.index[xr]=this.root}getNodeMap(){return this.index}node(e){return this.index[e]}setNode(e,t){this.index[e]=t}getBridgeGraph(e){const t=this.index[e];if(!t)throw Error("Could not find node in hierarchy: "+e);if(!("metaGraph"in t))return null;const n=t;if(n.bridgeGraph)return n.bridgeGraph;const r=Zc(_r,Tr.BRIDGE,this.graphOptions);if(n.bridgeGraph=r,!t.parentNode||!("metaGraph"in t.parentNode))return r;const o=t.parentNode;return[o.metaGraph,this.getBridgeGraph(o.name)].forEach((t=>{t.edges().filter((t=>t.v===e||t.w===e)).forEach((n=>{const o=n.w===e;t.edge(n).baseEdgeList.forEach((t=>{const[i,a]=o?[t.w,n.v]:[t.v,n.w],s=this.getChildName(e,i),u={v:o?a:s,w:o?s:a};let c=r.edge(u);c||(c=Yc(u.v,u.w),c.inbound=o,r.setEdge(u.v,u.w,c)),c.addBaseEdge(t,this)}))}))})),r}getChildName(e,t){let n=this.index[t];for(;n;){if(n.parentNode&&n.parentNode.name===e)return n.name;n=n.parentNode}throw Error("Could not find immediate child for descendant: "+t)}getPredecessors(e){const t=this.index[e];if(!t)throw Error("Could not find node with name: "+e);return this.getOneWayEdges(t,!0)}getSuccessors(e){const t=this.index[e];if(!t)throw Error("Could not find node with name: "+e);return this.getOneWayEdges(t,!1)}getOneWayEdges(e,t){const n=[];if(!e.parentNode||!e.parentNode.isGroupNode)return n;const r=e.parentNode,o=r.metaGraph,i=this.getBridgeGraph(r.name);return Kc(o,e,t,n),Kc(i,e,t,n),n}}function Kc(e,t,n,r){(n?e.inEdges(t.name):e.outEdges(t.name)).forEach((t=>{const n=e.edge(t);r.push(n)}))}class Qc{constructor(e){this.hierarchy=e,this.index={},this.hasSubHierarchy={},this.root=new tl(this.hierarchy.root,this.hierarchy.graphOptions),this.index[e.root.name]=this.root,this.buildSubHierarchy(e.root.name),this.root.expanded=!0}getRenderInfoNodes(){return Object.values(this.index)}getSubHierarchy(){return this.hasSubHierarchy}buildSubHierarchy(e){if(e in this.hasSubHierarchy)return;this.hasSubHierarchy[e]=!0;const t=this.index[e];if(t.node.type!==Sr.META)return;const n=t,r=n.node.metaGraph,o=n.coreGraph;r.nodes().forEach((e=>{const t=this.getOrCreateRenderNodeByName(e);o.setNode(e,t)})),r.edges().forEach((e=>{const t=r.edge(e),n=new el(t);o.setEdge(e.v,e.w,n)}));const i=n.node.parentNode;if(!i)return;const a=this.getRenderNodeByName(i.name),s=(e,...t)=>t.concat([e?"IN":"OUT"]).join("~~"),u=this.hierarchy.getBridgeGraph(e);u.edges().forEach((t=>{const n=u.edge(t),c=!!r.node(t.w),[l,d]=c?[t.w,t.v]:[t.v,t.w],f=t=>{const n=c?{v:t,w:e}:{v:e,w:t};return a.coreGraph.edge(n)};let h=f(d);h||(h=f(s(c,d,i.name)));const p=s(c,e),g=s(c,d,e);let m=o.node(g);if(!m){let e=o.node(p);if(!e){const t={name:p,type:Sr.BRIDGE,isGroupNode:!1,cardinality:0,parentNode:null,include:Ir.UNSPECIFIED,inbound:c,attr:{}};e=new Jc(t),this.index[p]=e,o.setNode(p,e)}const t={name:g,type:Sr.BRIDGE,isGroupNode:!1,cardinality:1,parentNode:null,include:Ir.UNSPECIFIED,inbound:c,attr:{}};m=new Jc(t),this.index[g]=m,o.setNode(g,m),o.setParent(g,p),e.node.cardinality++}const v=new el(n);v.adjoiningMetaEdge=h,c?o.setEdge(g,l,v):o.setEdge(l,g,v)}))}getOrCreateRenderNodeByName(e){if(!e)return null;if(e in this.index)return this.index[e];const t=this.getNodeByName(e);return t?(this.index[e]=t.isGroupNode?new tl(t,this.hierarchy.graphOptions):new Jc(t),this.index[e]):null}getRenderNodeByName(e){return this.index[e]}getNodeByName(e){return this.hierarchy.node(e)}}class Jc{constructor(e){this.node=e,this.expanded=!1,this.x=0,this.y=0,this.coreBox={width:0,height:0},this.outboxWidth=0,this.labelOffset=0,this.radius=0,this.labelHeight=0,this.paddingTop=0,this.paddingLeft=0,this.paddingRight=0,this.paddingBottom=0,this.width=e.width||0,this.height=e.height||0,this.displayName=e.name,this.attr=e.attr}}class el{constructor(e){this.metaEdge=e,this.adjoiningMetaEdge=null,this.weight=1,this.points=[]}}class tl extends Jc{constructor(e,t){super(e);const n=e.metaGraph.graph();t.compound=!0,this.coreGraph=Zc(n.name,Tr.CORE,t)}}function nl(e,t){e.node.isGroupNode&&function(e,t){const n=Er(t);e.coreGraph.nodes().map((t=>e.coreGraph.node(t))).forEach((e=>{var r,o,i,a,s,u;const{height:c,width:l}=e;switch(e.node.type){case Sr.NODE:Object.assign(e,n.nodeSize.node),e.height=c||n.nodeSize.node.height,e.width=l||n.nodeSize.node.width;break;case Sr.BRIDGE:Object.assign(e,n.nodeSize.bridge);break;case Sr.META:e.expanded?nl(e,t):(Object.assign(e,n.nodeSize.meta),e.height=n.nodeSize.meta.height,e.width=n.nodeSize.meta.width);break;default:throw Error("Unrecognized node type: "+e.node.type)}if(!e.expanded){const n=e.attr;!function(e,t=!1){if(e.coreBox.width=e.width,e.coreBox.height=e.height,!t){const t=`${e.displayName}`.length,n=3;e.width=Math.max(e.coreBox.width,t*n)}}(e,t&&(0===e.node.type&&!!(null===(o=null===(r=null==t?void 0:t.nodeSize)||void 0===r?void 0:r.meta)||void 0===o?void 0:o.width)||1===e.node.type&&(!!(null===(a=null===(i=null==t?void 0:t.nodeSize)||void 0===i?void 0:i.node)||void 0===a?void 0:a.width)||!!n.width)||2===e.node.type&&!!(null===(u=null===(s=null==t?void 0:t.nodeSize)||void 0===s?void 0:s.bridge)||void 0===u?void 0:u.width)))}}))}(e,t),e.node.type===Sr.META&&function(e,t){const n=Er(t),r=n.subScene.meta;Object.assign(e,r);const{nodeSep:o,rankSep:i,edgeSep:a,align:s}=n.graph.meta,u={nodesep:o,ranksep:i,edgesep:a,align:s};Object.assign(e.coreBox,function(e,t){const{ranksep:n,nodesep:r,edgesep:o,align:i}=t;Object.assign(e.graph(),{ranksep:n,nodesep:r,edgesep:o,align:i});const a=[];if(e.nodes().forEach((t=>{e.node(t).node.type!==Sr.BRIDGE&&a.push(t)})),!a.length)return{width:0,height:0};Bc(e);let s=1/0,u=1/0,c=-1/0,l=-1/0;return a.forEach((t=>{const n=e.node(t),r=.5*n.width,o=n.x-r,i=n.x+r;s=o<s?o:s,c=i>c?i:c;const a=.5*n.height,d=n.y-a,f=n.y+a;u=d<u?d:u,l=f>l?f:l})),e.edges().forEach((t=>{const n=e.edge(t),r=e.node(n.metaEdge.v),o=e.node(n.metaEdge.w);if(3===n.points.length&&function(e){let t=rl(e[0],e[1]);for(let n=1;n<e.length-1;n++){const r=rl(e[n],e[n+1]);if(Math.abs(r-t)>1)return!1;t=r}return!0}(n.points)){if(null!=r){const e=r.expanded?r.x:ol(r);n.points[0].x=e}if(null!=o){const e=o.expanded?o.x:ol(o);n.points[2].x=e}n.points=[n.points[0],n.points[1]]}const i=n.points[n.points.length-2];null!=o&&(n.points[n.points.length-1]=il(i,o));const a=n.points[1];null!=r&&(n.points[0]=il(a,r)),n.points.forEach((e=>{s=e.x<s?e.x:s,c=e.x>c?e.x:c,u=e.y<u?e.y:u,l=e.y>l?e.y:l}))})),e.nodes().forEach((t=>{const n=e.node(t);n.x-=s,n.y-=u})),e.edges().forEach((t=>{e.edge(t).points.forEach((e=>{e.x-=s,e.y-=u}))})),{width:c-s,height:l-u}}(e.coreGraph,u));let c=0;e.coreGraph.nodeCount()>0&&c++;const l=c<=1?0:c;e.coreBox.width+=l+l,e.coreBox.height=r.labelHeight+e.coreBox.height,e.width=e.coreBox.width+r.paddingLeft+r.paddingRight,e.height=e.paddingTop+e.coreBox.height+e.paddingBottom}(e,t)}function rl(e,t){const n=t.x-e.x,r=t.y-e.y;return 180*Math.atan(r/n)/Math.PI}function ol(e){return e.expanded?e.x:e.x-e.width/2+0+e.coreBox.width/2}function il(e,t){const n=t.expanded?t.x:ol(t),r=t.y,o=e.x-n,i=e.y-r;let a,s,u=t.expanded?t.width:t.coreBox.width,c=t.expanded?t.height:t.coreBox.height;return Math.abs(i)*u/2>Math.abs(o)*c/2?(i<0&&(c=-c),a=0===i?0:c/2*o/i,s=c/2):(o<0&&(u=-u),a=u/2,s=0===o?0:u/2*i/o),{x:n+a,y:r+s}}function al(e,t,n,r){var o,i;let a=[];const s=(null===(o=n.find((t=>t.id===e)))||void 0===o?void 0:o.path)||[],u=(null===(i=n.find((e=>e.id===t)))||void 0===i?void 0:i.path)||[],c=[xr,...s].slice(0,s.length).reverse(),l=[xr,...u].slice(0,u.length);return c.forEach((o=>{const i=n.find((e=>e.id===o));a=a.concat(i.edges.filter((n=>n.baseEdgeList.some((n=>n.v===((null==r?void 0:r.v)||e)&&n.w===((null==r?void 0:r.w)||t))))))})),l.filter((e=>!c.includes(e))).forEach((o=>{const i=n.find((e=>e.id===o));a=a.concat(i.edges.filter((n=>n.baseEdgeList.some((n=>n.v===((null==r?void 0:r.v)||e)&&n.w===((null==r?void 0:r.w)||t))))))})),a}function sl(e){const t=e.coreGraph.nodes().map((t=>e.coreGraph.node(t)));return Object.assign(Object.assign({},ul(e)),{expanded:e.expanded,nodes:e.expanded?(n=t,n.map((e=>e.node.type===Sr.META?sl(e):ul(e)))):[],edges:e.expanded?cl(e):[]});var n}function ul(e){return{id:e.node.name,name:e.node.name,type:e.node.type,cardinality:e.node.cardinality,attr:e.attr,parentNodeName:e.node.parentNode?e.node.parentNode.name:null,coreBox:Object.assign({},e.coreBox),x:e.x,y:e.y,width:e.width,height:e.height,radius:e.radius,labelHeight:e.labelHeight,labelOffset:e.labelOffset,outboxWidth:e.outboxWidth,paddingLeft:e.paddingLeft,paddingTop:e.paddingTop,paddingRight:e.paddingRight,paddingBottom:e.paddingBottom,path:e.node.path}}function cl(e){return e.coreGraph.edges().map((t=>({renderInfoEdge:e.coreGraph.edge(t),edge:t}))).filter((({renderInfoEdge:e})=>e.metaEdge)).map((({edge:t,renderInfoEdge:n})=>{const r=function(e,t){const n=t.points.map((e=>Object.assign({},e)));if(t.adjoiningMetaEdge){const r=t.adjoiningMetaEdge.points,o=t.metaEdge.inbound,i=o?r[r.length-1]:r[0],a=n[o?0:n.length-1],s=e.x-e.width/2,u=e.y-e.height/2,c=i.x-s,l=i.y-u,d=-e.paddingLeft,f=-(e.paddingTop+e.labelHeight);a.x=c+d,a.y=l+f}return n}(e,n);return{adjoiningEdge:n.adjoiningMetaEdge?{w:n.adjoiningMetaEdge.metaEdge.w,v:n.adjoiningMetaEdge.metaEdge.v}:null,inbound:n.metaEdge.inbound,w:t.w,v:t.v,points:r,weight:n.weight,baseEdgeList:n.metaEdge.baseEdgeList,parentNodeName:e.node.name}}))}class ll extends i{constructor(e){super(),this.rankdir="TB",this.nodesep=50,this.edgesep=5,this.ranksep=50,this.controlPoints=!0,this.anchorPoint=!0,this.nodes=[],this.edges=[],this.combos=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{rankdir:"TB",align:void 0,begin:void 0,nodeSize:void 0,nodesep:50,ranksep:50,controlPoints:!0,anchorPoint:!0}}init(e){const t=e.hiddenNodes||[],n=e.hiddenEdges||[],r=e.hiddenCombos||[];this.nodes=this.getDataByOrder((e.nodes||[]).concat(t)),this.edges=this.getDataByOrder((e.edges||[]).concat(n)),this.combos=(e.combos||[]).concat(r.map((e=>Object.assign(Object.assign({},e),{collapsed:!0}))))}execute(){const e=this,{nodes:t,edges:n}=e;if(!t)return;const{graphDef:r,graphOption:o,graphSettings:i}=e.getLayoutConfig(),a=function(e,t=!1){const n=JSON.parse(JSON.stringify(e)),r={nodes:[n],edges:[...n.edges]};return n.nodes.forEach((function e(t){(0===t.type||1===t.type)&&r.nodes.push(t),0===t.type&&(r.edges=r.edges.concat(t.edges)),Array.isArray(t.nodes)&&t.nodes.forEach(e)})),t&&r.nodes.forEach((e=>{const t=r.nodes.find((t=>t.id===e.parentNodeName));if(t){const n=t.x-t.width/2+t.paddingLeft,r=t.y-t.height/2+t.labelHeight+t.paddingTop;t.id!==xr&&(e.x+=n,e.y+=r),0===e.type&&e.edges.forEach((t=>{t.points.forEach((t=>{t.x+=e.x-e.width/2+e.paddingLeft,t.y+=e.y-e.height/2+e.labelHeight+e.paddingTop}))}))}})),r}(function(e,t,n){var r,o,i,a;const s=e.nodes.filter(((e,t,n)=>n.findIndex((t=>t.id===e.id))!==t)).map((e=>e.id));if(s.length)throw new Error(`Duplicated ids found: ${s.join(", ")}`);const u=function(e){const t={nodes:[]},n=e.compound,r=Object.keys(n||{}),o=new Map,i=(e,t=[])=>{if(o.has(e))return o.get(e);for(let o=0;o<r.length;o++){let a=r[o];if(n&&-1!==n[a].indexOf(e))return t.unshift(a),i(a,t)}return 0===t.length&&o.set(e,t),t},a=t=>e.edges.filter((e=>e.w===t)).map((e=>({name:e.v})));return e.nodes.forEach((e=>{const n=e.id,r=[...i(n),n];let o=a(n);t.nodes.push({name:n,path:r,inputs:o,width:e.width,height:e.height,attr:Object.assign({},e)})})),t}(e),c=function(e,t){const n=(e,t)=>{for(let n of t.values())if(n.includes(e))return!0;return!1},r=(e,t=[])=>{if(0===Object.keys(e).length)return[...new Set(t)];const o=new Map(Object.keys(e).map((t=>[t,e[t]]))),i={};for(let[e,r]of o)n(e,o)?i[e]=r:t=t.concat(e,r);return r(i,t)};return r(e).filter((e=>t.includes(e)))}(e.compound||{},(null==t?void 0:t.expanded)||[]),l=function(e,t){return function(e){return new Qc(e)}(function(e,t){const{rankDirection:n,align:r}=t,o=new $c({rankdir:n,align:r});return function(e,t){Object.keys(t.nodes).forEach((n=>{const r=t.nodes[n],o=r.path;let i=e.root;i.depth=Math.max(o.length,i.depth);for(let t=0;t<o.length&&(i.depth=Math.max(i.depth,o.length-t),i.cardinality+=r.cardinality,t!==o.length-1);t++){const n=o[t];let a=e.node(n);a||(a=qc(n,e.graphOptions),a.path=r.path.slice(0,t+1),a.parentNode=i,e.setNode(n,a),i.metaGraph.setNode(n,a)),i=a}e.setNode(r.name,r),r.parentNode=i,i.metaGraph.setNode(r.name,r)}))}(o,e),function(e,t){const n=e.getNodeMap();let r=[],o=[];const i=(e,t)=>{let n=0;for(;e;)t[n++]=e.name,e=e.parentNode;return n-1};t.edges.forEach((a=>{r=[],o=[];let s=i(t.nodes[a.v],r),u=i(t.nodes[a.w],o);for(;r[s]===o[u];)if(s--,u--,s<0||u<0)throw Error("No difference found between ancestor paths.");const c=n[r[s+1]],l=r[s],d=o[u];let f=c.metaGraph.edge(l,d);f||(f=Yc(l,d),c.metaGraph.setEdge(l,d,f)),f.addBaseEdge(a,e)}))}(o,e),o}(function(e){const t=new Wc;return e.nodes.map((e=>new Vc(e))).forEach((e=>{t.nodes[e.name]=e,e.inputs.forEach((n=>{!function(e,t,n){n.name!==t.name&&e.edges.push(Object.assign(Object.assign({},n.attr),{v:n.name,w:t.name}))}(t,e,n)}))})),t}(e),t))}(u,{rankDirection:(null===(o=null===(r=null==n?void 0:n.graph)||void 0===r?void 0:r.meta)||void 0===o?void 0:o.rankDir)||(null==t?void 0:t.rankDirection)||br.graph.meta.rankDir,align:(null===(a=null===(i=null==n?void 0:n.graph)||void 0===i?void 0:i.meta)||void 0===a?void 0:a.align)||br.graph.meta.align});return function(e,t){t.forEach((t=>{const n=e.getRenderInfoNodes().find((e=>e.displayName===t));let r=n&&n.node&&n.node.name||"";const o=e.getRenderNodeByName(r);if(!o)throw new Error(`No nodes found: ${r}`);o.expanded=!0,e.buildSubHierarchy(r)}))}(l,c),nl(l.root,n),sl(l.root)}(r,o,i),!0);return this.updatePosition(a),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}getNodePath(e){const{nodes:t,combos:n}=this,r=t.find((t=>t.id===e)),o=(e,t=[])=>{const r=n.find((t=>t.id===e));return r?(t.unshift(e),r.parentId?o(r.parentId,t):t):t};return r&&r.comboId?o(r.comboId,[e]):[e]}getLayoutConfig(){var e,t,n;const r=this,{nodes:o,edges:i,combos:a,nodeSize:u,rankdir:c,align:d,edgesep:f,nodesep:h,ranksep:p,settings:g}=r,m=(a||[]).reduce(((e,t)=>{const n=o.filter((e=>e.comboId===t.id)).map((e=>e.id)),r=(a||[]).filter((e=>e.parentId===t.id)).map((e=>e.id));return(n.length||r.length)&&(e[t.id]=[...n,...r]),e}),{});let v;v=u?s(u)?()=>u:()=>[u,u]:e=>e&&e.size?s(e.size)?e.size:l(e.size)?[e.size.width||40,e.size.height||40]:[e.size,e.size]:[40,40];const[y,b]=(e=>e&&e.size?s(e.size)?e.size:[e.size,e.size]:[80,40])(null==a?void 0:a[0]),E=null===(t=null===(e=r.graphSettings)||void 0===e?void 0:e.subScene)||void 0===t?void 0:t.meta,[w,x,_,S]=(null===(n=a.find((e=>!e.collapsed)))||void 0===n?void 0:n.padding)||[20,20,20,20],I={compound:m,nodes:[...(o||[]).map((e=>{const t=v(e),n=t[0],r=t[1];return Object.assign(Object.assign({},e),{width:n,height:r})}))],edges:[...(i||[]).map((e=>Object.assign(Object.assign({},e),{v:e.source,w:e.target})))]},T={expanded:(a||[]).filter((e=>!e.collapsed)).map((e=>e.id))},A={graph:{meta:{align:d,rankDir:c,nodeSep:h,edgeSep:f,rankSep:p}},subScene:{meta:{paddingTop:w||(null==E?void 0:E.paddingTop)||20,paddingRight:x||(null==E?void 0:E.paddingRight)||20,paddingBottom:_||(null==E?void 0:E.paddingBottom)||20,paddingLeft:S||(null==E?void 0:E.paddingLeft)||20,labelHeight:0}},nodeSize:{meta:{width:y,height:b}}},N=Er(g,Object.assign({},Er(A,br)));return r.graphSettings=N,{graphDef:I,graphOption:T,graphSettings:N}}updatePosition(e){const{nodes:t,edges:n}=e;this.updateNodePosition(t,n),this.updateEdgePosition(t,n)}getBegin(e,t){const{begin:n}=this,r=[0,0];if(n){let o=1/0,i=1/0;e.forEach((e=>{o>e.x&&(o=e.x),i>e.y&&(i=e.y)})),t.forEach((e=>{e.points.forEach((e=>{o>e.x&&(o=e.x),i>e.y&&(i=e.y)}))})),r[0]=n[0]-o,r[1]=n[1]-i}return r}updateNodePosition(e,t){const{combos:n,nodes:r,edges:o,anchorPoint:i,graphSettings:a}=this,s=this.getBegin(e,t);e.forEach((e=>{var u;const{x:c,y:l,id:d,type:f,coreBox:h}=e;if(f===Ar.META&&d!==xr){const t=n.findIndex((e=>e.id===d)),r=null===(u=null==a?void 0:a.subScene)||void 0===u?void 0:u.meta;n[t].offsetX=c+s[0],n[t].offsetY=l+s[1],n[t].fixSize=[h.width,h.height],n[t].fixCollapseSize=[h.width,h.height],e.expanded?n[t].padding=[null==r?void 0:r.paddingTop,null==r?void 0:r.paddingRight,null==r?void 0:r.paddingBottom,null==r?void 0:r.paddingLeft]:n[t].padding=[0,0,0,0]}else if(f===Ar.OP){const n=r.findIndex((e=>e.id===d));if(r[n].x=c+s[0],r[n].y=l+s[1],i){const i=[],a=t.filter((e=>e.v===d)),s=t.filter((e=>e.w===d));a.length>0&&a.forEach((t=>{const n=t.points[0],r=(n.x-c)/e.width+.5,a=(n.y-l)/e.height+.5;i.push([r,a]),t.baseEdgeList.forEach((e=>{const t=o.find((t=>t.source===e.v&&t.target===e.w));t&&(t.sourceAnchor=i.length-1)}))})),s.length>0&&s.forEach((t=>{const n=t.points[t.points.length-1],r=(n.x-c)/e.width+.5,a=(n.y-l)/e.height+.5;i.push([r,a]),t.baseEdgeList.forEach((e=>{const t=o.find((t=>t.source===e.v&&t.target===e.w));t&&(t.targetAnchor=i.length-1)}))})),r[n].anchorPoints=i.length>0?i:r[n].anchorPoints||[]}}}))}updateEdgePosition(e,t){const n=this,{combos:r,edges:o,controlPoints:i}=n,a=this.getBegin(e,t);i&&(r.forEach((e=>{e.inEdges=[],e.outEdges=[]})),o.forEach((t=>{var o,i,s,u;let c=e.find((e=>e.id===t.source)),l=e.find((e=>e.id===t.target)),d=[],f=[];if(c&&l)f=al(null==c?void 0:c.id,null==l?void 0:l.id,e);else if(!c||!l){const r=n.getNodePath(t.source),o=n.getNodePath(t.target),i=r.reverse().slice(c?0:1).find((t=>e.find((e=>e.id===t)))),a=o.reverse().slice(l?0:1).find((t=>e.find((e=>e.id===t))));c=e.find((e=>e.id===i)),l=e.find((e=>e.id===a)),f=al(null==c?void 0:c.id,null==l?void 0:l.id,e,{v:t.source,w:t.target})}if(d=f.reduce(((e,t)=>[...e,...t.points.map((e=>Object.assign(Object.assign({},e),{x:e.x+a[0],y:e.y+a[1]})))]),[]),d=d.slice(1,-1),t.controlPoints=d,(null==l?void 0:l.type)===Sr.META){const e=r.findIndex((e=>e.id===(null==l?void 0:l.id)));if(!r[e]||(null===(o=r[e].inEdges)||void 0===o?void 0:o.some((e=>e.source===c.id&&e.target===l.id))))return;null===(i=r[e].inEdges)||void 0===i||i.push({source:c.id,target:l.id,controlPoints:d})}if((null==c?void 0:c.type)===Sr.META){const e=r.findIndex((e=>e.id===(null==c?void 0:c.id)));if(!r[e]||(null===(s=r[e].outEdges)||void 0===s?void 0:s.some((e=>e.source===c.id&&e.target===l.id))))return;null===(u=r[e].outEdges)||void 0===u||u.push({source:c.id,target:l.id,controlPoints:d})}})))}getType(){return"dagreCompound"}getDataByOrder(e){return e.every((e=>void 0!==e.layoutOrder))||e.forEach(((e,t)=>{e.layoutOrder=t})),e.sort(((e,t)=>e.layoutOrder-t.layoutOrder))}}const dl=Object.prototype.toString;function fl(e){return dl.call(e).endsWith("Array]")}function hl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!fl(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");var n=t.fromIndex,r=void 0===n?0:n,o=t.toIndex,i=void 0===o?e.length:o;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=r||i>e.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=e[r],s=r+1;s<i;s++)e[s]>a&&(a=e[s]);return a}function pl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!fl(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");var n=t.fromIndex,r=void 0===n?0:n,o=t.toIndex,i=void 0===o?e.length:o;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=r||i>e.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=e[r],s=r+1;s<i;s++)e[s]<a&&(a=e[s]);return a}function gl(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!fl(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!fl(n.output))throw new TypeError("output option must be an array if specified");t=n.output}else t=new Array(e.length);var r=pl(e),o=hl(e);if(r===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=n.min,a=void 0===i?n.autoMinMax?r:0:i,s=n.max,u=void 0===s?n.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var c=(u-a)/(o-r),l=0;l<e.length;l++)t[l]=(e[l]-r)*c+a;return t}const ml=" ".repeat(2),vl=" ".repeat(4);function yl(e,t={}){const{maxRows:n=15,maxColumns:r=10,maxNumSize:o=8,padMinus:i="auto"}=t;return`${e.constructor.name} {\n${ml}[\n${vl}${function(e,t,n,r,o){const{rows:i,columns:a}=e,s=Math.min(i,t),u=Math.min(a,n),c=[];if("auto"===o){o=!1;e:for(let t=0;t<s;t++)for(let n=0;n<u;n++)if(e.get(t,n)<0){o=!0;break e}}for(let t=0;t<s;t++){let n=[];for(let i=0;i<u;i++)n.push(bl(e.get(t,i),r,o));c.push(`${n.join(" ")}`)}return u!==a&&(c[c.length-1]+=` ... ${a-n} more columns`),s!==i&&c.push(`... ${i-t} more rows`),c.join(`\n${vl}`)}(e,n,r,o,i)}\n${ml}]\n${ml}rows: ${e.rows}\n${ml}columns: ${e.columns}\n}`}function bl(e,t,n){return(e>=0&&n?` ${El(e,t-1)}`:El(e,t)).padEnd(t)}function El(e,t){let n=e.toString();if(n.length<=t)return n;let r=e.toFixed(t);if(r.length>t&&(r=e.toFixed(Math.max(0,t-(r.length-t)))),r.length<=t&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let o=e.toExponential(t);return o.length>t&&(o=e.toExponential(Math.max(0,t-(o.length-t)))),o.slice(0)}function wl(e,t,n){let r=n?e.rows:e.rows-1;if(t<0||t>r)throw new RangeError("Row index out of range")}function xl(e,t,n){let r=n?e.columns:e.columns-1;if(t<0||t>r)throw new RangeError("Column index out of range")}function _l(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function Sl(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function Il(e,t,n,r,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(Al("startRow",t),Al("endRow",n),Al("startColumn",r),Al("endColumn",o),t>n||r>o||t<0||t>=e.rows||n<0||n>=e.rows||r<0||r>=e.columns||o<0||o>=e.columns)throw new RangeError("Submatrix indices are out of range")}function Tl(e,t=0){let n=[];for(let r=0;r<e;r++)n.push(t);return n}function Al(e,t){if("number"!=typeof t)throw new TypeError(`${e} must be a number`)}function Nl(e){if(e.isEmpty())throw new Error("Empty matrix has no elements to index")}class Dl{static from1DArray(e,t,n){if(e*t!==n.length)throw new RangeError("data length does not match given dimensions");let r=new Ml(e,t);for(let o=0;o<e;o++)for(let e=0;e<t;e++)r.set(o,e,n[o*t+e]);return r}static rowVector(e){let t=new Ml(1,e.length);for(let n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){let t=new Ml(e.length,1);for(let n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static zeros(e,t){return new Ml(e,t)}static ones(e,t){return new Ml(e,t).fill(1)}static rand(e,t,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{random:r=Math.random}=n;let o=new Ml(e,t);for(let n=0;n<e;n++)for(let e=0;e<t;e++)o.set(n,e,r());return o}static randInt(e,t,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{min:r=0,max:o=1e3,random:i=Math.random}=n;if(!Number.isInteger(r))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(r>=o)throw new RangeError("min must be smaller than max");let a=o-r,s=new Ml(e,t);for(let n=0;n<e;n++)for(let e=0;e<t;e++){let t=r+Math.round(i()*a);s.set(n,e,t)}return s}static eye(e,t,n){void 0===t&&(t=e),void 0===n&&(n=1);let r=Math.min(e,t),o=this.zeros(e,t);for(let e=0;e<r;e++)o.set(e,e,n);return o}static diag(e,t,n){let r=e.length;void 0===t&&(t=r),void 0===n&&(n=t);let o=Math.min(r,t,n),i=this.zeros(t,n);for(let t=0;t<o;t++)i.set(t,t,e[t]);return i}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,r=e.columns,o=new Ml(n,r);for(let i=0;i<n;i++)for(let n=0;n<r;n++)o.set(i,n,Math.min(e.get(i,n),t.get(i,n)));return o}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,r=e.columns,o=new this(n,r);for(let i=0;i<n;i++)for(let n=0;n<r;n++)o.set(i,n,Math.max(e.get(i,n),t.get(i,n)));return o}static checkMatrix(e){return Dl.isMatrix(e)?e:new Ml(e)}static isMatrix(e){return null!=e&&"Matrix"===e.klass}get size(){return this.rows*this.columns}apply(e){if("function"!=typeof e)throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.call(this,t,n);return this}to1DArray(){let e=[];for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}to2DArray(){let e=[];for(let t=0;t<this.rows;t++){e.push([]);for(let n=0;n<this.columns;n++)e[t].push(this.get(t,n))}return e}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let e=0;e<this.rows;e++)for(let t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}isEchelonForm(){let e=0,t=0,n=-1,r=!0,o=!1;for(;e<this.rows&&r;){for(t=0,o=!1;t<this.columns&&!1===o;)0===this.get(e,t)?t++:1===this.get(e,t)&&t>n?(o=!0,n=t):(r=!1,o=!0);e++}return r}isReducedEchelonForm(){let e=0,t=0,n=-1,r=!0,o=!1;for(;e<this.rows&&r;){for(t=0,o=!1;t<this.columns&&!1===o;)0===this.get(e,t)?t++:1===this.get(e,t)&&t>n?(o=!0,n=t):(r=!1,o=!0);for(let n=t+1;n<this.rows;n++)0!==this.get(e,n)&&(r=!1);e++}return r}echelonForm(){let e=this.clone(),t=0,n=0;for(;t<e.rows&&n<e.columns;){let r=t;for(let o=t;o<e.rows;o++)e.get(o,n)>e.get(r,n)&&(r=o);if(0===e.get(r,n))n++;else{e.swapRows(t,r);let o=e.get(t,n);for(let r=n;r<e.columns;r++)e.set(t,r,e.get(t,r)/o);for(let r=t+1;r<e.rows;r++){let o=e.get(r,n)/e.get(t,n);e.set(r,n,0);for(let i=n+1;i<e.columns;i++)e.set(r,i,e.get(r,i)-e.get(t,i)*o)}t++,n++}}return e}reducedEchelonForm(){let e=this.echelonForm(),t=e.columns,n=e.rows,r=n-1;for(;r>=0;)if(0===e.maxRow(r))r--;else{let o=0,i=!1;for(;o<n&&!1===i;)1===e.get(r,o)?i=!0:o++;for(let n=0;n<r;n++){let i=e.get(n,o);for(let a=o;a<t;a++){let t=e.get(n,a)-i*e.get(r,a);e.set(n,a,t)}}r--}return e}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{rows:t=1,columns:n=1}=e;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let r=new Ml(this.rows*t,this.columns*n);for(let e=0;e<t;e++)for(let t=0;t<n;t++)r.setSubMatrix(this,this.rows*e,this.columns*t);return r}fill(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,e);return this}neg(){return this.mulS(-1)}getRow(e){wl(this,e);let t=[];for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}getRowVector(e){return Ml.rowVector(this.getRow(e))}setRow(e,t){wl(this,e),t=_l(this,t);for(let n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){wl(this,e),wl(this,t);for(let n=0;n<this.columns;n++){let r=this.get(e,n);this.set(e,n,this.get(t,n)),this.set(t,n,r)}return this}getColumn(e){xl(this,e);let t=[];for(let n=0;n<this.rows;n++)t.push(this.get(n,e));return t}getColumnVector(e){return Ml.columnVector(this.getColumn(e))}setColumn(e,t){xl(this,e),t=Sl(this,t);for(let n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){xl(this,e),xl(this,t);for(let n=0;n<this.rows;n++){let r=this.get(n,e);this.set(n,e,this.get(n,t)),this.set(n,t,r)}return this}addRowVector(e){e=_l(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[n]);return this}subRowVector(e){e=_l(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[n]);return this}mulRowVector(e){e=_l(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[n]);return this}divRowVector(e){e=_l(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[n]);return this}addColumnVector(e){e=Sl(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[t]);return this}subColumnVector(e){e=Sl(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[t]);return this}mulColumnVector(e){e=Sl(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[t]);return this}divColumnVector(e){e=Sl(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[t]);return this}mulRow(e,t){wl(this,e);for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){xl(this,e);for(let n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(e){if(this.isEmpty())return NaN;switch(e){case"row":{const e=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e[t]&&(e[t]=this.get(t,n));return e}case"column":{const e=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e[n]&&(e[n]=this.get(t,n));return e}case void 0:{let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}default:throw new Error(`invalid option: ${e}`)}}maxIndex(){Nl(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t}min(e){if(this.isEmpty())return NaN;switch(e){case"row":{const e=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e[t]&&(e[t]=this.get(t,n));return e}case"column":{const e=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e[n]&&(e[n]=this.get(t,n));return e}case void 0:{let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}default:throw new Error(`invalid option: ${e}`)}}minIndex(){Nl(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t}maxRow(e){if(wl(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){wl(this,e),Nl(this);let t=this.get(e,0),n=[e,0];for(let r=1;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r),n[1]=r);return n}minRow(e){if(wl(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){wl(this,e),Nl(this);let t=this.get(e,0),n=[e,0];for(let r=1;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r),n[1]=r);return n}maxColumn(e){if(xl(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){xl(this,e),Nl(this);let t=this.get(0,e),n=[0,e];for(let r=1;r<this.rows;r++)this.get(r,e)>t&&(t=this.get(r,e),n[0]=r);return n}minColumn(e){if(xl(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){xl(this,e),Nl(this);let t=this.get(0,e),n=[0,e];for(let r=1;r<this.rows;r++)this.get(r,e)<t&&(t=this.get(r,e),n[0]=r);return n}diag(){let e=Math.min(this.rows,this.columns),t=[];for(let n=0;n<e;n++)t.push(this.get(n,n));return t}norm(e="frobenius"){let t=0;if("max"===e)return this.max();if("frobenius"===e){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n)*this.get(e,n);return Math.sqrt(t)}throw new RangeError(`unknown norm type: ${e}`)}cumulativeSum(){let e=0;for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e+=this.get(t,n),this.set(t,n,e);return this}dot(e){Dl.isMatrix(e)&&(e=e.to1DArray());let t=this.to1DArray();if(t.length!==e.length)throw new RangeError("vectors do not have the same size");let n=0;for(let r=0;r<t.length;r++)n+=t[r]*e[r];return n}mmul(e){e=Ml.checkMatrix(e);let t=this.rows,n=this.columns,r=e.columns,o=new Ml(t,r),i=new Float64Array(n);for(let a=0;a<r;a++){for(let t=0;t<n;t++)i[t]=e.get(t,a);for(let e=0;e<t;e++){let t=0;for(let r=0;r<n;r++)t+=this.get(e,r)*i[r];o.set(e,a,t)}}return o}strassen2x2(e){e=Ml.checkMatrix(e);let t=new Ml(2,2);const n=this.get(0,0),r=e.get(0,0),o=this.get(0,1),i=e.get(0,1),a=this.get(1,0),s=e.get(1,0),u=this.get(1,1),c=e.get(1,1),l=(n+u)*(r+c),d=(a+u)*r,f=n*(i-c),h=u*(s-r),p=(n+o)*c,g=l+h-p+(o-u)*(s+c),m=f+p,v=d+h,y=l-d+f+(a-n)*(r+i);return t.set(0,0,g),t.set(0,1,m),t.set(1,0,v),t.set(1,1,y),t}strassen3x3(e){e=Ml.checkMatrix(e);let t=new Ml(3,3);const n=this.get(0,0),r=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),d=e.get(0,0),f=e.get(0,1),h=e.get(0,2),p=e.get(1,0),g=e.get(1,1),m=e.get(1,2),v=e.get(2,0),y=e.get(2,1),b=e.get(2,2),E=(n-i)*(-f+g),w=(-n+i+a)*(d-f+g),x=(i+a)*(-d+f),_=n*d,S=(-n+u+c)*(d-h+m),I=(-n+u)*(h-m),T=(u+c)*(-d+h),A=(-o+c+l)*(g+v-y),N=(o-l)*(g-y),D=o*v,k=(c+l)*(-v+y),M=(-o+a+s)*(m+v-b),O=(o-s)*(m-b),R=(a+s)*(-v+b),C=_+D+r*p,L=(n+r+o-i-a-c-l)*g+w+x+_+A+D+k,z=_+S+T+(n+r+o-a-s-u-c)*m+D+M+R,G=E+a*(-d+f+p-g-m-v+b)+w+_+D+M+O,P=E+w+x+_+s*y,j=D+M+O+R+i*h,F=_+S+I+c*(-d+h+p-g-m-v+y)+A+N+D,U=A+N+D+k+u*f,B=_+S+I+T+l*b;return t.set(0,0,C),t.set(0,1,L),t.set(0,2,z),t.set(1,0,G),t.set(1,1,P),t.set(1,2,j),t.set(2,0,F),t.set(2,1,U),t.set(2,2,B),t}mmulStrassen(e){e=Ml.checkMatrix(e);let t=this.clone(),n=t.rows,r=t.columns,o=e.rows,i=e.columns;function a(e,t,n){let r=e.rows,o=e.columns;if(r===t&&o===n)return e;{let r=Dl.zeros(t,n);return r=r.setSubMatrix(e,0,0),r}}r!==o&&console.warn(`Multiplying ${n} x ${r} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(n,o),u=Math.max(r,i);return t=a(t,s,u),function e(t,n,r,o){if(r<=512||o<=512)return t.mmul(n);r%2==1&&o%2==1?(t=a(t,r+1,o+1),n=a(n,r+1,o+1)):r%2==1?(t=a(t,r+1,o),n=a(n,r+1,o)):o%2==1&&(t=a(t,r,o+1),n=a(n,r,o+1));let i=parseInt(t.rows/2,10),s=parseInt(t.columns/2,10),u=t.subMatrix(0,i-1,0,s-1),c=n.subMatrix(0,i-1,0,s-1),l=t.subMatrix(0,i-1,s,t.columns-1),d=n.subMatrix(0,i-1,s,n.columns-1),f=t.subMatrix(i,t.rows-1,0,s-1),h=n.subMatrix(i,n.rows-1,0,s-1),p=t.subMatrix(i,t.rows-1,s,t.columns-1),g=n.subMatrix(i,n.rows-1,s,n.columns-1),m=e(Dl.add(u,p),Dl.add(c,g),i,s),v=e(Dl.add(f,p),c,i,s),y=e(u,Dl.sub(d,g),i,s),b=e(p,Dl.sub(h,c),i,s),E=e(Dl.add(u,l),g,i,s),w=e(Dl.sub(f,u),Dl.add(c,d),i,s),x=e(Dl.sub(l,p),Dl.add(h,g),i,s),_=Dl.add(m,b);_.sub(E),_.add(x);let S=Dl.add(y,E),I=Dl.add(v,b),T=Dl.sub(m,v);T.add(y),T.add(w);let A=Dl.zeros(2*_.rows,2*_.columns);return A=A.setSubMatrix(_,0,0),A=A.setSubMatrix(S,_.rows,0),A=A.setSubMatrix(I,0,_.columns),A=A.setSubMatrix(T,_.rows,_.columns),A.subMatrix(0,r-1,0,o-1)}(t,e=a(e,s,u),s,u)}scaleRows(e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{min:t=0,max:n=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(t>=n)throw new RangeError("min must be smaller than max");let r=new Ml(this.rows,this.columns);for(let e=0;e<this.rows;e++){const o=this.getRow(e);o.length>0&&gl(o,{min:t,max:n,output:o}),r.setRow(e,o)}return r}scaleColumns(e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{min:t=0,max:n=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(t>=n)throw new RangeError("min must be smaller than max");let r=new Ml(this.rows,this.columns);for(let e=0;e<this.columns;e++){const o=this.getColumn(e);o.length&&gl(o,{min:t,max:n,output:o}),r.setColumn(e,o)}return r}flipRows(){const e=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let n=0;n<e;n++){let e=this.get(t,n),r=this.get(t,this.columns-1-n);this.set(t,n,r),this.set(t,this.columns-1-n,e)}return this}flipColumns(){const e=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let n=0;n<e;n++){let e=this.get(n,t),r=this.get(this.rows-1-n,t);this.set(n,t,r),this.set(this.rows-1-n,t,e)}return this}kroneckerProduct(e){e=Ml.checkMatrix(e);let t=this.rows,n=this.columns,r=e.rows,o=e.columns,i=new Ml(t*r,n*o);for(let a=0;a<t;a++)for(let t=0;t<n;t++)for(let n=0;n<r;n++)for(let s=0;s<o;s++)i.set(r*a+n,o*t+s,this.get(a,t)*e.get(n,s));return i}kroneckerSum(e){if(e=Ml.checkMatrix(e),!this.isSquare()||!e.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let t=this.rows,n=e.rows,r=this.kroneckerProduct(Ml.eye(n,n)),o=Ml.eye(t,t).kroneckerProduct(e);return r.add(o)}transpose(){let e=new Ml(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.set(n,t,this.get(t,n));return e}sortRows(e=kl){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e=kl){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,r){Il(this,e,t,n,r);let o=new Ml(t-e+1,r-n+1);for(let i=e;i<=t;i++)for(let t=n;t<=r;t++)o.set(i-e,t-n,this.get(i,t));return o}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||t<0||t>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let r=new Ml(e.length,n-t+1);for(let o=0;o<e.length;o++)for(let i=t;i<=n;i++){if(e[o]<0||e[o]>=this.rows)throw new RangeError(`Row index out of range: ${e[o]}`);r.set(o,i-t,this.get(e[o],i))}return r}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||t<0||t>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let r=new Ml(n-t+1,e.length);for(let o=0;o<e.length;o++)for(let i=t;i<=n;i++){if(e[o]<0||e[o]>=this.columns)throw new RangeError(`Column index out of range: ${e[o]}`);r.set(i-t,o,this.get(i,e[o]))}return r}setSubMatrix(e,t,n){if((e=Ml.checkMatrix(e)).isEmpty())return this;Il(this,t,t+e.rows-1,n,n+e.columns-1);for(let r=0;r<e.rows;r++)for(let o=0;o<e.columns;o++)this.set(t+r,n+o,e.get(r,o));return this}selection(e,t){!function(e,t){if(!fl(t))throw new TypeError("row indices must be an array");for(let n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.rows)throw new RangeError("row indices are out of range")}(this,e),function(e,t){if(!fl(t))throw new TypeError("column indices must be an array");for(let n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.columns)throw new RangeError("column indices are out of range")}(this,t);let n=new Ml(e.length,t.length);for(let r=0;r<e.length;r++){let o=e[r];for(let e=0;e<t.length;e++){let i=t[e];n.set(r,e,this.get(o,i))}}return n}trace(){let e=Math.min(this.rows,this.columns),t=0;for(let n=0;n<e;n++)t+=this.get(n,n);return t}clone(){let e=new Ml(this.rows,this.columns);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.set(t,n,this.get(t,n));return e}sum(e){switch(e){case"row":return function(e){let t=Tl(e.rows);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[n]+=e.get(n,r);return t}(this);case"column":return function(e){let t=Tl(e.columns);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[r]+=e.get(n,r);return t}(this);case void 0:return function(e){let t=0;for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)t+=e.get(n,r);return t}(this);default:throw new Error(`invalid option: ${e}`)}}product(e){switch(e){case"row":return function(e){let t=Tl(e.rows,1);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[n]*=e.get(n,r);return t}(this);case"column":return function(e){let t=Tl(e.columns,1);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[r]*=e.get(n,r);return t}(this);case void 0:return function(e){let t=1;for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)t*=e.get(n,r);return t}(this);default:throw new Error(`invalid option: ${e}`)}}mean(e){const t=this.sum(e);switch(e){case"row":for(let e=0;e<this.rows;e++)t[e]/=this.columns;return t;case"column":for(let e=0;e<this.columns;e++)t[e]/=this.rows;return t;case void 0:return t/this.size;default:throw new Error(`invalid option: ${e}`)}}variance(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw new TypeError("options must be an object");const{unbiased:n=!0,mean:r=this.mean(e)}=t;if("boolean"!=typeof n)throw new TypeError("unbiased must be a boolean");switch(e){case"row":if(!fl(r))throw new TypeError("mean must be an array");return function(e,t,n){const r=e.rows,o=e.columns,i=[];for(let a=0;a<r;a++){let r=0,s=0,u=0;for(let t=0;t<o;t++)u=e.get(a,t)-n[a],r+=u,s+=u*u;t?i.push((s-r*r/o)/(o-1)):i.push((s-r*r/o)/o)}return i}(this,n,r);case"column":if(!fl(r))throw new TypeError("mean must be an array");return function(e,t,n){const r=e.rows,o=e.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let t=0;t<r;t++)u=e.get(t,a)-n[a],o+=u,s+=u*u;t?i.push((s-o*o/r)/(r-1)):i.push((s-o*o/r)/r)}return i}(this,n,r);case void 0:if("number"!=typeof r)throw new TypeError("mean must be a number");return function(e,t,n){const r=e.rows,o=e.columns,i=r*o;let a=0,s=0,u=0;for(let t=0;t<r;t++)for(let r=0;r<o;r++)u=e.get(t,r)-n,a+=u,s+=u*u;return t?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,n,r);default:throw new Error(`invalid option: ${e}`)}}standardDeviation(e,t){"object"==typeof e&&(t=e,e=void 0);const n=this.variance(e,t);if(void 0===e)return Math.sqrt(n);for(let e=0;e<n.length;e++)n[e]=Math.sqrt(n[e]);return n}center(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw new TypeError("options must be an object");const{center:n=this.mean(e)}=t;switch(e){case"row":if(!fl(n))throw new TypeError("center must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[n])}(this,n),this;case"column":if(!fl(n))throw new TypeError("center must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[r])}(this,n),this;case void 0:if("number"!=typeof n)throw new TypeError("center must be a number");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}scale(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw new TypeError("options must be an object");let n=t.scale;switch(e){case"row":if(void 0===n)n=function(e){const t=[];for(let n=0;n<e.rows;n++){let r=0;for(let t=0;t<e.columns;t++)r+=Math.pow(e.get(n,t),2)/(e.columns-1);t.push(Math.sqrt(r))}return t}(this);else if(!fl(n))throw new TypeError("scale must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[n])}(this,n),this;case"column":if(void 0===n)n=function(e){const t=[];for(let n=0;n<e.columns;n++){let r=0;for(let t=0;t<e.rows;t++)r+=Math.pow(e.get(t,n),2)/(e.rows-1);t.push(Math.sqrt(r))}return t}(this);else if(!fl(n))throw new TypeError("scale must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[r])}(this,n),this;case void 0:if(void 0===n)n=function(e){const t=e.size-1;let n=0;for(let r=0;r<e.columns;r++)for(let o=0;o<e.rows;o++)n+=Math.pow(e.get(o,r),2)/t;return Math.sqrt(n)}(this);else if("number"!=typeof n)throw new TypeError("scale must be a number");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}toString(e){return yl(this,e)}}function kl(e,t){return e-t}Dl.prototype.klass="Matrix","undefined"!=typeof Symbol&&(Dl.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return yl(this)}),Dl.random=Dl.rand,Dl.randomInt=Dl.randInt,Dl.diagonal=Dl.diag,Dl.prototype.diagonal=Dl.prototype.diag,Dl.identity=Dl.eye,Dl.prototype.negate=Dl.prototype.neg,Dl.prototype.tensorProduct=Dl.prototype.kroneckerProduct;class Ml extends Dl{constructor(e,t){if(super(),Ml.isMatrix(e))return e.clone();if(Number.isInteger(e)&&e>=0){if(this.data=[],!(Number.isInteger(t)&&t>=0))throw new TypeError("nColumns must be a positive integer");for(let n=0;n<e;n++)this.data.push(new Float64Array(t))}else{if(!fl(e))throw new TypeError("First argument must be a positive number or an array");{const n=e;if("number"!=typeof(t=(e=n.length)?n[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let r=0;r<e;r++){if(n[r].length!==t)throw new RangeError("Inconsistent array dimensions");if(!n[r].every((e=>"number"==typeof e)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(n[r]))}}}this.rows=e,this.columns=t}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}removeRow(e){return wl(this,e),this.data.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),wl(this,e,!0),t=Float64Array.from(_l(this,t)),this.data.splice(e,0,t),this.rows+=1,this}removeColumn(e){xl(this,e);for(let t=0;t<this.rows;t++){const n=new Float64Array(this.columns-1);for(let r=0;r<e;r++)n[r]=this.data[t][r];for(let r=e+1;r<this.columns;r++)n[r-1]=this.data[t][r];this.data[t]=n}return this.columns-=1,this}addColumn(e,t){void 0===t&&(t=e,e=this.columns),xl(this,e,!0),t=Sl(this,t);for(let n=0;n<this.rows;n++){const r=new Float64Array(this.columns+1);let o=0;for(;o<e;o++)r[o]=this.data[n][o];for(r[o++]=t[n];o<this.columns+1;o++)r[o]=this.data[n][o-1];this.data[n]=r}return this.columns+=1,this}}!function(e,t){e.prototype.add=function(e){return"number"==typeof e?this.addS(e):this.addM(e)},e.prototype.addS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e);return this},e.prototype.addM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e.get(t,n));return this},e.add=function(e,n){return new t(e).add(n)},e.prototype.sub=function(e){return"number"==typeof e?this.subS(e):this.subM(e)},e.prototype.subS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e);return this},e.prototype.subM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e.get(t,n));return this},e.sub=function(e,n){return new t(e).sub(n)},e.prototype.subtract=e.prototype.sub,e.prototype.subtractS=e.prototype.subS,e.prototype.subtractM=e.prototype.subM,e.subtract=e.sub,e.prototype.mul=function(e){return"number"==typeof e?this.mulS(e):this.mulM(e)},e.prototype.mulS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this},e.prototype.mulM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e.get(t,n));return this},e.mul=function(e,n){return new t(e).mul(n)},e.prototype.multiply=e.prototype.mul,e.prototype.multiplyS=e.prototype.mulS,e.prototype.multiplyM=e.prototype.mulM,e.multiply=e.mul,e.prototype.div=function(e){return"number"==typeof e?this.divS(e):this.divM(e)},e.prototype.divS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e);return this},e.prototype.divM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e.get(t,n));return this},e.div=function(e,n){return new t(e).div(n)},e.prototype.divide=e.prototype.div,e.prototype.divideS=e.prototype.divS,e.prototype.divideM=e.prototype.divM,e.divide=e.div,e.prototype.mod=function(e){return"number"==typeof e?this.modS(e):this.modM(e)},e.prototype.modS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e);return this},e.prototype.modM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e.get(t,n));return this},e.mod=function(e,n){return new t(e).mod(n)},e.prototype.modulus=e.prototype.mod,e.prototype.modulusS=e.prototype.modS,e.prototype.modulusM=e.prototype.modM,e.modulus=e.mod,e.prototype.and=function(e){return"number"==typeof e?this.andS(e):this.andM(e)},e.prototype.andS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e);return this},e.prototype.andM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e.get(t,n));return this},e.and=function(e,n){return new t(e).and(n)},e.prototype.or=function(e){return"number"==typeof e?this.orS(e):this.orM(e)},e.prototype.orS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e);return this},e.prototype.orM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e.get(t,n));return this},e.or=function(e,n){return new t(e).or(n)},e.prototype.xor=function(e){return"number"==typeof e?this.xorS(e):this.xorM(e)},e.prototype.xorS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e);return this},e.prototype.xorM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e.get(t,n));return this},e.xor=function(e,n){return new t(e).xor(n)},e.prototype.leftShift=function(e){return"number"==typeof e?this.leftShiftS(e):this.leftShiftM(e)},e.prototype.leftShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e);return this},e.prototype.leftShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e.get(t,n));return this},e.leftShift=function(e,n){return new t(e).leftShift(n)},e.prototype.signPropagatingRightShift=function(e){return"number"==typeof e?this.signPropagatingRightShiftS(e):this.signPropagatingRightShiftM(e)},e.prototype.signPropagatingRightShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e);return this},e.prototype.signPropagatingRightShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e.get(t,n));return this},e.signPropagatingRightShift=function(e,n){return new t(e).signPropagatingRightShift(n)},e.prototype.rightShift=function(e){return"number"==typeof e?this.rightShiftS(e):this.rightShiftM(e)},e.prototype.rightShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e);return this},e.prototype.rightShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e.get(t,n));return this},e.rightShift=function(e,n){return new t(e).rightShift(n)},e.prototype.zeroFillRightShift=e.prototype.rightShift,e.prototype.zeroFillRightShiftS=e.prototype.rightShiftS,e.prototype.zeroFillRightShiftM=e.prototype.rightShiftM,e.zeroFillRightShift=e.rightShift,e.prototype.not=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,~this.get(e,t));return this},e.not=function(e){return new t(e).not()},e.prototype.abs=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.abs(this.get(e,t)));return this},e.abs=function(e){return new t(e).abs()},e.prototype.acos=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.acos(this.get(e,t)));return this},e.acos=function(e){return new t(e).acos()},e.prototype.acosh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.acosh(this.get(e,t)));return this},e.acosh=function(e){return new t(e).acosh()},e.prototype.asin=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.asin(this.get(e,t)));return this},e.asin=function(e){return new t(e).asin()},e.prototype.asinh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.asinh(this.get(e,t)));return this},e.asinh=function(e){return new t(e).asinh()},e.prototype.atan=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.atan(this.get(e,t)));return this},e.atan=function(e){return new t(e).atan()},e.prototype.atanh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.atanh(this.get(e,t)));return this},e.atanh=function(e){return new t(e).atanh()},e.prototype.cbrt=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cbrt(this.get(e,t)));return this},e.cbrt=function(e){return new t(e).cbrt()},e.prototype.ceil=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.ceil(this.get(e,t)));return this},e.ceil=function(e){return new t(e).ceil()},e.prototype.clz32=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.clz32(this.get(e,t)));return this},e.clz32=function(e){return new t(e).clz32()},e.prototype.cos=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cos(this.get(e,t)));return this},e.cos=function(e){return new t(e).cos()},e.prototype.cosh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cosh(this.get(e,t)));return this},e.cosh=function(e){return new t(e).cosh()},e.prototype.exp=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.exp(this.get(e,t)));return this},e.exp=function(e){return new t(e).exp()},e.prototype.expm1=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.expm1(this.get(e,t)));return this},e.expm1=function(e){return new t(e).expm1()},e.prototype.floor=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.floor(this.get(e,t)));return this},e.floor=function(e){return new t(e).floor()},e.prototype.fround=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.fround(this.get(e,t)));return this},e.fround=function(e){return new t(e).fround()},e.prototype.log=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log(this.get(e,t)));return this},e.log=function(e){return new t(e).log()},e.prototype.log1p=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log1p(this.get(e,t)));return this},e.log1p=function(e){return new t(e).log1p()},e.prototype.log10=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log10(this.get(e,t)));return this},e.log10=function(e){return new t(e).log10()},e.prototype.log2=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log2(this.get(e,t)));return this},e.log2=function(e){return new t(e).log2()},e.prototype.round=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.round(this.get(e,t)));return this},e.round=function(e){return new t(e).round()},e.prototype.sign=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sign(this.get(e,t)));return this},e.sign=function(e){return new t(e).sign()},e.prototype.sin=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sin(this.get(e,t)));return this},e.sin=function(e){return new t(e).sin()},e.prototype.sinh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sinh(this.get(e,t)));return this},e.sinh=function(e){return new t(e).sinh()},e.prototype.sqrt=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sqrt(this.get(e,t)));return this},e.sqrt=function(e){return new t(e).sqrt()},e.prototype.tan=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.tan(this.get(e,t)));return this},e.tan=function(e){return new t(e).tan()},e.prototype.tanh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.tanh(this.get(e,t)));return this},e.tanh=function(e){return new t(e).tanh()},e.prototype.trunc=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.trunc(this.get(e,t)));return this},e.trunc=function(e){return new t(e).trunc()},e.pow=function(e,n){return new t(e).pow(n)},e.prototype.pow=function(e){return"number"==typeof e?this.powS(e):this.powM(e)},e.prototype.powS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,Math.pow(this.get(t,n),e));return this},e.prototype.powM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,Math.pow(this.get(t,n),e.get(t,n)));return this}}(Dl,Ml);class Ol extends Dl{constructor(e){super(),this.data=e,this.rows=e.length,this.columns=e[0].length}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}}function Rl(e,t){let n=0;return Math.abs(e)>Math.abs(t)?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0!==t?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0}class Cl{constructor(e,t={}){if((e=Ol.checkMatrix(e)).isEmpty())throw new Error("Matrix must be non-empty");let n=e.rows,r=e.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=t;let s,u=Boolean(o),c=Boolean(i),l=!1;if(n<r)if(a){s=e.transpose(),n=s.rows,r=s.columns,l=!0;let t=u;u=c,c=t}else s=e.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=e.clone();let d=Math.min(n,r),f=Math.min(n+1,r),h=new Float64Array(f),p=new Ml(n,d),g=new Ml(r,r),m=new Float64Array(r),v=new Float64Array(n),y=new Float64Array(f);for(let e=0;e<f;e++)y[e]=e;let b=Math.min(n-1,r),E=Math.max(0,Math.min(r-2,n)),w=Math.max(b,E);for(let e=0;e<w;e++){if(e<b){h[e]=0;for(let t=e;t<n;t++)h[e]=Rl(h[e],s.get(t,e));if(0!==h[e]){s.get(e,e)<0&&(h[e]=-h[e]);for(let t=e;t<n;t++)s.set(t,e,s.get(t,e)/h[e]);s.set(e,e,s.get(e,e)+1)}h[e]=-h[e]}for(let t=e+1;t<r;t++){if(e<b&&0!==h[e]){let r=0;for(let o=e;o<n;o++)r+=s.get(o,e)*s.get(o,t);r=-r/s.get(e,e);for(let o=e;o<n;o++)s.set(o,t,s.get(o,t)+r*s.get(o,e))}m[t]=s.get(e,t)}if(u&&e<b)for(let t=e;t<n;t++)p.set(t,e,s.get(t,e));if(e<E){m[e]=0;for(let t=e+1;t<r;t++)m[e]=Rl(m[e],m[t]);if(0!==m[e]){m[e+1]<0&&(m[e]=0-m[e]);for(let t=e+1;t<r;t++)m[t]/=m[e];m[e+1]+=1}if(m[e]=-m[e],e+1<n&&0!==m[e]){for(let t=e+1;t<n;t++)v[t]=0;for(let t=e+1;t<n;t++)for(let n=e+1;n<r;n++)v[t]+=m[n]*s.get(t,n);for(let t=e+1;t<r;t++){let r=-m[t]/m[e+1];for(let o=e+1;o<n;o++)s.set(o,t,s.get(o,t)+r*v[o])}}if(c)for(let t=e+1;t<r;t++)g.set(t,e,m[t])}}let x=Math.min(r,n+1);if(b<r&&(h[b]=s.get(b,b)),n<x&&(h[x-1]=0),E+1<x&&(m[E]=s.get(E,x-1)),m[x-1]=0,u){for(let e=b;e<d;e++){for(let t=0;t<n;t++)p.set(t,e,0);p.set(e,e,1)}for(let e=b-1;e>=0;e--)if(0!==h[e]){for(let t=e+1;t<d;t++){let r=0;for(let o=e;o<n;o++)r+=p.get(o,e)*p.get(o,t);r=-r/p.get(e,e);for(let o=e;o<n;o++)p.set(o,t,p.get(o,t)+r*p.get(o,e))}for(let t=e;t<n;t++)p.set(t,e,-p.get(t,e));p.set(e,e,1+p.get(e,e));for(let t=0;t<e-1;t++)p.set(t,e,0)}else{for(let t=0;t<n;t++)p.set(t,e,0);p.set(e,e,1)}}if(c)for(let e=r-1;e>=0;e--){if(e<E&&0!==m[e])for(let t=e+1;t<r;t++){let n=0;for(let o=e+1;o<r;o++)n+=g.get(o,e)*g.get(o,t);n=-n/g.get(e+1,e);for(let o=e+1;o<r;o++)g.set(o,t,g.get(o,t)+n*g.get(o,e))}for(let t=0;t<r;t++)g.set(t,e,0);g.set(e,e,1)}let _=x-1,S=0,I=Number.EPSILON;for(;x>0;){let e,t;for(e=x-2;e>=-1&&-1!==e;e--){const t=Number.MIN_VALUE+I*Math.abs(h[e]+Math.abs(h[e+1]));if(Math.abs(m[e])<=t||Number.isNaN(m[e])){m[e]=0;break}}if(e===x-2)t=4;else{let n;for(n=x-1;n>=e&&n!==e;n--){let t=(n!==x?Math.abs(m[n]):0)+(n!==e+1?Math.abs(m[n-1]):0);if(Math.abs(h[n])<=I*t){h[n]=0;break}}n===e?t=3:n===x-1?t=1:(t=2,e=n)}switch(e++,t){case 1:{let t=m[x-2];m[x-2]=0;for(let n=x-2;n>=e;n--){let o=Rl(h[n],t),i=h[n]/o,a=t/o;if(h[n]=o,n!==e&&(t=-a*m[n-1],m[n-1]=i*m[n-1]),c)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,x-1),g.set(e,x-1,-a*g.get(e,n)+i*g.get(e,x-1)),g.set(e,n,o)}break}case 2:{let t=m[e-1];m[e-1]=0;for(let r=e;r<x;r++){let o=Rl(h[r],t),i=h[r]/o,a=t/o;if(h[r]=o,t=-a*m[r],m[r]=i*m[r],u)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,e-1),p.set(t,e-1,-a*p.get(t,r)+i*p.get(t,e-1)),p.set(t,r,o)}break}case 3:{const t=Math.max(Math.abs(h[x-1]),Math.abs(h[x-2]),Math.abs(m[x-2]),Math.abs(h[e]),Math.abs(m[e])),o=h[x-1]/t,i=h[x-2]/t,a=m[x-2]/t,s=h[e]/t,l=m[e]/t,d=((i+o)*(i-o)+a*a)/2,f=o*a*(o*a);let v=0;0===d&&0===f||(v=d<0?0-Math.sqrt(d*d+f):Math.sqrt(d*d+f),v=f/(d+v));let y=(s+o)*(s-o)+v,b=s*l;for(let t=e;t<x-1;t++){let o=Rl(y,b);0===o&&(o=Number.MIN_VALUE);let i=y/o,a=b/o;if(t!==e&&(m[t-1]=o),y=i*h[t]+a*m[t],m[t]=i*m[t]-a*h[t],b=a*h[t+1],h[t+1]=i*h[t+1],c)for(let e=0;e<r;e++)o=i*g.get(e,t)+a*g.get(e,t+1),g.set(e,t+1,-a*g.get(e,t)+i*g.get(e,t+1)),g.set(e,t,o);if(o=Rl(y,b),0===o&&(o=Number.MIN_VALUE),i=y/o,a=b/o,h[t]=o,y=i*m[t]+a*h[t+1],h[t+1]=-a*m[t]+i*h[t+1],b=a*m[t+1],m[t+1]=i*m[t+1],u&&t<n-1)for(let e=0;e<n;e++)o=i*p.get(e,t)+a*p.get(e,t+1),p.set(e,t+1,-a*p.get(e,t)+i*p.get(e,t+1)),p.set(e,t,o)}m[x-2]=y,S+=1;break}case 4:if(h[e]<=0&&(h[e]=h[e]<0?-h[e]:0,c))for(let t=0;t<=_;t++)g.set(t,e,-g.get(t,e));for(;e<_&&!(h[e]>=h[e+1]);){let t=h[e];if(h[e]=h[e+1],h[e+1]=t,c&&e<r-1)for(let n=0;n<r;n++)t=g.get(n,e+1),g.set(n,e+1,g.get(n,e)),g.set(n,e,t);if(u&&e<n-1)for(let r=0;r<n;r++)t=p.get(r,e+1),p.set(r,e+1,p.get(r,e)),p.set(r,e,t);e++}S=0,x--}}if(l){let e=g;g=p,p=e}this.m=n,this.n=r,this.s=h,this.U=p,this.V=g}solve(e){let t=e,n=this.threshold,r=this.s.length,o=Ml.zeros(r,r);for(let e=0;e<r;e++)Math.abs(this.s[e])<=n?o.set(e,e,0):o.set(e,e,1/this.s[e]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,c=i.rows,l=Ml.zeros(u,c);for(let e=0;e<u;e++)for(let t=0;t<c;t++){let n=0;for(let o=0;o<r;o++)n+=s.get(e,o)*i.get(t,o);l.set(e,t,n)}return l.mmul(t)}solveForDiagonal(e){return this.solve(Ml.diag(e))}inverse(){let e=this.V,t=this.threshold,n=e.rows,r=e.columns,o=new Ml(n,this.s.length);for(let i=0;i<n;i++)for(let n=0;n<r;n++)Math.abs(this.s[n])>t&&o.set(i,n,e.get(i,n)/this.s[n]);let i=this.U,a=i.rows,s=i.columns,u=new Ml(n,a);for(let e=0;e<n;e++)for(let t=0;t<a;t++){let n=0;for(let r=0;r<s;r++)n+=o.get(e,r)*i.get(t,r);u.set(e,t,n)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let e=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,n=this.s;for(let r=0,o=n.length;r<o;r++)n[r]>e&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Ml.diag(this.s)}}class Ll{constructor(e){this.distances=e.distances,this.dimension=e.dimension||2,this.linkDistance=e.linkDistance}layout(){const{dimension:e,distances:t,linkDistance:n}=this;try{const n=Ml.mul(Ml.pow(t,2),-.5),r=n.mean("row"),o=n.mean("column"),i=n.mean();n.add(i).subRowVector(r).subColumnVector(o);const a=new Cl(n),s=Ml.sqrt(a.diagonalMatrix).diagonal();return a.leftSingularVectors.toJSON().map((t=>Ml.mul([t],[s]).toJSON()[0].splice(0,e)))}catch(e){const r=[];for(let e=0;e<t.length;e++){const e=Math.random()*n,t=Math.random()*n;r.push([e,t])}return r}}}class zl{constructor(e){this.disp=[],this.positions=e.positions,this.adjMatrix=e.adjMatrix,this.focusID=e.focusID,this.radii=e.radii,this.iterations=e.iterations||10,this.height=e.height||10,this.width=e.width||10,this.speed=e.speed||100,this.gravity=e.gravity||10,this.nodeSizeFunc=e.nodeSizeFunc,this.k=e.k||5,this.strictRadial=e.strictRadial,this.nodes=e.nodes}layout(){const e=this,t=e.positions,n=[],r=e.iterations,o=e.width/10;e.maxDisplace=o,e.disp=n;for(let o=0;o<r;o++)t.forEach(((e,t)=>{n[t]={x:0,y:0}})),e.getRepulsion(),e.updatePositions();return t}getRepulsion(){const e=this,t=e.positions,n=e.nodes,r=e.disp,o=e.k,i=e.radii||[];t.forEach(((a,s)=>{r[s]={x:0,y:0},t.forEach(((t,u)=>{if(s===u)return;if(i[s]!==i[u])return;let c=a[0]-t[0],l=a[1]-t[1],d=Math.sqrt(c*c+l*l);if(0===d){d=1;const e=s>u?1:-1;c=.01*e,l=.01*e}if(d<e.nodeSizeFunc(n[s])/2+e.nodeSizeFunc(n[u])/2){const e=o*o/d;r[s].x+=c/d*e,r[s].y+=l/d*e}}))}))}updatePositions(){const e=this,t=e.positions,n=e.disp,r=e.speed,o=e.strictRadial,i=e.focusID,a=e.maxDisplace||e.width/10;o&&n.forEach(((e,n)=>{const r=t[n][0]-t[i][0],o=t[n][1]-t[i][1],a=Math.sqrt(r*r+o*o);let s=o/a,u=-r/a;const c=Math.sqrt(e.x*e.x+e.y*e.y);let l=Math.acos((s*e.x+u*e.y)/c);l>Math.PI/2&&(l-=Math.PI/2,s*=-1,u*=-1);const d=Math.cos(l)*c;e.x=s*d,e.y=u*d}));const s=e.radii;t.forEach(((e,u)=>{if(u===i)return;const c=Math.sqrt(n[u].x*n[u].x+n[u].y*n[u].y);if(c>0&&u!==i){const l=Math.min(a*(r/800),c);if(e[0]+=n[u].x/c*l,e[1]+=n[u].y/c*l,o){let n=e[0]-t[i][0],r=e[1]-t[i][1];const o=Math.sqrt(n*n+r*r);n=n/o*s[u],r=r/o*s[u],e[0]=t[i][0]+n,e[1]=t[i][1]+r}}}))}}function Gl(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}class Pl extends i{constructor(e){super(),this.maxIteration=1e3,this.focusNode=null,this.unitRadius=null,this.linkDistance=50,this.preventOverlap=!1,this.strictRadial=!0,this.maxPreventOverlapIteration=200,this.sortStrength=10,this.nodes=[],this.edges=[],this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}}execute(){const e=this,t=e.nodes,n=e.edges||[];if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const r=e.center;if(1===t.length)return t[0].x=r[0],t[0].y=r[1],void(e.onLayoutEnd&&e.onLayoutEnd());const o=e.linkDistance;let i=null;if(a(e.focusNode)){let n=!1;for(let r=0;r<t.length;r++)t[r].id===e.focusNode&&(i=t[r],e.focusNode=i,n=!0,r=t.length);n||(i=null)}else i=e.focusNode;i||(i=t[0],e.focusNode=i);let d=function(e,t){let n=-1;return e.forEach(((e,r)=>{e.id===t&&(n=r)})),n}(t,i.id);d<0&&(d=0),e.focusIndex=d;const f=g({nodes:t,edges:n},!1),h=p(f),m=e.maxToFocus(h,d);e.handleInfinity(h,d,m+1),e.distances=h;const v=h[d],y=e.width||500,b=e.height||500;let E=y-r[0]>r[0]?r[0]:y-r[0],x=b-r[1]>r[1]?r[1]:b-r[1];0===E&&(E=y/2),0===x&&(x=b/2);const _=x>E?E:x,S=Math.max(...v),I=[];v.forEach(((t,n)=>{e.unitRadius||(e.unitRadius=_/S),I[n]=t*e.unitRadius})),e.radii=I;const T=e.eIdealDisMatrix();e.eIdealDistances=T;const A=function(e){const t=e.length,n=e[0].length,r=[];for(let o=0;o<t;o++){const t=[];for(let r=0;r<n;r++)0!==e[o][r]?t.push(1/(e[o][r]*e[o][r])):t.push(0);r.push(t)}return r}(T);e.weights=A;let N=new Ll({linkDistance:o,distances:T}).layout();N.forEach((e=>{c(e[0])&&(e[0]=Math.random()*o),c(e[1])&&(e[1]=Math.random()*o)})),e.positions=N,N.forEach(((e,n)=>{t[n].x=e[0]+r[0],t[n].y=e[1]+r[1]})),N.forEach((e=>{e[0]-=N[d][0],e[1]-=N[d][1]})),e.run();const D=e.preventOverlap,k=e.nodeSize;let M;const O=e.strictRadial;if(D){const n=e.nodeSpacing;let r;r=u(n)?()=>n:w(n)?n:()=>0,M=k?s(k)?e=>(k[0]>k[1]?k[0]:k[1])+r(e):e=>k+r(e):e=>e.size?s(e.size)?(e.size[0]>e.size[1]?e.size[0]:e.size[1])+r(e):l(e.size)?(e.size.width>e.size.height?e.size.width:e.size.height)+r(e):e.size+r(e):10+r(e);const o={nodes:t,nodeSizeFunc:M,adjMatrix:f,positions:N,radii:I,height:b,width:y,strictRadial:O,focusID:d,iterations:e.maxPreventOverlapIteration||200,k:N.length/4.5},i=new zl(o);N=i.layout()}return N.forEach(((e,n)=>{t[n].x=e[0]+r[0],t[n].y=e[1]+r[1]})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}run(){const e=this,t=e.maxIteration,n=e.positions||[],r=e.weights||[],o=e.eIdealDistances||[],i=e.radii||[];for(let a=0;a<=t;a++){const s=a/t;e.oneIteration(s,n,i,o,r)}}oneIteration(e,t,n,r,o){const i=1-e,a=this.focusIndex;t.forEach(((s,u)=>{const c=Gl(s,[0,0]),l=0===c?0:1/c;if(u===a)return;let d=0,f=0,h=0;t.forEach(((e,t)=>{if(u===t)return;const n=Gl(s,e),i=0===n?0:1/n,a=r[t][u];h+=o[u][t],d+=o[u][t]*(e[0]+a*(s[0]-e[0])*i),f+=o[u][t]*(e[1]+a*(s[1]-e[1])*i)}));const p=0===n[u]?0:1/n[u];h*=i,h+=e*p*p,d*=i,d+=e*p*s[0]*l,s[0]=d/h,f*=i,f+=e*p*s[1]*l,s[1]=f/h}))}eIdealDisMatrix(){const e=this,t=e.nodes;if(!t)return[];const n=e.distances,r=e.linkDistance,o=e.radii||[],i=e.unitRadius||50,s=[];return n&&n.forEach(((n,u)=>{const c=[];n.forEach(((n,s)=>{if(u===s)c.push(0);else if(o[u]===o[s])if("data"===e.sortBy)c.push(n*(Math.abs(u-s)*e.sortStrength)/(o[u]/i));else if(e.sortBy){let r=t[u][e.sortBy]||0,l=t[s][e.sortBy]||0;a(r)&&(r=r.charCodeAt(0)),a(l)&&(l=l.charCodeAt(0)),c.push(n*(Math.abs(r-l)*e.sortStrength)/(o[u]/i))}else c.push(n*r/(o[u]/i));else{const e=(r+i)/2;c.push(n*e)}})),s.push(c)})),s}handleInfinity(e,t,n){const r=e.length;for(let o=0;o<r;o++)if(e[t][o]===1/0){e[t][o]=n,e[o][t]=n;for(let i=0;i<r;i++)e[o][i]!==1/0&&e[t][i]===1/0&&(e[t][i]=n+e[o][i],e[i][t]=n+e[o][i])}for(let n=0;n<r;n++)if(n!==t)for(let o=0;o<r;o++)if(e[n][o]===1/0){let r=Math.abs(e[t][n]-e[t][o]);r=0===r?1:r,e[n][o]=r}}maxToFocus(e,t){let n=0;for(let r=0;r<e[t].length;r++)e[t][r]!==1/0&&(n=e[t][r]>n?e[t][r]:n);return n}getType(){return"radial"}}class jl extends i{constructor(e){super(),this.nodeSize=30,this.minNodeSpacing=10,this.nodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=1.5*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){var e,t;const n=this,{nodes:r,edges:o}=n,i=r.length;if(0===i)return void(null===(e=n.onLayoutEnd)||void 0===e||e.call(n));n.width||"undefined"==typeof window||(n.width=window.innerWidth),n.height||"undefined"==typeof window||(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const c=n.center;if(1===i)return r[0].x=c[0],r[0].y=c[1],void(null===(t=n.onLayoutEnd)||void 0===t||t.call(n));const{nodeSize:d,nodeSpacing:f}=n,p=[];let g,m=0;g=s(d)?Math.max(d[0],d[1]):d,s(f)?m=Math.max(f[0],f[1]):u(f)&&(m=f),r.forEach((e=>{p.push(e);let t=g;s(e.size)?t=Math.max(e.size[0],e.size[1]):u(e.size)?t=e.size:l(e.size)&&(t=Math.max(e.size.width,e.size.height)),g=Math.max(g,t),w(f)&&(m=Math.max(f(e),m))})),n.clockwise=void 0!==n.counterclockwise?!n.counterclockwise:n.clockwise;const v={},y={};if(p.forEach(((e,t)=>{v[e.id]=e,y[e.id]=t})),!("degree"!==n.sortBy&&a(n.sortBy)&&void 0!==p[0][n.sortBy]||(n.sortBy="degree",u(r[0].degree)))){const e=h(r.length,y,o);p.forEach(((t,n)=>{t.degree=e[n].all}))}p.sort(((e,t)=>t[n.sortBy]-e[n.sortBy])),n.maxValueNode=p[0],n.maxLevelDiff=n.maxLevelDiff||n.maxValueNode[n.sortBy]/4;const b=[[]];let E=b[0];p.forEach((e=>{if(E.length>0){const t=Math.abs(E[0][n.sortBy]-e[n.sortBy]);n.maxLevelDiff&&t>=n.maxLevelDiff&&(E=[],b.push(E))}E.push(e)}));let x=g+(m||n.minNodeSpacing);if(!n.preventOverlap){const e=b.length>0&&b[0].length>1,t=(Math.min(n.width,n.height)/2-x)/(b.length+(e?1:0));x=Math.min(x,t)}let _=0;if(b.forEach((e=>{let t=n.sweep;void 0===t&&(t=2*Math.PI-2*Math.PI/e.length);const r=e.dTheta=t/Math.max(1,e.length-1);if(e.length>1&&n.preventOverlap){const e=Math.cos(r)-Math.cos(0),t=Math.sin(r)-Math.sin(0),n=Math.sqrt(x*x/(e*e+t*t));_=Math.max(n,_)}e.r=_,_+=x})),n.equidistant){let e=0,t=0;for(let n=0;n<b.length;n++){const r=b[n].r-t;e=Math.max(e,r)}t=0,b.forEach(((n,r)=>{0===r&&(t=n.r),n.r=t,t+=e}))}return b.forEach((e=>{const t=e.dTheta,r=e.r;e.forEach(((e,o)=>{const i=n.startAngle+(n.clockwise?1:-1)*t*o;e.x=c[0]+r*Math.cos(i),e.y=c[1]+r*Math.sin(i)}))})),n.onLayoutEnd&&n.onLayoutEnd(),{nodes:r,edges:o}}getType(){return"concentric"}}class Fl extends i{constructor(e){super(),this.center=[0,0],this.linkDistance=50,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],linkDistance:50}}execute(){const e=this,{nodes:t,edges:n=[]}=e,r=e.center;if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());if(1===t.length)return t[0].x=r[0],t[0].y=r[1],void(e.onLayoutEnd&&e.onLayoutEnd());const o=e.linkDistance,i=g({nodes:t,edges:n},!1),a=p(i);e.handleInfinity(a);const s=((e,t)=>{const n=[];return e.forEach((e=>{const r=[];e.forEach((e=>{r.push(e*t)})),n.push(r)})),n})(a,o);e.scaledDistances=s;const u=e.runMDS();return e.positions=u,u.forEach(((e,n)=>{t[n].x=e[0]+r[0],t[n].y=e[1]+r[1]})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}runMDS(){const e=this.scaledDistances,t=Ml.mul(Ml.pow(e,2),-.5),n=t.mean("row"),r=t.mean("column"),o=t.mean();t.add(o).subRowVector(n).subColumnVector(r);const i=new Cl(t),a=Ml.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((e=>Ml.mul([e],[a]).toJSON()[0].splice(0,2)))}handleInfinity(e){let t=-999999;e.forEach((e=>{e.forEach((e=>{e!==1/0&&t<e&&(t=e)}))})),e.forEach(((n,r)=>{n.forEach(((n,o)=>{n===1/0&&(e[r][o]=t)}))}))}getType(){return"mds"}}class Ul extends i{constructor(e){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.animate=!0,this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10,animate:!0}}execute(){var e,t;const n=this,r=n.nodes;if(void 0!==n.timeInterval&&"undefined"!=typeof window&&window.clearInterval(n.timeInterval),!r||0===r.length)return void(null===(e=n.onLayoutEnd)||void 0===e||e.call(n));n.width||"undefined"==typeof window||(n.width=window.innerWidth),n.height||"undefined"==typeof window||(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const o=n.center;if(1===r.length)return r[0].x=o[0],r[0].y=o[1],void(null===(t=n.onLayoutEnd)||void 0===t||t.call(n));const i={},a={};return r.forEach(((e,t)=>{u(e.x)||(e.x=Math.random()*this.width),u(e.y)||(e.y=Math.random()*this.height),i[e.id]=e,a[e.id]=t})),n.nodeMap=i,n.nodeIdxMap=a,n.run()}run(){var e;const t=this,n=t.nodes;if(!n)return;const{edges:r,maxIteration:o,workerEnabled:i,clustering:a,animate:s}=t,u={};if(a&&n.forEach((e=>{void 0===u[e.cluster]&&(u[e.cluster]={name:e.cluster,cx:0,cy:0,count:0})})),i||!s){for(let e=0;e<o;e++)t.runOneStep(u);null===(e=t.onLayoutEnd)||void 0===e||e.call(t)}else{if("undefined"==typeof window)return;let e=0;this.timeInterval=window.setInterval((()=>{var n;t.runOneStep(u),e++,e>=o&&(null===(n=t.onLayoutEnd)||void 0===n||n.call(t),window.clearInterval(t.timeInterval))}),0)}return{nodes:n,edges:r}}runOneStep(e){var t;const n=this,r=n.nodes;if(!r)return;const{edges:o,center:i,gravity:a,speed:s,clustering:c}=n,l=n.height*n.width,d=Math.sqrt(l)/10,f=l/(r.length+1),h=Math.sqrt(f),p=[];if(r.forEach(((e,t)=>{p[t]={x:0,y:0}})),n.applyCalculate(r,o,p,h,f),c){for(const t in e)e[t].cx=0,e[t].cy=0,e[t].count=0;r.forEach((t=>{const n=e[t.cluster];u(t.x)&&(n.cx+=t.x),u(t.y)&&(n.cy+=t.y),n.count++}));for(const t in e)e[t].cx/=e[t].count,e[t].cy/=e[t].count;const t=n.clusterGravity||a;r.forEach(((n,r)=>{if(!u(n.x)||!u(n.y))return;const o=e[n.cluster],i=Math.sqrt((n.x-o.cx)*(n.x-o.cx)+(n.y-o.cy)*(n.y-o.cy)),a=h*t;p[r].x-=a*(n.x-o.cx)/i,p[r].y-=a*(n.y-o.cy)/i}))}r.forEach(((e,t)=>{if(!u(e.x)||!u(e.y))return;const n=.01*h*a;p[t].x-=n*(e.x-i[0]),p[t].y-=n*(e.y-i[1])})),r.forEach(((e,t)=>{if(u(e.fx)&&u(e.fy))return e.x=e.fx,void(e.y=e.fy);if(!u(e.x)||!u(e.y))return;const n=Math.sqrt(p[t].x*p[t].x+p[t].y*p[t].y);if(n>0){const r=Math.min(d*(s/800),n);e.x+=p[t].x/n*r,e.y+=p[t].y/n*r}})),null===(t=n.tick)||void 0===t||t.call(n)}applyCalculate(e,t,n,r,o){this.calRepulsive(e,n,o),t&&this.calAttractive(t,n,r)}calRepulsive(e,t,n){e.forEach(((r,o)=>{t[o]={x:0,y:0},e.forEach(((e,i)=>{if(o===i)return;if(!(u(r.x)&&u(e.x)&&u(r.y)&&u(e.y)))return;let a=r.x-e.x,s=r.y-e.y,c=a*a+s*s;if(0===c){c=1;const e=o>i?1:-1;a=.01*e,s=.01*e}const l=n/c;t[o].x+=a*l,t[o].y+=s*l}))}))}calAttractive(e,t,n){e.forEach((e=>{const r=f(e,"source"),o=f(e,"target");if(!r||!o)return;const i=this.nodeIdxMap[r],a=this.nodeIdxMap[o];if(i===a)return;const s=this.nodeMap[r],c=this.nodeMap[o];if(!(u(c.x)&&u(s.x)&&u(c.y)&&u(s.y)))return;const l=c.x-s.x,d=c.y-s.y,h=Math.sqrt(l*l+d*d),p=h*h/n;t[a].x-=l/h*p,t[a].y-=d/h*p,t[i].x+=l/h*p,t[i].y+=d/h*p}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"fruchterman"}}function Bl(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}function Vl(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Bl(i,r,o,a,s,"next",e)}function s(e){Bl(i,r,o,a,s,"throw",e)}a(void 0)}))}}function Wl(e){return Wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wl(e)}function Xl(e){var t=function(e,t){if("object"!==Wl(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Wl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Wl(t)?t:String(t)}function Hl(e,t,n){return(t=Xl(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ql(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Xl(r.key),r)}}function Zl(e,t,n){return t&&Yl(e.prototype,t),n&&Yl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var $l,Kl=n(812),Ql=n.n(Kl),Jl=n(22),ed=n.n(Jl),td=n(236),nd=n.n(td),rd=n(975),od=n.n(rd),id=1;function ad(){return id++}!function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.SAMPLED=4]="SAMPLED",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"}($l||($l={}));var sd,ud,cd,ld,dd=function(){function e(){ql(this,e),this.config=void 0}return Zl(e,[{key:"get",value:function(){return this.config}},{key:"set",value:function(e){this.config=e}}]),e}();function fd(){if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function hd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hd(Object(n),!0).forEach((function(t){Hl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}"undefined"!=typeof navigator&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),function(e){e.Void="Void",e.Boolean="Boolean",e.Float="Float",e.Uint32="Uint32",e.Int32="Int32",e.Vector="Vector",e.Vector2Float="vec2<f32>",e.Vector3Float="vec3<f32>",e.Vector4Float="vec4<f32>",e.Vector2Boolean="vec2<bool>",e.Vector3Boolean="vec3<bool>",e.Vector4Boolean="vec4<bool>",e.Vector2Uint="vec2<u32>",e.Vector3Uint="vec3<u32>",e.Vector4Uint="vec4<u32>",e.Vector2Int="vec2<i32>",e.Vector3Int="vec3<i32>",e.Vector4Int="vec4<i32>",e.Matrix="Matrix",e.Matrix3x3Float="mat3x3<f32>",e.Matrix4x4Float="mat4x4<i32>",e.Struct="Struct",e.FloatArray="Float[]",e.Vector4FloatArray="vec4<f32>[]"}(sd||(sd={})),function(e){e.Program="Program",e.Identifier="Identifier",e.VariableDeclaration="VariableDeclaration",e.BlockStatement="BlockStatement",e.ReturnStatement="ReturnStatement",e.FunctionDeclaration="FunctionDeclaration",e.VariableDeclarator="VariableDeclarator",e.AssignmentExpression="AssignmentExpression",e.LogicalExpression="LogicalExpression",e.BinaryExpression="BinaryExpression",e.ArrayExpression="ArrayExpression",e.UnaryExpression="UnaryExpression",e.UpdateExpression="UpdateExpression",e.FunctionExpression="FunctionExpression",e.MemberExpression="MemberExpression",e.ConditionalExpression="ConditionalExpression",e.ExpressionStatement="ExpressionStatement",e.CallExpression="CallExpression",e.NumThreadStatement="NumThreadStatement",e.StorageStatement="StorageStatement",e.DoWhileStatement="DoWhileStatement",e.WhileStatement="WhileStatement",e.ForStatement="ForStatement",e.BreakStatement="BreakStatement",e.ContinueStatement="ContinueStatement",e.IfStatement="IfStatement",e.ImportedFunctionStatement="ImportedFunctionStatement"}(ud||(ud={})),function(e){e.Input="Input",e.Output="Output",e.Uniform="Uniform",e.Workgroup="Workgroup",e.UniformConstant="UniformConstant",e.Image="Image",e.StorageBuffer="StorageBuffer",e.Private="Private",e.Function="Function"}(cd||(cd={})),function(e){e.GLSL100="GLSL100",e.GLSL450="GLSL450",e.WGSL="WGSL"}(ld||(ld={}));var gd,md,vd,yd,bd,Ed,wd,xd,_d,Sd,Id,Td,Ad,Nd,Dd=function(){function e(t,n){ql(this,e),this.engine=t,this.configService=n,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}var t,n,r;return Zl(e,[{key:"init",value:function(){var e=this.configService.get(),t=e.canvas,n=e.engineOptions;this.initPromise=this.engine.init(pd({canvas:t||fd(),antialiasing:!1},n))}},{key:"setBundle",value:function(e){this.compiledBundle=JSON.parse(JSON.stringify(e))}},{key:"setDispatch",value:function(e){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=e),this}},{key:"setMaxIteration",value:function(e){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=e),this}},{key:"setBinding",value:function(e,t){var n=this;if("string"==typeof e){var r=ed()(t)||Ql()(t)||nd()(t);if(this.compiledBundle&&this.compiledBundle.context){var o=this.compiledBundle.context.defines.find((function(t){return t.name===e}));if(o)return o.value=t,this;var i=this.compiledBundle.context.uniforms.find((function(t){return t.name===e}));i&&(r?(i.data=t,i.isReferer=!1,i.storageClass===cd.Uniform?this.model&&this.model.updateUniform(e,t):this.model&&this.model.updateBuffer(e,t)):(i.isReferer=!0,i.data=t))}}else Object.keys(e).forEach((function(t){n.setBinding(t,e[t])}));return this}},{key:"execute",value:(r=Vl(od().mark((function e(){var t,n,r=this,o=arguments;return od().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:1,!this.dirty){e.next=6;break}return this.compiledBundle.context&&(t>1?this.compiledBundle.context.maxIteration=t:this.compiledBundle.context.maxIteration++),e.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter((function(e){return e.isReferer})).forEach((function(e){var t=e.data,n=e.name;r.model.confirmInput(t.model,n)})),n=0;n<t;n++)this.model.run();return this.engine.endFrame(),e.abrupt("return",this);case 12:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getOutput",value:(n=Vl(od().mark((function e(){return od().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.readData());case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"compile",value:(t=Vl(od().mark((function e(){var t,n,r;return od().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPromise;case 2:return t=pd({},this.compiledBundle.context),n=this.engine.supportWebGPU?this.engine.useWGSL?ld.WGSL:ld.GLSL450:ld.GLSL100,r=this.compiledBundle.shaders[n],t.defines.filter((function(e){return e.runtime})).forEach((function(e){var t="".concat("__DefineValuePlaceholder__").concat(e.name);r=r.replace(t,"".concat(e.value))})),t.shader=r,t.uniforms.forEach((function(e){if(!e.data&&e.storageClass===cd.StorageBuffer){var n=1;e.type===sd.FloatArray?n=1:e.type===sd.Vector4FloatArray&&(n=4),e.data=new Float32Array(t.output.length*n).fill(0)}})),this.compiledBundle.context=t,e.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=e.sent;case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),kd=n(459),Md=n.n(kd),Od=function(){function e(t,n){ql(this,e),this.attribute=void 0,this.buffer=void 0;var r=n.buffer,o=n.offset,i=n.stride,a=n.normalized,s=n.size,u=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:o||0,stride:i||0,normalized:a||!1,divisor:u||0},s&&(this.attribute.size=s)}return Zl(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),Rd=(Hl(gd={},$l.POINTS,"points"),Hl(gd,$l.LINES,"lines"),Hl(gd,$l.LINE_LOOP,"line loop"),Hl(gd,$l.LINE_STRIP,"line strip"),Hl(gd,$l.TRIANGLES,"triangles"),Hl(gd,$l.TRIANGLE_FAN,"triangle fan"),Hl(gd,$l.TRIANGLE_STRIP,"triangle strip"),gd),Cd=(Hl(md={},$l.STATIC_DRAW,"static"),Hl(md,$l.DYNAMIC_DRAW,"dynamic"),Hl(md,$l.STREAM_DRAW,"stream"),md),Ld=(Hl(vd={},$l.BYTE,"int8"),Hl(vd,$l.UNSIGNED_INT,"int16"),Hl(vd,$l.INT,"int32"),Hl(vd,$l.UNSIGNED_BYTE,"uint8"),Hl(vd,$l.UNSIGNED_SHORT,"uint16"),Hl(vd,$l.UNSIGNED_INT,"uint32"),Hl(vd,$l.FLOAT,"float"),vd),zd=(Hl(yd={},$l.ALPHA,"alpha"),Hl(yd,$l.LUMINANCE,"luminance"),Hl(yd,$l.LUMINANCE_ALPHA,"luminance alpha"),Hl(yd,$l.RGB,"rgb"),Hl(yd,$l.RGBA,"rgba"),Hl(yd,$l.RGBA4,"rgba4"),Hl(yd,$l.RGB5_A1,"rgb5 a1"),Hl(yd,$l.RGB565,"rgb565"),Hl(yd,$l.DEPTH_COMPONENT,"depth"),Hl(yd,$l.DEPTH_STENCIL,"depth stencil"),yd),Gd=(Hl(bd={},$l.DONT_CARE,"dont care"),Hl(bd,$l.NICEST,"nice"),Hl(bd,$l.FASTEST,"fast"),bd),Pd=(Hl(Ed={},$l.NEAREST,"nearest"),Hl(Ed,$l.LINEAR,"linear"),Hl(Ed,$l.LINEAR_MIPMAP_LINEAR,"mipmap"),Hl(Ed,$l.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),Hl(Ed,$l.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),Hl(Ed,$l.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Ed),jd=(Hl(wd={},$l.REPEAT,"repeat"),Hl(wd,$l.CLAMP_TO_EDGE,"clamp"),Hl(wd,$l.MIRRORED_REPEAT,"mirror"),wd),Fd=(Hl(xd={},$l.NONE,"none"),Hl(xd,$l.BROWSER_DEFAULT_WEBGL,"browser"),xd),Ud=(Hl(_d={},$l.NEVER,"never"),Hl(_d,$l.ALWAYS,"always"),Hl(_d,$l.LESS,"less"),Hl(_d,$l.LEQUAL,"lequal"),Hl(_d,$l.GREATER,"greater"),Hl(_d,$l.GEQUAL,"gequal"),Hl(_d,$l.EQUAL,"equal"),Hl(_d,$l.NOTEQUAL,"notequal"),_d),Bd=(Hl(Sd={},$l.FUNC_ADD,"add"),Hl(Sd,$l.MIN_EXT,"min"),Hl(Sd,$l.MAX_EXT,"max"),Hl(Sd,$l.FUNC_SUBTRACT,"subtract"),Hl(Sd,$l.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Sd),Vd=(Hl(Id={},$l.ZERO,"zero"),Hl(Id,$l.ONE,"one"),Hl(Id,$l.SRC_COLOR,"src color"),Hl(Id,$l.ONE_MINUS_SRC_COLOR,"one minus src color"),Hl(Id,$l.SRC_ALPHA,"src alpha"),Hl(Id,$l.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),Hl(Id,$l.DST_COLOR,"dst color"),Hl(Id,$l.ONE_MINUS_DST_COLOR,"one minus dst color"),Hl(Id,$l.DST_ALPHA,"dst alpha"),Hl(Id,$l.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),Hl(Id,$l.CONSTANT_COLOR,"constant color"),Hl(Id,$l.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),Hl(Id,$l.CONSTANT_ALPHA,"constant alpha"),Hl(Id,$l.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),Hl(Id,$l.SRC_ALPHA_SATURATE,"src alpha saturate"),Id),Wd=(Hl(Td={},$l.NEVER,"never"),Hl(Td,$l.ALWAYS,"always"),Hl(Td,$l.LESS,"less"),Hl(Td,$l.LEQUAL,"lequal"),Hl(Td,$l.GREATER,"greater"),Hl(Td,$l.GEQUAL,"gequal"),Hl(Td,$l.EQUAL,"equal"),Hl(Td,$l.NOTEQUAL,"notequal"),Td),Xd=(Hl(Ad={},$l.ZERO,"zero"),Hl(Ad,$l.KEEP,"keep"),Hl(Ad,$l.REPLACE,"replace"),Hl(Ad,$l.INVERT,"invert"),Hl(Ad,$l.INCR,"increment"),Hl(Ad,$l.DECR,"decrement"),Hl(Ad,$l.INCR_WRAP,"increment wrap"),Hl(Ad,$l.DECR_WRAP,"decrement wrap"),Ad),Hd=(Hl(Nd={},$l.FRONT,"front"),Hl(Nd,$l.BACK,"back"),Nd),qd=function(){function e(t,n){ql(this,e),this.buffer=void 0;var r=n.data,o=n.usage,i=n.type;this.buffer=t.buffer({data:r,usage:Cd[o||$l.STATIC_DRAW],type:Ld[i||$l.UNSIGNED_BYTE]})}return Zl(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(e){var t=e.data,n=e.offset;this.buffer.subdata(t,n)}}]),e}();function Yd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zd(Object(n),!0).forEach((function(t){Hl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Kd=0,Qd=function(){function e(t,n){var r=this;ql(this,e),this.reGl=t,this.context=n,this.entity=ad(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var o={};this.context.uniforms.forEach((function(e){var t=e.name,n=e.type,i=e.data,a=e.isReferer,s=e.storageClass;if(s===cd.StorageBuffer){if(a)r.textureCache[t]={data:void 0},o["".concat(t,"Size")]=function(){return i.compiledBundle.context.output.textureSize};else{r.textureCache[t]=r.calcDataTexture(t,n,i);var u=r.textureCache[t],c=u.textureWidth,l=u.isOutput;o["".concat(t,"Size")]=[c,c],l&&(r.outputTextureName=t,r.context.needPingpong&&(r.outputTextureName="".concat(t,"Output"),r.textureCache[r.outputTextureName]=r.calcDataTexture(t,n,i)))}o[t]=function(){return r.textureCache[t].texture}}else if(s===cd.Uniform){if(i&&(Array.isArray(i)||Ql()(i))&&i.length>16)throw new Error("invalid data type ".concat(n));o[t]=function(){return e.data}}}));var i=this.getOuputDataTexture(),a=i.textureWidth,s=i.texelCount;o.u_OutputTextureSize=[a,a],o.u_OutputTexelCount=s,this.context.output.textureSize=[a,a];var u={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(this.context.shader),uniforms:o,vert:"attribute vec3 a_Position;\nattribute vec2 a_TexCoord;\n\nvarying vec2 v_TexCoord;\n\nvoid main() {\n  gl_Position = vec4(a_Position, 1.0);\n  v_TexCoord = a_TexCoord;\n}",primitive:"triangle strip",count:4};this.computeCommand=this.reGl(u)}var t;return Zl(e,[{key:"run",value:function(){var e=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use((function(){e.computeCommand()}))}},{key:"readData",value:(t=Vl(od().mark((function e(){var t,n,r,o,i,a,s,u,c=this;return od().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reGl({framebuffer:this.texFBO})((function(){t=c.reGl.read()})),!t){e.next=6;break}if(n=this.getOuputDataTexture(),r=n.originalDataLength,o=n.elementsPerTexel,i=n.typedArrayConstructor,a=void 0===i?Float32Array:i,s=[],4!==o)for(u=0;u<t.length;u+=4)1===o?s.push(t[u]):2===o?s.push(t[u],t[u+1]):s.push(t[u],t[u+1],t[u+2]);else s=t;return e.abrupt("return",new a(s.slice(0,r)));case 6:return e.abrupt("return",new Float32Array);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"confirmInput",value:function(e,t){var n;this.entity===e.entity?(this.dynamicPingpong=!0,n=this):n=e,this.textureCache[t].id=n.getOuputDataTexture().id,this.textureCache[t].texture=n.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(e,t){var n=this.context.uniforms.find((function(t){return t.name===e}));if(n){var r=this.calcDataTexture(e,n.type,t),o=r.texture,i=r.data;this.textureCache[e].data=i,this.textureCache[e].texture=o}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var e=this.context.output.name;this.textureCache[e].id=this.getOuputDataTexture().id,this.textureCache[e].texture=this.getOuputDataTexture().texture}var t=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=t}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var e=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=e}},{key:"cloneDataTexture",value:function(e){var t=e.data,n=e.textureWidth;return $d($d({},e),{},{id:Kd++,texture:this.reGl.texture({width:n,height:n,data:t,type:"float"})})}},{key:"calcDataTexture",value:function(e,t,n){var r=1;t===sd.Vector4FloatArray&&(r=4);for(var o=[],i=0;i<n.length;i+=r)1===r?o.push(n[i],0,0,0):2===r?o.push(n[i],n[i+1],0,0):3===r?o.push(n[i],n[i+1],n[i+2],0):4===r&&o.push(n[i],n[i+1],n[i+2],n[i+3]);var a,s=n.length,u=Math.ceil(s/r),c=Math.ceil(Math.sqrt(u)),l=c*c;u<l&&o.push.apply(o,function(e){if(Array.isArray(e))return Yd(e)}(a=new Array(4*(l-u)).fill(0))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||function(e,t){if(e){if("string"==typeof e)return Yd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yd(e,t):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var d=this.reGl.texture({width:c,height:c,data:o,type:"float"});return{id:Kd++,data:o,originalDataLength:s,typedArrayConstructor:Ql()(n)?n.constructor:void 0,textureWidth:c,texture:d,texelCount:u,elementsPerTexel:r,isOutput:e===this.context.output.name}}}]),e}(),Jd=function(){function e(t,n){ql(this,e),this.elements=void 0;var r=n.data,o=n.usage,i=n.type,a=n.count;this.elements=t.elements({data:r,usage:Cd[o||$l.STATIC_DRAW],type:Ld[i||$l.UNSIGNED_BYTE],count:a})}return Zl(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(e){var t=e.data;this.elements.subdata(t)}},{key:"destroy",value:function(){this.elements.destroy()}}]),e}(),ef=function(){function e(t,n){ql(this,e),this.framebuffer=void 0;var r=n.width,o=n.height,i=n.color,a=n.colors,s=(n.depth,n.stencil,{width:r,height:o});Array.isArray(a)&&(s.colors=a.map((function(e){return e.get()}))),i&&"boolean"!=typeof i&&(s.color=i.get()),this.framebuffer=t.framebuffer(s)}return Zl(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.framebuffer.resize(t,n)}}]),e}(),tf=n(636),nf=n.n(tf);function rf(e){var t={};return Object.keys(e).forEach((function(n){of(n,e[n],t,"")})),t}function of(e,t,n,r){null===t||"number"==typeof t||"boolean"==typeof t||Array.isArray(t)&&"number"==typeof t[0]||Ql()(t)||""===t||void 0!==t.resize?n["".concat(r&&r+".").concat(e)]=t:(nf()(t)&&Object.keys(t).forEach((function(o){of(o,t[o],n,"".concat(r&&r+".").concat(e))})),Array.isArray(t)&&t.forEach((function(t,o){Object.keys(t).forEach((function(i){of(i,t[i],n,"".concat(r&&r+".").concat(e,"[").concat(o,"]"))}))})))}function af(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?af(Object(n),!0).forEach((function(t){Hl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):af(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var uf=function(){function e(t,n){ql(this,e),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=t;var r=n.vs,o=n.fs,i=n.defines,a=n.attributes,s=n.uniforms,u=n.primitive,c=n.count,l=n.elements,d=n.depth,f=n.blend,h=n.stencil,p=n.cull,g=n.instances,m=n.scissor,v=n.viewport,y={};s&&(this.uniforms=rf(s),Object.keys(s).forEach((function(e){y[e]=t.prop(e)})));var b={};Object.keys(a).forEach((function(e){b[e]=a[e].get()}));var E=i&&this.generateDefines(i)||"",w={attributes:b,frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(E,"\n").concat(o),uniforms:y,vert:"\n".concat(E,"\n").concat(r),primitive:Rd[void 0===u?$l.TRIANGLES:u]};g&&(w.instances=g),c&&(w.count=c),l&&(w.elements=l.get()),m&&(w.scissor=m),v&&(w.viewport=v),this.initDepthDrawParams({depth:d},w),this.initBlendDrawParams({blend:f},w),this.initStencilDrawParams({stencil:h},w),this.initCullDrawParams({cull:p},w),this.drawCommand=t(w)}return Zl(e,[{key:"addUniforms",value:function(e){this.uniforms=sf(sf({},this.uniforms),rf(e))}},{key:"draw",value:function(e){var t=sf(sf({},this.uniforms),rf(e.uniforms||{})),n={};Object.keys(t).forEach((function(e){var r=Wl(t[e]);"boolean"===r||"number"===r||Array.isArray(t[e])||t[e].BYTES_PER_ELEMENT?n[e]=t[e]:"string"===r||(n[e]=t[e].get())})),this.drawCommand(n)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(e,t){var n=e.depth;n&&(t.depth={enable:void 0===n.enable||!!n.enable,mask:void 0===n.mask||!!n.mask,func:Ud[n.func||$l.LESS],range:n.range||[0,1]})}},{key:"initBlendDrawParams",value:function(e,t){var n=e.blend;if(n){var r=n.enable,o=n.func,i=n.equation,a=n.color,s=void 0===a?[0,0,0,0]:a;t.blend={enable:!!r,func:{srcRGB:Vd[o&&o.srcRGB||$l.SRC_ALPHA],srcAlpha:Vd[o&&o.srcAlpha||$l.SRC_ALPHA],dstRGB:Vd[o&&o.dstRGB||$l.ONE_MINUS_SRC_ALPHA],dstAlpha:Vd[o&&o.dstAlpha||$l.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Bd[i&&i.rgb||$l.FUNC_ADD],alpha:Bd[i&&i.alpha||$l.FUNC_ADD]},color:s}}}},{key:"initStencilDrawParams",value:function(e,t){var n=e.stencil;if(n){var r=n.enable,o=n.mask,i=void 0===o?-1:o,a=n.func,s=void 0===a?{cmp:$l.ALWAYS,ref:0,mask:-1}:a,u=n.opFront,c=void 0===u?{fail:$l.KEEP,zfail:$l.KEEP,zpass:$l.KEEP}:u,l=n.opBack,d=void 0===l?{fail:$l.KEEP,zfail:$l.KEEP,zpass:$l.KEEP}:l;t.stencil={enable:!!r,mask:i,func:sf(sf({},s),{},{cmp:Wd[s.cmp]}),opFront:{fail:Xd[c.fail],zfail:Xd[c.zfail],zpass:Xd[c.zpass]},opBack:{fail:Xd[d.fail],zfail:Xd[d.zfail],zpass:Xd[d.zpass]}}}}},{key:"initCullDrawParams",value:function(e,t){var n=e.cull;if(n){var r=n.enable,o=n.face,i=void 0===o?$l.BACK:o;t.cull={enable:!!r,face:Hd[i]}}}},{key:"generateDefines",value:function(e){return Object.keys(e).map((function(t){return"#define ".concat(t," ").concat(Number(e[t]))})).join("\n")}}]),e}(),cf=function(){function e(t,n){ql(this,e),this.texture=void 0,this.width=void 0,this.height=void 0;var r=n.data,o=n.type,i=void 0===o?$l.UNSIGNED_BYTE:o,a=n.width,s=n.height,u=n.flipY,c=void 0!==u&&u,l=n.format,d=void 0===l?$l.RGBA:l,f=n.mipmap,h=void 0!==f&&f,p=n.wrapS,g=void 0===p?$l.CLAMP_TO_EDGE:p,m=n.wrapT,v=void 0===m?$l.CLAMP_TO_EDGE:m,y=n.aniso,b=void 0===y?0:y,E=n.alignment,w=void 0===E?1:E,x=n.premultiplyAlpha,_=void 0!==x&&x,S=n.mag,I=void 0===S?$l.NEAREST:S,T=n.min,A=void 0===T?$l.NEAREST:T,N=n.colorSpace,D=void 0===N?$l.BROWSER_DEFAULT_WEBGL:N;this.width=a,this.height=s;var k={width:a,height:s,type:Ld[i],format:zd[d],wrapS:jd[g],wrapT:jd[v],mag:Pd[I],min:Pd[A],alignment:w,flipY:c,colorSpace:Fd[D],premultiplyAlpha:_,aniso:b};r&&(k.data=r),"number"==typeof h?k.mipmap=Gd[h]:"boolean"==typeof h&&(k.mipmap=h),this.texture=t.texture(k)}return Zl(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.texture.resize(t,n),this.width=t,this.height=n}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),lf=function(){function e(){var t=this;ql(this,e),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var e=Vl(od().mark((function e(n){return od().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.uniforms){e.next=3;break}return e.next=3,Promise.all(Object.keys(n.uniforms).map(function(){var e=Vl(od().mark((function e(t){var r;return od().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.uniforms[t]||void 0===n.uniforms[t].load){e.next=5;break}return e.next=3,n.uniforms[t].load();case 3:r=e.sent,n.uniforms[t]=r;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return e.abrupt("return",new uf(t.gl,n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createAttribute=function(e){return new Od(t.gl,e)},this.createBuffer=function(e){return new qd(t.gl,e)},this.createElements=function(e){return new Jd(t.gl,e)},this.createTexture2D=function(e){return new cf(t.gl,e)},this.createFramebuffer=function(e){return new ef(t.gl,e)},this.useFramebuffer=function(e,n){t.gl({framebuffer:e?e.get():null})(n)},this.createComputeModel=function(){var e=Vl(od().mark((function e(n){return od().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Qd(t.gl,n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.clear=function(e){var n=e.color,r=e.depth,o=e.stencil,i=e.framebuffer,a=void 0===i?null:i,s={color:n,depth:r,stencil:o};s.framebuffer=null===a?a:a.get(),t.gl.clear(s)},this.setScissor=function(e){t.gl&&t.gl._gl&&(e.enable&&e.box?(t.gl._gl.enable($l.SCISSOR_TEST),t.gl._gl.scissor(e.box.x,e.box.y,e.box.width,e.box.height)):t.gl._gl.disable($l.SCISSOR_TEST),t.gl._refresh())},this.viewport=function(e){var n=e.x,r=e.y,o=e.width,i=e.height;t.gl&&t.gl._gl&&(t.gl._gl.viewport(n,r,o,i),t.gl._refresh())},this.readPixels=function(e){var n=e.framebuffer,r={x:e.x,y:e.y,width:e.width,height:e.height};return n&&(r.framebuffer=n.get()),t.gl.read(r)},this.getCanvas=function(){return t.$canvas},this.getGLContext=function(){return t.gl._gl},this.destroy=function(){t.gl&&(t.gl.destroy(),t.inited=!1)}}var t;return Zl(e,[{key:"init",value:(t=Vl(od().mark((function e(t){return od().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inited){e.next=2;break}return e.abrupt("return");case 2:return this.$canvas=t.canvas,e.next=5,new Promise((function(e,n){Md()({canvas:t.canvas,attributes:{alpha:!0,antialias:t.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(t,r){!t&&r||n(t),e(r)}})}));case 5:this.gl=e.sent,this.inited=!0;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}(),df=function(){function e(){ql(this,e),this.engine=void 0,this.configService=new dd}return Zl(e,[{key:"setConfig",value:function(e){this.configService.set(e)}},{key:"setEngine",value:function(e){this.engine=e}},{key:"createEntity",value:function(){return ad()}},{key:"createKernel",value:function(e){var t=new Dd(this.engine,this.configService);return"string"==typeof e?t.setBundle(JSON.parse(e)):t.setBundle(e),t.init(),t}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=new e;return n.setConfig(t),n.setEngine(new lf),n}}]),e}();const ff=(e,t)=>{let n;return n=e?u(e)?()=>e:e:()=>t||1,n},hf=e=>{const t=[],n=e.length,r=e[0].length;for(let o=0;o<r;o++)e.forEach(((e,r)=>{if(t.push(e[o]),r===n-1)for(;t.length%4!=0;)t.push(0)}));return new Float32Array(t)};var pf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};class gf extends i{constructor(e){super(),this.maxIteration=1e3,this.gravity=10,this.speed=1,this.clustering=!1,this.clusterField="cluster",this.clusterGravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){return pf(this,void 0,void 0,(function*(){const e=this,t=e.nodes;if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(1===t.length)return t[0].x=n[0],t[0].y=n[1],void(e.onLayoutEnd&&e.onLayoutEnd());const r={},o={};t.forEach(((e,t)=>{u(e.x)||(e.x=Math.random()*this.width),u(e.y)||(e.y=Math.random()*this.height),r[e.id]=e,o[e.id]=t})),e.nodeMap=r,e.nodeIdxMap=o,yield e.run()}))}executeWithWorker(e,t){return pf(this,void 0,void 0,(function*(){const n=this,r=n.nodes,o=n.center;if(!r||0===r.length)return;if(1===r.length)return r[0].x=o[0],void(r[0].y=o[1]);const i={},a={};r.forEach(((e,t)=>{u(e.x)||(e.x=Math.random()*this.width),u(e.y)||(e.y=Math.random()*this.height),i[e.id]=e,a[e.id]=t})),n.nodeMap=i,n.nodeIdxMap=a,yield n.run(e,t)}))}run(e,t){return pf(this,void 0,void 0,(function*(){const n=this,r=n.nodes,o=n.edges,i=n.maxIteration,a=n.center,s=n.height*n.width;let c=Math.sqrt(s)/10;const l=s/(r.length+1),d=Math.sqrt(l),h=n.speed,p=n.clustering,{array:g,count:m}=((e,t)=>{const n=[],r=e.length,o={};return t.forEach((t=>{e.forEach(((e,i)=>{if(void 0===o[t[e]]&&(o[t[e]]=Object.keys(o).length),n.push(o[t[e]]),i===r-1)for(;n.length%4!=0;)n.push(0)}))})),{array:new Float32Array(n),count:Object.keys(o).length}})([n.clusterField],r);r.forEach(((e,t)=>{let n=0,r=0;u(e.fx)&&u(e.fy)&&(n=e.fx||.001,r=e.fy||.001),g[4*t+1]=n,g[4*t+2]=r}));const v=r.length,{maxEdgePerVetex:y,array:b}=((e,t)=>{const n=[],r=[],o={};let i=0;for(i=0;i<e.length;i++){const t=e[i];o[t.id]=i,n.push(t.x),n.push(t.y),n.push(0),n.push(0),r.push([])}for(i=0;i<t.length;i++){const e=t[i],n=f(e,"source"),a=f(e,"target");isNaN(o[n])||isNaN(o[a])||(r[o[n]].push(o[a]),r[o[a]].push(o[n]))}let a=0;for(i=0;i<e.length;i++){const e=n.length,t=r[i],o=t.length;n[4*i+2]=e,n[4*i+3]=o,a=Math.max(a,o);for(let e=0;e<o;++e){const r=t[e];n.push(+r)}}for(;n.length%4!=0;)n.push(0);return{maxEdgePerVetex:a,array:new Float32Array(n)}})(r,o);let E;E=n.workerEnabled?df.create({canvas:e,engineOptions:{supportCompute:!0}}):df.create({engineOptions:{supportCompute:!0}});const w=n.onLayoutEnd,x=[];for(let e=0;e<m;e++)x.push(0,0,0,0);const _=E.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([v,1,1]).setBinding({u_Data:b,u_K:d,u_K2:l,u_Gravity:n.gravity,u_ClusterGravity:n.clusterGravity||n.gravity||1,u_Speed:h,u_MaxDisplace:c,u_Clustering:p?1:0,u_Center:a,u_AttributeArray:g,u_ClusterCenters:x,MAX_EDGE_PER_VERTEX:y,VERTEX_COUNT:v});let S;p&&(S=E.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([m,1,1]).setBinding({u_Data:b,u_NodeAttributes:g,u_ClusterCenters:x,VERTEX_COUNT:v,CLUSTER_COUNT:m})),yield(()=>pf(this,void 0,void 0,(function*(){for(let e=0;e<i;e++)yield _.execute(),p&&(S.setBinding({u_Data:_}),yield S.execute(),_.setBinding({u_ClusterCenters:S})),_.setBinding({u_MaxDisplace:c*=.99});const n=yield _.getOutput();e?t.postMessage({type:ke,vertexEdgeData:n}):r.forEach(((e,t)=>{const r=n[4*t],o=n[4*t+1];e.x=r,e.y=o})),w&&w()})))()}))}getType(){return"fruchterman-gpu"}}var mf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};class vf extends i{constructor(e){super(),this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}}execute(){return mf(this,void 0,void 0,(function*(){const e=this,t=e.nodes;if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(1===t.length)return t[0].x=n[0],t[0].y=n[1],void(e.onLayoutEnd&&e.onLayoutEnd());const r={},o={};t.forEach(((t,n)=>{u(t.x)||(t.x=Math.random()*e.width),u(t.y)||(t.y=Math.random()*e.height),r[t.id]=t,o[t.id]=n})),e.nodeMap=r,e.nodeIdxMap=o,e.nodeStrength=ff(e.nodeStrength,1),e.edgeStrength=ff(e.edgeStrength,1),yield e.run()}))}executeWithWorker(e,t){const n=this,r=n.nodes,o=n.center;if(!r||0===r.length)return;if(1===r.length)return r[0].x=o[0],void(r[0].y=o[1]);const i={},a={};r.forEach(((e,t)=>{u(e.x)||(e.x=Math.random()*n.width),u(e.y)||(e.y=Math.random()*n.height),i[e.id]=e,a[e.id]=t})),n.nodeMap=i,n.nodeIdxMap=a,n.nodeStrength=ff(n.nodeStrength,1),n.edgeStrength=ff(n.edgeStrength,1),n.run(e,t)}run(e,t){return mf(this,void 0,void 0,(function*(){const n=this,r=n.nodes,o=n.edges,i=n.maxIteration;n.width||"undefined"==typeof window||(n.width=window.innerWidth),n.height||"undefined"==typeof window||(n.height=window.innerHeight);const a=r.length;n.linkDistance=ff(n.linkDistance),n.edgeStrength=ff(n.edgeStrength);const{maxEdgePerVetex:s,array:c}=((e,t,n,r)=>{const o=[],i=[],a={};let s=0;for(s=0;s<e.length;s++){const t=e[s];a[t.id]=s,o.push(t.x),o.push(t.y),o.push(0),o.push(0),i.push([])}for(s=0;s<t.length;s++){const e=t[s],o=f(e,"source"),u=f(e,"target");i[a[o]].push(a[u]),i[a[o]].push(n(e)),i[a[o]].push(r(e)),i[a[o]].push(0),i[a[u]].push(a[o]),i[a[u]].push(n(e)),i[a[u]].push(r(e)),i[a[u]].push(0)}let u=0;for(s=0;s<e.length;s++){const e=o.length,t=i[s],n=t.length;o[4*s+2]=e+1048576*n/4,o[4*s+3]=0,u=Math.max(u,n/4);for(let e=0;e<n;++e){const n=t[e];o.push(+n)}}for(;o.length%4!=0;)o.push(0);return{maxEdgePerVetex:u,array:new Float32Array(o)}})(r,o,n.linkDistance,n.edgeStrength);n.degrees=h(r.length,n.nodeIdxMap,o).map((e=>e.all));const l=[],d=[],p=[],g=[],m=[],v=[],y=[];n.getMass||(n.getMass=e=>n.degrees[n.nodeIdxMap[e.id]]||1);const b=n.gravity,E=n.center;r.forEach(((e,t)=>{l.push(n.getMass(e)),d.push(n.nodeStrength(e)),n.degrees[t]||(n.degrees[t]=0);let r=[E[0],E[1],b];if(n.getCenter){const o=n.getCenter(e,n.degrees[t]);o&&u(o[0])&&u(o[1])&&u(o[2])&&(r=o)}p.push(r[0]),g.push(r[1]),m.push(r[2]),u(e.fx)&&u(e.fy)?(v.push(e.fx||.001),y.push(e.fy||.001)):(v.push(0),y.push(0))}));const w=hf([l,n.degrees,d,v]),x=hf([p,g,m,y]);let _;_=n.workerEnabled?df.create({canvas:e,engineOptions:{supportCompute:!0}}):df.create({engineOptions:{supportCompute:!0}});const S=n.onLayoutEnd,I=[];c.forEach((e=>{I.push(e)}));for(let e=0;e<4;e++)I.push(0);const T=_.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {float distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\ngl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([a,1,1]).setBinding({u_Data:c,u_damping:n.damping,u_maxSpeed:n.maxSpeed,u_minMovement:n.minMovement,u_coulombDisScale:n.coulombDisScale,u_factor:n.factor,u_NodeAttributeArray1:w,u_NodeAttributeArray2:x,MAX_EDGE_PER_VERTEX:s,VERTEX_COUNT:a,u_AveMovement:I,u_interval:n.interval}),A=_.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([1,1,1]).setBinding({u_Data:c,VERTEX_COUNT:a,u_AveMovement:[0,0,0,0]});yield(()=>mf(this,void 0,void 0,(function*(){for(let e=0;e<i;e++){yield T.execute(),A.setBinding({u_Data:T}),yield A.execute();const t=Math.max(.02,n.interval-.002*e);T.setBinding({u_interval:t,u_AveMovement:A})}const o=yield T.getOutput();e?t.postMessage({type:ke,vertexEdgeData:o}):r.forEach(((e,t)=>{const n=o[4*t],r=o[4*t+1];e.x=n,e.y=r})),S&&S()})))()}))}getType(){return"gForce-gpu"}}class yf extends i{constructor(e){super(),this.center=[0,0],this.maxIteration=100,this.gravity=10,this.comboGravity=10,this.linkDistance=10,this.alpha=1,this.alphaMin=.001,this.alphaDecay=1-Math.pow(this.alphaMin,1/300),this.alphaTarget=0,this.velocityDecay=.6,this.edgeStrength=.6,this.nodeStrength=30,this.preventOverlap=!1,this.preventNodeOverlap=!1,this.preventComboOverlap=!1,this.collideStrength=void 0,this.nodeCollideStrength=.5,this.comboCollideStrength=.5,this.comboSpacing=20,this.comboPadding=10,this.optimizeRangeFactor=1,this.onTick=()=>{},this.onLayoutEnd=()=>{},this.depthAttractiveForceScale=1,this.depthRepulsiveForceScale=2,this.nodes=[],this.edges=[],this.combos=[],this.comboTrees=[],this.width=300,this.height=300,this.bias=[],this.nodeMap={},this.oriComboMap={},this.indexMap={},this.comboMap={},this.previousLayouted=!1,this.updateCfg(e)}getDefaultCfg(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}}execute(){const e=this,t=e.nodes,n=e.center;if(e.comboTree={id:"comboTreeRoot",depth:-1,children:e.comboTrees},t&&0!==t.length){if(1===t.length)return t[0].x=n[0],t[0].y=n[1],void(e.onLayoutEnd&&e.onLayoutEnd());e.initVals(),e.run(),e.onLayoutEnd&&e.onLayoutEnd()}else e.onLayoutEnd&&e.onLayoutEnd()}run(){const e=this,t=e.nodes,n=e.previousLayouted?e.maxIteration/5:e.maxIteration;e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight);const r=e.center,o=e.velocityDecay,i=e.comboMap;e.previousLayouted||e.initPos(i);for(let r=0;r<n;r++){const n=[];t.forEach(((e,t)=>{n[t]={x:0,y:0}})),e.applyCalculate(n),e.applyComboCenterForce(n),t.forEach(((e,t)=>{u(e.x)&&u(e.y)&&(e.x+=n[t].x*o,e.y+=n[t].y*o)})),e.alpha+=(e.alphaTarget-e.alpha)*e.alphaDecay,e.onTick()}const a=[0,0];t.forEach((e=>{u(e.x)&&u(e.y)&&(a[0]+=e.x,a[1]+=e.y)})),a[0]/=t.length,a[1]/=t.length;const s=[r[0]-a[0],r[1]-a[1]];t.forEach(((e,t)=>{u(e.x)&&u(e.y)&&(e.x+=s[0],e.y+=s[1])})),e.combos.forEach((e=>{const t=i[e.id];t&&t.empty&&(e.x=t.cx||e.x,e.y=t.cy||e.y)})),e.previousLayouted=!0}initVals(){const e=this,t=e.edges,n=e.nodes,r=e.combos,o={},i={},a={};n.forEach(((e,t)=>{i[e.id]=e,a[e.id]=t})),e.nodeMap=i,e.indexMap=a;const c={};r.forEach((e=>{c[e.id]=e})),e.oriComboMap=c,e.comboMap=e.getComboMap();const d=e.preventOverlap;e.preventComboOverlap=e.preventComboOverlap||d,e.preventNodeOverlap=e.preventNodeOverlap||d;const h=e.collideStrength;h&&(e.comboCollideStrength=h,e.nodeCollideStrength=h),e.comboCollideStrength=e.comboCollideStrength?e.comboCollideStrength:0,e.nodeCollideStrength=e.nodeCollideStrength?e.nodeCollideStrength:0;for(let e=0;e<t.length;++e){const n=f(t[e],"source"),r=f(t[e],"target");o[n]?o[n]++:o[n]=1,o[r]?o[r]++:o[r]=1}const p=[];for(let e=0;e<t.length;++e){const n=f(t[e],"source"),r=f(t[e],"target");p[e]=o[n]/(o[n]+o[r])}this.bias=p;const g=e.nodeSize,m=e.nodeSpacing;let v,y;if(y=u(m)?()=>m:w(m)?m:()=>0,this.nodeSpacing=y,g)if(w(g))v=e=>g(e);else if(s(g)){const e=(g[0]>g[1]?g[0]:g[1])/2;v=t=>e}else{const e=g/2;v=t=>e}else v=e=>e.size?s(e.size)?(e.size[0]>e.size[1]?e.size[0]:e.size[1])/2:l(e.size)?(e.size.width>e.size.height?e.size.width:e.size.height)/2:e.size/2:10;this.nodeSize=v;const b=e.comboSpacing;let E;E=u(b)?()=>b:w(b)?b:()=>0,this.comboSpacing=E;const x=e.comboPadding;let _;_=u(x)?()=>x:s(x)?()=>Math.max.apply(null,x):w(x)?x:()=>0,this.comboPadding=_;let S,I=this.linkDistance;I||(I=10),S=u(I)?e=>I:I,this.linkDistance=S;let T,A=this.edgeStrength;A||(A=1),T=u(A)?e=>A:A,this.edgeStrength=T;let N,D=this.nodeStrength;D||(D=30),N=u(D)?e=>D:D,this.nodeStrength=N}initPos(e){this.nodes.forEach(((t,n)=>{const r=t.comboId,o=e[r];r&&o?(t.x=o.cx+100/(n+1),t.y=o.cy+100/(n+1)):(t.x=100/(n+1),t.y=100/(n+1))}))}getComboMap(){const e=this,t=e.nodeMap,n=e.comboTrees,r=e.oriComboMap,o={};return(n||[]).forEach((n=>{const i=[];v(n,(n=>{if("node"===n.itemType)return!0;if(!r[n.id])return!0;if(void 0===o[n.id]){const t={id:n.id,name:n.id,cx:0,cy:0,count:0,depth:e.oriComboMap[n.id].depth||0,children:[]};o[n.id]=t}const a=n.children;a&&a.forEach((e=>{if(!o[e.id]&&!t[e.id])return!0;i.push(e)}));const s=o[n.id];if(s.cx=0,s.cy=0,0===i.length){s.empty=!0;const e=r[n.id];s.cx=e.x,s.cy=e.y}return i.forEach((e=>{if(s.count++,"node"!==e.itemType){const t=o[e.id];return u(t.cx)&&(s.cx+=t.cx),void(u(t.cy)&&(s.cy+=t.cy))}const n=t[e.id];n&&(u(n.x)&&(s.cx+=n.x),u(n.y)&&(s.cy+=n.y))})),s.cx/=s.count||1,s.cy/=s.count||1,s.children=i,!0}))})),o}applyComboCenterForce(e){const t=this,n=t.gravity,r=t.comboGravity||n,o=this.alpha,i=t.comboTrees,a=t.indexMap,s=t.nodeMap,c=t.comboMap;(i||[]).forEach((t=>{v(t,(t=>{if("node"===t.itemType)return!0;if(!c[t.id])return!0;const n=c[t.id],i=(n.depth+1)/10*.5,l=n.cx,d=n.cy;return n.cx=0,n.cy=0,n.children.forEach((t=>{if("node"!==t.itemType){const e=c[t.id];return e&&u(e.cx)&&(n.cx+=e.cx),void(e&&u(e.cy)&&(n.cy+=e.cy))}const f=s[t.id],h=f.x-l||.005,p=f.y-d||.005,g=Math.sqrt(h*h+p*p),m=a[f.id],v=r*o/g*i;e[m].x-=h*v,e[m].y-=p*v,u(f.x)&&(n.cx+=f.x),u(f.y)&&(n.cy+=f.y)})),n.cx/=n.count||1,n.cy/=n.count||1,!0}))}))}applyCalculate(e){const t=this,n=t.comboMap,r=t.nodes,o={};r.forEach(((e,t)=>{r.forEach(((n,r)=>{if(t<r)return;const i=e.x-n.x||.005,a=e.y-n.y||.005;let s=i*i+a*a;const u=Math.sqrt(s);s<1&&(s=u),o[`${e.id}-${n.id}`]={vx:i,vy:a,vl2:s,vl:u},o[`${n.id}-${e.id}`]={vl2:s,vl:u,vx:-i,vy:-a}}))})),t.updateComboSizes(n),t.calRepulsive(e,o),t.calAttractive(e,o),t.preventComboOverlap&&t.comboNonOverlapping(e,n)}updateComboSizes(e){const t=this,n=t.comboTrees,r=t.nodeMap,o=t.nodeSize,i=t.comboSpacing,a=t.comboPadding;(n||[]).forEach((n=>{const u=[];v(n,(n=>{if("node"===n.itemType)return!0;const c=e[n.id];if(!c)return!1;const l=n.children;l&&l.forEach((t=>{(e[t.id]||r[t.id])&&u.push(t)})),c.minX=1/0,c.minY=1/0,c.maxX=-1/0,c.maxY=-1/0,u.forEach((e=>{if("node"!==e.itemType)return!0;const t=r[e.id];if(!t)return!0;const n=o(t),i=t.x-n,a=t.y-n,s=t.x+n,u=t.y+n;c.minX>i&&(c.minX=i),c.minY>a&&(c.minY=a),c.maxX<s&&(c.maxX=s),c.maxY<u&&(c.maxY=u)}));let d=t.oriComboMap[n.id].size||10;s(d)&&(d=d[0]);const f=Math.max(c.maxX-c.minX,c.maxY-c.minY,d);return c.r=f/2+i(c)/2+a(c),!0}))}))}comboNonOverlapping(e,t){const n=this,r=n.comboTree,o=n.comboCollideStrength,i=n.indexMap,a=n.nodeMap;v(r,(n=>{if(!t[n.id]&&!a[n.id]&&"comboTreeRoot"!==n.id)return!1;const r=n.children;return r&&r.length>1&&r.forEach(((n,s)=>{if("node"===n.itemType)return!1;const u=t[n.id];u&&r.forEach(((r,c)=>{if(s<=c)return!1;if("node"===r.itemType)return!1;const l=t[r.id];if(!l)return!1;const d=u.cx-l.cx||.005,f=u.cy-l.cy||.005,h=d*d+f*f,p=u.r||1,g=l.r||1,m=p+g,v=g*g,y=p*p;if(h<m*m){const t=n.children;if(!t||0===t.length)return!1;const s=r.children;if(!s||0===s.length)return!1;const u=Math.sqrt(h),c=(m-u)/u*o,l=d*c,p=f*c,g=v/(y+v),b=1-g;t.forEach((t=>{if("node"!==t.itemType)return!1;if(!a[t.id])return;const n=i[t.id];s.forEach((t=>{if("node"!==t.itemType)return!1;if(!a[t.id])return!1;const r=i[t.id];e[n].x+=l*g,e[n].y+=p*g,e[r].x-=l*b,e[r].y-=p*b}))}))}}))})),!0}))}calRepulsive(e,t){const n=this,r=n.nodes,o=n.width*n.optimizeRangeFactor,i=n.nodeStrength,a=n.alpha,s=n.nodeCollideStrength,u=n.preventNodeOverlap,c=n.nodeSize,l=n.nodeSpacing,d=n.depthRepulsiveForceScale,f=n.center;r.forEach(((h,p)=>{if(h.x&&h.y){if(f){const t=n.gravity,r=h.x-f[0]||.005,o=h.y-f[1]||.005,i=Math.sqrt(r*r+o*o);e[p].x-=r*t*a/i,e[p].y-=o*t*a/i}r.forEach(((n,r)=>{if(p===r)return;if(!n.x||!n.y)return;const{vl2:f,vl:g}=t[`${h.id}-${n.id}`];if(g>o)return;const{vx:m,vy:v}=t[`${h.id}-${n.id}`];let y=Math.log(Math.abs(n.depth-h.depth)/10)+1||1;y=y<1?1:y,n.comboId!==h.comboId&&(y+=1);const b=y?Math.pow(d,y):1,E=i(n)*a/f*b;if(e[p].x+=m*E,e[p].y+=v*E,p<r&&u){const t=c(h)+l(h)||1,o=c(n)+l(n)||1,i=t+o;if(f<i*i){const n=(i-g)/g*s,a=o*o;let u=a/(t*t+a);const c=m*n,l=v*n;e[p].x+=c*u,e[p].y+=l*u,u=1-u,e[r].x-=c*u,e[r].y-=l*u}}}))}}))}calAttractive(e,t){const n=this,r=n.edges,o=n.linkDistance,i=n.alpha,a=n.edgeStrength,s=n.bias,c=n.depthAttractiveForceScale;r.forEach(((r,l)=>{const d=f(r,"source"),h=f(r,"target");if(!d||!h||d===h)return;const p=n.indexMap[d],g=n.indexMap[h],m=n.nodeMap[d],v=n.nodeMap[h];if(!m||!v)return;let y=m.depth===v.depth?0:Math.log(Math.abs(m.depth-v.depth)/10);m.comboId===v.comboId&&(y/=2);let b=y?Math.pow(c,y):1;if(m.comboId!==v.comboId&&1===b?b=c/2:m.comboId===v.comboId&&(b=2),!(u(v.x)&&u(m.x)&&u(v.y)&&u(m.y)))return;const{vl:E,vx:w,vy:x}=t[`${h}-${d}`],_=(E-o(r))/E*i*a(r)*b,S=w*_,I=x*_,T=s[l];e[g].x-=S*T,e[g].y-=I*T,e[p].x+=S*(1-T),e[p].y+=I*(1-T)}))}getType(){return"comboForce"}}class bf extends i{constructor(e){super(),this.center=[0,0],this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.comboPadding=10,this.comboTrees=[],this.updateCfg(e)}getDefaultCfg(){return{}}execute(){const e=this,t=e.nodes,n=e.center;if(t&&0!==t.length){if(1===t.length)return t[0].x=n[0],t[0].y=n[1],void(e.onLayoutEnd&&e.onLayoutEnd());e.initVals(),e.run(),e.onLayoutEnd&&e.onLayoutEnd()}else e.onLayoutEnd&&e.onLayoutEnd()}run(){var e;const{nodes:t,edges:n,combos:r,comboEdges:o,center:i}=this,a={};t.forEach((e=>{a[e.id]=e}));const s={};r.forEach((e=>{s[e.id]=e}));const u=this.getInnerGraphs(a),c=[],l=[],d={};let f=!0;this.comboTrees.forEach((e=>{const t=u[e.id],n=Object.assign(Object.assign({},e),{x:t.x||s[e.id].x,y:t.y||s[e.id].y,fx:t.fx||s[e.id].fx,fy:t.fy||s[e.id].fy,mass:t.mass||s[e.id].mass,size:t.size});l.push(n),isNaN(n.x)||0===n.x||isNaN(n.y)||0===n.y?(n.x=100*Math.random(),n.y=100*Math.random()):f=!1,c.push(e.id),v(e,(t=>(t.id!==e.id&&(d[t.id]=e.id),!0)))})),t.forEach((e=>{if(e.comboId&&s[e.comboId])return;const t=Object.assign({},e);l.push(t),isNaN(t.x)||0===t.x||isNaN(t.y)||0===t.y?(t.x=100*Math.random(),t.y=100*Math.random()):f=!1,c.push(e.id)}));const h=[];if(n.concat(o).forEach((e=>{const t=d[e.source]||e.source,n=d[e.target]||e.target;t!==n&&c.includes(t)&&c.includes(n)&&h.push({source:t,target:n})})),null==l?void 0:l.length){if(1===l.length)l[0].x=i[0],l[0].y=i[1];else{const t={nodes:l,edges:h},n=this.outerLayout||new M({gravity:1,factor:4,linkDistance:(e,t,n)=>{var r,o;const i=(((null===(r=t.size)||void 0===r?void 0:r[0])||30)+((null===(o=n.size)||void 0===o?void 0:o[0])||30))/2;return Math.min(1.5*i,700)}}),r=null===(e=n.getType)||void 0===e?void 0:e.call(n);n.updateCfg({center:i,kg:5,preventOverlap:!0,animate:!1}),f&&Me[r]&&(l.length<100?new Fl:new N).layout(t),n.layout(t)}l.forEach((e=>{const t=u[e.id];if(t)t.visited=!0,t.x=e.x,t.y=e.y,t.nodes.forEach((t=>{t.x+=e.x,t.y+=e.y}));else{const t=a[e.id];t&&(t.x=e.x,t.y=e.y)}}))}const p=Object.keys(u);for(let e=p.length-1;e>=0;e--){const t=p[e],n=u[t];n&&(n.nodes.forEach((e=>{n.visited||(e.x+=n.x||0,e.y+=n.y||0),a[e.id]&&(a[e.id].x=e.x,a[e.id].y=e.y)})),s[t]&&(s[t].x=n.x,s[t].y=n.y))}return{nodes:t,edges:n,combos:r,comboEdges:o}}getInnerGraphs(e){const{comboTrees:t,nodeSize:n,edges:r,comboPadding:o,spacing:i}=this,a={},c=this.innerLayout||new jl({sortBy:"id"});return c.center=[0,0],c.preventOverlap=!0,c.nodeSpacing=i,(t||[]).forEach((t=>{v(t,(t=>{var i;let l=(null==o?void 0:o(t))||10;if(s(l)&&(l=Math.max(...l)),null===(i=t.children)||void 0===i?void 0:i.length){const o=t.children.map((t=>{if("combo"===t.itemType)return a[t.id];const n=e[t.id]||{};return Object.assign(Object.assign({},n),t)})),i=o.map((e=>e.id)),d={nodes:o,edges:r.filter((e=>i.includes(e.source)&&i.includes(e.target)))};let f=1/0;o.forEach((e=>{var t;e.size||(e.size=(null===(t=a[e.id])||void 0===t?void 0:t.size)||(null==n?void 0:n(e))||[30,30]),u(e.size)&&(e.size=[e.size,e.size]),f>e.size[0]&&(f=e.size[0]),f>e.size[1]&&(f=e.size[1])})),c.layout(d);const{minX:h,minY:p,maxX:g,maxY:m}=(e=>{let t=1/0,n=1/0,r=-1/0,o=-1/0;return e.forEach((e=>{let i=e.size;s(i)?1===i.length&&(i=[i[0],i[0]]):u(i)?i=[i,i]:(void 0===i||isNaN(i))&&(i=[30,30]);const a=[i[0]/2,i[1]/2],c=e.x-a[0],l=e.x+a[0],d=e.y-a[1],f=e.y+a[1];t>c&&(t=c),n>d&&(n=d),r<l&&(r=l),o<f&&(o=f)})),{minX:t,minY:n,maxX:r,maxY:o}})(o),v={x:(g+h)/2,y:(m+p)/2};d.nodes.forEach((e=>{e.x-=v.x,e.y-=v.y}));const y=Math.max(g-h,m-p,f)+2*l;a[t.id]={id:t.id,nodes:o,size:[y,y]}}else if("combo"===t.itemType){const e=l?[2*l,2*l]:[30,30];a[t.id]={id:t.id,nodes:[],size:e}}return!0}))})),a}initVals(){const e=this,t=e.nodeSize,n=e.spacing;let r,o;if(o=u(n)?()=>n:w(n)?n:()=>0,this.spacing=o,t)if(w(t))r=e=>{const n=t(e),r=o(e);return s(e.size)?((e.size[0]>e.size[1]?e.size[0]:e.size[1])+r)/2:((n||10)+r)/2};else if(s(t)){const e=(t[0]>t[1]?t[0]:t[1])/2;r=t=>e+o(t)/2}else{const e=t/2;r=t=>e+o(t)/2}else r=e=>{const t=o(e);return e.size?s(e.size)?((e.size[0]>e.size[1]?e.size[0]:e.size[1])+t)/2:l(e.size)?((e.size.width>e.size.height?e.size.width:e.size.height)+t)/2:(e.size+t)/2:10+t/2};this.nodeSize=r;const i=e.comboPadding;let a;a=u(i)?()=>i:s(i)?()=>Math.max.apply(null,i):w(i)?i:()=>0,this.comboPadding=a}getType(){return"comboCombined"}}class Ef{constructor(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}distanceTo(e){const t=this.rx-e.rx,n=this.ry-e.ry;return Math.hypot(t,n)}setPos(e,t){this.rx=e,this.ry=t}resetForce(){this.fx=0,this.fy=0}addForce(e){const t=e.rx-this.rx,n=e.ry-this.ry;let r=Math.hypot(t,n);r=r<1e-4?1e-4:r;const o=this.g*(this.degree+1)*(e.degree+1)/r;this.fx+=o*t/r,this.fy+=o*n/r}in(e){return e.contains(this.rx,this.ry)}add(e){const t=this.mass+e.mass,n=(this.rx*this.mass+e.rx*e.mass)/t,r=(this.ry*this.mass+e.ry*e.mass)/t,o=this.degree+e.degree;return new Ef({rx:n,ry:r,mass:t,degree:o})}}class wf{constructor(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}getLength(){return this.length}contains(e,t){const n=this.length/2;return e<=this.xmid+n&&e>=this.xmid-n&&t<=this.ymid+n&&t>=this.ymid-n}NW(){const e=this.xmid-this.length/4,t=this.ymid+this.length/4,n=this.length/2;return new wf({xmid:e,ymid:t,length:n})}NE(){const e=this.xmid+this.length/4,t=this.ymid+this.length/4,n=this.length/2;return new wf({xmid:e,ymid:t,length:n})}SW(){const e=this.xmid-this.length/4,t=this.ymid-this.length/4,n=this.length/2;return new wf({xmid:e,ymid:t,length:n})}SE(){const e=this.xmid+this.length/4,t=this.ymid-this.length/4,n=this.length/2;return new wf({xmid:e,ymid:t,length:n})}}class xf{constructor(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=e&&(this.quad=e)}insert(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new xf(this.quad.NW()),this.NE=new xf(this.quad.NE()),this.SW=new xf(this.quad.SW()),this.SE=new xf(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e}_putBody(e){this.quad&&(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))}_isExternal(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE}updateForce(e){null!=this.body&&e!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(e)<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e)))}}class _f extends i{constructor(e){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(e)}getDefaultCfg(){return{}}execute(){const e=this,{nodes:t,onLayoutEnd:n,prune:r}=e;let o=e.maxIteration;e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight);const i=[],a=t.length;for(let n=0;n<a;n+=1){const r=t[n];let o=10,a=10;u(r.size)&&(o=r.size,a=r.size),s(r.size)?(isNaN(r.size[0])||(o=r.size[0]),isNaN(r.size[1])||(a=r.size[1])):l(r.size)&&(o=r.size.width,a=r.size.height),e.getWidth&&!isNaN(e.getWidth(r))&&(a=e.getWidth(r)),e.getHeight&&!isNaN(e.getHeight(r))&&(o=e.getHeight(r));const c=Math.max(o,a);i.push(c)}void 0===e.barnesHut&&a>250&&(e.barnesHut=!0),void 0===e.prune&&a>100&&(e.prune=!0),0!==this.maxIteration||e.prune?0===this.maxIteration&&r&&(o=100,a<=200&&a>100?o=500:a>200&&(o=950),this.maxIteration=o):(o=250,a<=200&&a>100?o=1e3:a>200&&(o=1200),this.maxIteration=o),e.kr||(e.kr=50,a>100&&a<=500?e.kr=20:a>500&&(e.kr=1)),e.kg||(e.kg=20,a>100&&a<=500?e.kg=10:a>500&&(e.kg=1)),this.nodes=e.updateNodesByForces(i),n()}updateNodesByForces(e){const t=this,{edges:n,maxIteration:r}=t;let o=t.nodes;const i=n.filter((e=>f(e,"source")!==f(e,"target"))),a=o.length,s=i.length,u=[],c={},l={},d=[];for(let e=0;e<a;e+=1)c[o[e].id]=e,u[e]=0,(void 0===o[e].x||isNaN(o[e].x))&&(o[e].x=1e3*Math.random()),(void 0===o[e].y||isNaN(o[e].y))&&(o[e].y=1e3*Math.random()),d.push({x:o[e].x,y:o[e].y});for(let e=0;e<s;e+=1){let t,n,r=0,s=0;for(let u=0;u<a;u+=1){const a=f(i[e],"source"),c=f(i[e],"target");o[u].id===a?(t=o[u],r=u):o[u].id===c&&(n=o[u],s=u),l[e]={sourceIdx:r,targetIdx:s}}t&&(u[c[t.id]]+=1),n&&(u[c[n.id]]+=1)}let h=r;if(o=this.iterate(h,c,l,s,u,e),t.prune){for(let e=0;e<s;e+=1)u[l[e].sourceIdx]<=1?(o[l[e].sourceIdx].x=o[l[e].targetIdx].x,o[l[e].sourceIdx].y=o[l[e].targetIdx].y):u[l[e].targetIdx]<=1&&(o[l[e].targetIdx].x=o[l[e].sourceIdx].x,o[l[e].targetIdx].y=o[l[e].sourceIdx].y);t.prune=!1,t.barnesHut=!1,h=100,o=this.iterate(h,c,l,s,u,e)}return o}iterate(e,t,n,r,o,i){const a=this;let{nodes:s}=a;const{kr:u,preventOverlap:c}=a,{barnesHut:l}=a,d=s.length;let f=0,h=e,p=[];const g=[],m=[];for(let e=0;e<d;e+=1)if(p[2*e]=0,p[2*e+1]=0,l){const t={id:e,rx:s[e].x,ry:s[e].y,mass:1,g:u,degree:o[e]};m[e]=new Ef(t)}for(;h>0;){for(let e=0;e<d;e+=1)g[2*e]=p[2*e],g[2*e+1]=p[2*e+1],p[2*e]=0,p[2*e+1]=0;p=this.getAttrForces(h,50,r,t,n,o,i,p),p=l&&(c&&h>50||!c)?this.getOptRepGraForces(p,m,o):this.getRepGraForces(h,50,p,100,i,o);const e=this.updatePos(p,g,f,o);s=e.nodes,f=e.sg,h--,a.tick&&a.tick()}return s}getAttrForces(e,t,n,r,o,i,a,s){const{nodes:u,preventOverlap:c,dissuadeHubs:l,mode:d,prune:f}=this;for(let h=0;h<n;h+=1){const n=u[o[h].sourceIdx],p=o[h].sourceIdx,g=u[o[h].targetIdx],m=o[h].targetIdx;if(f&&(i[p]<=1||i[m]<=1))continue;const v=[g.x-n.x,g.y-n.y];let y=Math.hypot(v[0],v[1]);y=y<1e-4?1e-4:y,v[0]=v[0]/y,v[1]=v[1]/y,c&&e<t&&(y=y-a[p]-a[m]);let b=y,E=b;"linlog"===d&&(b=Math.log(1+y),E=b),l&&(b=y/i[p],E=y/i[m]),c&&e<t&&y<=0?(b=0,E=0):c&&e<t&&y>0&&(b=y,E=y),s[2*r[n.id]]+=b*v[0],s[2*r[g.id]]-=E*v[0],s[2*r[n.id]+1]+=b*v[1],s[2*r[g.id]+1]-=E*v[1]}return s}getRepGraForces(e,t,n,r,o,i){const{nodes:a,preventOverlap:s,kr:u,kg:c,center:l,prune:d}=this,f=a.length;for(let h=0;h<f;h+=1){for(let c=h+1;c<f;c+=1){if(d&&(i[h]<=1||i[c]<=1))continue;const l=[a[c].x-a[h].x,a[c].y-a[h].y];let f=Math.hypot(l[0],l[1]);f=f<1e-4?1e-4:f,l[0]=l[0]/f,l[1]=l[1]/f,s&&e<t&&(f=f-o[h]-o[c]);let p=u*(i[h]+1)*(i[c]+1)/f;s&&e<t&&f<0?p=r*(i[h]+1)*(i[c]+1):s&&e<t&&0===f?p=0:s&&e<t&&f>0&&(p=u*(i[h]+1)*(i[c]+1)/f),n[2*h]-=p*l[0],n[2*c]+=p*l[0],n[2*h+1]-=p*l[1],n[2*c+1]+=p*l[1]}const p=[a[h].x-l[0],a[h].y-l[1]],g=Math.hypot(p[0],p[1]);p[0]=p[0]/g,p[1]=p[1]/g;const m=c*(i[h]+1);n[2*h]-=m*p[0],n[2*h+1]-=m*p[1]}return n}getOptRepGraForces(e,t,n){const{nodes:r,kg:o,center:i,prune:a}=this,s=r.length;let u=9e10,c=-9e10,l=9e10,d=-9e10;for(let e=0;e<s;e+=1)a&&n[e]<=1||(t[e].setPos(r[e].x,r[e].y),r[e].x>=c&&(c=r[e].x),r[e].x<=u&&(u=r[e].x),r[e].y>=d&&(d=r[e].y),r[e].y<=l&&(l=r[e].y));const f=Math.max(c-u,d-l),h=new wf({xmid:(c+u)/2,ymid:(d+l)/2,length:f,massCenter:i,mass:s}),p=new xf(h);for(let e=0;e<s;e+=1)a&&n[e]<=1||t[e].in(h)&&p.insert(t[e]);for(let u=0;u<s;u+=1){if(a&&n[u]<=1)continue;t[u].resetForce(),p.updateForce(t[u]),e[2*u]-=t[u].fx,e[2*u+1]-=t[u].fy;const s=[r[u].x-i[0],r[u].y-i[1]];let c=Math.hypot(s[0],s[1]);c=c<1e-4?1e-4:c,s[0]=s[0]/c,s[1]=s[1]/c;const l=o*(n[u]+1);e[2*u]-=l*s[0],e[2*u+1]-=l*s[1]}return e}updatePos(e,t,n,r){const{nodes:o,ks:i,tao:a,prune:s,ksmax:c}=this,l=o.length,d=[],f=[];let h=0,p=0;for(let n=0;n<l;n+=1){if(s&&r[n]<=1)continue;const o=[e[2*n]-t[2*n],e[2*n+1]-t[2*n+1]],i=Math.hypot(o[0],o[1]),a=[e[2*n]+t[2*n],e[2*n+1]+t[2*n+1]],u=Math.hypot(a[0],a[1]);d[n]=i,f[n]=u/2,h+=(r[n]+1)*d[n],p+=(r[n]+1)*f[n]}const g=n;n=a*p/h,0!==g&&(n=n>1.5*g?1.5*g:n);for(let t=0;t<l;t+=1){if(s&&r[t]<=1)continue;if(u(o[t].fx)&&u(o[t].fy))continue;let a=i*n/(1+n*Math.sqrt(d[t])),l=Math.hypot(e[2*t],e[2*t+1]);l=l<1e-4?1e-4:l;const f=c/l;a=a>f?f:a;const h=a*e[2*t],p=a*e[2*t+1];o[t].x+=h,o[t].y+=p}return{nodes:o,sg:n}}}class Sf{constructor(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}init(e,t,n){this.cells=[],this.CELL_W=n.CELL_W||Sf.DEFAULT_CELL_W,this.CELL_H=n.CELL_H||Sf.DEFAULT_CELL_H,this.columnNum=Math.ceil(e/this.CELL_W),this.rowNum=Math.ceil(t/this.CELL_H),Sf.MIN_DIST=Math.pow(e,2)+Math.pow(t,2);for(let e=0;e<this.columnNum;e++){const t=[];for(let n=0;n<this.rowNum;n++){const r={dx:e,dy:n,x:e*this.CELL_W,y:n*this.CELL_H,occupied:!1};t.push(r)}this.cells.push(t)}}findGridByNodeId(e){var t,n;for(let r=0;r<this.columnNum;r++)for(let o=0;o<this.rowNum;o++)if(this.cells[r][o].node&&(null===(n=null===(t=this.cells[r][o])||void 0===t?void 0:t.node)||void 0===n?void 0:n.id)===e)return{column:r,row:o};return null}sqdist(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)}occupyNearest(e){let t,n=Sf.MIN_DIST,r=null;for(let o=0;o<this.columnNum;o++)for(let i=0;i<this.rowNum;i++)!this.cells[o][i].occupied&&(t=this.sqdist(e,this.cells[o][i]))<n&&(n=t,r=this.cells[o][i]);return r&&(r.occupied=!0),r}insertColumn(e,t){if(!(t<=0)){for(let e=0;e<t;e++){this.cells[e+this.columnNum]=[];for(let t=0;t<this.rowNum;t++)this.cells[e+this.columnNum][t]={dx:e,dy:t,x:e*this.CELL_W,y:t*this.CELL_H,occupied:!1,node:null}}for(let n=this.columnNum-1;n>e;n--)for(let e=0;e<this.rowNum;e++)this.cells[n+t][e]=Object.assign(Object.assign({},this.cells[n][e]),{x:(n+t)*this.CELL_W,y:e*this.CELL_H}),this.cells[n][e]={x:n*this.CELL_W,y:e*this.CELL_H,occupied:!0,node:null};for(let n=0;n<this.additionColumn.length;n++)this.additionColumn[n]>=e&&(this.additionColumn[n]+=t);for(let n=0;n<t;n++)this.additionColumn.push(e+n+1);this.columnNum+=t}}insertRow(e,t){if(!(t<=0)){for(let e=0;e<t;e++)for(let t=0;t<this.columnNum;t++)this.cells[t][e+this.rowNum]={dx:t,dy:e,x:t*this.CELL_W,y:e*this.CELL_H,occupied:!1,node:null};for(let n=0;n<this.columnNum;n++)for(let r=this.rowNum-1;r>e;r--)this.cells[n][r+t]=Object.assign(Object.assign({},this.cells[n][r]),{dx:n,dy:r+t,x:n*this.CELL_W,y:(r+t)*this.CELL_H}),this.cells[n][r]={dx:n,dy:r,x:n*this.CELL_W,y:r*this.CELL_H,occupied:!1,node:null};for(let n=0;n<this.additionRow.length;n++)this.additionRow[n]>=e&&(this.additionRow[n]+=t);for(let n=0;n<t;n++)this.additionRow.push(e+n+1);this.rowNum+=t}}getNodes(){const e=[];for(let t=0;t<this.columnNum;t++)for(let n=0;n<this.rowNum;n++)this.cells[t][n].node&&e.push(this.cells[t][n]);return e}}Sf.MIN_DIST=50,Sf.DEFAULT_CELL_W=80,Sf.DEFAULT_CELL_H=80;const If=1e7,Tf=1.5707963267948966,Af=new Map;let Nf=.8;function Df(e,t){const n=(Af.get(e.id)||[]).find((e=>e.source===t.id||e.target===t.id)),r=e.size[0]*e.size[1],o=t.size[0]*t.size[1],i=r>o?t:e,a=r>o?e:t,s=i.x-i.size[0]/2,u=i.y-i.size[1]/2,c=i.x+i.size[0]/2,l=i.y+i.size[1]/2,d=a.x-a.size[0]/2,f=a.y-a.size[1]/2,h=a.x+a.size[0]/2,p=a.y+a.size[1]/2,g=i.x,m=i.y,v=a.x,y=a.y;let b=0,E=0;if(c>=d&&h>=s&&l>=f&&p>=u)E=Math.sqrt(Math.pow(v-g,2)+Math.pow(y-m,2)),0===E&&(E=1e-7),b=10/E*100+((c<h?c:h)-(s>d?s:d))*((l<p?l:p)-(u>f?u:f)),b*=If;else{let e=!1;const t=function(e,t,n){const r=e.x-e.size[0]/2,o=e.y-e.size[1]/2,i=e.x+e.size[0]/2,a=e.y+e.size[1]/2,s=t.x-t.size[0]/2,u=t.y-t.size[1]/2,c=t.x+t.size[0]/2,l=t.y+t.size[1]/2,d=e.x,f=e.y,h=t.x,p=t.y,g=h-d,m=Math.atan2(g,p-f);let v=0,y=0,b=0,E=0;m>Tf?(y=o-l,v=s-i,b=parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)),E=parseFloat(v?(v/Math.sin(m)).toFixed(2):y.toFixed(2))):0<m&&m<=Tf?(y=u-a,v=s-i,b=E=y>v?parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)):parseFloat(v?(v/Math.sin(m)).toFixed(2):y.toFixed(2))):m<-Tf?(y=o-l,v=-(c-r),b=E=y>v?parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)):parseFloat(v?(v/Math.sin(m)).toFixed(2):y.toFixed(2))):(y=u-a,v=Math.abs(g)>(i-r)/2?r-c:g,b=E=y>v?parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)):parseFloat(v&&0!==m?(v/Math.sin(m)).toFixed(2):y.toFixed(2)));const w=parseFloat(m.toFixed(2));let x=n;return n&&(x=1.1780972450961724<w&&w<1.9634954084936207),{distance:Math.abs(b<E?b:E),isHoriz:x}}(i,a,e);E=t.distance,e=t.isHoriz,E<=10?b+=0!==E?n?10+1e7/E:10+1e8/E:If:(b+=E,n&&(b+=E*E))}return b}function kf(e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];(r.x<0||r.y<0||r.x>1200||r.y>800)&&(t+=1e12);for(let o=n+1;o<e.length;o++)t+=Df(r,e[o])}return t}function Mf(e,t,n,r){const o=new Map;n.forEach(((e,t)=>{o.set(e.id,e)}));const i=r.filter((t=>t.source===e.id||t.target===e.id))||[],a=[];i.forEach((t=>{const n=t.source===e.id?t.target:t.source,r=o.get(n);r&&a.push(r)}));let s=!0;for(let n=0;n<a.length;n++){const r=a[n],o=180*Math.atan((e.y-r.y)/(r.x-e.y)),i=180*Math.atan((t.y-r.y)/(r.x-t.y)),u=o>70&&o<110,c=i>70&&i<110;if((o<30||o>150)&&!(i<30||i>150)||o*i<0){s=!1;break}if(u&&!c||o*i<0){s=!1;break}if((r.x-e.x)*(r.x-t.x)<0){s=!1;break}if((r.y-e.y)*(r.y-t.y)<0){s=!1;break}}return s}function Of(e,t){let n=!1;const r=[10,-10,0,0],o=[0,0,10,-10];for(let i=0;i<e.length;++i){const a=e[i];let s=Rf(a,e);for(let i=0;i<r.length;i++)if(Mf(a,{x:a.x+r[i],y:a.y+o[i]},e,t)){a.x+=r[i],a.y+=o[i];const t=Rf(a,e),u=Math.random();t<s||u<Nf&&u>.1?(s=t,n=!0):(a.x-=r[i],a.y-=o[i])}}return Nf>.1&&(Nf*=.5),n?kf(e):0}function Rf(e,t){let n=0;(e.x<0||e.y<0||e.x+e.size[0]+20>1200||e.y+e.size[1]+20>800)&&(n+=1e12);for(let r=0;r<t.length;++r)e.id!==t[r].id&&(n+=Df(e,t[r]));return n}function Cf(e,t){const{nodes:n,edges:r}=e,o=t.width,i=t.height;if(!(null==n?void 0:n.length))return Promise.resolve();const a=[];n.forEach((e=>{if(r.filter((t=>t.source===e.id||t.target===e.id)).length>1){const t=Object.assign({},e);delete t.size,a.push(t)}}));const s=[];r.forEach((e=>{const t=a.find((t=>t.id===e.source)),n=a.find((t=>t.id===e.target));t&&n&&s.push(e)}));const u=new vr({type:"dagre",ranksep:t.nodeMinGap,nodesep:t.nodeMinGap}),{nodes:c}=u.layout({nodes:a,edges:s});n.forEach((e=>{const t=(c||[]).find((t=>t.id===e.id));e.x=(null==t?void 0:t.x)||o/2,e.y=(null==t?void 0:t.y)||i/2}));const l=JSON.parse(JSON.stringify(n)),d=JSON.parse(JSON.stringify(r)),f=be().nodes(l).force("link",Se(d).id((e=>e.id)).distance((e=>s.find((t=>t.source===e.source&&t.target===e.target))?30:20))).force("charge",Ee()).force("center",we(o/2,i/2)).force("x",Ne(o/2)).force("y",De(i/2)).alpha(.3).alphaDecay(.08).alphaMin(.001),h=new Promise((e=>{f.on("end",(()=>{n.forEach((e=>{const t=l.find((t=>t.id===e.id));t&&(e.x=t.x,e.y=t.y)}));const a=Math.min(...n.map((e=>e.x))),s=Math.max(...n.map((e=>e.x))),u=Math.min(...n.map((e=>e.y))),c=Math.max(...n.map((e=>e.y))),d=o/(s-a),f=i/(c-u);n.forEach((e=>{void 0!==e.x&&d<1&&(e.x=(e.x-a)*d),void 0!==e.y&&f<1&&(e.y=(e.y-u)*f)})),n.forEach((e=>{e.sizeTemp=e.size,e.size=[10,10]})),function(e,t){if(0===e.length)return{nodes:e,edges:t};e.forEach((e=>{const n=t.filter((t=>t.source===e.id||t.target===e.id));Af.set(e,n)})),e.sort(((e,t)=>{var n,r;return(null===(n=Af.get(e.id))||void 0===n?void 0:n.length)-(null===(r=Af.get(t.id))||void 0===r?void 0:r.length)}));let n=kf(e),r=20,o=1,i=0,a=0;for(;r>0&&(a++,!(a>=50));){const a=Of(e,t);0!==a&&(i=a),o=i-n,n=i,0===o?--r:r=20}e.forEach((e=>{e.x=e.x-e.size[0]/2,e.y=e.y-e.size[1]/2}))}(n,r),n.forEach((e=>{e.size=e.sizeTemp||[],delete e.sizeTemp})),function(e,t){if(!e.nodes||0===e.nodes.length)return e;const n=t.width,r=t.height,o=t.nodeMinGap;let i=1e4,a=1e4;e.nodes.forEach((e=>{const t=e.size[0]||50,n=e.size[1]||50;i=Math.min(t,i),a=Math.min(n,a)}));const s=new Sf;s.init(n,r,{CELL_H:a,CELL_W:i}),e.nodes.forEach((e=>{const t=s.occupyNearest(e);t&&(t.node={id:e.id,size:e.size},e.x=t.x,e.y=t.y,e.dx=t.dx,e.dy=t.dy)}));for(let t=0;t<e.nodes.length;t++){const n=e.nodes[t],r=s.findGridByNodeId(n.id);if(!r)throw new Error("can not find node cell");const{column:u,row:c}=r;if(n.size[0]+o>i){const e=Math.ceil((n.size[0]+o)/i)-1;let t=e;for(let n=0;n<e&&s.additionColumn.indexOf(u+n+1)>-1&&!s.cells[u+n+1][c].node;n++)t--;s.insertColumn(u,t)}if(n.size[1]+o>a){const e=Math.ceil((n.size[1]+o)/a)-1;let t=e;for(let n=0;n<e&&s.additionRow.indexOf(c+n+1)>-1&&!s.cells[u][c+n+1].node;n++)t--;s.insertRow(c,t)}}for(let t=0;t<s.columnNum;t++)for(let n=0;n<s.rowNum;n++){const r=s.cells[t][n];if(r.node){const t=e.nodes.find((e=>{var t;return e.id===(null===(t=null==r?void 0:r.node)||void 0===t?void 0:t.id)}));t&&(t.x=r.x+t.size[0]/2,t.y=r.y+t.size[1]/2)}}}({nodes:n,edges:r},t),e()}))}));return h}class Lf extends i{constructor(e){super(),this.width=300,this.height=300,this.nodeMinGap=50,this.onLayoutEnd=()=>{},e&&this.updateCfg(e)}getDefaultCfg(){return{width:300,height:300,nodeMinGap:50}}execute(){const e=this,t=e.nodes,n=e.edges;return null==t||t.forEach((e=>{e.size||(e.size=[50,50])})),Cf({nodes:t,edges:n},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then((()=>{e.onLayoutEnd&&e.onLayoutEnd()}))}getType(){return"er"}}class zf{constructor(e){const t=A(e.type);this.layoutInstance=new t(e)}layout(e){return this.layoutInstance.layout(e)}updateCfg(e){this.layoutInstance.updateCfg(e)}init(e){this.correctLayers(e.nodes),this.layoutInstance.init(e)}correctLayers(e){if(!(null==e?void 0:e.length))return;let t=1/0;const n=[];if(e.forEach((e=>{a(e.layer)&&(e.layer=parseInt(e.layer,10)),void 0===e.layer||isNaN(e.layer)||(n.push(e),e.layer<t&&(t=e.layer))})),t<=0){const e=Math.abs(t)+1;n.forEach((t=>t.layer+=e))}}execute(){this.layoutInstance.execute()}getDefaultCfg(){return this.layoutInstance.getDefaultCfg()}destroy(){return this.layoutInstance.destroy()}}const Gf={force:Oe,fruchterman:Ul,forceAtlas2:_f,gForce:M,force2:B,dagre:vr,dagreCompound:ll,circular:Le,radial:Pl,concentric:jl,grid:N,mds:Fl,comboForce:yf,comboCombined:bf,random:D,"gForce-gpu":vf,"fruchterman-gpu":gf,er:Lf},Pf={layout:{meta:{global:!1},methods:{onAction:function(e){if("instance"===e.action.name)return o}}}}},835:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={}},75:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={}},380:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={"zh-cn":n(75).Z}},267:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=[]},625:(e,t,n)=>{"use strict";function r(e){return{state:{},getters:{},mutations:{},actions:{}}}n.d(t,{Z:()=>r})},100:(e,t,n)=>{var r=n(233),o=n(361)(r);o.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),e.exports=o},361:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(r)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var s=0;s<e.length;s++){var u=[].concat(e[s]);r&&o[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),t.push(u))}},t}},233:e=>{"use strict";function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.exports=function(e){var n,r,o=(r=4,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(n,r)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[1],a=o[3];if(!a)return i;if("function"==typeof btoa){var s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),c="/*# ".concat(u," */"),l=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[i].concat(l).concat([c]).join("\n")}return[i].join("\n")}},690:(e,t,n)=>{var r=n(441).Symbol;e.exports=r},318:(e,t,n)=>{var r=n(690),o=n(77),i=n(954),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):i(e)}},749:(e,t,n)=>{var r=n(318),o=n(216),i=n(387),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!a[r(e)]}},535:e=>{e.exports=function(e){return function(t){return e(t)}}},414:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},407:(e,t,n)=>{var r=n(717)(Object.getPrototypeOf,Object);e.exports=r},77:(e,t,n)=>{var r=n(690),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=a.call(e);return r&&(t?e[s]=n:delete e[s]),o}},782:(e,t,n)=>{e=n.nmd(e);var r=n(414),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o&&r.process,s=function(){try{return i&&i.require&&i.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s},954:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},717:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},441:(e,t,n)=>{var r=n(414),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},236:e=>{var t=Array.isArray;e.exports=t},216:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},22:(e,t,n)=>{var r=n(318),o=n(387);e.exports=function(e){return"number"==typeof e||o(e)&&"[object Number]"==r(e)}},387:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},636:(e,t,n)=>{var r=n(318),o=n(407),i=n(387),a=Function.prototype,s=Object.prototype,u=a.toString,c=s.hasOwnProperty,l=u.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=r(e))return!1;var t=o(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==l}},812:(e,t,n)=>{var r=n(749),o=n(535),i=n(782),a=i&&i.isTypedArray,s=a?o(a):r;e.exports=s},459:function(e){e.exports=function(){"use strict";var e=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},t=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},n="\n";function r(e){var t=new Error("(regl) "+e);throw console.error(t),t}function o(e,t){e||r(t)}function i(e){return e?": "+e:""}function a(e,t){switch(t){case"number":return"number"==typeof e;case"object":return"object"==typeof e;case"string":return"string"==typeof e;case"boolean":return"boolean"==typeof e;case"function":return"function"==typeof e;case"undefined":return void 0===e;case"symbol":return"symbol"==typeof e}}function s(e,t,n){t.indexOf(e)<0&&r("invalid value"+i(n)+". must be one of: "+t)}var u=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function c(e,t){for(e+="";e.length<t;)e=" "+e;return e}function l(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function d(e,t){this.number=e,this.line=t,this.errors=[]}function f(e,t,n){this.file=e,this.line=t,this.message=n}function h(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return r?r[1]:"unknown"}function p(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return r?r[1]:"unknown"}function g(e,t){var n,r=e.split("\n"),o=1,i=0,a={unknown:new l,0:new l};a.unknown.name=a[0].name=t||h(),a.unknown.lines.push(new d(0,""));for(var s=0;s<r.length;++s){var u=r[s],c=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(u);if(c)switch(c[1]){case"line":var f=/(\d+)(\s+\d+)?/.exec(c[2]);f&&(o=0|f[1],f[2]&&((i=0|f[2])in a||(a[i]=new l)));break;case"define":var p=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);p&&(a[i].name=p[1]?(n=p[2],"undefined"!=typeof atob?atob(n):"base64:"+n):p[2])}a[i].lines.push(new d(o++,u))}return Object.keys(a).forEach((function(e){var t=a[e];t.lines.forEach((function(e){t.index[e.number]=e}))})),a}function m(e){e._commandRef=h()}function v(e,t){var n=p();r(e+" in command "+(t||h())+("unknown"===n?"":" called from "+n))}function y(e,t,n,r){a(e,t)||v("invalid parameter type"+i(n)+". expected "+t+", got "+typeof e,r||h())}var b=33071,E={};function w(e,t){return 32820===e||32819===e||33635===e?2:34042===e?4:E[e]*t}function x(e){return!(e&e-1||!e)}E[5120]=E[5121]=1,E[5122]=E[5123]=E[36193]=E[33635]=E[32819]=E[32820]=2,E[5124]=E[5125]=E[5126]=E[34042]=4;var _=t(o,{optional:function(e){e()},raise:r,commandRaise:v,command:function(e,t,n){e||v(t,n||h())},parameter:function(e,t,n){e in t||r("unknown parameter ("+e+")"+i(n)+". possible values: "+Object.keys(t).join())},commandParameter:function(e,t,n,r){e in t||v("unknown parameter ("+e+")"+i(n)+". possible values: "+Object.keys(t).join(),r||h())},constructor:function(e){Object.keys(e).forEach((function(e){u.indexOf(e)<0&&r('invalid regl constructor argument "'+e+'". must be one of '+u)}))},type:function(e,t,n){a(e,t)||r("invalid parameter type"+i(n)+". expected "+t+", got "+typeof e)},commandType:y,isTypedArray:function(t,n){e(t)||r("invalid parameter type"+i(n)+". must be a typed array")},nni:function(e,t){e>=0&&(0|e)===e||r("invalid parameter type, ("+e+")"+i(t)+". must be a nonnegative integer")},oneOf:s,shaderError:function(e,t,r,i,a){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var s=e.getShaderInfoLog(t),u=i===e.FRAGMENT_SHADER?"fragment":"vertex";y(r,"string",u+" shader source must be a string",a);var l=g(r,a),d=function(e){var t=[];return e.split("\n").forEach((function(e){if(!(e.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(e);n?t.push(new f(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new f("unknown",0,e))}})),t}(s);(function(e,t){t.forEach((function(t){var n=e[t.file];if(n){var r=n.index[t.line];if(r)return r.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)}))})(l,d),Object.keys(l).forEach((function(e){var t=l[e];if(t.hasErrors){var r=[""],o=[""];i("file number "+e+": "+t.name+"\n","color:red;text-decoration:underline;font-weight:bold"),t.lines.forEach((function(e){if(e.errors.length>0){i(c(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),i(e.line+n,"color:red; background-color:yellow; font-weight:bold");var t=0;e.errors.forEach((function(r){var o=r.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(o);if(a){var s=a[1];o=a[2],"assign"===s&&(s="="),t=Math.max(e.line.indexOf(s,t),0)}else t=0;i(c("| ",6)),i(c("^^^",t+3)+n,"font-weight:bold"),i(c("| ",6)),i(o+n,"font-weight:bold")})),i(c("| ",6)+n)}else i(c(e.number,4)+"|  "),i(e.line+n,"color:red")})),"undefined"==typeof document||window.chrome?console.log(r.join("")):(o[0]=r.join("%c"),console.log.apply(console,o))}function i(e,t){r.push(e),o.push(t||"")}})),o.raise("Error compiling "+u+" shader, "+l[0].name)}},linkError:function(e,t,r,i,a){if(!e.getProgramParameter(t,e.LINK_STATUS)){var s=e.getProgramInfoLog(t),u=g(r,a),c='Error linking program with vertex shader, "'+g(i,a)[0].name+'", and fragment shader "'+u[0].name+'"';"undefined"!=typeof document?console.log("%c"+c+"\n%c"+s,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(c+n+s),o.raise(c)}},callSite:p,saveCommandRef:m,saveDrawInfo:function(e,t,n,r){function o(e){return e?r.id(e):0}function i(e,t){Object.keys(t).forEach((function(t){e[r.id(t)]=!0}))}m(e),e._fragId=o(e.static.frag),e._vertId=o(e.static.vert);var a=e._uniformSet={};i(a,t.static),i(a,t.dynamic);var s=e._attributeSet={};i(s,n.static),i(s,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic},framebufferFormat:function(e,t,n){e.texture?s(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):s(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")},guessCommand:h,texture2D:function(e,t,n){var r,i=t.width,a=t.height,s=t.channels;o(i>0&&i<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),e.wrapS===b&&e.wrapT===b||o(x(i)&&x(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==i&&1!==a&&o(9984!==e.minFilter&&9986!==e.minFilter&&9985!==e.minFilter&&9987!==e.minFilter,"min filter requires mipmap"):(o(x(i)&&x(a),"texture must be a square power of 2 to support mipmapping"),o(t.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),5126===t.type&&(n.extensions.indexOf("oes_texture_float_linear")<0&&o(9728===e.minFilter&&9728===e.magFilter,"filter not supported, must enable oes_texture_float_linear"),o(!e.genMipmaps,"mipmap generation not supported with float textures"));var u=t.images;for(r=0;r<16;++r)if(u[r]){var c=i>>r,l=a>>r;o(t.mipmask&1<<r,"missing mipmap data");var d=u[r];if(o(d.width===c&&d.height===l,"invalid shape for mip images"),o(d.format===t.format&&d.internalformat===t.internalformat&&d.type===t.type,"incompatible type for mip image"),d.compressed);else if(d.data){var f=Math.ceil(w(d.type,s)*c/d.unpackAlignment)*d.unpackAlignment;o(d.data.byteLength===f*l,"invalid data for image, buffer size is inconsistent with image format")}else d.element||d.copy}else e.genMipmaps||o(0==(t.mipmask&1<<r),"extra mipmap data");t.compressed&&o(!e.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(e,t,n,r){var i=e.width,a=e.height,s=e.channels;o(i>0&&i<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),o(i===a,"cube map must be square"),o(t.wrapS===b&&t.wrapT===b,"wrap mode not supported by cube map");for(var u=0;u<n.length;++u){var c=n[u];o(c.width===i&&c.height===a,"inconsistent cube map face shape"),t.genMipmaps&&(o(!c.compressed,"can not generate mipmap for compressed textures"),o(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var l=c.images,d=0;d<16;++d){var f=l[d];if(f){var h=i>>d,p=a>>d;o(c.mipmask&1<<d,"missing mipmap data"),o(f.width===h&&f.height===p,"invalid shape for mip images"),o(f.format===e.format&&f.internalformat===e.internalformat&&f.type===e.type,"incompatible type for mip image"),f.compressed||(f.data?o(f.data.byteLength===h*p*Math.max(w(f.type,s),f.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):f.element||f.copy)}}}}}),S=0;function I(e,t){this.id=S++,this.type=e,this.data=t}function T(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function A(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+T(e.substr(1,e.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(r)return A(e.substr(0,r.index)).concat(A(r[1])).concat(A(e.substr(r.index+r[0].length)));var o=e.split(".");if(1===o.length)return['"'+T(e)+'"'];for(var i=[],a=0;a<o.length;++a)i=i.concat(A(o[a]));return i}function N(e){return"["+A(e).join("][")+"]"}var D={DynamicVariable:I,define:function(e,t){return new I(e,N(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof I},unbox:function e(t,n){return"function"==typeof t?new I(0,t):"number"==typeof t||"boolean"==typeof t?new I(5,t):Array.isArray(t)?new I(6,t.map(((t,r)=>e(t,n+"["+r+"]")))):t instanceof I?t:void _(!1,"invalid option type in uniform "+n)},accessor:N},k={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},M="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function O(e){return"string"==typeof e?e.split():(_(Array.isArray(e),"invalid extension array"),e)}function R(e){return"string"==typeof e?(_("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function C(e){var n,r,o,i,a,s=e||{},u={},c=[],l=[],d="undefined"==typeof window?1:window.devicePixelRatio,f=!1,h=function(e){e&&_.raise(e)},p=function(){};if("string"==typeof s?(_("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),n=document.querySelector(s),_(n,"invalid query string for element")):"object"==typeof s?"string"==typeof(a=s).nodeName&&"function"==typeof a.appendChild&&"function"==typeof a.getBoundingClientRect?n=s:function(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}(s)?o=(i=s).canvas:(_.constructor(s),"gl"in s?i=s.gl:"canvas"in s?o=R(s.canvas):"container"in s&&(r=R(s.container)),"attributes"in s&&(u=s.attributes,_.type(u,"object","invalid context attributes")),"extensions"in s&&(c=O(s.extensions)),"optionalExtensions"in s&&(l=O(s.optionalExtensions)),"onDone"in s&&(_.type(s.onDone,"function","invalid or missing onDone callback"),h=s.onDone),"profile"in s&&(f=!!s.profile),"pixelRatio"in s&&(d=+s.pixelRatio,_(d>0,"invalid pixel ratio"))):_.raise("invalid arguments to regl"),n&&("canvas"===n.nodeName.toLowerCase()?o=n:r=n),!i){if(!o){_("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var g=function(e,n,r){var o,i=document.createElement("canvas");function a(){var n=window.innerWidth,o=window.innerHeight;if(e!==document.body){var a=e.getBoundingClientRect();n=a.right-a.left,o=a.bottom-a.top}i.width=r*n,i.height=r*o,t(i.style,{width:n+"px",height:o+"px"})}return t(i.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(i),e===document.body&&(i.style.position="absolute",t(e.style,{margin:0,padding:0})),e!==document.body&&"function"==typeof ResizeObserver?(o=new ResizeObserver((function(){setTimeout(a)}))).observe(e):window.addEventListener("resize",a,!1),a(),{canvas:i,onDestroy:function(){o?o.disconnect():window.removeEventListener("resize",a),e.removeChild(i)}}}(r||document.body,0,d);if(!g)return null;o=g.canvas,p=g.onDestroy}void 0===u.premultipliedAlpha&&(u.premultipliedAlpha=!0),i=function(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(o,u)}return i?{gl:i,canvas:o,container:r,extensions:c,optionalExtensions:l,pixelRatio:d,profile:f,onDone:h,onDestroy:p}:(p(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function L(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function z(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1}function G(){var e=L(8,(function(){return[]}));function t(t){var n=function(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}(t),r=e[z(n)>>2];return r.length>0?r.pop():new ArrayBuffer(n)}function n(t){e[z(t.byteLength)>>2].push(t)}return{alloc:t,free:n,allocType:function(e,n){var r=null;switch(e){case 5120:r=new Int8Array(t(n),0,n);break;case 5121:r=new Uint8Array(t(n),0,n);break;case 5122:r=new Int16Array(t(2*n),0,n);break;case 5123:r=new Uint16Array(t(2*n),0,n);break;case 5124:r=new Int32Array(t(4*n),0,n);break;case 5125:r=new Uint32Array(t(4*n),0,n);break;case 5126:r=new Float32Array(t(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r},freeType:function(e){n(e.buffer)}}}var P=G();P.zero=G();var j=3553,F=6408,U=5126,B=36160;function V(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||e(t.data))}var W=function(e){return Object.keys(e).map((function(t){return e[t]}))},X={shape:function(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t},flatten:function(e,t,n,r){var o=1;if(t.length)for(var i=0;i<t.length;++i)o*=t[i];else o=0;var a=r||P.allocType(n,o);switch(t.length){case 0:break;case 1:!function(e,t,n){for(var r=0;r<t;++r)n[r]=e[r]}(e,t[0],a);break;case 2:!function(e,t,n,r){for(var o=0,i=0;i<t;++i)for(var a=e[i],s=0;s<n;++s)r[o++]=a[s]}(e,t[0],t[1],a);break;case 3:H(e,t[0],t[1],t[2],a,0);break;default:q(e,t,0,a,0)}return a}};function H(e,t,n,r,o,i){for(var a=i,s=0;s<t;++s)for(var u=e[s],c=0;c<n;++c)for(var l=u[c],d=0;d<r;++d)o[a++]=l[d]}function q(e,t,n,r,o){for(var i=1,a=n+1;a<t.length;++a)i*=t[a];var s=t[n];if(t.length-n==4){var u=t[n+1],c=t[n+2],l=t[n+3];for(a=0;a<s;++a)H(e[a],u,c,l,r,o),o+=i}else for(a=0;a<s;++a)q(e[a],t,n+1,r,o),o+=i}var Y={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Z={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},$={dynamic:35048,stream:35040,static:35044},K=X.flatten,Q=X.shape,J=5121,ee=5126,te=[];function ne(e){return 0|Y[Object.prototype.toString.call(e)]}function re(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function oe(e,t,n,r,o,i,a){for(var s=0,u=0;u<n;++u)for(var c=0;c<r;++c)e[s++]=t[o*u+i*c+a]}te[5120]=1,te[5122]=2,te[5124]=4,te[5121]=1,te[5123]=2,te[5125]=4,te[5126]=4;var ie={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ae=5121,se=5123,ue=5125,ce=34963;var le=new Float32Array(1),de=new Uint32Array(le.buffer);function fe(e){for(var t=P.allocType(5123,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-1/0)t[n]=64512;else{le[0]=e[n];var r=de[0],o=r>>>31<<15,i=(r<<1>>>24)-127,a=r>>13&1023;if(i<-24)t[n]=o;else if(i<-14){var s=-14-i;t[n]=o+(a+1024>>s)}else t[n]=i>15?o+31744:o+(i+15<<10)+a}return t}function he(t){return Array.isArray(t)||e(t)}var pe=function(e){return!(e&e-1||!e)},ge=3553,me=34067,ve=34069,ye=6408,be=6406,Ee=6407,we=6409,xe=6410,_e=32855,Se=6402,Ie=34041,Te=35904,Ae=35906,Ne=36193,De=33776,ke=33777,Me=33778,Oe=33779,Re=5121,Ce=5123,Le=5125,ze=5126,Ge=33071,Pe=9728,je=9984,Fe=9987,Ue=4352,Be=33984,Ve=[je,9986,9985,Fe],We=[0,we,xe,Ee,ye],Xe={};function He(e){return"[object "+e+"]"}Xe[6409]=Xe[6406]=Xe[6402]=1,Xe[34041]=Xe[6410]=2,Xe[6407]=Xe[35904]=3,Xe[6408]=Xe[35906]=4;var qe=He("HTMLCanvasElement"),Ye=He("OffscreenCanvas"),Ze=He("CanvasRenderingContext2D"),$e=He("ImageBitmap"),Ke=He("HTMLImageElement"),Qe=He("HTMLVideoElement"),Je=Object.keys(Y).concat([qe,Ye,Ze,$e,Ke,Qe]),et=[];et[5121]=1,et[5126]=4,et[36193]=2,et[5123]=2,et[5125]=4;var tt=[];function nt(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function rt(e){return!!Array.isArray(e)&&!(0===e.length||!he(e[0]))}function ot(e){return Object.prototype.toString.call(e)}function it(e){return ot(e)===qe}function at(e){return ot(e)===Ye}function st(e){if(!e)return!1;var t=ot(e);return Je.indexOf(t)>=0||nt(e)||rt(e)||V(e)}function ut(e){return 0|Y[Object.prototype.toString.call(e)]}function ct(e,t){return P.allocType(e.type===Ne?ze:e.type,t)}function lt(e,t){e.type===Ne?(e.data=fe(t),P.freeType(t)):e.data=t}function dt(e,t,n,r,o,i){var a;if(a=void 0!==tt[e]?tt[e]:Xe[e]*et[t],i&&(a*=6),o){for(var s=0,u=n;u>=1;)s+=a*u*u,u/=2;return s}return a*n*r}function ft(n,r,o,i,a,s,u){var c={"don't care":Ue,"dont care":Ue,nice:4354,fast:4353},l={repeat:10497,clamp:Ge,mirror:33648},d={nearest:Pe,linear:9729},f=t({mipmap:Fe,"nearest mipmap nearest":je,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":Fe},d),h={none:0,browser:37444},p={uint8:Re,rgba4:32819,rgb565:33635,"rgb5 a1":32820},g={alpha:be,luminance:we,"luminance alpha":xe,rgb:Ee,rgba:ye,rgba4:32854,"rgb5 a1":_e,rgb565:36194},m={};r.ext_srgb&&(g.srgb=Te,g.srgba=Ae),r.oes_texture_float&&(p.float32=p.float=ze),r.oes_texture_half_float&&(p.float16=p["half float"]=Ne),r.webgl_depth_texture&&(t(g,{depth:Se,"depth stencil":Ie}),t(p,{uint16:Ce,uint32:Le,"depth stencil":34042})),r.webgl_compressed_texture_s3tc&&t(m,{"rgb s3tc dxt1":De,"rgba s3tc dxt1":ke,"rgba s3tc dxt3":Me,"rgba s3tc dxt5":Oe}),r.webgl_compressed_texture_atc&&t(m,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),r.webgl_compressed_texture_pvrtc&&t(m,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),r.webgl_compressed_texture_etc1&&(m["rgb etc1"]=36196);var v=Array.prototype.slice.call(n.getParameter(34467));Object.keys(m).forEach((function(e){var t=m[e];v.indexOf(t)>=0&&(g[e]=t)}));var y=Object.keys(g);o.textureFormats=y;var b=[];Object.keys(g).forEach((function(e){var t=g[e];b[t]=e}));var E=[];Object.keys(p).forEach((function(e){var t=p[e];E[t]=e}));var w=[];Object.keys(d).forEach((function(e){w[d[e]]=e}));var x=[];Object.keys(f).forEach((function(e){var t=f[e];x[t]=e}));var S=[];Object.keys(l).forEach((function(e){S[l[e]]=e}));var I=y.reduce((function(e,t){var n=g[t];return n===we||n===be||n===we||n===xe||n===Se||n===Ie||r.ext_srgb&&(n===Te||n===Ae)?e[n]=n:n===_e||t.indexOf("rgba")>=0?e[n]=ye:e[n]=Ee,e}),{});function T(){this.internalformat=ye,this.format=ye,this.type=Re,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=37444,this.width=0,this.height=0,this.channels=0}function A(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function N(e,t){if("object"==typeof t&&t){if("premultiplyAlpha"in t&&(_.type(t.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(_.type(t.flipY,"boolean","invalid texture flip"),e.flipY=t.flipY),"alignment"in t&&(_.oneOf(t.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=t.alignment),"colorSpace"in t&&(_.parameter(t.colorSpace,h,"invalid colorSpace"),e.colorSpace=h[t.colorSpace]),"type"in t){var n=t.type;_(r.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),_(r.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),_(r.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),_.parameter(n,p,"invalid texture type"),e.type=p[n]}var i=e.width,a=e.height,s=e.channels,u=!1;"shape"in t?(_(Array.isArray(t.shape)&&t.shape.length>=2,"shape must be an array"),i=t.shape[0],a=t.shape[1],3===t.shape.length&&(s=t.shape[2],_(s>0&&s<=4,"invalid number of channels"),u=!0),_(i>=0&&i<=o.maxTextureSize,"invalid width"),_(a>=0&&a<=o.maxTextureSize,"invalid height")):("radius"in t&&(i=a=t.radius,_(i>=0&&i<=o.maxTextureSize,"invalid radius")),"width"in t&&(i=t.width,_(i>=0&&i<=o.maxTextureSize,"invalid width")),"height"in t&&(a=t.height,_(a>=0&&a<=o.maxTextureSize,"invalid height")),"channels"in t&&(s=t.channels,_(s>0&&s<=4,"invalid number of channels"),u=!0)),e.width=0|i,e.height=0|a,e.channels=0|s;var c=!1;if("format"in t){var l=t.format;_(r.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),_.parameter(l,g,"invalid texture format");var d=e.internalformat=g[l];e.format=I[d],l in p&&("type"in t||(e.type=p[l])),l in m&&(e.compressed=!0),c=!0}!u&&c?e.channels=Xe[e.format]:u&&!c?e.channels!==We[e.format]&&(e.format=e.internalformat=We[e.channels]):c&&u&&_(e.channels===Xe[e.format],"number of channels inconsistent with specified format")}}function D(e){n.pixelStorei(37440,e.flipY),n.pixelStorei(37441,e.premultiplyAlpha),n.pixelStorei(37443,e.colorSpace),n.pixelStorei(3317,e.unpackAlignment)}function k(){T.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function M(t,n){var r=null;if(st(n)?r=n:n&&(_.type(n,"object","invalid pixel data type"),N(t,n),"x"in n&&(t.xOffset=0|n.x),"y"in n&&(t.yOffset=0|n.y),st(n.data)&&(r=n.data)),_(!t.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){_(!r,"can not specify copy and data field for the same texture");var i=a.viewportWidth,s=a.viewportHeight;t.width=t.width||i-t.xOffset,t.height=t.height||s-t.yOffset,t.needsCopy=!0,_(t.xOffset>=0&&t.xOffset<i&&t.yOffset>=0&&t.yOffset<s&&t.width>0&&t.width<=i&&t.height>0&&t.height<=s,"copy texture read out of bounds")}else if(r){if(e(r))t.channels=t.channels||4,t.data=r,"type"in n||t.type!==Re||(t.type=ut(r));else if(nt(r))t.channels=t.channels||4,function(e,t){var n=t.length;switch(e.type){case Re:case Ce:case Le:case ze:var r=P.allocType(e.type,n);r.set(t),e.data=r;break;case Ne:e.data=fe(t);break;default:_.raise("unsupported texture type, must specify a typed array")}}(t,r),t.alignment=1,t.needsFree=!0;else if(V(r)){var u=r.data;Array.isArray(u)||t.type!==Re||(t.type=ut(u));var c,l,d,f,h,p,g=r.shape,m=r.stride;3===g.length?(d=g[2],p=m[2]):(_(2===g.length,"invalid ndarray pixel data, must be 2 or 3D"),d=1,p=1),c=g[0],l=g[1],f=m[0],h=m[1],t.alignment=1,t.width=c,t.height=l,t.channels=d,t.format=t.internalformat=We[d],t.needsFree=!0,function(e,t,n,r,o,i){for(var a=e.width,s=e.height,u=e.channels,c=ct(e,a*s*u),l=0,d=0;d<s;++d)for(var f=0;f<a;++f)for(var h=0;h<u;++h)c[l++]=t[n*f+r*d+o*h+i];lt(e,c)}(t,u,f,h,p,r.offset)}else if(it(r)||at(r)||ot(r)===Ze)it(r)||at(r)?t.element=r:t.element=r.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(function(e){return ot(e)===$e}(r))t.element=r,t.width=r.width,t.height=r.height,t.channels=4;else if(function(e){return ot(e)===Ke}(r))t.element=r,t.width=r.naturalWidth,t.height=r.naturalHeight,t.channels=4;else if(function(e){return ot(e)===Qe}(r))t.element=r,t.width=r.videoWidth,t.height=r.videoHeight,t.channels=4;else if(rt(r)){var v=t.width||r[0].length,y=t.height||r.length,b=t.channels;b=he(r[0][0])?b||r[0][0].length:b||1;for(var E=X.shape(r),w=1,x=0;x<E.length;++x)w*=E[x];var S=ct(t,w);X.flatten(r,E,"",S),lt(t,S),t.alignment=1,t.width=v,t.height=y,t.channels=b,t.format=t.internalformat=We[b],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===ze?_(o.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===Ne&&_(o.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function O(e,t,r){var o=e.element,a=e.data,s=e.internalformat,u=e.format,c=e.type,l=e.width,d=e.height;D(e),o?n.texImage2D(t,r,u,u,c,o):e.compressed?n.compressedTexImage2D(t,r,s,l,d,0,a):e.needsCopy?(i(),n.copyTexImage2D(t,r,u,e.xOffset,e.yOffset,l,d,0)):n.texImage2D(t,r,u,l,d,0,u,c,a||null)}function R(e,t,r,o,a){var s=e.element,u=e.data,c=e.internalformat,l=e.format,d=e.type,f=e.width,h=e.height;D(e),s?n.texSubImage2D(t,a,r,o,l,d,s):e.compressed?n.compressedTexSubImage2D(t,a,r,o,c,f,h,u):e.needsCopy?(i(),n.copyTexSubImage2D(t,a,r,o,e.xOffset,e.yOffset,f,h)):n.texSubImage2D(t,a,r,o,f,h,l,d,u)}var C=[];function L(){return C.pop()||new k}function z(e){e.needsFree&&P.freeType(e.data),k.call(e),C.push(e)}function G(){T.call(this),this.genMipmaps=!1,this.mipmapHint=Ue,this.mipmask=0,this.images=Array(16)}function j(e,t,n){var r=e.images[0]=L();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function F(e,t){var n=null;if(st(t))A(n=e.images[0]=L(),e),M(n,t),e.mipmask=1;else if(N(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,o=0;o<r.length;++o)A(n=e.images[o]=L(),e),n.width>>=o,n.height>>=o,M(n,r[o]),e.mipmask|=1<<o;else A(n=e.images[0]=L(),e),M(n,t),e.mipmask=1;A(e,e.images[0]),!e.compressed||e.internalformat!==De&&e.internalformat!==ke&&e.internalformat!==Me&&e.internalformat!==Oe||_(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function U(e,t){for(var n=e.images,r=0;r<n.length;++r){if(!n[r])return;O(n[r],t,r)}}var B=[];function H(){var e=B.pop()||new G;T.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function q(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&z(t[n]),t[n]=null;B.push(e)}function Y(){this.minFilter=Pe,this.magFilter=Pe,this.wrapS=Ge,this.wrapT=Ge,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ue}function Z(e,t){if("min"in t){var n=t.min;_.parameter(n,f),e.minFilter=f[n],Ve.indexOf(e.minFilter)>=0&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var r=t.mag;_.parameter(r,d),e.magFilter=d[r]}var i=e.wrapS,a=e.wrapT;if("wrap"in t){var s=t.wrap;"string"==typeof s?(_.parameter(s,l),i=a=l[s]):Array.isArray(s)&&(_.parameter(s[0],l),_.parameter(s[1],l),i=l[s[0]],a=l[s[1]])}else{if("wrapS"in t){var u=t.wrapS;_.parameter(u,l),i=l[u]}if("wrapT"in t){var h=t.wrapT;_.parameter(h,l),a=l[h]}}if(e.wrapS=i,e.wrapT=a,"anisotropic"in t){var p=t.anisotropic;_("number"==typeof p&&p>=1&&p<=o.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var g=!1;switch(typeof t.mipmap){case"string":_.parameter(t.mipmap,c,"invalid mipmap hint"),e.mipmapHint=c[t.mipmap],e.genMipmaps=!0,g=!0;break;case"boolean":g=e.genMipmaps=t.mipmap;break;case"object":_(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,g=!0;break;default:_.raise("invalid mipmap type")}g&&!("min"in t)&&(e.minFilter=je)}}function $(e,t){n.texParameteri(t,10241,e.minFilter),n.texParameteri(t,10240,e.magFilter),n.texParameteri(t,10242,e.wrapS),n.texParameteri(t,10243,e.wrapT),r.ext_texture_filter_anisotropic&&n.texParameteri(t,34046,e.anisotropic),e.genMipmaps&&(n.hint(33170,e.mipmapHint),n.generateMipmap(t))}var K=0,Q={},J=o.maxTextureUnits,ee=Array(J).map((function(){return null}));function te(e){T.call(this),this.mipmask=0,this.internalformat=ye,this.id=K++,this.refCount=1,this.target=e,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Y,u.profile&&(this.stats={size:0})}function ne(e){n.activeTexture(Be),n.bindTexture(e.target,e.texture)}function re(){var e=ee[0];e?n.bindTexture(e.target,e.texture):n.bindTexture(ge,null)}function oe(e){var t=e.texture;_(t,"must not double destroy texture");var r=e.unit,o=e.target;r>=0&&(n.activeTexture(Be+r),n.bindTexture(o,null),ee[r]=null),n.deleteTexture(t),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete Q[e.id],s.textureCount--}return t(te.prototype,{bind:function(){var e=this;e.bindCount+=1;var t=e.unit;if(t<0){for(var r=0;r<J;++r){var o=ee[r];if(o){if(o.bindCount>0)continue;o.unit=-1}ee[r]=e,t=r;break}t>=J&&_.raise("insufficient number of texture units"),u.profile&&s.maxTextureUnits<t+1&&(s.maxTextureUnits=t+1),e.unit=t,n.activeTexture(Be+t),n.bindTexture(e.target,e.texture)}return t},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&oe(this)}}),u.profile&&(s.getTotalTextureSize=function(){var e=0;return Object.keys(Q).forEach((function(t){e+=Q[t].stats.size})),e}),{create2D:function(e,t){var r=new te(ge);function i(e,t){var n=r.texInfo;Y.call(n);var a=H();return"number"==typeof e?j(a,0|e,"number"==typeof t?0|t:0|e):e?(_.type(e,"object","invalid arguments to regl.texture"),Z(n,e),F(a,e)):j(a,1,1),n.genMipmaps&&(a.mipmask=(a.width<<1)-1),r.mipmask=a.mipmask,A(r,a),_.texture2D(n,a,o),r.internalformat=a.internalformat,i.width=a.width,i.height=a.height,ne(r),U(a,ge),$(n,ge),re(),q(a),u.profile&&(r.stats.size=dt(r.internalformat,r.type,a.width,a.height,n.genMipmaps,!1)),i.format=b[r.internalformat],i.type=E[r.type],i.mag=w[n.magFilter],i.min=x[n.minFilter],i.wrapS=S[n.wrapS],i.wrapT=S[n.wrapT],i}return Q[r.id]=r,s.textureCount++,i(e,t),i.subimage=function(e,t,n,o){_(!!e,"must specify image data");var a=0|t,s=0|n,u=0|o,c=L();return A(c,r),c.width=0,c.height=0,M(c,e),c.width=c.width||(r.width>>u)-a,c.height=c.height||(r.height>>u)-s,_(r.type===c.type&&r.format===c.format&&r.internalformat===c.internalformat,"incompatible format for texture.subimage"),_(a>=0&&s>=0&&a+c.width<=r.width&&s+c.height<=r.height,"texture.subimage write out of bounds"),_(r.mipmask&1<<u,"missing mipmap data"),_(c.data||c.element||c.needsCopy,"missing image data"),ne(r),R(c,ge,a,s,u),re(),z(c),i},i.resize=function(e,t){var o=0|e,a=0|t||o;if(o===r.width&&a===r.height)return i;i.width=r.width=o,i.height=r.height=a,ne(r);for(var s=0;r.mipmask>>s;++s){var c=o>>s,l=a>>s;if(!c||!l)break;n.texImage2D(ge,s,r.format,c,l,0,r.format,r.type,null)}return re(),u.profile&&(r.stats.size=dt(r.internalformat,r.type,o,a,!1,!1)),i},i._reglType="texture2d",i._texture=r,u.profile&&(i.stats=r.stats),i.destroy=function(){r.decRef()},i},createCube:function(e,t,r,i,a,c){var l=new te(me);Q[l.id]=l,s.cubeCount++;var d=new Array(6);function f(e,t,n,r,i,a){var s,c=l.texInfo;for(Y.call(c),s=0;s<6;++s)d[s]=H();if("number"!=typeof e&&e)if("object"==typeof e)if(t)F(d[0],e),F(d[1],t),F(d[2],n),F(d[3],r),F(d[4],i),F(d[5],a);else if(Z(c,e),N(l,e),"faces"in e){var h=e.faces;for(_(Array.isArray(h)&&6===h.length,"cube faces must be a length 6 array"),s=0;s<6;++s)_("object"==typeof h[s]&&!!h[s],"invalid input for cube map face"),A(d[s],l),F(d[s],h[s])}else for(s=0;s<6;++s)F(d[s],e);else _.raise("invalid arguments to cube map");else{var p=0|e||1;for(s=0;s<6;++s)j(d[s],p,p)}for(A(l,d[0]),o.npotTextureCube||_(pe(l.width)&&pe(l.height),"your browser does not support non power or two texture dimensions"),c.genMipmaps?l.mipmask=(d[0].width<<1)-1:l.mipmask=d[0].mipmask,_.textureCube(l,c,d,o),l.internalformat=d[0].internalformat,f.width=d[0].width,f.height=d[0].height,ne(l),s=0;s<6;++s)U(d[s],ve+s);for($(c,me),re(),u.profile&&(l.stats.size=dt(l.internalformat,l.type,f.width,f.height,c.genMipmaps,!0)),f.format=b[l.internalformat],f.type=E[l.type],f.mag=w[c.magFilter],f.min=x[c.minFilter],f.wrapS=S[c.wrapS],f.wrapT=S[c.wrapT],s=0;s<6;++s)q(d[s]);return f}return f(e,t,r,i,a,c),f.subimage=function(e,t,n,r,o){_(!!t,"must specify image data"),_("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var i=0|n,a=0|r,s=0|o,u=L();return A(u,l),u.width=0,u.height=0,M(u,t),u.width=u.width||(l.width>>s)-i,u.height=u.height||(l.height>>s)-a,_(l.type===u.type&&l.format===u.format&&l.internalformat===u.internalformat,"incompatible format for texture.subimage"),_(i>=0&&a>=0&&i+u.width<=l.width&&a+u.height<=l.height,"texture.subimage write out of bounds"),_(l.mipmask&1<<s,"missing mipmap data"),_(u.data||u.element||u.needsCopy,"missing image data"),ne(l),R(u,ve+e,i,a,s),re(),z(u),f},f.resize=function(e){var t=0|e;if(t!==l.width){f.width=l.width=t,f.height=l.height=t,ne(l);for(var r=0;r<6;++r)for(var o=0;l.mipmask>>o;++o)n.texImage2D(ve+r,o,l.format,t>>o,t>>o,0,l.format,l.type,null);return re(),u.profile&&(l.stats.size=dt(l.internalformat,l.type,f.width,f.height,!1,!0)),f}},f._reglType="textureCube",f._texture=l,u.profile&&(f.stats=l.stats),f.destroy=function(){l.decRef()},f},clear:function(){for(var e=0;e<J;++e)n.activeTexture(Be+e),n.bindTexture(ge,null),ee[e]=null;W(Q).forEach(oe),s.cubeCount=0,s.textureCount=0},getTexture:function(e){return null},restore:function(){for(var e=0;e<J;++e){var t=ee[e];t&&(t.bindCount=0,t.unit=-1,ee[e]=null)}W(Q).forEach((function(e){e.texture=n.createTexture(),n.bindTexture(e.target,e.texture);for(var t=0;t<32;++t)if(0!=(e.mipmask&1<<t))if(e.target===ge)n.texImage2D(ge,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var r=0;r<6;++r)n.texImage2D(ve+r,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);$(e.texInfo,e.target)}))},refresh:function(){for(var e=0;e<J;++e){var t=ee[e];t&&(t.bindCount=0,t.unit=-1,ee[e]=null),n.activeTexture(Be+e),n.bindTexture(ge,null),n.bindTexture(me,null)}}}}tt[32854]=2,tt[32855]=2,tt[36194]=2,tt[34041]=4,tt[33776]=.5,tt[33777]=.5,tt[33778]=1,tt[33779]=1,tt[35986]=.5,tt[35987]=1,tt[34798]=1,tt[35840]=.5,tt[35841]=.25,tt[35842]=.5,tt[35843]=.25,tt[36196]=.5;var ht=36161,pt=32854,gt=[];function mt(e,t,n){return gt[e]*t*n}gt[32854]=2,gt[32855]=2,gt[36194]=2,gt[33189]=2,gt[36168]=1,gt[34041]=4,gt[35907]=4,gt[34836]=16,gt[34842]=8,gt[34843]=6;var vt=36160,yt=36161,bt=3553,Et=34069,wt=[6407,6408],xt=[];xt[6408]=4,xt[6407]=3;var _t=[];_t[5121]=1,_t[5126]=4,_t[36193]=2;var St=[32854,32855,36194,35907,34842,34843,34836],It={};It[36053]="complete",It[36054]="incomplete attachment",It[36057]="incomplete dimensions",It[36055]="incomplete, missing attachment",It[36061]="unsupported";function Tt(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}var At=5121,Nt=5126;function Dt(t,n,r,o,i,a,s){function u(u){var c;null===n.next?(_(i.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),c=At):(_(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),c=n.next.colorAttachments[0].texture._texture.type,a.oes_texture_float?(_(c===At||c===Nt,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),c===Nt&&_(s.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):_(c===At,"Reading from a framebuffer is only allowed for the type 'uint8'"));var l=0,d=0,f=o.framebufferWidth,h=o.framebufferHeight,p=null;e(u)?p=u:u&&(_.type(u,"object","invalid arguments to regl.read()"),l=0|u.x,d=0|u.y,_(l>=0&&l<o.framebufferWidth,"invalid x offset for regl.read"),_(d>=0&&d<o.framebufferHeight,"invalid y offset for regl.read"),f=0|(u.width||o.framebufferWidth-l),h=0|(u.height||o.framebufferHeight-d),p=u.data||null),p&&(c===At?_(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):c===Nt&&_(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),_(f>0&&f+l<=o.framebufferWidth,"invalid width for read pixels"),_(h>0&&h+d<=o.framebufferHeight,"invalid height for read pixels"),r();var g=f*h*4;return p||(c===At?p=new Uint8Array(g):c===Nt&&(p=p||new Float32Array(g))),_.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),_(p.byteLength>=g,"data buffer for regl.read() too small"),t.pixelStorei(3333,4),t.readPixels(l,d,f,h,6408,c,p),p}return function(e){return e&&"framebuffer"in e?function(e){var t;return n.setFBO({framebuffer:e.framebuffer},(function(){t=u(e)})),t}(e):u(e)}}function kt(e){return Array.prototype.slice.call(e)}function Mt(e){return kt(e).join("")}var Ot="xyzw".split(""),Rt="dither",Ct="blend.enable",Lt="blend.color",zt="blend.equation",Gt="blend.func",Pt="depth.enable",jt="depth.func",Ft="depth.range",Ut="depth.mask",Bt="colorMask",Vt="cull.enable",Wt="cull.face",Xt="frontFace",Ht="lineWidth",qt="polygonOffset.enable",Yt="polygonOffset.offset",Zt="sample.alpha",$t="sample.enable",Kt="sample.coverage",Qt="stencil.enable",Jt="stencil.mask",en="stencil.func",tn="stencil.opFront",nn="stencil.opBack",rn="scissor.enable",on="scissor.box",an="viewport",sn="profile",un="framebuffer",cn="vert",ln="frag",dn="elements",fn="primitive",hn="count",pn="offset",gn="instances",mn="vao",vn="Width",yn="Height",bn=un+vn,En=un+yn,wn=an+vn,xn=an+yn,_n="drawingBuffer",Sn=_n+vn,In=_n+yn,Tn=[Gt,zt,en,tn,nn,Kt,an,on,Yt],An=34962,Nn=5126,Dn=35664,kn=35665,Mn=35666,On=5124,Rn=35667,Cn=35668,Ln=35669,zn=35670,Gn=35671,Pn=35672,jn=35673,Fn=35674,Un=35675,Bn=35676,Vn=35678,Wn=35680,Xn=1028,Hn=1029,qn=2305,Yn=7680,Zn={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},$n=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Kn={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Qn={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Jn={frag:35632,vert:35633},er={cw:2304,ccw:qn};function tr(t){return Array.isArray(t)||e(t)||V(t)}function nr(e){return e.sort((function(e,t){return e===an?-1:t===an?1:e<t?-1:1}))}function rr(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function or(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function ir(e){return new rr(!1,!1,!1,e)}function ar(e,t){var n=e.type;if(0===n){var r=e.data.length;return new rr(!0,r>=1,r>=2,t)}if(4===n){var o=e.data;return new rr(o.thisDep,o.contextDep,o.propDep,t)}if(5===n)return new rr(!1,!1,!1,t);if(6===n){for(var i=!1,a=!1,s=!1,u=0;u<e.data.length;++u){var c=e.data[u];if(1===c.type)s=!0;else if(2===c.type)a=!0;else if(3===c.type)i=!0;else if(0===c.type){i=!0;var l=c.data;l>=1&&(a=!0),l>=2&&(s=!0)}else 4===c.type&&(i=i||c.data.thisDep,a=a||c.data.contextDep,s=s||c.data.propDep)}return new rr(i,a,s,t)}return new rr(3===n,2===n,1===n,t)}var sr=new rr(!1,!1,!1,(function(){}));function ur(e,n,r,o,i,a,s,u,c,l,d,f,h,p,g){var m=l.Record,v={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(v.min=32775,v.max=32776);var y=r.angle_instanced_arrays,b=r.webgl_draw_buffers,E={dirty:!0,profile:g.profile},w={},x=[],S={},I={};function T(e){return e.replace(".","_")}function A(e,t,n){var r=T(e);x.push(e),w[r]=E[r]=!!n,S[r]=t}function N(e,t,n){var r=T(e);x.push(e),Array.isArray(n)?(E[r]=n.slice(),w[r]=n.slice()):E[r]=w[r]=n,I[r]=t}A(Rt,3024),A(Ct,3042),N(Lt,"blendColor",[0,0,0,0]),N(zt,"blendEquationSeparate",[32774,32774]),N(Gt,"blendFuncSeparate",[1,0,1,0]),A(Pt,2929,!0),N(jt,"depthFunc",513),N(Ft,"depthRange",[0,1]),N(Ut,"depthMask",!0),N(Bt,Bt,[!0,!0,!0,!0]),A(Vt,2884),N(Wt,"cullFace",Hn),N(Xt,Xt,qn),N(Ht,Ht,1),A(qt,32823),N(Yt,"polygonOffset",[0,0]),A(Zt,32926),A($t,32928),N(Kt,"sampleCoverage",[1,!1]),A(Qt,2960),N(Jt,"stencilMask",-1),N(en,"stencilFunc",[519,0,-1]),N(tn,"stencilOpSeparate",[Xn,Yn,Yn,Yn]),N(nn,"stencilOpSeparate",[Hn,Yn,Yn,Yn]),A(rn,3089),N(on,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),N(an,an,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var k={gl:e,context:h,strings:n,next:w,current:E,draw:f,elements:a,buffer:i,shader:d,attributes:l.state,vao:l,uniforms:c,framebuffer:u,extensions:r,timer:p,isBufferArgs:tr},M={primTypes:ie,compareFuncs:Kn,blendFuncs:Zn,blendEquations:v,stencilOps:Qn,glTypes:Z,orientationType:er};_.optional((function(){k.isArrayLike=he})),b&&(M.backBuffer=[Hn],M.drawBuffer=L(o.maxDrawbuffers,(function(e){return 0===e?[0]:L(e,(function(e){return 36064+e}))})));var O=0;function R(){var e=function(){var e=0,n=[],r=[];function o(){var n=[],r=[];return t((function(){n.push.apply(n,kt(arguments))}),{def:function(){var t="v"+e++;return r.push(t),arguments.length>0&&(n.push(t,"="),n.push.apply(n,kt(arguments)),n.push(";")),t},toString:function(){return Mt([r.length>0?"var "+r.join(",")+";":"",Mt(n)])}})}function i(){var e=o(),n=o(),r=e.toString,i=n.toString;function a(t,r){n(t,r,"=",e.def(t,r),";")}return t((function(){e.apply(e,kt(arguments))}),{def:e.def,entry:e,exit:n,save:a,set:function(t,n,r){a(t,n),e(t,n,"=",r,";")},toString:function(){return r()+i()}})}var a=o(),s={};return{global:a,link:function(t){for(var o=0;o<r.length;++o)if(r[o]===t)return n[o];var i="g"+e++;return n.push(i),r.push(t),i},block:o,proc:function(e,n){var r=[];function o(){var e="a"+r.length;return r.push(e),e}n=n||0;for(var a=0;a<n;++a)o();var u=i(),c=u.toString;return s[e]=t(u,{arg:o,toString:function(){return Mt(["function(",r.join(),"){",c(),"}"])}})},scope:i,cond:function(){var e=Mt(arguments),n=i(),r=i(),o=n.toString,a=r.toString;return t(n,{then:function(){return n.apply(n,kt(arguments)),this},else:function(){return r.apply(r,kt(arguments)),this},toString:function(){var t=a();return t&&(t="else{"+t+"}"),Mt(["if(",e,"){",o(),"}",t])}})},compile:function(){var e=['"use strict";',a,"return {"];Object.keys(s).forEach((function(t){e.push('"',t,'":',s[t].toString(),",")})),e.push("}");var t=Mt(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(t)).apply(null,r)}}}(),r=e.link,o=e.global;e.id=O++,e.batchId="0";var i=r(k),a=e.shared={props:"a0"};Object.keys(k).forEach((function(e){a[e]=o.def(i,".",e)})),_.optional((function(){e.CHECK=r(_),e.commandStr=_.guessCommand(),e.command=r(e.commandStr),e.assert=function(e,t,n){e("if(!(",t,"))",this.CHECK,".commandRaise(",r(n),",",this.command,");")},M.invalidBlendCombinations=$n}));var s=e.next={},u=e.current={};Object.keys(I).forEach((function(e){Array.isArray(E[e])&&(s[e]=o.def(a.next,".",e),u[e]=o.def(a.current,".",e))}));var c=e.constants={};Object.keys(M).forEach((function(e){c[e]=o.def(JSON.stringify(M[e]))})),e.invoke=function(t,n){switch(n.type){case 0:var o=["this",a.context,a.props,e.batchId];return t.def(r(n.data),".call(",o.slice(0,Math.max(n.data.length+1,4)),")");case 1:return t.def(a.props,n.data);case 2:return t.def(a.context,n.data);case 3:return t.def("this",n.data);case 4:return n.data.append(e,t),n.data.ref;case 5:return n.data.toString();case 6:return n.data.map((function(n){return e.invoke(t,n)}))}},e.attribCache={};var d={};return e.scopeAttrib=function(e){var t=n.id(e);if(t in d)return d[t];var o=l.scope[t];return o||(o=l.scope[t]=new m),d[t]=r(o)},e}function C(e,t,s,c,f){var h=e.static,p=e.dynamic;_.optional((function(){var e=[un,cn,ln,dn,fn,pn,hn,gn,sn,mn].concat(x);function t(t){Object.keys(t).forEach((function(t){_.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',f.commandStr)}))}t(h),t(p)}));var g=function(e,t){var n=e.static;if("string"==typeof n[ln]&&"string"==typeof n[cn]){if(Object.keys(t.dynamic).length>0)return null;var r=t.static,o=Object.keys(r);if(o.length>0&&"number"==typeof r[o[0]]){for(var i=[],a=0;a<o.length;++a)_("number"==typeof r[o[a]],"must specify all vertex attribute locations when using vaos"),i.push([0|r[o[a]],o[a]]);return i}}return null}(e,t),b=function(e,t){var n=e.static,r=e.dynamic;if(un in n){var o=n[un];return o?(o=u.getFramebuffer(o),_.command(o,"invalid framebuffer object"),ir((function(e,t){var n=e.link(o),r=e.shared;t.set(r.framebuffer,".next",n);var i=r.context;return t.set(i,"."+bn,n+".width"),t.set(i,"."+En,n+".height"),n}))):ir((function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var r=n.context;return t.set(r,"."+bn,r+"."+Sn),t.set(r,"."+En,r+"."+In),"null"}))}if(un in r){var i=r[un];return ar(i,(function(e,t){var n=e.invoke(t,i),r=e.shared,o=r.framebuffer,a=t.def(o,".getFramebuffer(",n,")");_.optional((function(){e.assert(t,"!"+n+"||"+a,"invalid framebuffer object")})),t.set(o,".next",a);var s=r.context;return t.set(s,"."+bn,a+"?"+a+".width:"+s+"."+Sn),t.set(s,"."+En,a+"?"+a+".height:"+s+"."+In),a}))}return null}(e),E=function(e,t,n){var r=e.static,o=e.dynamic;function i(e){if(e in r){var i=r[e];_.commandType(i,"object","invalid "+e,n.commandStr);var a,s,u=!0,c=0|i.x,l=0|i.y;return"width"in i?(a=0|i.width,_.command(a>=0,"invalid "+e,n.commandStr)):u=!1,"height"in i?(s=0|i.height,_.command(s>=0,"invalid "+e,n.commandStr)):u=!1,new rr(!u&&t&&t.thisDep,!u&&t&&t.contextDep,!u&&t&&t.propDep,(function(e,t){var n=e.shared.context,r=a;"width"in i||(r=t.def(n,".",bn,"-",c));var o=s;return"height"in i||(o=t.def(n,".",En,"-",l)),[c,l,r,o]}))}if(e in o){var d=o[e],f=ar(d,(function(t,n){var r=t.invoke(n,d);_.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}));var o=t.shared.context,i=n.def(r,".x|0"),a=n.def(r,".y|0"),s=n.def('"width" in ',r,"?",r,".width|0:","(",o,".",bn,"-",i,")"),u=n.def('"height" in ',r,"?",r,".height|0:","(",o,".",En,"-",a,")");return _.optional((function(){t.assert(n,s+">=0&&"+u+">=0","invalid "+e)})),[i,a,s,u]}));return t&&(f.thisDep=f.thisDep||t.thisDep,f.contextDep=f.contextDep||t.contextDep,f.propDep=f.propDep||t.propDep),f}return t?new rr(t.thisDep,t.contextDep,t.propDep,(function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",bn),t.def(n,".",En)]})):null}var a=i(an);if(a){var s=a;a=new rr(a.thisDep,a.contextDep,a.propDep,(function(e,t){var n=s.append(e,t),r=e.shared.context;return t.set(r,"."+wn,n[2]),t.set(r,"."+xn,n[3]),n}))}return{viewport:a,scissor_box:i(on)}}(e,b,f),w=function(e,t){var n=e.static,r=e.dynamic,o=function(){if(dn in n){var e=n[dn];tr(e)?e=a.getElements(a.create(e,!0)):e&&(e=a.getElements(e),_.command(e,"invalid elements",t.commandStr));var o=ir((function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r,r}return t.ELEMENTS=null,null}));return o.value=e,o}if(dn in r){var i=r[dn];return ar(i,(function(e,t){var n=e.shared,r=n.isBufferArgs,o=n.elements,a=e.invoke(t,i),s=t.def("null"),u=t.def(r,"(",a,")"),c=e.cond(u).then(s,"=",o,".createStream(",a,");").else(s,"=",o,".getElements(",a,");");return _.optional((function(){e.assert(c.else,"!"+a+"||"+s,"invalid elements")})),t.entry(c),t.exit(e.cond(u).then(o,".destroyStream(",s,");")),e.ELEMENTS=s,s}))}return null}();function i(e,i){if(e in n){var a=0|n[e];return _.command(!i||a>=0,"invalid "+e,t.commandStr),ir((function(e,t){return i&&(e.OFFSET=a),a}))}if(e in r){var s=r[e];return ar(s,(function(t,n){var r=t.invoke(n,s);return i&&(t.OFFSET=r,_.optional((function(){t.assert(n,r+">=0","invalid "+e)}))),r}))}return i&&o?ir((function(e,t){return e.OFFSET="0",0})):null}var s=i(pn,!0);return{elements:o,primitive:function(){if(fn in n){var e=n[fn];return _.commandParameter(e,ie,"invalid primitve",t.commandStr),ir((function(t,n){return ie[e]}))}if(fn in r){var i=r[fn];return ar(i,(function(e,t){var n=e.constants.primTypes,r=e.invoke(t,i);return _.optional((function(){e.assert(t,r+" in "+n,"invalid primitive, must be one of "+Object.keys(ie))})),t.def(n,"[",r,"]")}))}return o?or(o)?o.value?ir((function(e,t){return t.def(e.ELEMENTS,".primType")})):ir((function(){return 4})):new rr(o.thisDep,o.contextDep,o.propDep,(function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",4)})):null}(),count:function(){if(hn in n){var e=0|n[hn];return _.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),ir((function(){return e}))}if(hn in r){var i=r[hn];return ar(i,(function(e,t){var n=e.invoke(t,i);return _.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(o){if(or(o)){if(o)return s?new rr(s.thisDep,s.contextDep,s.propDep,(function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return _.optional((function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")})),n})):ir((function(e,t){return t.def(e.ELEMENTS,".vertCount")}));var a=ir((function(){return-1}));return _.optional((function(){a.MISSING=!0})),a}var u=new rr(o.thisDep||s.thisDep,o.contextDep||s.contextDep,o.propDep||s.propDep,(function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}));return _.optional((function(){u.DYNAMIC=!0})),u}return null}(),instances:i(gn,!1),offset:s}}(e,f),S=function(e,t){var n=e.static,r=e.dynamic,i={};return x.forEach((function(e){var a=T(e);function s(t,o){if(e in n){var s=t(n[e]);i[a]=ir((function(){return s}))}else if(e in r){var u=r[e];i[a]=ar(u,(function(e,t){return o(e,t,e.invoke(t,u))}))}}switch(e){case Vt:case Ct:case Rt:case Qt:case Pt:case rn:case qt:case Zt:case $t:case Ut:return s((function(n){return _.commandType(n,"boolean",e,t.commandStr),n}),(function(t,n,r){return _.optional((function(){t.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+e,t.commandStr)})),r}));case jt:return s((function(n){return _.commandParameter(n,Kn,"invalid "+e,t.commandStr),Kn[n]}),(function(t,n,r){var o=t.constants.compareFuncs;return _.optional((function(){t.assert(n,r+" in "+o,"invalid "+e+", must be one of "+Object.keys(Kn))})),n.def(o,"[",r,"]")}));case Ft:return s((function(e){return _.command(he(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e}),(function(e,t,n){return _.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[t.def("+",n,"[0]"),t.def("+",n,"[1]")]}));case Gt:return s((function(e){_.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,o="dstRGB"in e?e.dstRGB:e.dst,i="dstAlpha"in e?e.dstAlpha:e.dst;return _.commandParameter(n,Zn,a+".srcRGB",t.commandStr),_.commandParameter(r,Zn,a+".srcAlpha",t.commandStr),_.commandParameter(o,Zn,a+".dstRGB",t.commandStr),_.commandParameter(i,Zn,a+".dstAlpha",t.commandStr),_.command(-1===$n.indexOf(n+", "+o),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+o+")",t.commandStr),[Zn[n],Zn[o],Zn[r],Zn[i]]}),(function(t,n,r){var o=t.constants.blendFuncs;function i(i,a){var s=n.def('"',i,a,'" in ',r,"?",r,".",i,a,":",r,".",i);return _.optional((function(){t.assert(n,s+" in "+o,"invalid "+e+"."+i+a+", must be one of "+Object.keys(Zn))})),s}_.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")}));var a=i("src","RGB"),s=i("dst","RGB");_.optional((function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var u=n.def(o,"[",a,"]"),c=n.def(o,"[",i("src","Alpha"),"]");return[u,n.def(o,"[",s,"]"),c,n.def(o,"[",i("dst","Alpha"),"]")]}));case zt:return s((function(n){return"string"==typeof n?(_.commandParameter(n,v,"invalid "+e,t.commandStr),[v[n],v[n]]):"object"==typeof n?(_.commandParameter(n.rgb,v,e+".rgb",t.commandStr),_.commandParameter(n.alpha,v,e+".alpha",t.commandStr),[v[n.rgb],v[n.alpha]]):void _.commandRaise("invalid blend.equation",t.commandStr)}),(function(t,n,r){var o=t.constants.blendEquations,i=n.def(),a=n.def(),s=t.cond("typeof ",r,'==="string"');return _.optional((function(){function n(e,n,r){t.assert(e,r+" in "+o,"invalid "+n+", must be one of "+Object.keys(v))}n(s.then,e,r),t.assert(s.else,r+"&&typeof "+r+'==="object"',"invalid "+e),n(s.else,e+".rgb",r+".rgb"),n(s.else,e+".alpha",r+".alpha")})),s.then(i,"=",a,"=",o,"[",r,"];"),s.else(i,"=",o,"[",r,".rgb];",a,"=",o,"[",r,".alpha];"),n(s),[i,a]}));case Lt:return s((function(e){return _.command(he(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),L(4,(function(t){return+e[t]}))}),(function(e,t,n){return _.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),L(4,(function(e){return t.def("+",n,"[",e,"]")}))}));case Jt:return s((function(e){return _.commandType(e,"number",a,t.commandStr),0|e}),(function(e,t,n){return _.optional((function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")})),t.def(n,"|0")}));case en:return s((function(n){_.commandType(n,"object",a,t.commandStr);var r=n.cmp||"keep",o=n.ref||0,i="mask"in n?n.mask:-1;return _.commandParameter(r,Kn,e+".cmp",t.commandStr),_.commandType(o,"number",e+".ref",t.commandStr),_.commandType(i,"number",e+".mask",t.commandStr),[Kn[r],o,i]}),(function(e,t,n){var r=e.constants.compareFuncs;return _.optional((function(){function o(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}o(n+"&&typeof ",n,'==="object"'),o('!("cmp" in ',n,")||(",n,".cmp in ",r,")")})),[t.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",Yn),t.def(n,".ref|0"),t.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case tn:case nn:return s((function(n){_.commandType(n,"object",a,t.commandStr);var r=n.fail||"keep",o=n.zfail||"keep",i=n.zpass||"keep";return _.commandParameter(r,Qn,e+".fail",t.commandStr),_.commandParameter(o,Qn,e+".zfail",t.commandStr),_.commandParameter(i,Qn,e+".zpass",t.commandStr),[e===nn?Hn:Xn,Qn[r],Qn[o],Qn[i]]}),(function(t,n,r){var o=t.constants.stencilOps;function i(i){return _.optional((function(){t.assert(n,'!("'+i+'" in '+r+")||("+r+"."+i+" in "+o+")","invalid "+e+"."+i+", must be one of "+Object.keys(Qn))})),n.def('"',i,'" in ',r,"?",o,"[",r,".",i,"]:",Yn)}return _.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)})),[e===nn?Hn:Xn,i("fail"),i("zfail"),i("zpass")]}));case Yt:return s((function(e){_.commandType(e,"object",a,t.commandStr);var n=0|e.factor,r=0|e.units;return _.commandType(n,"number",a+".factor",t.commandStr),_.commandType(r,"number",a+".units",t.commandStr),[n,r]}),(function(t,n,r){return _.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)})),[n.def(r,".factor|0"),n.def(r,".units|0")]}));case Wt:return s((function(e){var n=0;return"front"===e?n=Xn:"back"===e&&(n=Hn),_.command(!!n,a,t.commandStr),n}),(function(e,t,n){return _.optional((function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),t.def(n,'==="front"?',Xn,":",Hn)}));case Ht:return s((function(e){return _.command("number"==typeof e&&e>=o.lineWidthDims[0]&&e<=o.lineWidthDims[1],"invalid line width, must be a positive number between "+o.lineWidthDims[0]+" and "+o.lineWidthDims[1],t.commandStr),e}),(function(e,t,n){return _.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+o.lineWidthDims[0]+"&&"+n+"<="+o.lineWidthDims[1],"invalid line width")})),n}));case Xt:return s((function(e){return _.commandParameter(e,er,a,t.commandStr),er[e]}),(function(e,t,n){return _.optional((function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),t.def(n+'==="cw"?2304:'+qn)}));case Bt:return s((function(e){return _.command(he(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map((function(e){return!!e}))}),(function(e,t,n){return _.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),L(4,(function(e){return"!!"+n+"["+e+"]"}))}));case Kt:return s((function(e){_.command("object"==typeof e&&e,a,t.commandStr);var n="value"in e?e.value:1,r=!!e.invert;return _.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,r]}),(function(e,t,n){return _.optional((function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[t.def('"value" in ',n,"?+",n,".value:1"),t.def("!!",n,".invert")]}))}})),i}(e,f),I=function(e,t,r){var o=e.static,i=e.dynamic;function a(e){if(e in o){var t=n.id(o[e]);_.optional((function(){d.shader(Jn[e],t,_.guessCommand())}));var r=ir((function(){return t}));return r.id=t,r}if(e in i){var a=i[e];return ar(a,(function(t,n){var r=t.invoke(n,a),o=n.def(t.shared.strings,".id(",r,")");return _.optional((function(){n(t.shared.shader,".shader(",Jn[e],",",o,",",t.command,");")})),o}))}return null}var s,u=a(ln),c=a(cn),l=null;return or(u)&&or(c)?(l=d.program(c.id,u.id,null,r),s=ir((function(e,t){return e.link(l)}))):s=new rr(u&&u.thisDep||c&&c.thisDep,u&&u.contextDep||c&&c.contextDep,u&&u.propDep||c&&c.propDep,(function(e,t){var n,r=e.shared.shader;n=u?u.append(e,t):t.def(r,".",ln);var o=r+".program("+(c?c.append(e,t):t.def(r,".",cn))+","+n;return _.optional((function(){o+=","+e.command})),t.def(o+")")})),{frag:u,vert:c,progVar:s,program:l}}(e,0,g);function A(e){var t=E[e];t&&(S[e]=t)}A(an),A(T(on));var N=Object.keys(S).length>0,D={framebuffer:b,draw:w,shader:I,state:S,dirty:N,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(D.profile=function(e){var t,n=e.static,r=e.dynamic;if(sn in n){var o=!!n[sn];(t=ir((function(e,t){return o}))).enable=o}else if(sn in r){var i=r[sn];t=ar(i,(function(e,t){return e.invoke(t,i)}))}return t}(e),D.uniforms=function(e,t){var n=e.static,r=e.dynamic,o={};return Object.keys(n).forEach((function(e){var r,i=n[e];if("number"==typeof i||"boolean"==typeof i)r=ir((function(){return i}));else if("function"==typeof i){var a=i._reglType;"texture2d"===a||"textureCube"===a?r=ir((function(e){return e.link(i)})):"framebuffer"===a||"framebufferCube"===a?(_.command(i.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),r=ir((function(e){return e.link(i.color[0])}))):_.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else he(i)?r=ir((function(t){return t.global.def("[",L(i.length,(function(n){return _.command("number"==typeof i[n]||"boolean"==typeof i[n],"invalid uniform "+e,t.commandStr),i[n]})),"]")})):_.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);r.value=i,o[e]=r})),Object.keys(r).forEach((function(e){var t=r[e];o[e]=ar(t,(function(e,n){return e.invoke(n,t)}))})),o}(s,f),D.drawVAO=D.scopeVAO=function(e,t){var n=e.static,r=e.dynamic;if(mn in n){var o=n[mn];return null!==o&&null===l.getVAO(o)&&(o=l.createVAO(o)),ir((function(e){return e.link(l.getVAO(o))}))}if(mn in r){var i=r[mn];return ar(i,(function(e,t){var n=e.invoke(t,i);return t.def(e.shared.vao+".getVAO("+n+")")}))}return null}(e),!D.drawVAO&&I.program&&!g&&r.angle_instanced_arrays){var k=!0,M=I.program.attributes.map((function(e){var n=t.static[e];return k=k&&!!n,n}));if(k&&M.length>0){var O=l.getVAO(l.createVAO(M));D.drawVAO=new rr(null,null,null,(function(e,t){return e.link(O)})),D.useVAO=!0}}return g?D.useVAO=!0:D.attributes=function(e,t){var r=e.static,o=e.dynamic,a={};return Object.keys(r).forEach((function(e){var o=r[e],s=n.id(e),u=new m;if(tr(o))u.state=1,u.buffer=i.getBuffer(i.create(o,An,!1,!0)),u.type=0;else{var c=i.getBuffer(o);if(c)u.state=1,u.buffer=c,u.type=0;else if(_.command("object"==typeof o&&o,"invalid data for attribute "+e,t.commandStr),"constant"in o){var l=o.constant;u.buffer="null",u.state=2,"number"==typeof l?u.x=l:(_.command(he(l)&&l.length>0&&l.length<=4,"invalid constant for attribute "+e,t.commandStr),Ot.forEach((function(e,t){t<l.length&&(u[e]=l[t])})))}else{c=tr(o.buffer)?i.getBuffer(i.create(o.buffer,An,!1,!0)):i.getBuffer(o.buffer),_.command(!!c,'missing buffer for attribute "'+e+'"',t.commandStr);var d=0|o.offset;_.command(d>=0,'invalid offset for attribute "'+e+'"',t.commandStr);var f=0|o.stride;_.command(f>=0&&f<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',t.commandStr);var h=0|o.size;_.command(!("size"in o)||h>0&&h<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',t.commandStr);var p=!!o.normalized,g=0;"type"in o&&(_.commandParameter(o.type,Z,"invalid type for attribute "+e,t.commandStr),g=Z[o.type]);var v=0|o.divisor;"divisor"in o&&(_.command(0===v||y,'cannot specify divisor for attribute "'+e+'", instancing not supported',t.commandStr),_.command(v>=0,'invalid divisor for attribute "'+e+'"',t.commandStr)),_.optional((function(){var n=t.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(o).forEach((function(t){_.command(r.indexOf(t)>=0,'unknown parameter "'+t+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",n)}))})),u.buffer=c,u.state=1,u.size=h,u.normalized=p,u.type=g||c.dtype,u.offset=d,u.stride=f,u.divisor=v}}a[e]=ir((function(e,t){var n=e.attribCache;if(s in n)return n[s];var r={isStream:!1};return Object.keys(u).forEach((function(e){r[e]=u[e]})),u.buffer&&(r.buffer=e.link(u.buffer),r.type=r.type||r.buffer+".dtype"),n[s]=r,r}))})),Object.keys(o).forEach((function(e){var t=o[e];a[e]=ar(t,(function(n,r){var o=n.invoke(r,t),i=n.shared,a=n.constants,s=i.isBufferArgs,u=i.buffer;_.optional((function(){n.assert(r,o+"&&(typeof "+o+'==="object"||typeof '+o+'==="function")&&('+s+"("+o+")||"+u+".getBuffer("+o+")||"+u+".getBuffer("+o+".buffer)||"+s+"("+o+'.buffer)||("constant" in '+o+"&&(typeof "+o+'.constant==="number"||'+i.isArrayLike+"("+o+".constant))))",'invalid dynamic attribute "'+e+'"')}));var c={isStream:r.def(!1)},l=new m;l.state=1,Object.keys(l).forEach((function(e){c[e]=r.def(""+l[e])}));var d=c.buffer,f=c.type;function h(e){r(c[e],"=",o,".",e,"|0;")}return r("if(",s,"(",o,")){",c.isStream,"=true;",d,"=",u,".createStream(",An,",",o,");",f,"=",d,".dtype;","}else{",d,"=",u,".getBuffer(",o,");","if(",d,"){",f,"=",d,".dtype;",'}else if("constant" in ',o,"){",c.state,"=",2,";","if(typeof "+o+'.constant === "number"){',c[Ot[0]],"=",o,".constant;",Ot.slice(1).map((function(e){return c[e]})).join("="),"=0;","}else{",Ot.map((function(e,t){return c[e]+"="+o+".constant.length>"+t+"?"+o+".constant["+t+"]:0;"})).join(""),"}}else{","if(",s,"(",o,".buffer)){",d,"=",u,".createStream(",An,",",o,".buffer);","}else{",d,"=",u,".getBuffer(",o,".buffer);","}",f,'="type" in ',o,"?",a.glTypes,"[",o,".type]:",d,".dtype;",c.normalized,"=!!",o,".normalized;"),h("size"),h("offset"),h("stride"),h("divisor"),r("}}"),r.exit("if(",c.isStream,"){",u,".destroyStream(",d,");","}"),c}))})),a}(t,f),D.context=function(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach((function(e){var n=t[e];r[e]=ir((function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)}))})),Object.keys(n).forEach((function(e){var t=n[e];r[e]=ar(t,(function(e,n){return e.invoke(n,t)}))})),r}(c),D}function z(e,t,n){var r=e.shared.context,o=e.scope();Object.keys(n).forEach((function(i){t.save(r,"."+i);var a=n[i].append(e,t);Array.isArray(a)?o(r,".",i,"=[",a.join(),"];"):o(r,".",i,"=",a,";")})),t(o)}function G(e,t,n,r){var o,i=e.shared,a=i.gl,s=i.framebuffer;b&&(o=t.def(i.extensions,".webgl_draw_buffers"));var u,c=e.constants,l=c.drawBuffer,d=c.backBuffer;u=n?n.append(e,t):t.def(s,".next"),r||t("if(",u,"!==",s,".cur){"),t("if(",u,"){",a,".bindFramebuffer(",36160,",",u,".framebuffer);"),b&&t(o,".drawBuffersWEBGL(",l,"[",u,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",36160,",null);"),b&&t(o,".drawBuffersWEBGL(",d,");"),t("}",s,".cur=",u,";"),r||t("}")}function P(e,t,n){var r=e.shared,o=r.gl,i=e.current,a=e.next,s=r.current,u=r.next,c=e.cond(s,".dirty");x.forEach((function(t){var r,l,d=T(t);if(!(d in n.state))if(d in a){r=a[d],l=i[d];var f=L(E[d].length,(function(e){return c.def(r,"[",e,"]")}));c(e.cond(f.map((function(e,t){return e+"!=="+l+"["+t+"]"})).join("||")).then(o,".",I[d],"(",f,");",f.map((function(e,t){return l+"["+t+"]="+e})).join(";"),";"))}else{r=c.def(u,".",d);var h=e.cond(r,"!==",s,".",d);c(h),d in S?h(e.cond(r).then(o,".enable(",S[d],");").else(o,".disable(",S[d],");"),s,".",d,"=",r,";"):h(o,".",I[d],"(",r,");",s,".",d,"=",r,";")}})),0===Object.keys(n.state).length&&c(s,".dirty=false;"),t(c)}function j(e,t,n,r){var o=e.shared,i=e.current,a=o.current,s=o.gl;nr(Object.keys(n)).forEach((function(o){var u=n[o];if(!r||r(u)){var c=u.append(e,t);if(S[o]){var l=S[o];or(u)?t(s,c?".enable(":".disable(",l,");"):t(e.cond(c).then(s,".enable(",l,");").else(s,".disable(",l,");")),t(a,".",o,"=",c,";")}else if(he(c)){var d=i[o];t(s,".",I[o],"(",c,");",c.map((function(e,t){return d+"["+t+"]="+e})).join(";"),";")}else t(s,".",I[o],"(",c,");",a,".",o,"=",c,";")}}))}function F(e,t){y&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function U(e,t,n,r,o){var i,a,s,u=e.shared,c=e.stats,l=u.current,d=u.timer,f=n.profile;function h(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function g(e){e(i=t.def(),"=",h(),";"),"string"==typeof o?e(c,".count+=",o,";"):e(c,".count++;"),p&&(r?e(a=t.def(),"=",d,".getNumPendingQueries();"):e(d,".beginQuery(",c,");"))}function m(e){e(c,".cpuTime+=",h(),"-",i,";"),p&&(r?e(d,".pushScopeStats(",a,",",d,".getNumPendingQueries(),",c,");"):e(d,".endQuery();"))}function v(e){var n=t.def(l,".profile");t(l,".profile=",e,";"),t.exit(l,".profile=",n,";")}if(f){if(or(f))return void(f.enable?(g(t),m(t.exit),v("true")):v("false"));v(s=f.append(e,t))}else s=t.def(l,".profile");var y=e.block();g(y),t("if(",s,"){",y,"}");var b=e.block();m(b),t.exit("if(",s,"){",b,"}")}function B(e,t,n,r,o){var i=e.shared;r.forEach((function(r){var a,s=r.name,u=n.attributes[s];if(u){if(!o(u))return;a=u.append(e,t)}else{if(!o(sr))return;var c=e.scopeAttrib(s);_.optional((function(){e.assert(t,c+".state","missing attribute "+s)})),a={},Object.keys(new m).forEach((function(e){a[e]=t.def(c,".",e)}))}!function(n,r,o){var a=i.gl,s=t.def(n,".location"),u=t.def(i.attributes,"[",s,"]"),c=o.state,l=o.buffer,d=[o.x,o.y,o.z,o.w],f=["buffer","normalized","offset","stride"];function h(){t("if(!",u,".buffer){",a,".enableVertexAttribArray(",s,");}");var n,i=o.type;if(n=o.size?t.def(o.size,"||",r):r,t("if(",u,".type!==",i,"||",u,".size!==",n,"||",f.map((function(e){return u+"."+e+"!=="+o[e]})).join("||"),"){",a,".bindBuffer(",An,",",l,".buffer);",a,".vertexAttribPointer(",[s,n,i,o.normalized,o.stride,o.offset],");",u,".type=",i,";",u,".size=",n,";",f.map((function(e){return u+"."+e+"="+o[e]+";"})).join(""),"}"),y){var c=o.divisor;t("if(",u,".divisor!==",c,"){",e.instancing,".vertexAttribDivisorANGLE(",[s,c],");",u,".divisor=",c,";}")}}function p(){t("if(",u,".buffer){",a,".disableVertexAttribArray(",s,");",u,".buffer=null;","}if(",Ot.map((function(e,t){return u+"."+e+"!=="+d[t]})).join("||"),"){",a,".vertexAttrib4f(",s,",",d,");",Ot.map((function(e,t){return u+"."+e+"="+d[t]+";"})).join(""),"}")}1===c?h():2===c?p():(t("if(",c,"===",1,"){"),h(),t("}else{"),p(),t("}"))}(e.link(r),function(e){switch(e){case Dn:case Rn:case Gn:return 2;case kn:case Cn:case Pn:return 3;case Mn:case Ln:case jn:return 4;default:return 1}}(r.info.type),a)}))}function V(e,t,r,o,i){for(var a,s=e.shared,u=s.gl,c=0;c<o.length;++c){var l,d=o[c],f=d.name,h=d.info.type,p=r.uniforms[f],g=e.link(d)+".location";if(p){if(!i(p))continue;if(or(p)){var m=p.value;if(_.command(null!=m,'missing uniform "'+f+'"',e.commandStr),h===Vn||h===Wn){_.command("function"==typeof m&&(h===Vn&&("texture2d"===m._reglType||"framebuffer"===m._reglType)||h===Wn&&("textureCube"===m._reglType||"framebufferCube"===m._reglType)),"invalid texture for uniform "+f,e.commandStr);var v=e.link(m._texture||m.color[0]._texture);t(u,".uniform1i(",g,",",v+".bind());"),t.exit(v,".unbind();")}else if(h===Fn||h===Un||h===Bn){_.optional((function(){_.command(he(m),"invalid matrix for uniform "+f,e.commandStr),_.command(h===Fn&&4===m.length||h===Un&&9===m.length||h===Bn&&16===m.length,"invalid length for matrix uniform "+f,e.commandStr)}));var y=e.global.def("new Float32Array(["+Array.prototype.slice.call(m)+"])"),b=2;h===Un?b=3:h===Bn&&(b=4),t(u,".uniformMatrix",b,"fv(",g,",false,",y,");")}else{switch(h){case Nn:_.commandType(m,"number","uniform "+f,e.commandStr),a="1f";break;case Dn:_.command(he(m)&&2===m.length,"uniform "+f,e.commandStr),a="2f";break;case kn:_.command(he(m)&&3===m.length,"uniform "+f,e.commandStr),a="3f";break;case Mn:_.command(he(m)&&4===m.length,"uniform "+f,e.commandStr),a="4f";break;case zn:_.commandType(m,"boolean","uniform "+f,e.commandStr),a="1i";break;case On:_.commandType(m,"number","uniform "+f,e.commandStr),a="1i";break;case Gn:case Rn:_.command(he(m)&&2===m.length,"uniform "+f,e.commandStr),a="2i";break;case Pn:case Cn:_.command(he(m)&&3===m.length,"uniform "+f,e.commandStr),a="3i";break;case jn:case Ln:_.command(he(m)&&4===m.length,"uniform "+f,e.commandStr),a="4i"}t(u,".uniform",a,"(",g,",",he(m)?Array.prototype.slice.call(m):m,");")}continue}l=p.append(e,t)}else{if(!i(sr))continue;l=t.def(s.uniforms,"[",n.id(f),"]")}h===Vn?(_(!Array.isArray(l),"must specify a scalar prop for textures"),t("if(",l,"&&",l,'._reglType==="framebuffer"){',l,"=",l,".color[0];","}")):h===Wn&&(_(!Array.isArray(l),"must specify a scalar prop for cube maps"),t("if(",l,"&&",l,'._reglType==="framebufferCube"){',l,"=",l,".color[0];","}")),_.optional((function(){function n(n,r){e.assert(t,n,'bad data or missing for uniform "'+f+'".  '+r)}function r(e){_(!Array.isArray(l),"must not specify an array type for uniform"),n("typeof "+l+'==="'+e+'"',"invalid type, expected "+e)}function o(t,r){Array.isArray(l)?_(l.length===t,"must have length "+t):n(s.isArrayLike+"("+l+")&&"+l+".length==="+t,"invalid vector, should have length "+t,e.commandStr)}function i(t){_(!Array.isArray(l),"must not specify a value type"),n("typeof "+l+'==="function"&&'+l+'._reglType==="texture'+(3553===t?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(h){case On:r("number");break;case Rn:o(2);break;case Cn:o(3);break;case Ln:o(4);break;case Nn:r("number");break;case Dn:o(2);break;case kn:o(3);break;case Mn:o(4);break;case zn:r("boolean");break;case Gn:o(2);break;case Pn:o(3);break;case jn:case Fn:o(4);break;case Un:o(9);break;case Bn:o(16);break;case Vn:i(3553);break;case Wn:i(34067)}}));var E=1;switch(h){case Vn:case Wn:var w=t.def(l,"._texture");t(u,".uniform1i(",g,",",w,".bind());"),t.exit(w,".unbind();");continue;case On:case zn:a="1i";break;case Rn:case Gn:a="2i",E=2;break;case Cn:case Pn:a="3i",E=3;break;case Ln:case jn:a="4i",E=4;break;case Nn:a="1f";break;case Dn:a="2f",E=2;break;case kn:a="3f",E=3;break;case Mn:a="4f",E=4;break;case Fn:a="Matrix2fv";break;case Un:a="Matrix3fv";break;case Bn:a="Matrix4fv"}if(t(u,".uniform",a,"(",g,","),"M"===a.charAt(0)){var x=Math.pow(h-Fn+2,2),S=e.global.def("new Float32Array(",x,")");Array.isArray(l)?t("false,(",L(x,(function(e){return S+"["+e+"]="+l[e]})),",",S,")"):t("false,(Array.isArray(",l,")||",l," instanceof Float32Array)?",l,":(",L(x,(function(e){return S+"["+e+"]="+l+"["+e+"]"})),",",S,")")}else E>1?t(L(E,(function(e){return Array.isArray(l)?l[e]:l+"["+e+"]"}))):(_(!Array.isArray(l),"uniform value must not be an array"),t(l));t(");")}}function W(e,t,n,r){var o=e.shared,i=o.gl,a=o.draw,s=r.draw;var u=function(){var o,u=s.elements,c=t;return u?((u.contextDep&&r.contextDynamic||u.propDep)&&(c=n),o=u.append(e,c)):o=c.def(a,".",dn),o&&c("if("+o+")"+i+".bindBuffer(34963,"+o+".buffer.buffer);"),o}();function c(o){var i=s[o];return i?i.contextDep&&r.contextDynamic||i.propDep?i.append(e,n):i.append(e,t):t.def(a,".",o)}var l,d,f=c(fn),h=c(pn),p=function(){var o,i=s.count,u=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(u=n),o=i.append(e,u),_.optional((function(){i.MISSING&&e.assert(t,"false","missing vertex count"),i.DYNAMIC&&e.assert(u,o+">=0","missing vertex count")}))):(o=u.def(a,".",hn),_.optional((function(){e.assert(u,o+">=0","missing vertex count")}))),o}();if("number"==typeof p){if(0===p)return}else n("if(",p,"){"),n.exit("}");y&&(l=c(gn),d=e.instancing);var g=u+".type",m=s.elements&&or(s.elements);function v(){function e(){n(d,".drawElementsInstancedANGLE(",[f,p,g,h+"<<(("+g+"-5121)>>1)",l],");")}function t(){n(d,".drawArraysInstancedANGLE(",[f,h,p,l],");")}u?m?e():(n("if(",u,"){"),e(),n("}else{"),t(),n("}")):t()}function b(){function e(){n(i+".drawElements("+[f,p,g,h+"<<(("+g+"-5121)>>1)"]+");")}function t(){n(i+".drawArrays("+[f,h,p]+");")}u?m?e():(n("if(",u,"){"),e(),n("}else{"),t(),n("}")):t()}y&&("number"!=typeof l||l>=0)?"string"==typeof l?(n("if(",l,">0){"),v(),n("}else if(",l,"<0){"),b(),n("}")):v():b()}function X(e,t,n,r,o){var i=R(),a=i.proc("body",o);return _.optional((function(){i.commandStr=t.commandStr,i.command=i.link(t.commandStr)})),y&&(i.instancing=a.def(i.shared.extensions,".angle_instanced_arrays")),e(i,a,n,r),i.compile().body}function H(e,t,n,r){F(e,t),n.useVAO?n.drawVAO?t(e.shared.vao,".setVAO(",n.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),B(e,t,n,r.attributes,(function(){return!0}))),V(e,t,n,r.uniforms,(function(){return!0})),W(e,t,t,n)}function q(e,t,n,r){function o(){return!0}e.batchId="a1",F(e,t),B(e,t,n,r.attributes,o),V(e,t,n,r.uniforms,o),W(e,t,t,n)}function Y(e,t,n,r){F(e,t);var o=n.contextDep,i=t.def(),a=t.def();e.shared.props=a,e.batchId=i;var s=e.scope(),u=e.scope();function c(e){return e.contextDep&&o||e.propDep}function l(e){return!c(e)}if(t(s.entry,"for(",i,"=0;",i,"<","a1",";++",i,"){",a,"=","a0","[",i,"];",u,"}",s.exit),n.needsContext&&z(e,u,n.context),n.needsFramebuffer&&G(e,u,n.framebuffer),j(e,u,n.state,c),n.profile&&c(n.profile)&&U(e,u,n,!1,!0),r)n.useVAO?n.drawVAO?c(n.drawVAO)?u(e.shared.vao,".setVAO(",n.drawVAO.append(e,u),");"):s(e.shared.vao,".setVAO(",n.drawVAO.append(e,s),");"):s(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(s(e.shared.vao,".setVAO(null);"),B(e,s,n,r.attributes,l),B(e,u,n,r.attributes,c)),V(e,s,n,r.uniforms,l),V(e,u,n,r.uniforms,c),W(e,s,u,n);else{var d=e.global.def("{}"),f=n.shader.progVar.append(e,u),h=u.def(f,".id"),p=u.def(d,"[",h,"]");u(e.shared.gl,".useProgram(",f,".program);","if(!",p,"){",p,"=",d,"[",h,"]=",e.link((function(t){return X(q,e,n,t,2)})),"(",f,");}",p,".call(this,a0[",i,"],",i,");")}}function $(e,t,n){var r=t.static[n];if(r&&function(e){if("object"==typeof e&&!he(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(D.isDynamic(e[t[n]]))return!0;return!1}}(r)){var o=e.global,i=Object.keys(r),a=!1,s=!1,u=!1,c=e.global.def("{}");i.forEach((function(t){var n=r[t];if(D.isDynamic(n)){"function"==typeof n&&(n=r[t]=D.unbox(n));var i=ar(n,null);a=a||i.thisDep,u=u||i.propDep,s=s||i.contextDep}else{switch(o(c,".",t,"="),typeof n){case"number":o(n);break;case"string":o('"',n,'"');break;case"object":Array.isArray(n)&&o("[",n.join(),"]");break;default:o(e.link(n))}o(";")}})),t.dynamic[n]=new D.DynamicVariable(4,{thisDep:a,contextDep:s,propDep:u,ref:c,append:function(e,t){i.forEach((function(n){var o=r[n];if(D.isDynamic(o)){var i=e.invoke(t,o);t(c,".",n,"=",i,";")}}))}}),delete t.static[n]}}return{next:w,current:E,procs:function(){var e=R(),t=e.proc("poll"),n=e.proc("refresh"),i=e.block();t(i),n(i);var a,s=e.shared,u=s.gl,c=s.next,l=s.current;i(l,".dirty=false;"),G(e,t),G(e,n,null,!0),y&&(a=e.link(y)),r.oes_vertex_array_object&&n(e.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var d=0;d<o.maxAttributes;++d){var f=n.def(s.attributes,"[",d,"]"),h=e.cond(f,".buffer");h.then(u,".enableVertexAttribArray(",d,");",u,".bindBuffer(",An,",",f,".buffer.buffer);",u,".vertexAttribPointer(",d,",",f,".size,",f,".type,",f,".normalized,",f,".stride,",f,".offset);").else(u,".disableVertexAttribArray(",d,");",u,".vertexAttrib4f(",d,",",f,".x,",f,".y,",f,".z,",f,".w);",f,".buffer=null;"),n(h),y&&n(a,".vertexAttribDivisorANGLE(",d,",",f,".divisor);")}return n(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"),Object.keys(S).forEach((function(r){var o=S[r],a=i.def(c,".",r),s=e.block();s("if(",a,"){",u,".enable(",o,")}else{",u,".disable(",o,")}",l,".",r,"=",a,";"),n(s),t("if(",a,"!==",l,".",r,"){",s,"}")})),Object.keys(I).forEach((function(r){var o,a,s=I[r],d=E[r],f=e.block();if(f(u,".",s,"("),he(d)){var h=d.length;o=e.global.def(c,".",r),a=e.global.def(l,".",r),f(L(h,(function(e){return o+"["+e+"]"})),");",L(h,(function(e){return a+"["+e+"]="+o+"["+e+"];"})).join("")),t("if(",L(h,(function(e){return o+"["+e+"]!=="+a+"["+e+"]"})).join("||"),"){",f,"}")}else o=i.def(c,".",r),a=i.def(l,".",r),f(o,");",l,".",r,"=",o,";"),t("if(",o,"!==",a,"){",f,"}");n(f)})),e.compile()}(),compile:function(e,r,o,i,a){var s=R();s.stats=s.link(a),Object.keys(r.static).forEach((function(e){$(s,r,e)})),Tn.forEach((function(t){$(s,e,t)}));var u=C(e,r,o,i,s);return function(e,t){var n=e.proc("draw",1);F(e,n),z(e,n,t.context),G(e,n,t.framebuffer),P(e,n,t),j(e,n,t.state),U(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)H(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var o=e.global.def("{}"),i=n.def(r,".id"),a=n.def(o,"[",i,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",o,"[",i,"]=",e.link((function(n){return X(H,e,t,n,1)})),"(",r,");",a,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}(s,u),function(e,t){var r=e.proc("scope",3);e.batchId="a2";var o=e.shared,i=o.current;function a(n){var i=t.shader[n];i&&r.set(o.shader,"."+n,i.append(e,r))}z(e,r,t.context),t.framebuffer&&t.framebuffer.append(e,r),nr(Object.keys(t.state)).forEach((function(n){var i=t.state[n].append(e,r);he(i)?i.forEach((function(t,o){r.set(e.next[n],"["+o+"]",t)})):r.set(o.next,"."+n,i)})),U(e,r,t,!0,!0),[dn,pn,hn,gn,fn].forEach((function(n){var i=t.draw[n];i&&r.set(o.draw,"."+n,""+i.append(e,r))})),Object.keys(t.uniforms).forEach((function(i){var a=t.uniforms[i].append(e,r);Array.isArray(a)&&(a="["+a.join()+"]"),r.set(o.uniforms,"["+n.id(i)+"]",a)})),Object.keys(t.attributes).forEach((function(n){var o=t.attributes[n].append(e,r),i=e.scopeAttrib(n);Object.keys(new m).forEach((function(e){r.set(i,"."+e,o[e])}))})),t.scopeVAO&&r.set(o.vao,".targetVAO",t.scopeVAO.append(e,r)),a(cn),a(ln),Object.keys(t.state).length>0&&(r(i,".dirty=true;"),r.exit(i,".dirty=true;")),r("a1(",e.shared.context,",a0,",e.batchId,");")}(s,u),function(e,t){var n=e.proc("batch",2);e.batchId="0",F(e,n);var r=!1,o=!0;Object.keys(t.context).forEach((function(e){r=r||t.context[e].propDep})),r||(z(e,n,t.context),o=!1);var i=t.framebuffer,a=!1;function s(e){return e.contextDep&&r||e.propDep}i?(i.propDep?r=a=!0:i.contextDep&&r&&(a=!0),a||G(e,n,i)):G(e,n,null),t.state.viewport&&t.state.viewport.propDep&&(r=!0),P(e,n,t),j(e,n,t.state,(function(e){return!s(e)})),t.profile&&s(t.profile)||U(e,n,t,!1,"a1"),t.contextDep=r,t.needsContext=o,t.needsFramebuffer=a;var u=t.shader.progVar;if(u.contextDep&&r||u.propDep)Y(e,n,t,null);else{var c=u.append(e,n);if(n(e.shared.gl,".useProgram(",c,".program);"),t.shader.program)Y(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var l=e.global.def("{}"),d=n.def(c,".id"),f=n.def(l,"[",d,"]");n(e.cond(f).then(f,".call(this,a0,a1);").else(f,"=",l,"[",d,"]=",e.link((function(n){return X(Y,e,t,n,2)})),"(",c,");",f,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}(s,u),t(s.compile(),{destroy:function(){u.shader.program.destroy()}})}}}var cr=function(e,t){if(!t.ext_disjoint_timer_query)return null;var n=[];function r(e){n.push(e)}var o=[];function i(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var a=[];function s(e){a.push(e)}var u=[];function c(e,t,n){var r=a.pop()||new i;r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,u.push(r)}var l=[],d=[];return{beginQuery:function(e){var r=n.pop()||t.ext_disjoint_timer_query.createQueryEXT();t.ext_disjoint_timer_query.beginQueryEXT(35007,r),o.push(r),c(o.length-1,o.length,e)},endQuery:function(){t.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:c,update:function(){var e,n,i=o.length;if(0!==i){d.length=Math.max(d.length,i+1),l.length=Math.max(l.length,i+1),l[0]=0,d[0]=0;var a=0;for(e=0,n=0;n<o.length;++n){var c=o[n];t.ext_disjoint_timer_query.getQueryObjectEXT(c,34919)?(a+=t.ext_disjoint_timer_query.getQueryObjectEXT(c,34918),r(c)):o[e++]=c,l[n+1]=a,d[n+1]=e}for(o.length=e,e=0,n=0;n<u.length;++n){var f=u[n],h=f.startQueryIndex,p=f.endQueryIndex;f.sum+=l[p]-l[h];var g=d[h],m=d[p];m===g?(f.stats.gpuTime+=f.sum/1e6,s(f)):(f.startQueryIndex=g,f.endQueryIndex=m,u[e++]=f)}u.length=e}},getNumPendingQueries:function(){return o.length},clear:function(){n.push.apply(n,o);for(var e=0;e<n.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(n[e]);o.length=0,n.length=0},restore:function(){o.length=0,n.length=0}}},lr="webglcontextlost",dr="webglcontextrestored";function fr(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}return function(n){var r=C(n);if(!r)return null;var o=r.gl,i=o.getContextAttributes(),a=o.isContextLost(),s=function(e,t){var n={};function r(t){_.type(t,"string","extension name must be string");var r,o=t.toLowerCase();try{r=n[o]=e.getExtension(o)}catch(e){}return!!r}for(var o=0;o<t.extensions.length;++o){var i=t.extensions[o];if(!r(i))return t.onDestroy(),t.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach((function(e){if(n[e]&&!r(e))throw new Error("(regl): error restoring extension "+e)}))}}}(o,r);if(!s)return null;var u,c,l=(u={"":0},c=[""],{id:function(e){var t=u[e];return t||(t=u[e]=c.length,c.push(e),t)},str:function(e){return c[e]}}),d={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},f=s.extensions,h=cr(0,f),p=M(),g=o.drawingBufferWidth,m=o.drawingBufferHeight,v={tick:0,time:0,viewportWidth:g,viewportHeight:m,framebufferWidth:g,framebufferHeight:m,drawingBufferWidth:g,drawingBufferHeight:m,pixelRatio:r.pixelRatio},y=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,o=1;t.webgl_draw_buffers&&(r=e.getParameter(34852),o=e.getParameter(36063));var i=!!t.oes_texture_float;if(i){var a=e.createTexture();e.bindTexture(j,a),e.texImage2D(j,0,F,1,1,0,F,U,null);var s=e.createFramebuffer();if(e.bindFramebuffer(B,s),e.framebufferTexture2D(B,36064,j,a,0),e.bindTexture(j,null),36053!==e.checkFramebufferStatus(B))i=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(16384);var u=P.allocType(U,4);e.readPixels(0,0,1,1,F,U,u),e.getError()?i=!1:(e.deleteFramebuffer(s),e.deleteTexture(a),i=1===u[0]),P.freeType(u)}}var c=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var l=e.createTexture(),d=P.allocType(5121,36);e.activeTexture(33984),e.bindTexture(34067,l),e.texImage2D(34069,0,F,3,3,0,F,5121,d),P.freeType(d),e.bindTexture(34067,null),e.deleteTexture(l),c=!e.getError()}return{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter((function(e){return!!t[e]})),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:o,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:i,npotTextureCube:c}}(o,f),b=function(t,n,r,o){var i=0,a={};function s(e){this.id=i++,this.buffer=t.createBuffer(),this.type=e,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=J,this.persistentData=null,r.profile&&(this.stats={size:0})}s.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){d(this)};var u=[];function c(e,n,r){e.byteLength=n.byteLength,t.bufferData(e.type,n,r)}function l(t,n,r,o,i,a){var s,u;if(t.usage=r,Array.isArray(n)){if(t.dtype=o||ee,n.length>0)if(Array.isArray(n[0])){s=Q(n);for(var l=1,d=1;d<s.length;++d)l*=s[d];t.dimension=l,c(t,u=K(n,s,t.dtype),r),a?t.persistentData=u:P.freeType(u)}else if("number"==typeof n[0]){t.dimension=i;var f=P.allocType(t.dtype,n.length);re(f,n),c(t,f,r),a?t.persistentData=f:P.freeType(f)}else e(n[0])?(t.dimension=n[0].length,t.dtype=o||ne(n[0])||ee,c(t,u=K(n,[n.length,n[0].length],t.dtype),r),a?t.persistentData=u:P.freeType(u)):_.raise("invalid buffer data")}else if(e(n))t.dtype=o||ne(n),t.dimension=i,c(t,n,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(V(n)){s=n.shape;var h=n.stride,p=n.offset,g=0,m=0,v=0,y=0;1===s.length?(g=s[0],m=1,v=h[0],y=0):2===s.length?(g=s[0],m=s[1],v=h[0],y=h[1]):_.raise("invalid shape"),t.dtype=o||ne(n.data)||ee,t.dimension=m;var b=P.allocType(t.dtype,g*m);oe(b,n.data,g,m,v,y,p),c(t,b,r),a?t.persistentData=b:P.freeType(b)}else n instanceof ArrayBuffer?(t.dtype=J,t.dimension=i,c(t,n,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(n)))):_.raise("invalid buffer data")}function d(e){n.bufferCount--,o(e);var r=e.buffer;_(r,"buffer must not be deleted already"),t.deleteBuffer(r),e.buffer=null,delete a[e.id]}return r.profile&&(n.getTotalBufferSize=function(){var e=0;return Object.keys(a).forEach((function(t){e+=a[t].stats.size})),e}),{create:function(o,i,u,c){n.bufferCount++;var f=new s(i);function h(n){var o=35044,i=null,a=0,s=0,u=1;return Array.isArray(n)||e(n)||V(n)||n instanceof ArrayBuffer?i=n:"number"==typeof n?a=0|n:n&&(_.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(_(null===i||Array.isArray(i)||e(i)||V(i),"invalid data for buffer"),i=n.data),"usage"in n&&(_.parameter(n.usage,$,"invalid buffer usage"),o=$[n.usage]),"type"in n&&(_.parameter(n.type,Z,"invalid buffer type"),s=Z[n.type]),"dimension"in n&&(_.type(n.dimension,"number","invalid dimension"),u=0|n.dimension),"length"in n&&(_.nni(a,"buffer length must be a nonnegative integer"),a=0|n.length)),f.bind(),i?l(f,i,o,s,u,c):(a&&t.bufferData(f.type,a,o),f.dtype=s||J,f.usage=o,f.dimension=u,f.byteLength=a),r.profile&&(f.stats.size=f.byteLength*te[f.dtype]),h}function p(e,n){_(n+e.byteLength<=f.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+n+" to a buffer of size "+f.byteLength),t.bufferSubData(f.type,n,e)}return a[f.id]=f,u||h(o),h._reglType="buffer",h._buffer=f,h.subdata=function(t,n){var r,o=0|(n||0);if(f.bind(),e(t)||t instanceof ArrayBuffer)p(t,o);else if(Array.isArray(t)){if(t.length>0)if("number"==typeof t[0]){var i=P.allocType(f.dtype,t.length);re(i,t),p(i,o),P.freeType(i)}else if(Array.isArray(t[0])||e(t[0])){r=Q(t);var a=K(t,r,f.dtype);p(a,o),P.freeType(a)}else _.raise("invalid buffer data")}else if(V(t)){r=t.shape;var s=t.stride,u=0,c=0,l=0,d=0;1===r.length?(u=r[0],c=1,l=s[0],d=0):2===r.length?(u=r[0],c=r[1],l=s[0],d=s[1]):_.raise("invalid shape");var g=Array.isArray(t.data)?f.dtype:ne(t.data),m=P.allocType(g,u*c);oe(m,t.data,u,c,l,d,t.offset),p(m,o),P.freeType(m)}else _.raise("invalid data for buffer subdata");return h},r.profile&&(h.stats=f.stats),h.destroy=function(){d(f)},h},createStream:function(e,t){var n=u.pop();return n||(n=new s(e)),n.bind(),l(n,t,35040,0,1,!1),n},destroyStream:function(e){u.push(e)},clear:function(){W(a).forEach(d),u.forEach(d)},getBuffer:function(e){return e&&e._buffer instanceof s?e._buffer:null},restore:function(){W(a).forEach((function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)}))},_initBuffer:l}}(o,d,r,(function(e){return E.destroyBuffer(e)})),E=function(t,n,r,o,i){for(var a=r.maxAttributes,s=new Array(a),u=0;u<a;++u)s[u]=new Tt;var c=0,l={},d={Record:Tt,scope:{},state:s,currentVAO:null,targetVAO:null,restore:f()?function(){f()&&W(l).forEach((function(e){e.refresh()}))}:function(){},createVAO:function(t){var r=new p;function s(t){_(Array.isArray(t),"arguments to vertex array constructor must be an array"),_(t.length<a,"too many attributes"),_(t.length>0,"must specify at least one attribute");var o={},u=r.attributes;u.length=t.length;for(var c=0;c<t.length;++c){var l,d=t[c],f=u[c]=new Tt,h=d.data||d;Array.isArray(h)||e(h)||V(h)?(r.buffers[c]&&(l=r.buffers[c],e(h)&&l._buffer.byteLength>=h.byteLength?l.subdata(h):(l.destroy(),r.buffers[c]=null)),r.buffers[c]||(l=r.buffers[c]=i.create(d,34962,!1,!0)),f.buffer=i.getBuffer(l),f.size=0|f.buffer.dimension,f.normalized=!1,f.type=f.buffer.dtype,f.offset=0,f.stride=0,f.divisor=0,f.state=1,o[c]=1):i.getBuffer(d)?(f.buffer=i.getBuffer(d),f.size=0|f.buffer.dimension,f.normalized=!1,f.type=f.buffer.dtype,f.offset=0,f.stride=0,f.divisor=0,f.state=1):i.getBuffer(d.buffer)?(f.buffer=i.getBuffer(d.buffer),f.size=0|(+d.size||f.buffer.dimension),f.normalized=!!d.normalized||!1,"type"in d?(_.parameter(d.type,Z,"invalid buffer type"),f.type=Z[d.type]):f.type=f.buffer.dtype,f.offset=0|(d.offset||0),f.stride=0|(d.stride||0),f.divisor=0|(d.divisor||0),f.state=1,_(f.size>=1&&f.size<=4,"size must be between 1 and 4"),_(f.offset>=0,"invalid offset"),_(f.stride>=0&&f.stride<=255,"stride must be between 0 and 255"),_(f.divisor>=0,"divisor must be positive"),_(!f.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in d?(_(c>0,"first attribute must not be a constant"),f.x=+d.x||0,f.y=+d.y||0,f.z=+d.z||0,f.w=+d.w||0,f.state=2):_(!1,"invalid attribute spec for location "+c)}for(var p=0;p<r.buffers.length;++p)!o[p]&&r.buffers[p]&&(r.buffers[p].destroy(),r.buffers[p]=null);return r.refresh(),s}return o.vaoCount+=1,s.destroy=function(){for(var e=0;e<r.buffers.length;++e)r.buffers[e]&&r.buffers[e].destroy();r.buffers.length=0,r.destroy()},s._vao=r,s._reglType="vao",s(t)},getVAO:function(e){return"function"==typeof e&&e._vao?e._vao:null},destroyBuffer:function(e){for(var n=0;n<s.length;++n){var r=s[n];r.buffer===e&&(t.disableVertexAttribArray(n),r.buffer=null)}},setVAO:f()?function(e){if(e!==d.currentVAO){var t=f();e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),d.currentVAO=e}}:function(e){if(e!==d.currentVAO){if(e)e.bindAttrs();else for(var n=h(),r=0;r<s.length;++r){var o=s[r];o.buffer?(t.enableVertexAttribArray(r),t.vertexAttribPointer(r,o.size,o.type,o.normalized,o.stride,o.offfset),n&&o.divisor&&n.vertexAttribDivisorANGLE(r,o.divisor)):(t.disableVertexAttribArray(r),t.vertexAttrib4f(r,o.x,o.y,o.z,o.w))}d.currentVAO=e}},clear:f()?function(){W(l).forEach((function(e){e.destroy()}))}:function(){}};function f(){return n.oes_vertex_array_object}function h(){return n.angle_instanced_arrays}function p(){this.id=++c,this.attributes=[];var e=f();this.vao=e?e.createVertexArrayOES():null,l[this.id]=this,this.buffers=[]}return p.prototype.bindAttrs=function(){for(var e=h(),n=this.attributes,r=0;r<n.length;++r){var o=n[r];o.buffer?(t.enableVertexAttribArray(r),t.bindBuffer(34962,o.buffer.buffer),t.vertexAttribPointer(r,o.size,o.type,o.normalized,o.stride,o.offset),e&&o.divisor&&e.vertexAttribDivisorANGLE(r,o.divisor)):(t.disableVertexAttribArray(r),t.vertexAttrib4f(r,o.x,o.y,o.z,o.w))}for(var i=n.length;i<a;++i)t.disableVertexAttribArray(i)},p.prototype.refresh=function(){var e=f();e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),d.currentVAO=this)},p.prototype.destroy=function(){if(this.vao){var e=f();this===d.currentVAO&&(d.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}l[this.id]&&(delete l[this.id],o.vaoCount-=1)},d}(o,f,y,d,b),w=function(t,n,r,o){var i={},a=0,s={uint8:ae,uint16:se};function u(e){this.id=a++,i[this.id]=this,this.buffer=e,this.primType=4,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(s.uint32=ue),u.prototype.bind=function(){this.buffer.bind()};var c=[];function l(o,i,a,s,u,c,l){var d;if(o.buffer.bind(),i){var f=l;l||e(i)&&(!V(i)||e(i.data))||(f=n.oes_element_index_uint?ue:se),r._initBuffer(o.buffer,i,a,f,3)}else t.bufferData(ce,c,a),o.buffer.dtype=d||ae,o.buffer.usage=a,o.buffer.dimension=3,o.buffer.byteLength=c;if(d=l,!l){switch(o.buffer.dtype){case ae:case 5120:d=ae;break;case se:case 5122:d=se;break;case ue:case 5124:d=ue;break;default:_.raise("unsupported type for element array")}o.buffer.dtype=d}o.type=d,_(d!==ue||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var h=u;h<0&&(h=o.buffer.byteLength,d===se?h>>=1:d===ue&&(h>>=2)),o.vertCount=h;var p=s;if(s<0){p=4;var g=o.buffer.dimension;1===g&&(p=0),2===g&&(p=1),3===g&&(p=4)}o.primType=p}function d(e){o.elementsCount--,_(null!==e.buffer,"must not double destroy elements"),delete i[e.id],e.buffer.destroy(),e.buffer=null}return{create:function(t,n){var i=r.create(null,ce,!0),a=new u(i._buffer);function c(t){if(t)if("number"==typeof t)i(t),a.primType=4,a.vertCount=0|t,a.type=ae;else{var n=null,r=35044,o=-1,u=-1,d=0,f=0;Array.isArray(t)||e(t)||V(t)?n=t:(_.type(t,"object","invalid arguments for elements"),"data"in t&&(n=t.data,_(Array.isArray(n)||e(n)||V(n),"invalid data for element buffer")),"usage"in t&&(_.parameter(t.usage,$,"invalid element buffer usage"),r=$[t.usage]),"primitive"in t&&(_.parameter(t.primitive,ie,"invalid element buffer primitive"),o=ie[t.primitive]),"count"in t&&(_("number"==typeof t.count&&t.count>=0,"invalid vertex count for elements"),u=0|t.count),"type"in t&&(_.parameter(t.type,s,"invalid buffer type"),f=s[t.type]),"length"in t?d=0|t.length:(d=u,f===se||5122===f?d*=2:f!==ue&&5124!==f||(d*=4))),l(a,n,r,o,u,d,f)}else i(),a.primType=4,a.vertCount=0,a.type=ae;return c}return o.elementsCount++,c(t),c._reglType="elements",c._elements=a,c.subdata=function(e,t){return i.subdata(e,t),c},c.destroy=function(){d(a)},c},createStream:function(e){var t=c.pop();return t||(t=new u(r.create(null,ce,!0,!1)._buffer)),l(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){c.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof u?e._elements:null},clear:function(){W(i).forEach(d)}}}(o,f,b,d),x=function(e,n,r,o){var i={},a={};function s(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function u(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function c(t,r,o){var s=35632===t?i:a,u=s[r];if(!u){var c=n.str(r);u=e.createShader(t),e.shaderSource(u,c),e.compileShader(u),_.shaderError(e,u,c,t,o),s[r]=u}return u}var l={},d=[],f=0;function h(e,t){this.id=f++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,o.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function p(t,r,i){var a,l,d=c(35632,t.fragId),f=c(35633,t.vertId),h=t.program=e.createProgram();if(e.attachShader(h,d),e.attachShader(h,f),i)for(a=0;a<i.length;++a){var p=i[a];e.bindAttribLocation(h,p[0],p[1])}e.linkProgram(h),_.linkError(e,h,n.str(t.fragId),n.str(t.vertId),r);var g=e.getProgramParameter(h,35718);o.profile&&(t.stats.uniformsCount=g);var m=t.uniforms;for(a=0;a<g;++a)if(l=e.getActiveUniform(h,a))if(l.size>1)for(var v=0;v<l.size;++v){var y=l.name.replace("[0]","["+v+"]");u(m,new s(y,n.id(y),e.getUniformLocation(h,y),l))}else u(m,new s(l.name,n.id(l.name),e.getUniformLocation(h,l.name),l));var b=e.getProgramParameter(h,35721);o.profile&&(t.stats.attributesCount=b);var E=t.attributes;for(a=0;a<b;++a)(l=e.getActiveAttrib(h,a))&&u(E,new s(l.name,n.id(l.name),e.getAttribLocation(h,l.name),l))}return o.profile&&(r.getMaxUniformsCount=function(){var e=0;return d.forEach((function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)})),e},r.getMaxAttributesCount=function(){var e=0;return d.forEach((function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)})),e}),{clear:function(){var t=e.deleteShader.bind(e);W(i).forEach(t),i={},W(a).forEach(t),a={},d.forEach((function(t){e.deleteProgram(t.program)})),d.length=0,l={},r.shaderCount=0},program:function(n,o,s,u){_.command(n>=0,"missing vertex shader",s),_.command(o>=0,"missing fragment shader",s);var c=l[o];c||(c=l[o]={});var f=c[n];if(f&&(f.refCount++,!u))return f;var g=new h(o,n);return r.shaderCount++,p(g,s,u),f||(c[n]=g),d.push(g),t(g,{destroy:function(){if(g.refCount--,g.refCount<=0){e.deleteProgram(g.program);var t=d.indexOf(g);d.splice(t,1),r.shaderCount--}c[g.vertId].refCount<=0&&(e.deleteShader(a[g.vertId]),delete a[g.vertId],delete l[g.fragId][g.vertId]),Object.keys(l[g.fragId]).length||(e.deleteShader(i[g.fragId]),delete i[g.fragId],delete l[g.fragId])}})},restore:function(){i={},a={};for(var e=0;e<d.length;++e)p(d[e],null,d[e].attributes.map((function(e){return[e.location,e.name]})))},shader:c,frag:-1,vert:-1}}(o,l,d,r),S=ft(o,f,y,(function(){A.procs.poll()}),v,d,r),I=function(e,t,n,r,o){var i={rgba4:pt,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(i.srgba=35907),t.ext_color_buffer_half_float&&(i.rgba16f=34842,i.rgb16f=34843),t.webgl_color_buffer_float&&(i.rgba32f=34836);var a=[];Object.keys(i).forEach((function(e){var t=i[e];a[t]=e}));var s=0,u={};function c(e){this.id=s++,this.refCount=1,this.renderbuffer=e,this.format=pt,this.width=0,this.height=0,o.profile&&(this.stats={size:0})}function l(t){var n=t.renderbuffer;_(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(ht,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete u[t.id],r.renderbufferCount--}return c.prototype.decRef=function(){--this.refCount<=0&&l(this)},o.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(u).forEach((function(t){e+=u[t].stats.size})),e}),{create:function(t,s){var l=new c(e.createRenderbuffer());function d(t,r){var s=0,u=0,c=pt;if("object"==typeof t&&t){var f=t;if("shape"in f){var h=f.shape;_(Array.isArray(h)&&h.length>=2,"invalid renderbuffer shape"),s=0|h[0],u=0|h[1]}else"radius"in f&&(s=u=0|f.radius),"width"in f&&(s=0|f.width),"height"in f&&(u=0|f.height);"format"in f&&(_.parameter(f.format,i,"invalid renderbuffer format"),c=i[f.format])}else"number"==typeof t?(s=0|t,u="number"==typeof r?0|r:s):t?_.raise("invalid arguments to renderbuffer constructor"):s=u=1;if(_(s>0&&u>0&&s<=n.maxRenderbufferSize&&u<=n.maxRenderbufferSize,"invalid renderbuffer size"),s!==l.width||u!==l.height||c!==l.format)return d.width=l.width=s,d.height=l.height=u,l.format=c,e.bindRenderbuffer(ht,l.renderbuffer),e.renderbufferStorage(ht,c,s,u),_(0===e.getError(),"invalid render buffer format"),o.profile&&(l.stats.size=mt(l.format,l.width,l.height)),d.format=a[l.format],d}return u[l.id]=l,r.renderbufferCount++,d(t,s),d.resize=function(t,r){var i=0|t,a=0|r||i;return i===l.width&&a===l.height||(_(i>0&&a>0&&i<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),d.width=l.width=i,d.height=l.height=a,e.bindRenderbuffer(ht,l.renderbuffer),e.renderbufferStorage(ht,l.format,i,a),_(0===e.getError(),"invalid render buffer format"),o.profile&&(l.stats.size=mt(l.format,l.width,l.height))),d},d._reglType="renderbuffer",d._renderbuffer=l,o.profile&&(d.stats=l.stats),d.destroy=function(){l.decRef()},d},clear:function(){W(u).forEach(l)},restore:function(){W(u).forEach((function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(ht,t.renderbuffer),e.renderbufferStorage(ht,t.format,t.width,t.height)})),e.bindRenderbuffer(ht,null)}}}(o,f,y,d,r),T=function(e,n,r,o,i,a){var s={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],c=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&c.push("srgba"),n.ext_color_buffer_half_float&&c.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&c.push("rgba32f");var l=["uint8"];function d(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=0,o=0;t?(r=t.width,o=t.height):n&&(r=n.width,o=n.height),this.width=r,this.height=o}function f(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function h(e,t,n){if(e)if(e.texture){var r=e.texture._texture,o=Math.max(1,r.width),i=Math.max(1,r.height);_(o===t&&i===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=e.renderbuffer._renderbuffer;_(a.width===t&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function p(t,n){n&&(n.texture?e.framebufferTexture2D(vt,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(vt,t,yt,n.renderbuffer._renderbuffer.renderbuffer))}function g(e){var t=bt,n=null,r=null,o=e;"object"==typeof e&&(o=e.data,"target"in e&&(t=0|e.target)),_.type(o,"function","invalid attachment data");var i=o._reglType;return"texture2d"===i?(n=o,_(t===bt)):"textureCube"===i?(n=o,_(t>=Et&&t<34075,"invalid cube map target")):"renderbuffer"===i?(r=o,t=yt):_.raise("invalid regl object for attachment"),new d(t,n,r)}function m(e,t,n,r,a){if(n){var s=o.create2D({width:e,height:t,format:r,type:a});return s._texture.refCount=0,new d(bt,s,null)}var u=i.create({width:e,height:t,format:r});return u._renderbuffer.refCount=0,new d(yt,null,u)}function v(e){return e&&(e.texture||e.renderbuffer)}function y(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}n.oes_texture_half_float&&l.push("half float","float16"),n.oes_texture_float&&l.push("float","float32");var b=0,E={};function w(){this.id=b++,E[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function x(e){e.colorAttachments.forEach(f),f(e.depthAttachment),f(e.stencilAttachment),f(e.depthStencilAttachment)}function S(t){var n=t.framebuffer;_(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,a.framebufferCount--,delete E[t.id]}function I(t){var n;e.bindFramebuffer(vt,t.framebuffer);var o=t.colorAttachments;for(n=0;n<o.length;++n)p(36064+n,o[n]);for(n=o.length;n<r.maxColorAttachments;++n)e.framebufferTexture2D(vt,36064+n,bt,null,0);e.framebufferTexture2D(vt,33306,bt,null,0),e.framebufferTexture2D(vt,36096,bt,null,0),e.framebufferTexture2D(vt,36128,bt,null,0),p(36096,t.depthAttachment),p(36128,t.stencilAttachment),p(33306,t.depthStencilAttachment);var i=e.checkFramebufferStatus(vt);e.isContextLost()||36053===i||_.raise("framebuffer configuration not supported, status = "+It[i]),e.bindFramebuffer(vt,s.next?s.next.framebuffer:null),s.cur=s.next,e.getError()}function T(e,o){var i=new w;function d(e,t){var o;_(s.next!==i,"can not update framebuffer which is currently in use");var a=0,f=0,p=!0,y=!0,b=null,E=!0,w="rgba",S="uint8",T=1,A=null,N=null,D=null,k=!1;if("number"==typeof e)a=0|e,f=0|t||a;else if(e){_.type(e,"object","invalid arguments for framebuffer");var M=e;if("shape"in M){var O=M.shape;_(Array.isArray(O)&&O.length>=2,"invalid shape for framebuffer"),a=O[0],f=O[1]}else"radius"in M&&(a=f=M.radius),"width"in M&&(a=M.width),"height"in M&&(f=M.height);("color"in M||"colors"in M)&&(b=M.color||M.colors,Array.isArray(b)&&_(1===b.length||n.webgl_draw_buffers,"multiple render targets not supported")),b||("colorCount"in M&&(T=0|M.colorCount,_(T>0,"invalid color buffer count")),"colorTexture"in M&&(E=!!M.colorTexture,w="rgba4"),"colorType"in M&&(S=M.colorType,E?(_(n.oes_texture_float||!("float"===S||"float32"===S),"you must enable OES_texture_float in order to use floating point framebuffer objects"),_(n.oes_texture_half_float||!("half float"===S||"float16"===S),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===S||"float16"===S?(_(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),w="rgba16f"):"float"!==S&&"float32"!==S||(_(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),w="rgba32f"),_.oneOf(S,l,"invalid color type")),"colorFormat"in M&&(w=M.colorFormat,u.indexOf(w)>=0?E=!0:c.indexOf(w)>=0?E=!1:E?_.oneOf(M.colorFormat,u,"invalid color format for texture"):_.oneOf(M.colorFormat,c,"invalid color format for renderbuffer"))),("depthTexture"in M||"depthStencilTexture"in M)&&(k=!(!M.depthTexture&&!M.depthStencilTexture),_(!k||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in M&&("boolean"==typeof M.depth?p=M.depth:(A=M.depth,y=!1)),"stencil"in M&&("boolean"==typeof M.stencil?y=M.stencil:(N=M.stencil,p=!1)),"depthStencil"in M&&("boolean"==typeof M.depthStencil?p=y=M.depthStencil:(D=M.depthStencil,p=!1,y=!1))}else a=f=1;var R=null,C=null,L=null,z=null;if(Array.isArray(b))R=b.map(g);else if(b)R=[g(b)];else for(R=new Array(T),o=0;o<T;++o)R[o]=m(a,f,E,w,S);_(n.webgl_draw_buffers||R.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),_(R.length<=r.maxColorAttachments,"too many color attachments, not supported"),a=a||R[0].width,f=f||R[0].height,A?C=g(A):p&&!y&&(C=m(a,f,k,"depth","uint32")),N?L=g(N):y&&!p&&(L=m(a,f,!1,"stencil","uint8")),D?z=g(D):!A&&!N&&y&&p&&(z=m(a,f,k,"depth stencil","depth stencil")),_(!!A+!!N+!!D<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var G=null;for(o=0;o<R.length;++o)if(h(R[o],a,f),_(!R[o]||R[o].texture&&wt.indexOf(R[o].texture._texture.format)>=0||R[o].renderbuffer&&St.indexOf(R[o].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+o+" is invalid"),R[o]&&R[o].texture){var P=xt[R[o].texture._texture.format]*_t[R[o].texture._texture.type];null===G?G=P:_(G===P,"all color attachments much have the same number of bits per pixel.")}return h(C,a,f),_(!C||C.texture&&6402===C.texture._texture.format||C.renderbuffer&&33189===C.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),h(L,a,f),_(!L||L.renderbuffer&&36168===L.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),h(z,a,f),_(!z||z.texture&&34041===z.texture._texture.format||z.renderbuffer&&34041===z.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),x(i),i.width=a,i.height=f,i.colorAttachments=R,i.depthAttachment=C,i.stencilAttachment=L,i.depthStencilAttachment=z,d.color=R.map(v),d.depth=v(C),d.stencil=v(L),d.depthStencil=v(z),d.width=i.width,d.height=i.height,I(i),d}return a.framebufferCount++,d(e,o),t(d,{resize:function(e,t){_(s.next!==i,"can not resize a framebuffer which is currently in use");var n=Math.max(0|e,1),r=Math.max(0|t||n,1);if(n===i.width&&r===i.height)return d;for(var o=i.colorAttachments,a=0;a<o.length;++a)y(o[a],n,r);return y(i.depthAttachment,n,r),y(i.stencilAttachment,n,r),y(i.depthStencilAttachment,n,r),i.width=d.width=n,i.height=d.height=r,I(i),d},_reglType:"framebuffer",_framebuffer:i,destroy:function(){S(i),x(i)},use:function(e){s.setFBO({framebuffer:d},e)}})}return t(s,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof w)return t}return null},create:T,createCube:function(e){var i=Array(6);function a(e){var r;_(i.indexOf(s.next)<0,"can not update framebuffer which is currently in use");var c,d={color:null},f=0,h=null,p="rgba",g="uint8",m=1;if("number"==typeof e)f=0|e;else if(e){_.type(e,"object","invalid arguments for framebuffer");var v=e;if("shape"in v){var y=v.shape;_(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),_(y[0]===y[1],"cube framebuffer must be square"),f=y[0]}else"radius"in v&&(f=0|v.radius),"width"in v?(f=0|v.width,"height"in v&&_(v.height===f,"must be square")):"height"in v&&(f=0|v.height);("color"in v||"colors"in v)&&(h=v.color||v.colors,Array.isArray(h)&&_(1===h.length||n.webgl_draw_buffers,"multiple render targets not supported")),h||("colorCount"in v&&(m=0|v.colorCount,_(m>0,"invalid color buffer count")),"colorType"in v&&(_.oneOf(v.colorType,l,"invalid color type"),g=v.colorType),"colorFormat"in v&&(p=v.colorFormat,_.oneOf(v.colorFormat,u,"invalid color format for texture"))),"depth"in v&&(d.depth=v.depth),"stencil"in v&&(d.stencil=v.stencil),"depthStencil"in v&&(d.depthStencil=v.depthStencil)}else f=1;if(h)if(Array.isArray(h))for(c=[],r=0;r<h.length;++r)c[r]=h[r];else c=[h];else{c=Array(m);var b={radius:f,format:p,type:g};for(r=0;r<m;++r)c[r]=o.createCube(b)}for(d.color=Array(c.length),r=0;r<c.length;++r){var E=c[r];_("function"==typeof E&&"textureCube"===E._reglType,"invalid cube map"),f=f||E.width,_(E.width===f&&E.height===f,"invalid cube map shape"),d.color[r]={target:Et,data:c[r]}}for(r=0;r<6;++r){for(var w=0;w<c.length;++w)d.color[w].target=Et+r;r>0&&(d.depth=i[0].depth,d.stencil=i[0].stencil,d.depthStencil=i[0].depthStencil),i[r]?i[r](d):i[r]=T(d)}return t(a,{width:f,height:f,color:c})}return a(e),t(a,{faces:i,resize:function(e){var t,n=0|e;if(_(n>0&&n<=r.maxCubeMapSize,"invalid radius for cube fbo"),n===a.width)return a;var o=a.color;for(t=0;t<o.length;++t)o[t].resize(n);for(t=0;t<6;++t)i[t].resize(n);return a.width=a.height=n,a},_reglType:"framebufferCube",destroy:function(){i.forEach((function(e){e.destroy()}))}})},clear:function(){W(E).forEach(S)},restore:function(){s.cur=null,s.next=null,s.dirty=!0,W(E).forEach((function(t){t.framebuffer=e.createFramebuffer(),I(t)}))}})}(o,f,y,S,I,d),A=ur(o,l,f,y,b,w,0,T,{},E,x,{elements:null,primitive:4,count:-1,offset:0,instances:-1},v,h,r),N=Dt(o,T,A.procs.poll,v,i,f,y),O=A.next,R=o.canvas,L=[],z=[],G=[],X=[r.onDestroy],H=null;function q(){if(0===L.length)return h&&h.update(),void(H=null);H=k.next(q),ye();for(var e=L.length-1;e>=0;--e){var t=L[e];t&&t(v,null,0)}o.flush(),h&&h.update()}function Y(){!H&&L.length>0&&(H=k.next(q))}function le(){H&&(k.cancel(q),H=null)}function de(e){e.preventDefault(),a=!0,le(),z.forEach((function(e){e()}))}function fe(e){o.getError(),a=!1,s.restore(),x.restore(),b.restore(),S.restore(),I.restore(),T.restore(),E.restore(),h&&h.restore(),A.procs.refresh(),Y(),G.forEach((function(e){e()}))}function he(e){function n(e,t){var n={},r={};return Object.keys(e).forEach((function(o){var i=e[o];if(D.isDynamic(i))r[o]=D.unbox(i,o);else{if(t&&Array.isArray(i))for(var a=0;a<i.length;++a)if(D.isDynamic(i[a]))return void(r[o]=D.unbox(i,o));n[o]=i}})),{dynamic:r,static:n}}_(!!e,"invalid args to regl({...})"),_.type(e,"object","invalid args to regl({...})");var r=n(e.context||{},!0),o=n(e.uniforms||{},!0),i=n(e.attributes||{},!1),s=n(function(e){var n=t({},e);function r(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach((function(r){n[e+"."+r]=t[r]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),"vao"in e&&(n.vao=e.vao),n}(e),!1),u={gpuTime:0,cpuTime:0,count:0},c=A.compile(s,i,o,r,u),l=c.draw,d=c.batch,f=c.scope,h=[];return t((function(e,t){var n;if(a&&_.raise("context lost"),"function"==typeof e)return f.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)f.call(this,null,t,n);else{if(!Array.isArray(e))return f.call(this,e,t,0);for(n=0;n<e.length;++n)f.call(this,e[n],t,n)}else if("number"==typeof e){if(e>0)return d.call(this,function(e){for(;h.length<e;)h.push(null);return h}(0|e),0|e)}else{if(!Array.isArray(e))return l.call(this,e);if(e.length)return d.call(this,e,e.length)}}),{stats:u,destroy:function(){c.destroy()}})}R&&(R.addEventListener(lr,de,!1),R.addEventListener(dr,fe,!1));var pe=T.setFBO=he({framebuffer:D.define.call(null,1,"framebuffer")});function ge(e,t){var n=0;A.procs.poll();var r=t.color;r&&(o.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in t&&(o.clearDepth(+t.depth),n|=256),"stencil"in t&&(o.clearStencil(0|t.stencil),n|=1024),_(!!n,"called regl.clear with no buffer specified"),o.clear(n)}function me(e){return _.type(e,"function","regl.frame() callback must be a function"),L.push(e),Y(),{cancel:function(){var t=fr(L,e);_(t>=0,"cannot cancel a frame twice"),L[t]=function e(){var t=fr(L,e);L[t]=L[L.length-1],L.length-=1,L.length<=0&&le()}}}}function ve(){var e=O.viewport,t=O.scissor_box;e[0]=e[1]=t[0]=t[1]=0,v.viewportWidth=v.framebufferWidth=v.drawingBufferWidth=e[2]=t[2]=o.drawingBufferWidth,v.viewportHeight=v.framebufferHeight=v.drawingBufferHeight=e[3]=t[3]=o.drawingBufferHeight}function ye(){v.tick+=1,v.time=Ee(),ve(),A.procs.poll()}function be(){S.refresh(),ve(),A.procs.refresh(),h&&h.update()}function Ee(){return(M()-p)/1e3}be();var we=t(he,{clear:function(e){if(_("object"==typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var n=0;n<6;++n)pe(t({framebuffer:e.framebuffer.faces[n]},e),ge);else pe(e,ge);else ge(0,e)},prop:D.define.bind(null,1),context:D.define.bind(null,2),this:D.define.bind(null,3),draw:he({}),buffer:function(e){return b.create(e,34962,!1,!1)},elements:function(e){return w.create(e,!1)},texture:S.create2D,cube:S.createCube,renderbuffer:I.create,framebuffer:T.create,framebufferCube:T.createCube,vao:E.createVAO,attributes:i,frame:me,on:function(e,t){var n;switch(_.type(t,"function","listener callback must be a function"),e){case"frame":return me(t);case"lost":n=z;break;case"restore":n=G;break;case"destroy":n=X;break;default:_.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}},limits:y,hasExtension:function(e){return y.extensions.indexOf(e.toLowerCase())>=0},read:N,destroy:function(){L.length=0,le(),R&&(R.removeEventListener(lr,de),R.removeEventListener(dr,fe)),x.clear(),T.clear(),I.clear(),S.clear(),w.clear(),b.clear(),E.clear(),h&&h.clear(),X.forEach((function(e){e()}))},_gl:o,_refresh:be,poll:function(){ye(),h&&h.update()},now:Ee,stats:d});return r.onDone(null,we),we}}()},262:(e,t,n)=>{var r=n(100);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),(0,n(159).Z)("5a039d0e",r,!0,{})},159:(e,t,n)=>{"use strict";function r(e,t){for(var n=[],r={},o=0;o<t.length;o++){var i=t[o],a=i[0],s={id:e+":"+o,css:i[1],media:i[2],sourceMap:i[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}n.d(t,{Z:()=>p});var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},a=o&&(document.head||document.getElementsByTagName("head")[0]),s=null,u=0,c=!1,l=function(){},d=null,f="data-vue-ssr-id",h="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(e,t,n,o){c=n,d=o||{};var a=r(e,t);return g(a),function(t){for(var n=[],o=0;o<a.length;o++){var s=a[o];(u=i[s.id]).refs--,n.push(u)}for(t?g(a=r(e,t)):a=[],o=0;o<n.length;o++){var u;if(0===(u=n[o]).refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete i[u.id]}}}}function g(e){for(var t=0;t<e.length;t++){var n=e[t],r=i[n.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](n.parts[o]);for(;o<n.parts.length;o++)r.parts.push(v(n.parts[o]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var a=[];for(o=0;o<n.parts.length;o++)a.push(v(n.parts[o]));i[n.id]={id:n.id,refs:1,parts:a}}}}function m(){var e=document.createElement("style");return e.type="text/css",a.appendChild(e),e}function v(e){var t,n,r=document.querySelector("style["+f+'~="'+e.id+'"]');if(r){if(c)return l;r.parentNode.removeChild(r)}if(h){var o=u++;r=s||(s=m()),t=E.bind(null,r,o,!1),n=E.bind(null,r,o,!0)}else r=m(),t=w.bind(null,r),n=function(){r.parentNode.removeChild(r)};return t(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;t(e=r)}else n()}}var y,b=(y=[],function(e,t){return y[e]=t,y.filter(Boolean).join("\n")});function E(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function w(e,t){var n=t.css,r=t.media,o=t.sourceMap;if(r&&e.setAttribute("media",r),d.ssrId&&e.setAttribute(f,t.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},142:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=142,e.exports=t},649:(e,t,n)=>{var r=n(114).default;function o(){"use strict";e.exports=o=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,i=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof g?t:g,i=Object.create(o.prototype),s=new N(r||[]);return a(i,"_invoke",{value:S(e,n,s)}),i}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var p={};function g(){}function m(){}function v(){}var y={};d(y,u,(function(){return this}));var b=Object.getPrototypeOf,E=b&&b(b(D([])));E&&E!==n&&i.call(E,u)&&(y=E);var w=v.prototype=g.prototype=Object.create(y);function x(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(o,a,s,u){var c=h(e[o],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var o;a(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}})}function S(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=I(a,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=h(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function I(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var o=h(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,p;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function D(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:k}}function k(){return{value:void 0,done:!0}}return m.prototype=v,a(w,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:m,configurable:!0}),m.displayName=d(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,d(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},x(_.prototype),d(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new _(f(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(w),d(w,l,"Generator"),d(w,u,(function(){return this})),d(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=D,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},t}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},114:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},975:(e,t,n)=>{var r=n(649)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var r={};(()=>{"use strict";var e;n.r(r),n.d(r,{default:()=>t}),n(262);const t={install:function(t,r){return e?console.error("already installed."):(e=t,r({routes:n(267).Z,store:n(625).Z(e),config:n(835).Z,locales:n(380).Z,components:n(229).Z}))}}})(),window["a-antvlayout"]=r})();
//# sourceMappingURL=front.js.map